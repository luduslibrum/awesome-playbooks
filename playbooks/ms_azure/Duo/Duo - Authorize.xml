<?xml version="1.0" encoding="utf-8"?>
<Workflow>
  <WorkflowInfo Name="Duo - Authorize" Description="" Details="" XML="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;SequentialWorkflowActivity xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/workflow&quot; xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot; x:Name=&quot;CustomWorkflow&quot; x:Class=&quot;WorkflowDesignerControl.CustomWorkflow&quot;&gt;&lt;MemorySet x:Name=&quot;setAPI&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;apiURL&quot; VariableValue=&quot;api-XXXXXXXX.duosecurity.com&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;MemorySet x:Name=&quot;setIntegrationKey&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;integrationKey&quot; VariableValue=&quot;XXXXXXXXXXX&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;MemorySet x:Name=&quot;setSecretKey&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;secretKey&quot; VariableValue=&quot;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;MemorySet x:Name=&quot;setMethod&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;method&quot; VariableValue=&quot;POST&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;MemorySet x:Name=&quot;setParams&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;paramList&quot; VariableValue=&quot;device=auto&amp;amp;factor=auto&amp;amp;username=%parent.duoUsername%&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;MemorySet x:Name=&quot;setPath&quot; activityLicenseType=&quot;1&quot; id=&quot;430&quot; name=&quot;MemorySet&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Set Memory&quot; Description=&quot;Allocates a value to a Workflow/Global  variable&quot; VariableScope=&quot;Workflow&quot; IsSaved=&quot;False&quot; VariableName=&quot;path&quot; VariableValue=&quot;/auth/v2/auth&quot; IsAppend=&quot;False&quot; TypeName=&quot;MemorySet&quot; label=&quot;Set Memory&quot; description=&quot;Allocates a value to a Workflow/Global  variable&quot; notes=&quot;&quot; /&gt;&lt;PowerShellScript x:Name=&quot;rfcDate&quot; activityLicenseType=&quot;1&quot; id=&quot;87&quot; name=&quot;PowerShellScript&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;PowerShell Script&quot; Description=&quot;Executes a Powershell script on a local device&quot; ScriptPath=&quot;&quot; ScriptCode=&quot;$date = Get-Date&amp;#xA;[string]$dateString = $date.ToUniversalTime().ToString(&amp;quot;ddd, dd MMM yyyy HH:mm:ss -0000&amp;quot;,([System.Globalization.CultureInfo]::InvariantCulture))&amp;#xA;&amp;#xA;Write-Output $dateString&quot; scriptSource=&quot;1&quot; TableAsString=&quot;&quot; HasParams=&quot;0&quot; HostId=&quot;-1&quot; HostName=&quot;{x:Null}&quot; TypeName=&quot;PowerShellScript&quot; label=&quot;PowerShell Script&quot; description=&quot;Executes a Powershell script on a local device&quot; notes=&quot;&quot; /&gt;&lt;PowerShellScript x:Name=&quot;authorizationHeader&quot; activityLicenseType=&quot;1&quot; id=&quot;87&quot; name=&quot;PowerShellScript&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;PowerShell Script&quot; Description=&quot;Executes a Powershell script on a local device&quot; ScriptPath=&quot;&quot; ScriptCode=&quot;$dateString = '%rfcDate%'&amp;#xA;$api = '%apiURL%'&amp;#xA;$integrationKey = '%integrationKey%'&amp;#xA;$secretKey = '%secretKey%'&amp;#xA;$method = '%method%'&amp;#xA;$params = '%paramList%'&amp;#xA;$path = '%path%'&amp;#xA;&amp;#xA;$message = &amp;quot;$($dateString)`n$($method)`n$($api)`n$($path)`n$($params)&amp;quot;&amp;#xA;&amp;#xA;$hmacsha = New-Object System.Security.Cryptography.HMACSHA1&amp;#xA;$hmacsha.Key = [System.Text.Encoding]::UTF8.GetBytes($secretKey)&amp;#xA;$hash_bytes = $hmacsha.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($message))&amp;#xA;$hash_hex = [System.BitConverter]::ToString($hash_bytes)&amp;#xA;$response = $hash_hex.Replace(&amp;quot;-&amp;quot;,&amp;quot;&amp;quot;).ToLower()&amp;#xA;&amp;#xA;$auth = &amp;quot;$integrationKey&amp;quot; + &amp;quot;:&amp;quot; + &amp;quot;$response&amp;quot;&amp;#xA;$auth = [System.Convert]::ToBase64String([System.Text.Encoding]::ASCII.GetBytes($auth))&amp;#xA;&amp;#xA;Write-Output $auth&quot; scriptSource=&quot;1&quot; TableAsString=&quot;&quot; HasParams=&quot;0&quot; HostId=&quot;-1&quot; HostName=&quot;{x:Null}&quot; TypeName=&quot;PowerShellScript&quot; label=&quot;PowerShell Script&quot; description=&quot;Executes a Powershell script on a local device&quot; notes=&quot;&quot; /&gt;&lt;HTTPRequest x:Name=&quot;sendDuoRequest&quot; activityLicenseType=&quot;1&quot; id=&quot;492&quot; name=&quot;HTTPRequest&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:05:00&quot; TimeInSeconds=&quot;300&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;HTTP Request&quot; Description=&quot;Sends an HTTP request (including headers)&quot; Url=&quot;https://%apiURL%%path%?&quot; UserName=&quot;&quot; Password=&quot;&quot; RequestType=&quot;Post&quot; ContentType=&quot;application/x-www-form-urlencoded&quot; PostData=&quot;%paramList%&quot; HeaderData=&quot;Authorization|y|y|Basic %authorizationHeader%|x|x|X-Duo-Date|y|y|%rfcDate%|x|x|method|y|y|%method%|x|x|host|y|y|%apiURL%|x|x|path|y|y|%path%|x|x|params|y|y|%paramList%|x|x|&quot; Proxy=&quot;&quot; SrcUserName=&quot;&quot; SrcPassword=&quot;&quot; Sectype=&quot;TLS12&quot; crtval=&quot;0&quot; SiteId=&quot;-1&quot; SiteName=&quot;&quot; ProxyUrls=&quot;&quot; isChecked=&quot;False&quot; byPass=&quot;False&quot; HostId=&quot;0&quot; HostName=&quot;&quot; TypeName=&quot;HTTPRequest&quot; label=&quot;HTTP Request&quot; description=&quot;Sends an HTTP request (including headers)&quot; notes=&quot;&quot; /&gt;&lt;StartJsonSession x:Name=&quot;startJsonSession&quot; activityLicenseType=&quot;1&quot; id=&quot;464&quot; name=&quot;StartJsonSession&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Start Json Session&quot; Description=&quot;Start Json Session&quot; JsonString=&quot;getcellvalue(%sendDuoRequest%,1,1)&quot; HostId=&quot;0&quot; HostName=&quot;{x:Null}&quot; StartSession=&quot;XML&quot; Password=&quot;{x:Null}&quot; UserName=&quot;{x:Null}&quot; TypeName=&quot;StartJsonSession&quot; label=&quot;Start Json Session&quot; description=&quot;Start Json Session&quot; notes=&quot;&quot; /&gt;&lt;JsonToTable x:Name=&quot;duoResponse&quot; activityLicenseType=&quot;1&quot; id=&quot;463&quot; name=&quot;JsonToTable&quot; visible=&quot;True&quot; disabled=&quot;False&quot; isFavorite=&quot;False&quot; isJsonValid=&quot;True&quot; IsValid=&quot;True&quot; Timeout=&quot;00:01:00&quot; TimeInSeconds=&quot;60&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; TargetModuleID=&quot;&quot; TargetModuleName=&quot;&quot; Path=&quot;{x:Null}&quot; DisplayName=&quot;Json To Table&quot; Description=&quot;Json To Table&quot; SessionName=&quot;startJsonSession&quot; KeyPath=&quot;.response.result&quot; HostId=&quot;0&quot; HostName=&quot;{x:Null}&quot; TypeName=&quot;JsonToTable&quot; label=&quot;Json To Table&quot; description=&quot;Json To Table&quot; notes=&quot;&quot; /&gt;&lt;/SequentialWorkflowActivity&gt;" />
  <Tags>
  </Tags>
</Workflow>