{
  "flows": [
    {
      "name": "yyy_m_NGINX_Controller_HTTP_Access",
      "nodes": [
        {
          "id": "be24707b-782c-453b-833b-7ef2348adc5b",
          "name": "OddUserAgent",
          "kind": "augmentation",
          "lql": "`SELECT useragent, count(useragent) AS agentcount from NC_httpaccesslogs\nGROUP BY useragent`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 760,
          "y": 122,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "384538d8-44de-4af7-ad63-4a5db3a45c7c",
          "name": "PrepOddsforOutput",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts AS alert_time, \n'LH00161' AS alert_id, \nconcat(\"Suspicious Browser Seen \",useragent, \" connecting to \",proxyupstreamname) AS alert_title, \n\"Initial Access\" AS technique, \n\"Exploit Public Facing Application\" AS tactic, \n2 as lhub_score,\n2 risk_score,\n1 fidelity_score,\nTO_JSON(STRUCT(url, uripath, useragent, remoteaddress, httpstatus, method, agentcount)) as additional_data,\n\" \" AS src_user,\n\" \" AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname AS dest_machine_name\nFROM ManualBrowserWhitelist`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 680,
          "y": 650,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "d8edd919-3bfe-4696-b3d9-5daee4e5be47",
          "name": "PrepRequestTimeAlertOutput",
          "kind": "augmentation",
          "lql": "`select lhub_ts as alert_time,'\nLH00162' as alert_id,\nconcat(\"Suspicious Request Fullfillment details for address \",remoteaddress) AS alert_title,\n\"Endpoint Denial of Service\" as technique, \t\n\"Impact\" as tactic, \n\"Actions on Objective\" as attack_chain, \n3 as lhub_score,\n1 as fidelity_score,\n3 as risk_score, \nTO_JSON(STRUCT(remoteaddress,method,uripath,httpprotocol,httpstatus,url,useragent,requestlength,requesttime,proxyaddress)) as additional_data,\n\" \" AS src_user,\n\" \" AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname as dest_machine_name from SuspiciousRequestTime_Size`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 990,
          "y": 640,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "c1afd171-18b1-4067-8771-c6c857c886f4",
          "name": "URLs_for_excessive_login_attempt_monitoring",
          "kind": "augmentation",
          "lql": "`SELECT * FROM NC_httpaccesslogs \n/* List all authentication portals behind the controler */ \nWHERE url LIKE (\"%/users/sign_in\")`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 80,
          "y": 112,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "93cedf37-a1a2-489c-b8eb-0263d5b478f0",
          "name": "InitialScoring",
          "kind": "augmentation",
          "lql": "`select *, \nCASE\n    WHEN agentcount > 5 THEN 0\n    WHEN LENGTH(useragent) < 2 THEN 9\n    WHEN LENGTH(useragent) < 7 THEN 7\n    WHEN useragent REGEXP '[bB][oO][tT]' THEN 5\n    ELSE 4\nEND AS lhub_score\nfrom OddUserAgent\nORDER BY lhub_score DESC`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 760,
          "y": 254,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "752b2f7c-bf69-4fc1-a005-c171576c6394",
          "name": "count_connection_attempts_in_group_by_statement",
          "kind": "augmentation",
          "lql": "`select remoteaddress, count(remoteaddress) AS remotecount from URLs_for_excessive_login_attempt_monitoring\ngroup by remoteaddress\norder by remotecount DESC;`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 0,
          "y": 244,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "346853ac-ff54-4106-b955-c37ea81ed0e2",
          "name": "ManualBrowserWhitelist",
          "kind": "augmentation",
          "lql": "`select * from JoinCountstoFull\n/* Adding manual whitelist entires by Browser/UAS */\nWHERE (useragent !=\"mtest\")\nAND lhub_score > 7`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 680,
          "y": 518,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "0a8d4b7e-7885-4c0b-a67d-545f3c24c3bd",
          "name": "HealthCheckNotGoogle",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts, remoteaddress, method, httpstatus, url, useragent, uripath,localaddress, proxyupstreamname,\tproxyaddress from NC_httpaccesslogs\nWHERE uripath=\"/healthz\"\n/* Add useragent for any smoke testing */\nAND useragent NOT LIKE \"%StatusCake%\"\nAND useragent!=\"GoogleStackdriverMonitoring-UptimeChecks(https://cloud.google.com/monitoring)\";`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1590,
          "y": 518,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "5ffd4783-9c8a-41c7-a69f-a6ade593e596",
          "name": "PrepForAlertOutput_InfoLeak",
          "kind": "augmentation",
          "lql": "`select lhub_ts AS alert_time, 'LH00166' AS alert_id, concat(\"Possible infoleak by address \",remoteaddress) AS alert_title,\n\"Cloud Service Discovery\" as technique, \t\n\"Discovery\" as tactic,\n\"Reconnaissance\" as attack_chain, \n2 as lhub_score,\n1 risk_score,\n2 fidelity_score,\nTO_JSON(STRUCT(lhub_ts, proxyupstreamname,proxyaddress,method, httpstatus,url,uripath,useragent)) as additional_data,\n\" \" AS src_user,\n\" \" AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname as dest_machine_name\n from HealthCheckNotGoogle`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1590,
          "y": 640,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "f7a464cf-718f-499c-b3c1-acf325b3cf9d",
          "name": "NC_httpaccesslogs",
          "kind": "eventType",
          "isLeaf": false,
          "eventType": "eventType-28",
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 760,
          "y": 0,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "contentItemIdentifier": {
            "kind": "EventTypeContentKind",
            "id": "eventType-28"
          },
          "categoryKind": "FetchData",
          "linkToTrigger": true,
          "iconTitle": "Fetch Data: NGINX_Controller_HTTP_access",
          "usedByEventTypes": []
        },
        {
          "id": "2440fccb-13a2-4c29-aa17-535068b4d4e6",
          "name": "JoinCountstoFull",
          "kind": "augmentation",
          "lql": "autoJoin(NC_httpaccesslogs, InitialScoring)",
          "operator": "autoJoin",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 680,
          "y": 386,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "OperatorForm",
          "contentItemIdentifier": {
            "kind": "OperatorContentKind",
            "id": "autoJoin"
          },
          "categoryKind": "Transform",
          "iconTitle": "Transform: Auto Join",
          "usedByEventTypes": []
        },
        {
          "id": "3af12d5f-ed03-4d3b-87c4-493900cab832",
          "name": "PrepAlertOutput_Counts",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts AS alert_time, \n'LH00161' AS alert_id, \nconcat(\"Brute Force Behavior address \", remoteaddress, \" against \", proxyupstreamname) AS alert_title, \n\"Brute Force\" AS technique, \n\"Credential Access\" AS tactic, \n2 as lhub_score,\n2 risk_score,\n1 fidelity_score,\nTO_JSON(STRUCT(lhub_ts,method,uripath,httpprotocol,httpstatus,url,useragent,requestlength,requesttime,proxyupstreamname,proxyaddress)) as additional_data,\n\" \" AS src_user,\n\" \" AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname AS dest_machine_name \nFROM manualWhitelist`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 80,
          "y": 650,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "40e2b6b3-89c5-4cf0-8901-ec0b4c399ac2",
          "name": "JiraAccessNoAtlassianWebHook",
          "kind": "augmentation",
          "lql": "`select * from NC_httpaccesslogs\nWHERE uripath LIKE \"%jira%\"\nAND useragent NOT LIKE \"Atlassian%\"\nAND useragent NOT Like \"okhttp%\"\nAND uripath NOT LIKE \"%.png\"\nAND uripath NOT LIKE \"%.svg\"\nAND proxyupstreamname LIKE \"production%\"\n;`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 380,
          "y": 376,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "05fe5ca5-c449-4827-8095-b65a67425c34",
          "name": "URLWhitelist",
          "kind": "augmentation",
          "lql": "`select * from JiraAccessNoAtlassianWebHook\n/* Current thought is that whitelisting will be at url level */\nWHERE NOT url  REGEXP \"atest.test\"`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 380,
          "y": 518,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "8a8af683-f3e2-4e1f-9fe5-4eeb99ef01ea",
          "name": "PrepforOutputJiraWebhook",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts AS alert_time, \n'LH00164' AS alert_id, \nconcat(\"Suspicious Jira Exposure on \", proxyupstreamname ,\" using \", method, \" from \", remoteaddress) AS alert_title, \n\" \" AS technique, \n\" \" AS tactic, \n2 as lhub_score,\n2 risk_score,\n1 fidelity_score,\nTO_JSON(STRUCT(proxyupstreamname, remoteaddress, useragent, method, httpstatus)) as additional_data,\n\" \" AS src_user,\n\" \" AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname AS dest_machine_name \nFROM URLWhitelist`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 380,
          "y": 650,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "d85e2a63-bd16-479f-b103-b17a227f8a14",
          "name": "PrepAllAlertOutputs",
          "kind": "augmentation",
          "lql": "unionAll(PrepAlertOutput_Counts, PrepOddsforOutput, PrepforOutputJiraWebhook, PrepforOutputJiraAccess, PrepRequestTimeAlertOutput, PrepForAlertOutput_InfoLeak)",
          "operator": "unionAll",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 830,
          "y": 772,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": true,
          "formType": "OperatorForm",
          "contentItemIdentifier": {
            "kind": "OperatorContentKind",
            "id": "unionAll"
          },
          "categoryKind": "Transform",
          "iconTitle": "Transform: Union All",
          "usedByEventTypes": []
        },
        {
          "id": "aed8f36b-4ec7-41e1-87bb-758d1e1dbd8f",
          "name": "JiraAccessUserNotMatchingKey",
          "kind": "augmentation",
          "lql": "`select lhub_ts, id, key, localAddress, remoteaddress, useragent, url from NC_httpaccesslogs\nWHERE useragent=\"Atlassian Webhook HTTP Client\"\nAND ucase(id)!=ucase(key)\n`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1290,
          "y": 376,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "6cbf435c-2bfa-41bd-866a-83e1536d9484",
          "name": "Output",
          "kind": "output",
          "warnings": [],
          "description": "",
          "nodes": [
            "d85e2a63-bd16-479f-b103-b17a227f8a14"
          ],
          "isExplainable": true,
          "x": 830,
          "y": 884,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "categoryKind": "Unknown",
          "iconTitle": "Unknown",
          "usedByEventTypes": []
        },
        {
          "id": "295df768-42fe-40ff-afe5-8dfc1ec970ab",
          "name": "PrepforOutputJiraAccess",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts AS alert_time, \n'LH00165' AS alert_id, \n\"Mismatched Key to User Jira Access\" AS alert_title, \n\"Exploitation for Credential Access\" AS technique, \n\"Credential Access\" AS tactic, \n2 as lhub_score,\n2 risk_score,\n1 fidelity_score,\nTO_JSON(STRUCT(id, key, useragent)) as additional_data,\n\" \" AS src_user,\nid AS dest_user, \nremoteaddress as src_ip, \nlocaladdress as dest_ip, \n\" \" as src_machine_name, \nproxyupstreamname AS dest_machine_name \nFROM UserKeyWhitelist`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1290,
          "y": 650,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "7570692d-682d-4f16-bc35-6e100049b924",
          "name": "SuspiciousRequestTime_Size",
          "kind": "augmentation",
          "lql": "`select * from NC_httpaccesslogs\nWHERE requesttime > 6.0\n/*Too many larger, very quick api calls */`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 990,
          "y": 508,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "123a2ecf-0275-484c-bea9-fae8f6a3399f",
          "name": "UserKeyWhitelist",
          "kind": "augmentation",
          "lql": "`SELECT * from JiraAccessUserNotMatchingKey\n/* Adding manual whitelist entires id and key pair */\nWHERE (id!=\"testid\" AND key!=\"testkey\")`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1290,
          "y": 518,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "196d5fc5-f99b-4a32-8014-40cfec8223f5",
          "name": "manualWhitelist",
          "kind": "augmentation",
          "lql": "`SELECT * from join_connection_attempts\nWHERE remotecount > 35`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 80,
          "y": 518,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "2ebfe8f7-b6e4-4faf-ba7b-7da3b2482842",
          "name": "join_connection_attempts",
          "kind": "augmentation",
          "lql": "autoJoinTables([URLs_for_excessive_login_attempt_monitoring,count_connection_attempts_in_group_by_statement])",
          "operator": "autoJoinTables",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 80,
          "y": 386,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "OperatorForm",
          "contentItemIdentifier": {
            "kind": "OperatorContentKind",
            "id": "autoJoinTables"
          },
          "categoryKind": "Transform",
          "iconTitle": "Transform: Auto Join Tables",
          "usedByEventTypes": []
        }
      ],
      "oldId": "flow-1037",
      "listNames": [],
      "dependentCommands": [],
      "resourceFormatVersion": 2,
      "fileDataSeq": []
    }
  ],
  "baselines": [],
  "eventTypes": [
    {
      "id": "eventType-28",
      "data": {
        "name": "NGINX_Controller_HTTP_access",
        "query": "(_sourceCategory=kubernetes/ingress/nginx/nginx/ingress/controller)\nhttp NOT \"buffered to a temporary file\" |parse regex field=_raw \"\\\"log\\\":\\\"(?<localAddress>[\\w.:]*)[\\s-]+(?<remoteAddress>[\\w.:]*)[\\s-]-\\s[^]]*]\\s\\\\\\\"(?<method>\\w+)\\s(?<uriPath>[^\\s]+)\\s(?<httpProtocol>[^\\\\]+)\\\\\\\"\\s(?<httpStatus>\\d+)\\s\\d+\\s\\\\\\\"(?<url>[^\\\\]+)\\\\\\\"\\s\\\\\\\"(?<userAgent>.*)\\\\\\\"\\s(?<requestLength>\\d+)\\s(?<requestTime>.+)\\s\\[(?<proxyUpstreamName>.+)\\]\\s(?<proxyAddress>[\\w.:]*)\\s\" nodrop | parse regex field=uriPath \"user_id=(?<id>[\\-.+\\w+]*)&user_key=(?<key>[\\-.+\\w+]*)\"",
        "keyColumns": "localAddress,remoteAddress,method,uriPath,httpProtocol,httpStatus,url,userAgent,requestLength,requestTime,proxyUpstreamName,proxyAddress,id,key",
        "connection": "connection-5",
        "connectionTypeEntities": {
          "entities": [
            {
              "connectionType": {
                "connectionType": "sumologic",
                "value": "query"
              },
              "connectionTypeDetail": {
                "query": "(_sourceCategory=kubernetes/ingress/nginx/nginx/ingress/controller)\nhttp NOT \"buffered to a temporary file\" |parse regex field=_raw \"\\\"log\\\":\\\"(?<localAddress>[\\w.:]*)[\\s-]+(?<remoteAddress>[\\w.:]*)[\\s-]-\\s[^]]*]\\s\\\\\\\"(?<method>\\w+)\\s(?<uriPath>[^\\s]+)\\s(?<httpProtocol>[^\\\\]+)\\\\\\\"\\s(?<httpStatus>\\d+)\\s\\d+\\s\\\\\\\"(?<url>[^\\\\]+)\\\\\\\"\\s\\\\\\\"(?<userAgent>.*)\\\\\\\"\\s(?<requestLength>\\d+)\\s(?<requestTime>.+)\\s\\[(?<proxyUpstreamName>.+)\\]\\s(?<proxyAddress>[\\w.:]*)\\s\" nodrop | parse regex field=uriPath \"user_id=(?<id>[\\-.+\\w+]*)&user_key=(?<key>[\\-.+\\w+]*)\"",
                "connection": "connection-5"
              }
            }
          ]
        },
        "defaultConnectionType": {
          "connectionType": "sumologic",
          "value": "query"
        }
      }
    }
  ],
  "connections": [
    {
      "id": "connection-5",
      "data": {
        "connectionType": "sumologic",
        "name": "Sumo",
        "isActive": false,
        "account": "",
        "secret": "",
        "url": "https://api.us2.sumologic.com/api/v1"
      }
    }
  ],
  "modules": [],
  "annotations": [],
  "filters": [],
  "ruleSets": [],
  "integrationInstances": [],
  "customLists": [],
  "streams": [],
  "dashboards": [],
  "images": [],
  "codeBlobs": {},
  "customListsData": {},
  "executionScripts": [],
  "userForms": [],
  "flowNodeReferences": [],
  "destinations": [],
  "fileResources": [],
  "fileDataSeq": [],
  "eventModels": [],
  "version": 1
}