{
  "flows": [
    {
      "name": "yyy_d_Alerts_Registry_4657",
      "nodes": [
        {
          "id": "b7cd7954-248b-4dac-a0df-18100cd2b9e0",
          "name": "Array_Element_To_ColumnChild2",
          "kind": "augmentation",
          "lql": "`select _id, explode(split(tactic,'\\\\|')) as tactic  from Array_Element_To_Column`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 896,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "58e4a525-5b27-4c0f-98af-7d508aeebdac",
          "name": "Consolidate_Alerts",
          "kind": "augmentation",
          "lql": "`SELECT max(lhub_score) AS lhub_score, collect_set(tag_description) as tag_description FROM Create_Alert_Descriptions GROUP BY _id`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 1028,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "344832f6-b24d-4b83-a608-72e5c85aca85",
          "name": "Tag_To_Array",
          "kind": "augmentation",
          "lql": "`select  *,split(powershell_tags,';') tag_split from One_Tag_Per_Line`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 750,
          "y": 672,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "a38218d3-1116-457b-88c6-66ae45ceec6c",
          "name": "Join_Alerts_Back_To_Orginal_Data",
          "kind": "scorer",
          "lql": "autoJoinScores([Prepare_Additional_Data,Consolidate_Alerts,Unique_Techniques,Unique_Tactics,Unique_Alert_Ids])",
          "operator": "autoJoinScores",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 1140,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "OperatorForm",
          "contentItemIdentifier": {
            "kind": "OperatorContentKind",
            "id": "autoJoinScores"
          },
          "categoryKind": "Transform",
          "iconTitle": "Transform: Auto Join Scores",
          "usedByEventTypes": []
        },
        {
          "id": "137b546f-2e18-4a8a-b1c0-c1d281925bfe",
          "name": "Unique_Alert_Ids",
          "kind": "augmentation",
          "lql": "`select collect_set(alert_id) as alert_id_array  from Array_Element_To_ColumnChild3 group by _id`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1200,
          "y": 1028,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "2954e1d5-0a47-48fd-b872-dd07f50aa4c3",
          "name": "Output",
          "kind": "output",
          "warnings": [],
          "description": "",
          "nodes": [
            "af6c5305-b644-488b-8196-6af4f4da3b87"
          ],
          "isExplainable": true,
          "x": 600,
          "y": 1384,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "categoryKind": "Unknown",
          "iconTitle": "Unknown",
          "usedByEventTypes": []
        },
        {
          "id": "32e896f1-3903-4c98-9edc-74db779bb634",
          "name": "Array_Element_To_ColumnChild1",
          "kind": "augmentation",
          "lql": "`select _id, explode(split(technique,'\\\\|')) as technique  from Array_Element_To_Column`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 900,
          "y": 896,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "35b36fbb-57b7-46f3-b7f5-c3a9e5520b2e",
          "name": "Unique_Techniques",
          "kind": "augmentation",
          "lql": "`select concat_ws(';',collect_set(technique)) as technique from Array_Element_To_ColumnChild1 group by _id `",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 900,
          "y": 1028,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "ff38ad74-0c58-4c74-aae7-96947392420a",
          "name": "Array_Element_To_ColumnChild3",
          "kind": "augmentation",
          "lql": "`select _id, explode(split(alert_id,'\\\\|')) as alert_id from Array_Element_To_Column`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 1200,
          "y": 896,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "f619751f-6274-442a-86c0-8b070d5fc497",
          "name": "MDR_MITRE_Sample_Data",
          "kind": "eventType",
          "isLeaf": false,
          "eventType": "eventType-4",
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 0,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "contentItemIdentifier": {
            "kind": "EventTypeContentKind",
            "id": "eventType-4"
          },
          "categoryKind": "FetchData",
          "linkToTrigger": true,
          "iconTitle": "Fetch Data: MDR_MITRE_Sample_Data",
          "usedByEventTypes": []
        },
        {
          "id": "b21fe8f4-466f-46be-b882-d40157c917b1",
          "name": "ESK_Registryv2",
          "kind": "eventType",
          "isLeaf": false,
          "eventType": "eventType-5",
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 224,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "contentItemIdentifier": {
            "kind": "EventTypeContentKind",
            "id": "eventType-5"
          },
          "categoryKind": "FetchData",
          "linkToTrigger": true,
          "iconTitle": "Fetch Data: ESK_Registryv2",
          "usedByEventTypes": []
        },
        {
          "id": "d8f443c4-bb0f-4aae-9509-6633e23725e2",
          "name": "Unique_Tactics",
          "kind": "augmentation",
          "lql": "`select concat_ws(';',collect_set(tactic)) as tactic from Array_Element_To_ColumnChild2 group by _id `",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 1028,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "802b1301-64fd-4618-a61f-0e8510dc5fe5",
          "name": "One_Tag_Per_Line",
          "kind": "augmentation",
          "lql": "`select *,lhub_id as _id,explode(split(regexp_replace(GET_JSON_OBJECT(lhub_pattern_tags, \"$.tags\"),'\\\\[|\\\\]|\\\\\"',''),',')) as powershell_tags\nfrom Reg_Match_Pattern where length(GET_JSON_OBJECT(lhub_pattern_tags, \"$.tags\")) >2`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 750,
          "y": 560,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "54767de3-a2d3-40f6-b2b6-a9c634fa76e9",
          "name": "Prepare_Additional_Data",
          "kind": "augmentation",
          "lql": "`select *, lhub_id as _id from Reg_Match_Pattern`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 0,
          "y": 1028,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "ad766094-8961-417d-956d-73af1a503db4",
          "name": "Array_Element_To_Column",
          "kind": "augmentation",
          "lql": "`select *, element_at(tag_split,1)  as lhub_score,\nelement_at(tag_split,2)  as short_name,\nelement_at(tag_split,3)  as technique,\nelement_at(tag_split,4)  as tactic,\nelement_at(tag_split,5)  as alert_id\n from Tag_To_Array`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 750,
          "y": 784,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "ca130bfe-ca94-49ce-9462-e479ff4fd2d0",
          "name": "Create_Alert_Descriptions",
          "kind": "augmentation",
          "lql": "`SELECT lhub_score, _id,STRUCT(short_name, technique, tactic, lhub_score,alert_id) as tag_description FROM Array_Element_To_Column`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 906,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "4bb7024b-4a28-4a79-90df-c029ec2eab86",
          "name": "reg_sample",
          "kind": "augmentation",
          "lql": "`SELECT lhub_ts, explode(reg) AS object_name, \"machine1\" AS computer_name, \"administrator\" AS src_user, \"ACME\\administrator\" AS security_id, \"ACME\" AS account_domain, \"0x176293\" AS logon_id, \"C:\\Windows\\regedit.exe\" process_name, '' old_value, '' new_value FROM Add_Positive_Reg_Hits`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 336,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "36ecfda8-8e2b-4a8b-89be-31f9da3d1828",
          "name": "Reg_Match_Pattern",
          "kind": "augmentation",
          "lql": "matchPattern(reg_sample, \"object_name\", Label_Prep, \"Pattern\", \"label\", \"match_type2\")",
          "operator": "matchPattern",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 450,
          "y": 448,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "OperatorForm",
          "contentItemIdentifier": {
            "kind": "OperatorContentKind",
            "id": "matchPattern"
          },
          "categoryKind": "Transform",
          "iconTitle": "Transform: Match Pattern",
          "usedByEventTypes": []
        },
        {
          "id": "4839f0ef-b1a1-4ffe-8a66-d30d35fc3328",
          "name": "Prep_Test_Data",
          "kind": "augmentation",
          "lql": "`select  Rule_Name, Risk_Rank, EventID_Array, Software_Array, TID_Array, Tactic_Array, Username, ComputerName, Count, Event_Details,\nGET_JSON_OBJECT(Event_Details, \"$.event_id\") as event_id,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.Image\") as Image,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.CommandLine\") as CommandLine,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.User\") as User,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.ParentImage\") as ParentImage,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.ParentCommandLine\") as ParentCommandLine, \nGET_JSON_OBJECT(Event_Details, \"$.event_data.ProcessId\") as ProcessId,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.ParentProcessId\") as ParentProcessId,\nGET_JSON_OBJECT(Event_Details, \"$.event_data.LogonId\") as LogonId,\nunix_timestamp() as lhub_ts\n\n from MDR_MITRE_Sample_Data`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 112,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "fa47b21f-c781-4266-9084-d7f9d76cf5b9",
          "name": "Add_Positive_Reg_Hits",
          "kind": "augmentation",
          "lql": "`select lhub_ts,array(\"\\\\InprocServer32\\\\(Default)\",\"\\\\ShowSuperHidden\",\"\\\\Hidden\",\"\\\\HideFileExt\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\GPExtensions\\\\\",\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\\",\"\\\\EnableFirewall\",\"\\\\DoNotAllowExceptions\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Appinit_Dlls\\\\\",\"HKLM\\\\Software\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Appinit_Dlls\\\\\",\"Microsoft\\\\Office\\\\Outlook\\\\Addins\\\\\",\"Office Test\\\\\",\"Internet Explorer\\\\Toolbar\\\\\",\"Internet Explorer\\\\Toolbar\\\\\",\"Browser Helper Objects\\\\\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\EnableLUA\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\LocalAccountTokenFilterPolicy\",\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\HideSCAHealth\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Custom\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\InstalledSDB\",\"HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\\",\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\",\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders\",\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServicesOnce\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\",\"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\",\"HKLM\\\\Software[Wow6432Node]Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\",\"HKCU\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\\",\"HKLM\\\\SOFTWARE[\\\\WOW6432Node]Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CryptSIPDllGetSignedDataMsg{{SIP_GUID}}\",\"HKLM\\\\SOFTWARE[WOW6432Node]Microsoft\\\\Cryptography\\\\OID\\\\EncodingType 0\\\\CryptSIPDllVerifyIndirectData{{SIP_GUID}}\",\"HKLM\\\\SOFTWARE[WOW6432Node]Microsoft\\\\Cryptography\\\\Providers\\\\Trust\\\\FinalPolicy{{trust provider GUID}}\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\OID\",\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Cryptography\\\\OID\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\Providers\\\\Trust\",\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Cryptography\\\\Providers\\\\Trust\",\"HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Services\\\\W32Time\\\\TimeProviders\\\\.\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Netsh\",\"[HKEY_CURRENT_USER]\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\FileExts\",\"HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\",\"HKCU\\\\Environment\\\\UserInitMprLogonScript\",\"HKCU\\\\Control Panel\\\\Desktop\\\\\",\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\ with the key value of 'Authentication Packages'=\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\LSASS.exe with AuditLevel = 8\",\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Print\\\\Monitors\",\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\",\"KEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\",\"HKEY_LOCAL_MACHINE\\\\Software\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\",\"[HKEY_CURRENT_USER]\\\\Software\\\\Classes\\\\mscfile\\\\shell\\\\open\\\\command\",\"[HKEY_CURRENT_USER]\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\control.exe\",\"[HKEY_CURRENT_USER]\\\\Software\\\\Classes\\\\exefile\\\\shell\\\\runas\\\\command\\\\isolatedCommand\",\"HKLM\\\\SOFTWARE{{\\\\Wow6432Node}}\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\\",\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SilentProcessExit\\\\\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\OID\",\"SYSTEM\\\\CurrentControlSet\\\\services\\\\SysmonDrv\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\DisableAntiVirus\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\\\DisableScanOnRealtimeEnable\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Security Center\\\\DisableMonitoring\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Security Center\\\\AllAlertsDisabled\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\\\DisableOnAccessProtection\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\DisableAntiSpyware\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Spynet\\\\SpyNetReporting\",\"SYSTEM\\\\CurrentControlSet\\\\services\\\\Sysmon\",\"\\\\PsKill\\\\EulaAccepted\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Security Center\\\\FirewallDisableNotify\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Security Center\\\\AntiVirusDisableNotify\",\"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\StandardProfile\\\\AuthorizedApplications\\\\List\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\",\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Security Center\\\\FirewallOverride\",\"HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\\\\DisableBehaviorMonitoring\",\"Microsoft\\\\SystemCertificates\\\\Root\\\\Certificate\",\"SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root\\\\Certificates\",\"Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf\",\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\Notification Packages\") as reg from Prep_Test_Data limit 1`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 300,
          "y": 224,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "a5ac17e5-0a83-4f47-ba22-f282be9e4cfa",
          "name": "Label_Prep",
          "kind": "augmentation",
          "lql": "`select *,replace(label, '\"', '\\\\\"') as label2, \"1\" match_type1, \"2\" match_type2 from ESK_Registryv2`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 336,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": false,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        },
        {
          "id": "af6c5305-b644-488b-8196-6af4f4da3b87",
          "name": "Create_Output",
          "kind": "augmentation",
          "lql": "`SELECT \nlhub_ts AS alert_time, \n\"LH00472\" AS alert_id, \n\"One or More Malicious Powershell patterns Found in Powershell Command Line\" AS alert_title, \ntechnique, \ntactic, \nConsolidate_Alerts as lhub_score,\nto_json(STRUCT( object_name, security_id, account_domain, logon_id, process_name, old_value, new_value))  AS additional_data, \nsrc_user, \" \" AS src_ip, \n\" \" AS dest_ip, \ncomputer_name  src_machine,\n\" \" AS dest_machine_name\n FROM Join_Alerts_Back_To_Orginal_Data  where technique  is not null`",
          "operator": "SELECT",
          "isLeaf": false,
          "warnings": [],
          "description": "",
          "isExplainable": true,
          "x": 600,
          "y": 1272,
          "vertices": [],
          "isEditable": false,
          "isStepImplementable": true,
          "executionDependsOn": [],
          "outputtedNode": true,
          "formType": "LQLEditor",
          "categoryKind": "Code",
          "iconTitle": "Code: SQL",
          "usedByEventTypes": []
        }
      ],
      "oldId": "flow-1013",
      "listNames": [],
      "dependentCommands": [],
      "resourceFormatVersion": 2,
      "fileDataSeq": []
    }
  ],
  "baselines": [],
  "eventTypes": [
    {
      "id": "eventType-4",
      "data": {
        "name": "MDR_MITRE_Sample_Data",
        "query": "*",
        "connection": "connection-4",
        "connectionTypeEntities": {
          "entities": [
            {
              "connectionType": {
                "connectionType": "file",
                "value": "query"
              },
              "connectionTypeDetail": {
                "query": "*",
                "connection": "connection-4"
              }
            }
          ]
        },
        "defaultConnectionType": {
          "connectionType": "file",
          "value": "query"
        }
      }
    },
    {
      "id": "eventType-5",
      "data": {
        "name": "ESK_Registryv2",
        "query": "*",
        "connection": "connection-3",
        "connectionTypeEntities": {
          "entities": [
            {
              "connectionType": {
                "connectionType": "file",
                "value": "query"
              },
              "connectionTypeDetail": {
                "query": "*",
                "connection": "connection-3"
              }
            }
          ]
        },
        "defaultConnectionType": {
          "connectionType": "file",
          "value": "query"
        }
      }
    }
  ],
  "connections": [
    {
      "id": "connection-4",
      "data": {
        "connectionType": "file",
        "name": "MDR_Mitre_Test_File",
        "isActive": false,
        "account": "",
        "secret": "",
        "url": "file:///opt/docker/data/service/event_files/MDR_MITRE_Sample_Data_QUOTED.csv"
      }
    },
    {
      "id": "connection-3",
      "data": {
        "connectionType": "file",
        "name": "ESK_Registryv2",
        "isActive": false,
        "account": "",
        "secret": "",
        "url": "file:///opt/docker/data/service/event_files/ESK_Registryv2.csv"
      }
    }
  ],
  "modules": [],
  "annotations": [],
  "filters": [],
  "ruleSets": [],
  "integrationInstances": [],
  "customLists": [],
  "streams": [],
  "dashboards": [],
  "images": [],
  "codeBlobs": {},
  "customListsData": {},
  "executionScripts": [],
  "userForms": [],
  "flowNodeReferences": [],
  "destinations": [],
  "fileResources": [],
  "fileDataSeq": [],
  "eventModels": [],
  "version": 1
}