{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Use Cases",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "",
            "description": "This playbook processes an ExtraHop detection of an internal database being accessed externally.  The playbook will block the corresponding client source IP Address on a Palo Alto Networks Firewall as well as retrieve the following information on both the client and server:\n  - ExtraHop device objects\n  - List of peer devices communicated with in the last 30 minutes\n  - List of client and server protocols spoken in the last 30 minutes",
            "hash": "8d080d5296fb8c579b0ce91de90c1d977d1f1683",
            "joint": {
                "cells": [
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "get db peers, get db protocols, get client peers, get client protocols, block client ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 260,
                        "line_start": 247,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 10,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 700,
                            "y": 760
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 2
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "19b59464-8c25-45bb-a5d0-fabc771e42f6",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "71465a73-196b-4544-818d-dab8c587a63e",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b79d39fc-e61a-4ae8-848a-84f3a7711d87",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 11
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "019d8473-5a00-4c57-99cd-30fccd695733",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "71465a73-196b-4544-818d-dab8c587a63e",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "015eb840-2d6f-4dd6-8c11-eb2e2accd90a",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 12
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9440f886-8432-4273-b53f-5fc29d2d15c3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9f45d35e-566a-4a31-b7d4-3ca6f49b3cf6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "66defd2f-51e7-469b-96fd-46432e555781",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 14
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "91fee5ec-bde9-4db5-b5fe-5e2f925b9cb1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9f45d35e-566a-4a31-b7d4-3ca6f49b3cf6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "5d3069fd-4835-4149-8667-49989fffe947",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 16
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "91b8b23c-2b04-40af-9178-f856d1cd8c8d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b79d39fc-e61a-4ae8-848a-84f3a7711d87",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 18
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "c1d8b7cf-00bb-4937-86ab-fcb37552bb92",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "015eb840-2d6f-4dd6-8c11-eb2e2accd90a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 19
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d5141434-2817-428a-a288-f0924882d7af",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "66defd2f-51e7-469b-96fd-46432e555781",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 20
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "e48b460f-859f-4049-add0-991d9a0a911c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5d3069fd-4835-4149-8667-49989fffe947",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 21
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'decision_1' block\n    decision_1(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0ab4cc37-3e2d-437c-9ff2-32418bcb64af",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 19,
                        "line_start": 11,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -60,
                            "y": 200
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 24
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "300e7b10-0414-4b2d-b6b9-5c6b2c8d7c19",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b53ef869-6c25-41a1-bfa7-649f228960d0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a87acfbd-9a6f-48ff-acca-4a9684b628e0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 29
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d8cedad1-7008-4b3f-85bf-874669388c35",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0ab4cc37-3e2d-437c-9ff2-32418bcb64af",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "eb678baa-5910-450c-a5cc-6d21ca3e37c1",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 30
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0e158051-c1fb-4954-862c-47989acb56e9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "eb678baa-5910-450c-a5cc-6d21ca3e37c1",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "71465a73-196b-4544-818d-dab8c587a63e",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 32
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bb6387e4-98ae-40ee-b801-86f81a4563b4",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "eb678baa-5910-450c-a5cc-6d21ca3e37c1",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9f45d35e-566a-4a31-b7d4-3ca6f49b3cf6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 33
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "fab340f9-5a0c-4f8a-a415-e693deffb395",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "eb678baa-5910-450c-a5cc-6d21ca3e37c1",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b53ef869-6c25-41a1-bfa7-649f228960d0",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 34
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def decision_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_1() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        conditions=[\n            [\"artifact:*.label\", \"==\", \"publicly_exposed_db\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        get_db_device_info(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        get_client_device_info(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        block_client_ip(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "Continue running this playbook only if the artifact label is \"publicly_exposed_db\"",
                        "hasElse": false,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "eb678baa-5910-450c-a5cc-6d21ca3e37c1",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 41,
                        "line_start": 22,
                        "name": "decision",
                        "notes": "Continue running this playbook only if the artifact label is \"publicly_exposed_db\"",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.label",
                                        "value": "publicly_exposed_db"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 80,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "decision_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 103
                    },
                    {
                        "action": "get device info",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.destinationAddress"
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get device info",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "artifact:*.cef.destinationAddress"
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "ipv4",
                                        "column_order": 1,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr4",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "column_name": "mac",
                                        "column_order": 2,
                                        "contains": [
                                            "mac address"
                                        ],
                                        "data_path": "action_result.data.*.macaddr",
                                        "data_type": "string",
                                        "example_values": [
                                            "0E:6F:28:A4:2B:62"
                                        ]
                                    },
                                    {
                                        "column_name": "host name",
                                        "column_order": 3,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dhcp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "dns name",
                                        "column_order": 4,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dns_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "device class",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.device_class",
                                        "data_type": "string",
                                        "example_values": [
                                            "node"
                                        ]
                                    },
                                    {
                                        "column_name": "extrahop api id",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1458
                                        ]
                                    },
                                    {
                                        "column_name": "is L3",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.is_l3",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "vendor",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.vendor",
                                        "data_type": "string",
                                        "example_values": [
                                            "VMware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discover_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522964970000
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr6",
                                        "data_type": "string",
                                        "example_values": [
                                            "FE80::0202:B3FF:FE1E:8329"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_type",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbios_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.user_mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525212324713
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.cdp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.vlanid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.parent_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            491
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.description",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.node_id",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525963038299
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.extrahop_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff45b060a0a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_name",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.default_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "VMware 208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis_level",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis",
                                        "data_type": "string",
                                        "example_values": [
                                            "advanced"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.on_watchlist",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Device count: 1"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discovery_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff45b060a0a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.device_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "allow_list": true,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get db device info"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_db_device_info(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_db_device_info() called')\n\n    # collect data for 'get_db_device_info' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.destinationAddress', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'get_db_device_info' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"get device info\", parameters=parameters, assets=['extrahop'], callback=get_db_device_info_callback, name=\"get_db_device_info\")\n\n    return",
                        "callback_code": "def get_db_device_info_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('get_db_device_info_callback() called')\n    \n    get_db_peers(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    get_db_protocols(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 65,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get db device info",
                        "delay": 0,
                        "description": "Get more details about the internal database server given its IP address. Details include MAC address, dhcp name, first discovered time, device type, and more",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "71465a73-196b-4544-818d-dab8c587a63e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 73,
                        "line_start": 44,
                        "message": "Configuring now",
                        "name": "get device info",
                        "notes": "Get more details about the internal database server given its IP address. Details include MAC address, dhcp name, first discovered time, device type, and more",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "get_db_device_info",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 106
                    },
                    {
                        "action": "get device info",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.sourceAddress"
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get device info",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "artifact:*.cef.sourceAddress"
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "ipv4",
                                        "column_order": 1,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr4",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "column_name": "mac",
                                        "column_order": 2,
                                        "contains": [
                                            "mac address"
                                        ],
                                        "data_path": "action_result.data.*.macaddr",
                                        "data_type": "string",
                                        "example_values": [
                                            "0E:6F:28:A4:2B:62"
                                        ]
                                    },
                                    {
                                        "column_name": "host name",
                                        "column_order": 3,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dhcp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "dns name",
                                        "column_order": 4,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dns_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "device class",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.device_class",
                                        "data_type": "string",
                                        "example_values": [
                                            "node"
                                        ]
                                    },
                                    {
                                        "column_name": "extrahop api id",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1458
                                        ]
                                    },
                                    {
                                        "column_name": "is L3",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.is_l3",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "vendor",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.vendor",
                                        "data_type": "string",
                                        "example_values": [
                                            "VMware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discover_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522964970000
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr6",
                                        "data_type": "string",
                                        "example_values": [
                                            "FE80::0202:B3FF:FE1E:8329"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "networksec.example.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_type",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbios_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.user_mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525212324713
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.cdp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.vlanid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.parent_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            491
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.description",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.node_id",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525963038299
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.extrahop_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff45b060a0a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_name",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.default_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "VMware 208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis_level",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis",
                                        "data_type": "string",
                                        "example_values": [
                                            "advanced"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.on_watchlist",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Device count: 1"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discovery_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff45b060a0a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.device_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "allow_list": true,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get client device info"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_client_device_info(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_client_device_info() called')\n\n    # collect data for 'get_client_device_info' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.sourceAddress', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'get_client_device_info' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"get device info\", parameters=parameters, assets=['extrahop'], callback=get_client_device_info_callback, name=\"get_client_device_info\")\n\n    return",
                        "callback_code": "def get_client_device_info_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('get_client_device_info_callback() called')\n    \n    get_client_peers(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    get_client_protocols(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 97,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get client device info",
                        "delay": "0",
                        "description": "Get more details about the external client given its IP address. Details include MAC address, dhcp name, first discovered time, device type, and more",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9f45d35e-566a-4a31-b7d4-3ca6f49b3cf6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 105,
                        "line_start": 76,
                        "message": "Configuring now",
                        "name": "get device info",
                        "notes": "Get more details about the external client given its IP address. Details include MAC address, dhcp name, first discovered time, device type, and more",
                        "number": 2,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 460
                        },
                        "previous_function": "",
                        "previous_name": "get_client_device_info",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 113
                    },
                    {
                        "action": "get peers",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "eh_api_id": "get_db_device_info:action_result.data.*.id",
                            "ip": "get_db_device_info:action_result.data.*.ipaddr4",
                            "minutes": 30,
                            "peer_role": "any",
                            "protocol": "any"
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get peers",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "eh_api_id": "get_db_device_info:action_result.data.*.id",
                                    "ip": "get_db_device_info:action_result.data.*.ipaddr4",
                                    "minutes": 30,
                                    "peer_role": "any",
                                    "protocol": "any"
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "ipv4",
                                        "column_order": 1,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr4",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.12.23"
                                        ]
                                    },
                                    {
                                        "column_name": "mac",
                                        "column_order": 2,
                                        "contains": [
                                            "mac address"
                                        ],
                                        "data_path": "action_result.data.*.macaddr",
                                        "data_type": "string",
                                        "example_values": [
                                            "A4:52:B7:E6:15:EB"
                                        ]
                                    },
                                    {
                                        "column_name": "host name",
                                        "column_order": 3,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dhcp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "dns name",
                                        "column_order": 4,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dns_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "device class",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.device_class",
                                        "data_type": "string",
                                        "example_values": [
                                            "node"
                                        ]
                                    },
                                    {
                                        "column_name": "extrahop api id",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2850
                                        ]
                                    },
                                    {
                                        "column_name": "is L3",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.is_l3",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "vendor",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.vendor",
                                        "data_type": "string",
                                        "example_values": [
                                            "ASUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discover_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522967820000
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr6",
                                        "data_type": "string",
                                        "example_values": [
                                            "FE80::0202:B3FF:FE1E:8329"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_type",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbios_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.user_mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522967940018
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.cdp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.vlanid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.parent_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            438
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.description",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.node_id",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525965708165
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.extrahop_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff4cc0a140a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_name",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.default_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "ASUS 208.14.12.23"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis_level",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis",
                                        "data_type": "string",
                                        "example_values": [
                                            "standard"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.on_watchlist",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.minutes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            30
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.peer_role",
                                        "data_type": "string",
                                        "example_values": [
                                            "any"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.protocol",
                                        "data_type": "string",
                                        "example_values": [
                                            "any"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.eh_api_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Peer count: 8"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discovery_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff4cc0a140a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.peer_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            8
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "eh_api_id": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "ExtraHop API id",
                                        "key": "eh_api_id",
                                        "order": 4,
                                        "primary": false,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address of device",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "minutes": {
                                        "data_type": "numeric",
                                        "default": 30,
                                        "description": "Minutes to look back",
                                        "key": "minutes",
                                        "order": 1,
                                        "primary": false,
                                        "required": true
                                    },
                                    "peer_role": {
                                        "data_type": "string",
                                        "default": "any",
                                        "description": "Filter by peer role",
                                        "key": "peer_role",
                                        "order": 2,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "any",
                                            "client",
                                            "server"
                                        ]
                                    },
                                    "protocol": {
                                        "data_type": "string",
                                        "default": "any",
                                        "description": "Filter by protocol",
                                        "key": "protocol",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get db peers"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_db_peers(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_db_peers() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_db_peers' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_db_device_info:action_result.data.*.ipaddr4', 'get_db_device_info:action_result.data.*.id', 'get_db_device_info:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'get_db_peers' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                'minutes': 30,\n                'protocol': \"any\",\n                'eh_api_id': results_item_1[1],\n                'peer_role': \"any\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[2]},\n            })\n\n    phantom.act(action=\"get peers\", parameters=parameters, assets=['extrahop'], name=\"get_db_peers\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "get db device info",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get db peers",
                        "delay": 0,
                        "description": "Retrieves a list of all of the peers that a device communicated with in the last 30 minutes",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b79d39fc-e61a-4ae8-848a-84f3a7711d87",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 135,
                        "line_start": 108,
                        "message": "Configuring now",
                        "name": "get peers",
                        "notes": "Retrieves a list of all of the peers that a device communicated with in the last 30 minutes",
                        "number": 1,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": 180
                        },
                        "previous_function": "",
                        "previous_name": "get_db_peers",
                        "required_params": {
                            "ip": true,
                            "minutes": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 120
                    },
                    {
                        "action": "get protocols",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "eh_api_id": "get_db_device_info:action_result.data.*.id",
                            "ip": "get_db_device_info:action_result.data.*.ipaddr4",
                            "minutes": 30
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get protocols",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "eh_api_id": "get_db_device_info:action_result.data.*.id",
                                    "ip": "get_db_device_info:action_result.data.*.ipaddr4",
                                    "minutes": 30
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "client protocols",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.client_protocols",
                                        "data_type": "string",
                                        "example_values": [
                                            "DNS, IPv4, LDAP, NTP, SSL, TCP, UDP"
                                        ]
                                    },
                                    {
                                        "column_name": "server protocols",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.server_protocols",
                                        "data_type": "string",
                                        "example_values": [
                                            "DB, IPv4, SSL, TCP"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.minutes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            30
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.eh_api_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Server protocol count: 4, Client protocol count: 7"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.server_protocol_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.client_protocol_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "eh_api_id": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "ExtraHop API id",
                                        "key": "eh_api_id",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address of device",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "minutes": {
                                        "data_type": "numeric",
                                        "default": 30,
                                        "description": "Minutes to look back",
                                        "key": "minutes",
                                        "order": 1,
                                        "primary": false,
                                        "required": true
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get db protocols"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_db_protocols(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_db_protocols() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_db_protocols' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_db_device_info:action_result.data.*.ipaddr4', 'get_db_device_info:action_result.data.*.id', 'get_db_device_info:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'get_db_protocols' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                'minutes': 30,\n                'eh_api_id': results_item_1[1],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[2]},\n            })\n\n    phantom.act(action=\"get protocols\", parameters=parameters, assets=['extrahop'], name=\"get_db_protocols\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "get db device info",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get db protocols",
                        "delay": 0,
                        "description": "Retrieves a list of all of the protocols that a device communicated over the last 30 minutes",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "015eb840-2d6f-4dd6-8c11-eb2e2accd90a",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 163,
                        "line_start": 138,
                        "message": "Configuring now",
                        "name": "get protocols",
                        "notes": "Retrieves a list of all of the protocols that a device communicated over the last 30 minutes",
                        "number": 1,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": 320
                        },
                        "previous_function": "",
                        "previous_name": "get_db_protocols",
                        "required_params": {
                            "ip": true,
                            "minutes": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 121
                    },
                    {
                        "action": "get peers",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "eh_api_id": "get_client_device_info:action_result.data.*.id",
                            "ip": "get_client_device_info:action_result.data.*.ipaddr4",
                            "minutes": 30,
                            "peer_role": "any",
                            "protocol": "any"
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get peers",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "eh_api_id": "get_client_device_info:action_result.data.*.id",
                                    "ip": "get_client_device_info:action_result.data.*.ipaddr4",
                                    "minutes": 30,
                                    "peer_role": "any",
                                    "protocol": "any"
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "ipv4",
                                        "column_order": 1,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr4",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.12.23"
                                        ]
                                    },
                                    {
                                        "column_name": "mac",
                                        "column_order": 2,
                                        "contains": [
                                            "mac address"
                                        ],
                                        "data_path": "action_result.data.*.macaddr",
                                        "data_type": "string",
                                        "example_values": [
                                            "A4:52:B7:E6:15:EB"
                                        ]
                                    },
                                    {
                                        "column_name": "host name",
                                        "column_order": 3,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dhcp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "dns name",
                                        "column_order": 4,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dns_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "column_name": "device class",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.device_class",
                                        "data_type": "string",
                                        "example_values": [
                                            "node"
                                        ]
                                    },
                                    {
                                        "column_name": "extrahop api id",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2850
                                        ]
                                    },
                                    {
                                        "column_name": "is L3",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.is_l3",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "vendor",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.vendor",
                                        "data_type": "string",
                                        "example_values": [
                                            "ASUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discover_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522967820000
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ipaddr6",
                                        "data_type": "string",
                                        "example_values": [
                                            "FE80::0202:B3FF:FE1E:8329"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "app-perf03.example.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_type",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbios_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.user_mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1522967940018
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.cdp_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.vlanid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.parent_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            438
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.description",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.node_id",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.mod_time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1525965708165
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.extrahop_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff4cc0a140a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.custom_name",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.default_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "ASUS 208.14.12.23"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis_level",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.analysis",
                                        "data_type": "string",
                                        "example_values": [
                                            "standard"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.on_watchlist",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.minutes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            30
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.peer_role",
                                        "data_type": "string",
                                        "example_values": [
                                            "any"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.protocol",
                                        "data_type": "string",
                                        "example_values": [
                                            "any"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.eh_api_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Peer count: 8"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.discovery_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "fff4cc0a140a0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.peer_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            8
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "eh_api_id": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "ExtraHop API id",
                                        "key": "eh_api_id",
                                        "order": 4,
                                        "primary": false,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address of device",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "minutes": {
                                        "data_type": "numeric",
                                        "default": 30,
                                        "description": "Minutes to look back",
                                        "key": "minutes",
                                        "order": 1,
                                        "primary": false,
                                        "required": true
                                    },
                                    "peer_role": {
                                        "data_type": "string",
                                        "default": "any",
                                        "description": "Filter by peer role",
                                        "key": "peer_role",
                                        "order": 2,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "any",
                                            "client",
                                            "server"
                                        ]
                                    },
                                    "protocol": {
                                        "data_type": "string",
                                        "default": "any",
                                        "description": "Filter by protocol",
                                        "key": "protocol",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get client peers"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_client_peers(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_client_peers() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_client_peers' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_client_device_info:action_result.data.*.ipaddr4', 'get_client_device_info:action_result.data.*.id', 'get_client_device_info:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'get_client_peers' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                'minutes': 30,\n                'protocol': \"any\",\n                'eh_api_id': results_item_1[1],\n                'peer_role': \"any\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[2]},\n            })\n\n    phantom.act(action=\"get peers\", parameters=parameters, assets=['extrahop'], name=\"get_client_peers\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "get client device info",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get client peers",
                        "delay": 0,
                        "description": "Retrieves a list of all of the peers that a device communicated with in the last 30 minutes",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "66defd2f-51e7-469b-96fd-46432e555781",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 193,
                        "line_start": 166,
                        "message": "Configuring now",
                        "name": "get peers",
                        "notes": "Retrieves a list of all of the peers that a device communicated with in the last 30 minutes",
                        "number": 2,
                        "order": 7,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": 460
                        },
                        "previous_function": "",
                        "previous_name": "get_client_peers",
                        "required_params": {
                            "ip": true,
                            "minutes": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 122
                    },
                    {
                        "action": "get protocols",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "eh_api_id": "get_client_device_info:action_result.data.*.id",
                            "ip": "get_client_device_info:action_result.data.*.ipaddr4",
                            "minutes": 30
                        },
                        "angle": 0,
                        "app": "ExtraHop",
                        "appid": "0c173506-b5ab-4c9f-a78c-68dea794232c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get protocols",
                                "active": true,
                                "app_name": "ExtraHop",
                                "app_version": "1.0.4",
                                "appid": "",
                                "asset_name": "extrahop",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "eh_api_id": "get_client_device_info:action_result.data.*.id",
                                    "ip": "get_client_device_info:action_result.data.*.ipaddr4",
                                    "minutes": 30
                                },
                                "has_app": true,
                                "id": 218,
                                "loaded": false,
                                "missing": false,
                                "name": "extrahop",
                                "output": [
                                    {
                                        "column_name": "status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "client protocols",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.client_protocols",
                                        "data_type": "string",
                                        "example_values": [
                                            "DNS, IPv4, LDAP, NTP, SSL, TCP, UDP"
                                        ]
                                    },
                                    {
                                        "column_name": "server protocols",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.server_protocols",
                                        "data_type": "string",
                                        "example_values": [
                                            "DB, IPv4, SSL, TCP"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "208.14.6.61"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.minutes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            30
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.eh_api_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Server protocol count: 4, Client protocol count: 7"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.server_protocol_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.client_protocol_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "eh_api_id": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "ExtraHop API id",
                                        "key": "eh_api_id",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP Address of device",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "minutes": {
                                        "data_type": "numeric",
                                        "default": 30,
                                        "description": "Minutes to look back",
                                        "key": "minutes",
                                        "order": 1,
                                        "primary": false,
                                        "required": true
                                    }
                                },
                                "product_name": "ExtraHop",
                                "product_vendor": "ExtraHop Networks",
                                "targets": "170",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get client protocols"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def get_client_protocols(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_client_protocols() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'get_client_protocols' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_client_device_info:action_result.data.*.ipaddr4', 'get_client_device_info:action_result.data.*.id', 'get_client_device_info:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'get_client_protocols' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                'minutes': 30,\n                'eh_api_id': results_item_1[1],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[2]},\n            })\n\n    phantom.act(action=\"get protocols\", parameters=parameters, assets=['extrahop'], name=\"get_client_protocols\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "get client device info",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get client protocols",
                        "delay": 0,
                        "description": "Retrieves a list of all of the protocols that a device communicated over the last 30 minutes",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5d3069fd-4835-4149-8667-49989fffe947",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 221,
                        "line_start": 196,
                        "message": "Configuring now",
                        "name": "get protocols",
                        "notes": "Retrieves a list of all of the protocols that a device communicated over the last 30 minutes",
                        "number": 2,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 460,
                            "y": 600
                        },
                        "previous_function": "",
                        "previous_name": "get_client_protocols",
                        "required_params": {
                            "ip": true,
                            "minutes": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 123
                    },
                    {
                        "action": "block ip",
                        "action_type": "contain",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.sourceAddress",
                            "is_source_address": "True",
                            "vsys": "vsys1"
                        },
                        "angle": 0,
                        "app": "Palo Alto Networks Firewall",
                        "appid": "e025e4ba-65be-438d-835f-95fe5da6b6d0",
                        "approver": "",
                        "assets": [
                            {
                                "action": "block ip",
                                "active": true,
                                "app_name": "Palo Alto Networks Firewall",
                                "app_version": "1.2.26",
                                "appid": "",
                                "config_type": "app",
                                "fields": {
                                    "ip": "artifact:*.cef.sourceAddress",
                                    "is_source_address": "True",
                                    "vsys": "vsys1"
                                },
                                "has_app": true,
                                "id": 17,
                                "loaded": false,
                                "missing": false,
                                "name": "Palo Alto Networks Firewall",
                                "output": [
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.vsys",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.is_source_address",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "column_name": "Status",
                                        "column_order": 1,
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 2,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to block",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "is_source_address": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "Source address",
                                        "key": "is_source_address",
                                        "order": 2,
                                        "required": false
                                    },
                                    "vsys": {
                                        "data_type": "string",
                                        "default": "vsys1",
                                        "description": "Virtual system (vsys) to configure",
                                        "key": "vsys",
                                        "order": 1,
                                        "required": false,
                                        "verbose": "If not specified, 'vsys1' is used"
                                    }
                                },
                                "product_name": "Firewall",
                                "product_vendor": "Palo Alto Networks",
                                "type": ""
                            },
                            {
                                "action": "block ip",
                                "active": true,
                                "app_name": "Palo Alto Networks Firewall",
                                "app_version": "1.2.26",
                                "appid": "",
                                "asset_name": "pan",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "artifact:*.cef.sourceAddress",
                                    "is_source_address": "True",
                                    "vsys": "vsys1"
                                },
                                "has_app": true,
                                "id": 97,
                                "loaded": false,
                                "missing": false,
                                "name": "pan",
                                "output": [
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.vsys",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.is_source_address",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "column_name": "Status",
                                        "column_order": 1,
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 2,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to block",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "is_source_address": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "Source address",
                                        "key": "is_source_address",
                                        "order": 2,
                                        "required": false
                                    },
                                    "vsys": {
                                        "data_type": "string",
                                        "default": "vsys1",
                                        "description": "Virtual system (vsys) to configure",
                                        "key": "vsys",
                                        "order": 1,
                                        "required": false,
                                        "verbose": "If not specified, 'vsys1' is used"
                                    }
                                },
                                "product_name": "Firewall",
                                "product_vendor": "Palo Alto Networks",
                                "targets": "145",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "block client ip"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Contain"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_contain.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def block_client_ip(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('block_client_ip() called')\n\n    # collect data for 'block_client_ip' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.sourceAddress', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'block_client_ip' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                'vsys': \"vsys1\",\n                'is_source_address': True,\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"block ip\", parameters=parameters, assets=['pan'], name=\"block_client_ip\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "block client ip",
                        "delay": 0,
                        "description": "Block the source IP that is externally accessing an internal database on the Palo Alto Networks Firewall",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b53ef869-6c25-41a1-bfa7-649f228960d0",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 247,
                        "line_start": 224,
                        "message": "Configuring now",
                        "name": "block ip",
                        "notes": "Block the source IP that is externally accessing an internal database on the Palo Alto Networks Firewall",
                        "number": 1,
                        "order": 9,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 740
                        },
                        "previous_function": "",
                        "previous_name": "block_client_ip",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Contain",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 127
                    }
                ]
            },
            "notes": "This playbook uses the following Apps:\n - ExtraHop - get device details, get list of peers and protocols\n - Palo Alto Networks Firewall - Block the source IP address\n\nDeployment Notes:\n  - The artifact label needs to be \"publicly_exposed_db\" for this playbook to run"
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.0.40961"
    },
    "create_time": "2021-01-19T21:57:15.387352+00:00",
    "draft_mode": false,
    "labels": [
        "events"
    ],
    "tags": [],
    "misc": {
        "apps_list": [
            "ExtraHop",
            "Palo Alto Networks Firewall"
        ]
    }
}