{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Use Cases",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "",
            "description": "This Playbook is part of the Splunk Analytic Story called DNS Hijacking. It is made to be run when the Detection Search within that story called \"DNS Record Changed\" is used to identify DNS record changes for cloud and corporate domains used in your environment. The detection search is dependent on a support searched called \"Discover DNS Records\" which finds the common DNS responses for the last 30 days of monitored corporate domains and cloud providers (located in lookups: cim_corporate_email_domains.csv, cim_corporate_web_domains.csv, and cloud_domains.csv from Splunk CIM App). These responses are stored under the lookup called discovered_dns_records.csv. The playbook starts with the changed DNS records and uses MaxMind, whois, Censys, Malware Domain List, and PassiveTotal to gather attributes of the DNS records for comparison against expected values. The resulting enrichment is displayed in Mission Control and posted back to the Notable Event in Splunk ES.",
            "hash": "f59cf2e896291c4cbc9c8aa97349cbc2feb8650e",
            "joint": {
                "cells": [
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "13045ed8-ec8f-48d7-8e41-431388b360b2",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "vertices": [
                            {
                                "x": 180,
                                "y": 300
                            }
                        ],
                        "z": 56
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "505d65fd-0265-48f3-bc4c-d5572b45d84e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 164
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "lookup certificate, ip reputation, domain reputation 1, domain reputation 2, update notable event",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "acdb33d7-aad8-43a9-8707-39ca2e2d063d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 400,
                        "line_start": 387,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 16,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2180,
                            "y": 700
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 492
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1a82074c-ef63-431a-8534-9e4c106a3ed5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 503
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "885e7c18-104d-44bb-a0eb-046ccd1c0bdc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "da2f10c6-2cd8-427a-8d17-06c8f9496d2b",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 545
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "aaf911f6-74e6-43e9-a87b-85a7b1de28d5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "3640d401-19b9-4d63-b389-f76477198916",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 558
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f2d2e941-6220-42b5-af97-c50710e37629",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 569
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b7c13a77-1093-4cd3-919d-dd0dc0a1d6bc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 578
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6482f66e-35c6-4b46-9f4f-ed9a00361cd9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 590
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "36cf039b-8ae6-43f5-b592-1ce03145fafa",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 594
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a3298b8e-5ee8-4910-a42f-914b10889b0c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [],
                        "z": 606
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "61ed2269-017b-4ead-a4ec-efb5b7ce8cc9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [],
                        "z": 636
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "916754f2-4a7c-4a72-9ff5-beb11bd6f517",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 642
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "00affc33-0b6b-49d0-9aa9-23cec8305cdf",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 643
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9335c7af-180e-4186-b41b-299ffe2be7f0",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "3640d401-19b9-4d63-b389-f76477198916",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 665
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "82d10626-38fa-4ed2-aaa9-cfa9a3a800d9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 668
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f9221d56-debb-4ccf-9112-61829546ec18",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "da2f10c6-2cd8-427a-8d17-06c8f9496d2b",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "acdb33d7-aad8-43a9-8707-39ca2e2d063d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 721
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".border": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def filter_query(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_query() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.query\", \"!=\", \"\"],\n        ],\n        name=\"filter_query:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        domain_reputation_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n        domain_reputation_2(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "filter_query",
                        "description": "Filter down to artifacts with the domain name of the DNS query in Splunk",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ad04a24d-9496-4fb8-810c-f388679c2590",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 40,
                        "line_start": 22,
                        "name": "filter",
                        "notes": "Filter down to artifacts with the domain name of the DNS query in Splunk",
                        "number": 2,
                        "order": 2,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.query",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 400
                        },
                        "previous_function": "",
                        "previous_name": "filter_query",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 744
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def filter_tls_certificate(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_tls_certificate() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256\", \"!=\", \"\"],\n        ],\n        name=\"filter_tls_certificate:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        lookup_certificate_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "censys lookup ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "filter tls certificate",
                        "description": "Filter down to Censys results with TLS certificates on port 443",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c27bc95c-46f0-4d79-88da-5fbe93fea0e1",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 331,
                        "line_start": 313,
                        "name": "filter",
                        "notes": "Filter down to Censys results with TLS certificates on port 443",
                        "number": 3,
                        "order": 13,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1080,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "filter_tls_certificate",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 748
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "filtered-data:filter_query:condition_1:artifact:*.cef.query",
                            "include_inactive": ""
                        },
                        "angle": 0,
                        "app": "Malware Domain List",
                        "appid": "03ead637-4890-4817-a03d-cf4e5f8998f0",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "actions": [
                                    "test connectivity",
                                    "domain reputation",
                                    "ip reputation"
                                ],
                                "active": true,
                                "app_name": "Malware Domain List",
                                "app_version": "1.0.11",
                                "appid": "03ead637-4890-4817-a03d-cf4e5f8998f0",
                                "asset_name": "malware_domain_list",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "domain": "filtered-data:filter_query:condition_1:artifact:*.cef.query",
                                    "include_inactive": ""
                                },
                                "has_app": true,
                                "id": 9,
                                "loaded": false,
                                "missing": false,
                                "name": "malware_domain_list",
                                "output": [
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.Domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Path",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.Path",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Description",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.Description",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 2,
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.IP",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "ASN",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.ASN",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Reverse Lookup",
                                        "column_order": 4,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.ReverseLookup",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Date (UTC)",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.DateUTC",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Registrant",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.Registrant",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.Country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.CountryCode",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.include_inactive",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.matching_records",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.malicious",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "include_inactive": {
                                        "data_type": "boolean",
                                        "default": false,
                                        "description": "Include inactive sites",
                                        "key": "include_inactive",
                                        "primary": false,
                                        "required": false
                                    }
                                },
                                "product_name": "Malware Domain List",
                                "product_vendor": "Malware Domain List",
                                "targets": "9",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "domain reputation 1"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def domain_reputation_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('domain_reputation_1() called')\n\n    # collect data for 'domain_reputation_1' call\n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_query:condition_1:artifact:*.cef.query', 'filtered-data:filter_query:condition_1:artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'domain_reputation_1' call\n    for filtered_artifacts_item_1 in filtered_artifacts_data_1:\n        if filtered_artifacts_item_1[0]:\n            parameters.append({\n                'domain': filtered_artifacts_item_1[0],\n                'include_inactive': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': filtered_artifacts_item_1[1]},\n            })\n\n    phantom.act(action=\"domain reputation\", parameters=parameters, assets=['malware_domain_list'], callback=join_format_results, name=\"domain_reputation_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "Gather domain reputation information from Malware Domain List",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "97a62ca0-1914-4ef2-b779-56cb692b559a",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 185,
                        "line_start": 163,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "Gather domain reputation information from Malware Domain List",
                        "number": 1,
                        "order": 7,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 400
                        },
                        "previous_function": "",
                        "previous_name": "domain_reputation_1",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 757
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "30e5ba22-8422-4df0-9453-2fbd394f6130",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "e0a1823b-d5c4-43ef-8b51-13cb3c7de657",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 760
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "cb79d635-bcc8-4988-ab49-66d6260453df",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "e0a1823b-d5c4-43ef-8b51-13cb3c7de657",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4d923913-0671-44aa-8439-0f6faefffcd8",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 764
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "27cd5e11-d27f-4b3c-83ed-ab10241e2b1e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4d923913-0671-44aa-8439-0f6faefffcd8",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "acdb33d7-aad8-43a9-8707-39ca2e2d063d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 767
                    },
                    {
                        "action": "whois ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "geolocate_ip_dst:action_result.parameter.ip"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "whois ip",
                                "active": true,
                                "app_name": "WHOIS",
                                "app_version": "1.2.31",
                                "appid": "",
                                "asset_name": "whois",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "geolocate_ip:action_result.parameter.ip"
                                },
                                "has_app": true,
                                "id": 41,
                                "loaded": false,
                                "missing": false,
                                "name": "whois",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.139.34"
                                        ]
                                    },
                                    {
                                        "column_name": "ASN",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.asn",
                                        "data_type": "string",
                                        "example_values": [
                                            "18207"
                                        ]
                                    },
                                    {
                                        "column_name": "ASN CIDR",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.asn_cidr",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.139.0/24"
                                        ]
                                    },
                                    {
                                        "column_name": "ASN Country Code",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.asn_country_code",
                                        "data_type": "string",
                                        "example_values": [
                                            "US"
                                        ]
                                    },
                                    {
                                        "column_name": "ASN Date",
                                        "column_order": 4,
                                        "data_path": "action_result.data.*.asn_date",
                                        "data_type": "string",
                                        "example_values": [
                                            "2000-04-27"
                                        ]
                                    },
                                    {
                                        "column_name": "ASN Registry",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.asn_registry",
                                        "data_type": "string",
                                        "example_values": [
                                            "apnic"
                                        ]
                                    },
                                    {
                                        "column_name": "Abuse Emails",
                                        "column_order": 6,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.abuse_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Address",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.nets.*.address",
                                        "data_type": "string",
                                        "example_values": [
                                            "1600 AmphiLane Markway"
                                        ]
                                    },
                                    {
                                        "column_name": "CIDR",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.nets.*.cidr",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.128.0/20"
                                        ]
                                    },
                                    {
                                        "column_name": "City",
                                        "column_order": 9,
                                        "data_path": "action_result.data.*.nets.*.city",
                                        "data_type": "string",
                                        "example_values": [
                                            "San Franscisco"
                                        ]
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 10,
                                        "data_path": "action_result.data.*.nets.*.country",
                                        "data_type": "string",
                                        "example_values": [
                                            "US"
                                        ]
                                    },
                                    {
                                        "column_name": "Created",
                                        "column_order": 11,
                                        "data_path": "action_result.data.*.nets.*.created",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Description",
                                        "column_order": 12,
                                        "data_path": "action_result.data.*.nets.*.description",
                                        "data_type": "string",
                                        "example_values": [
                                            "Level 3 Test, LLC"
                                        ]
                                    },
                                    {
                                        "column_name": "Emails",
                                        "column_order": 13,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.emails",
                                        "data_type": "string",
                                        "example_values": [
                                            "ipaddressing@level3.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.nets.*.handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "NET-8-8-8-0-1"
                                        ]
                                    },
                                    {
                                        "column_name": "Misc Emails",
                                        "column_order": 20,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.misc_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Name",
                                        "column_order": 14,
                                        "data_path": "action_result.data.*.nets.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "LVLT-GOGL-8-8-8"
                                        ]
                                    },
                                    {
                                        "column_name": "Postal Code",
                                        "column_order": 15,
                                        "data_path": "action_result.data.*.nets.*.postal_code",
                                        "data_type": "string",
                                        "example_values": [
                                            "94043"
                                        ]
                                    },
                                    {
                                        "column_name": "Range",
                                        "column_order": 16,
                                        "data_path": "action_result.data.*.nets.*.range",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.128.0 - 203.88.143.255"
                                        ]
                                    },
                                    {
                                        "column_name": "State",
                                        "column_order": 17,
                                        "data_path": "action_result.data.*.nets.*.state",
                                        "data_type": "string",
                                        "example_values": [
                                            "CA"
                                        ]
                                    },
                                    {
                                        "column_name": "Tech Emails",
                                        "column_order": 18,
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.nets.*.tech_emails",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Updated",
                                        "column_order": 19,
                                        "data_path": "action_result.data.*.nets.*.updated",
                                        "data_type": "string",
                                        "example_values": [
                                            "2014-03-14"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.nir",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.query",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.139.34"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.raw",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.raw_referral",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.referral",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.asn",
                                        "data_type": "string",
                                        "example_values": [
                                            "18207"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.country_code",
                                        "data_type": "string",
                                        "example_values": [
                                            "US"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.nets.*.address",
                                        "data_type": "string",
                                        "example_values": [
                                            "100 Century DriveLinks"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.nets.*.range",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.128.0 - 203.88.143.255"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.registry",
                                        "data_type": "string",
                                        "example_values": [
                                            "apnic"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Registry: arin ASN: 15169 Country: US Nets: Range: 8.0.0.0 - 8.127.255.255 Address: 100 Century DriveLinks Range: None Address: 1600 AmphiLane Markway"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to query",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Whois",
                                "product_vendor": "Generic",
                                "targets": "3",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "whois ip"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def whois_ip(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('whois_ip() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'whois_ip' call\n    results_data_1 = phantom.collect2(container=container, datapath=['geolocate_ip:action_result.parameter.ip', 'geolocate_ip:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'whois_ip' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"whois ip\", parameters=parameters, assets=['whois'], callback=whois_ip_callback, name=\"whois_ip\", parent_action=action)\n\n    return",
                        "callback_code": "def whois_ip_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('whois_ip_callback() called')\n    \n    censys_lookup_ip(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    ip_reputation_2(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 66,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "geolocate ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "whois ip",
                        "delay": 0,
                        "description": "WHOIS lookup on the IP address",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5c4cb229-8f0b-4ac2-a106-82f25a0872c6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 74,
                        "line_start": 43,
                        "message": "Configuring now",
                        "name": "whois ip",
                        "notes": "WHOIS lookup on the IP address",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 600,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "whois_ip",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 778
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "filtered-data:filter_query:condition_1:artifact:*.cef.query",
                            "from": "",
                            "to": ""
                        },
                        "angle": 0,
                        "app": "PassiveTotal",
                        "appid": "5ab4cd24-22c6-4d66-b959-dc0a5ec848a9",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "actions": [
                                    "whois domain",
                                    "whois ip",
                                    "ip reputation",
                                    "domain reputation",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "PassiveTotal",
                                "app_version": "1.2.36",
                                "appid": "5ab4cd24-22c6-4d66-b959-dc0a5ec848a9",
                                "asset_name": "passivetotal",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "domain": "filtered-data:filter_query:condition_1:artifact:*.cef.query",
                                    "from": "",
                                    "ph": "",
                                    "to": ""
                                },
                                "has_app": true,
                                "id": 8,
                                "loaded": false,
                                "missing": false,
                                "name": "passivetotal",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string",
                                        "example_values": [
                                            "splunk.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-08-01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.classification.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.ever_compromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.dynamicDns",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.everCompromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.global_tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "alexa_top_10k"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.metadata.primaryDomain",
                                        "data_type": "string",
                                        "example_values": [
                                            "splunk.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryType",
                                        "data_type": "string",
                                        "example_values": [
                                            "domain"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryValue",
                                        "data_type": "string",
                                        "example_values": [
                                            "splunk.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.sinkhole",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.subdomains",
                                        "data_type": "string",
                                        "example_values": [
                                            "zz-tr"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.system_tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "hashes"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tld",
                                        "data_type": "string",
                                        "example_values": [
                                            ".com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.firstSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-08-08 15:47:02"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.lastSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-01 02:49:36"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.pager",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryType",
                                        "data_type": "string",
                                        "example_values": [
                                            "domain"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryValue",
                                        "data_type": "string",
                                        "example_values": [
                                            "splunk.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.collected",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-29 06:59:57"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.firstSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-01 02:49:36"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.lastSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-01 02:49:36"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.passive.results.*.recordHash",
                                        "data_type": "string",
                                        "example_values": [
                                            "c37888add095d26003003939c5f6edb6d9450e296b05cfb8137f282c35b57952"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.recordType",
                                        "data_type": "string",
                                        "example_values": [
                                            "A"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.passive.results.*.resolve",
                                        "data_type": "string",
                                        "example_values": [
                                            "199.59.100.136"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.resolveType",
                                        "data_type": "string",
                                        "example_values": [
                                            "ip"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.source",
                                        "data_type": "string",
                                        "example_values": [
                                            "riskiq"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.value",
                                        "data_type": "string",
                                        "example_values": [
                                            "splunk.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.totalRecords",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.sinkhole",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "alexa_top_10k"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain",
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.unique",
                                        "data_type": "string",
                                        "example_values": [
                                            "199.59.100.136"
                                        ]
                                    },
                                    {
                                        "column_name": "Classification",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "column_name": "Dynamic Domain",
                                        "column_order": 6,
                                        "data_path": "action_result.summary.dynamic_domain",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "Ever Compromised",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.ever_compromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "First Seen",
                                        "column_order": 4,
                                        "data_path": "action_result.summary.first_seen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-08-08 15:47:02"
                                        ]
                                    },
                                    {
                                        "column_name": "Last Seen",
                                        "column_order": 5,
                                        "data_path": "action_result.summary.last_seen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-01 02:49:36"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.sinkhole",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "column_name": "Total Unique Domains",
                                        "column_order": 3,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.summary.total_unique_domains",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total unique domains: 4, Dynamic domain: False, Classification: None, Sinkhole: None, First seen: 2018-08-08 15:47:02, Ever compromised: False, Last seen: 2018-09-01 02:49:36"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain",
                                            "url"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain to query",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "from": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Start date for Passive data (YYYY-mm-dd)",
                                        "key": "from",
                                        "order": 2,
                                        "required": false
                                    },
                                    "ph": {
                                        "data_type": "ph",
                                        "default": null,
                                        "key": "ph",
                                        "order": 1,
                                        "required": false
                                    },
                                    "to": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "End date for Passive data (YYYY-mm-dd)",
                                        "key": "to",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "PassiveTotal",
                                "product_vendor": "PassiveTotal",
                                "targets": "8",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "domain reputation 2"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def domain_reputation_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('domain_reputation_2() called')\n\n    # collect data for 'domain_reputation_2' call\n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_query:condition_1:artifact:*.cef.query', 'filtered-data:filter_query:condition_1:artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'domain_reputation_2' call\n    for filtered_artifacts_item_1 in filtered_artifacts_data_1:\n        if filtered_artifacts_item_1[0]:\n            parameters.append({\n                'ph': \"\",\n                'to': \"\",\n                'from': \"\",\n                'domain': filtered_artifacts_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': filtered_artifacts_item_1[1]},\n            })\n\n    phantom.act(action=\"domain reputation\", parameters=parameters, assets=['passivetotal'], callback=join_format_results, name=\"domain_reputation_2\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": "0",
                        "description": "Gather domain reputation information from PassiveTotal",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "79f28b84-d3b0-4322-9da2-848949d8048f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 160,
                        "line_start": 136,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "Gather domain reputation information from PassiveTotal",
                        "number": 2,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 540
                        },
                        "previous_function": "",
                        "previous_name": "domain_reputation_2",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 784
                    },
                    {
                        "action": "lookup certificate",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "sha256": "filtered-data:filter_tls_certificate:condition_1:censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256"
                        },
                        "angle": 0,
                        "app": "Censys",
                        "appid": "97C8DF6F-C870-4482-B6CA-B6C31745FBAB",
                        "approver": "",
                        "assets": [
                            {
                                "action": "lookup certificate",
                                "actions": [
                                    "lookup certificate",
                                    "lookup domain",
                                    "lookup ip",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Censys",
                                "app_version": "1.0.19",
                                "appid": "97C8DF6F-C870-4482-B6CA-B6C31745FBAB",
                                "asset_name": "censys",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "sha256": "filtered-data:filter_tls_certificate:condition_1:censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256"
                                },
                                "has_app": true,
                                "id": 7,
                                "loaded": false,
                                "missing": false,
                                "name": "censys",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "hash",
                                            "sha256"
                                        ],
                                        "data_path": "action_result.parameter.sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.audit.nss.is_in",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.audit.nss.was_in",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.digicert_ct1.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_aviator.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_pilot.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.censys_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.censys_to_ct_status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_rocketeer.sct",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.google_submariner.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_ct.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_deneb.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.symantec_ws_vega.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.venafi_api_ctlog.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.added_to_ct_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.ct_to_censys_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ct.wosign_ctlog.index",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.current_in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.current_valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parents",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.basic_constraints.max_path_len",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.certificate_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.crl_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.subject_alt_name.directory_names.*.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.extensions.subject_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.post_processed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.precert",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.raw",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.seen_in_scan",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.updated_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.validation_timestamp",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.was_in_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.was_valid_nss",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.summary.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.valid_from",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.valid_to",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "sha256": {
                                        "contains": [
                                            "hash",
                                            "sha256"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "SHA256 fingerprint of certificate",
                                        "key": "sha256",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Censys",
                                "product_vendor": "Censys",
                                "targets": "7",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "lookup certificate"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def lookup_certificate_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('lookup_certificate_1() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'lookup_certificate_1' call\n    filtered_results_data_1 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_tls_certificate:condition_1:censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256\", \"filtered-data:filter_tls_certificate:condition_1:censys_lookup_ip:action_result.parameter.context.artifact_id\"])\n\n    parameters = []\n    \n    # build parameters list for 'lookup_certificate_1' call\n    for filtered_results_item_1 in filtered_results_data_1:\n        if filtered_results_item_1[0]:\n            parameters.append({\n                'sha256': filtered_results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': filtered_results_item_1[1]},\n            })\n\n    phantom.act(action=\"lookup certificate\", parameters=parameters, assets=['censys'], callback=join_format_results, name=\"lookup_certificate_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "censys lookup ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "Gather the issuer and other information about the detected TLS certificates",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a133dd12-e4c4-4daf-8cf2-072f80ba7724",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 310,
                        "line_start": 287,
                        "message": "Configuring now",
                        "name": "lookup certificate",
                        "notes": "Gather the issuer and other information about the detected TLS certificates",
                        "number": 1,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1220,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "lookup_certificate_1",
                        "required_params": {
                            "sha256": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 788
                    },
                    {
                        "action": "ip reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "from": "",
                            "ip": "geolocate_ip:action_result.parameter.ip",
                            "to": ""
                        },
                        "angle": 0,
                        "app": "PassiveTotal",
                        "appid": "5ab4cd24-22c6-4d66-b959-dc0a5ec848a9",
                        "approver": "",
                        "assets": [
                            {
                                "action": "ip reputation",
                                "actions": [
                                    "whois domain",
                                    "whois ip",
                                    "ip reputation",
                                    "domain reputation",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "PassiveTotal",
                                "app_version": "1.2.36",
                                "appid": "5ab4cd24-22c6-4d66-b959-dc0a5ec848a9",
                                "asset_name": "passivetotal",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "from": "",
                                    "ip": "geolocate_ip:action_result.parameter.ip",
                                    "ph": "",
                                    "to": ""
                                },
                                "has_app": true,
                                "id": 8,
                                "loaded": false,
                                "missing": false,
                                "name": "passivetotal",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-08-01"
                                        ]
                                    },
                                    {
                                        "column_name": "IP",
                                        "column_order": 0,
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.classification.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.ever_compromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.autonomousSystemName",
                                        "data_type": "string",
                                        "example_values": [
                                            "Splunk Inc."
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.autonomousSystemNumber",
                                        "data_type": "numeric",
                                        "example_values": [
                                            15009
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.country",
                                        "data_type": "string",
                                        "example_values": [
                                            "US"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.dynamic",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.dynamicDns",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.everCompromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.global_tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "Splunk"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.latitude",
                                        "data_type": "numeric",
                                        "example_values": [
                                            37.3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.longitude",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -122.0008
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.network",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.0/24"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.metadata.primaryDomain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.queryType",
                                        "data_type": "string",
                                        "example_values": [
                                            "ip"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.metadata.queryValue",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.sinkhole",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.system_tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "routable"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.metadata.tld",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.firstSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-29 00:00:00",
                                            "2018-08-01 00:00:00"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.lastSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-28 23:48:00",
                                            "2018-09-30 15:41:01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.pager",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.queryType",
                                        "data_type": "string",
                                        "example_values": [
                                            "ip"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.passive.queryValue",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.collected",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-29 06:55:51",
                                            "2018-10-29 06:58:01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.firstSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-30 14:00:00",
                                            "2018-09-25 00:45:01"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.lastSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-30 14:01:32",
                                            "2018-09-25 01:20:02"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.passive.results.*.recordHash",
                                        "data_type": "string",
                                        "example_values": [
                                            "72be28ddd4638821d24006c1919fe785e07107d5a6cb8b0e059fd214e0a2580f",
                                            "807bf684880658f3656001e35c4eb34308891e5ad9fee28ed470d728431dc62c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.recordType",
                                        "data_type": "string",
                                        "example_values": [
                                            "A"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.resolve",
                                        "data_type": "string",
                                        "example_values": [
                                            "pop.revistadecorar.com.br",
                                            "ipv6.portal79.com.br"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.resolveType",
                                        "data_type": "string",
                                        "example_values": [
                                            "domain"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.results.*.source",
                                        "data_type": "string",
                                        "example_values": [
                                            "riskiq"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.passive.results.*.value",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.passive.totalRecords",
                                        "data_type": "numeric",
                                        "example_values": [
                                            89,
                                            123
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.sinkhole",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.firstSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-22",
                                            "2017-09-09"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_path": "action_result.data.*.ssl_certificates.*.ipAddresses",
                                        "data_type": "string",
                                        "example_values": [
                                            "1.1.1.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.ssl_certificates.*.lastSeen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-26",
                                            "2017-09-20"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.ssl_certificates.*.sha1",
                                        "data_type": "string",
                                        "example_values": [
                                            "66b27f920b738b8ebbb3cf509201f8a2b7d0152c",
                                            "1dd378af8e556ab058e01ef3ba8d47f3d45a8a54"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "Splunk"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.unique",
                                        "data_type": "string",
                                        "example_values": [
                                            "cellinicapital.com.au",
                                            "pop.revistadecorar.com.br"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.as_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Splunk Inc."
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.classification",
                                        "data_type": "string",
                                        "example_values": []
                                    },
                                    {
                                        "column_name": "Country",
                                        "column_order": 3,
                                        "data_path": "action_result.summary.country",
                                        "data_type": "string",
                                        "example_values": [
                                            "US"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.dynamic_domain",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "column_name": "Ever Compromised",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.ever_compromised",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.first_seen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-09-29 00:00:00",
                                            "2018-08-01 00:00:00"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.last_seen",
                                        "data_type": "string",
                                        "example_values": [
                                            "2018-10-28 23:48:37",
                                            "2018-09-30 15:41:29"
                                        ]
                                    },
                                    {
                                        "column_name": "Sinkhole",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.sinkhole",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.summary.total_unique_domains",
                                        "data_type": "numeric",
                                        "example_values": [
                                            123,
                                            118
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total unique domains: 123, Classification: None, Sinkhole: False, Country: US, First seen: 2018-09-29 00:00:00, Ever compromised: False, As name: Splunk Inc., Last seen: 2018-10-28 23:48:35",
                                            "Total unique domains: 118, Classification: None, Sinkhole: False, Country: US, First seen: 2018-08-01 00:00:00, Ever compromised: False, As name: Splunk Inc., Last seen: 2018-09-30 15:41:25"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "from": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Start date for Passive data (YYYY-mm-dd)",
                                        "key": "from",
                                        "order": 2,
                                        "required": false
                                    },
                                    "ip": {
                                        "contains": [
                                            "ip",
                                            "ipv6"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to query",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "ph": {
                                        "data_type": "ph",
                                        "default": null,
                                        "key": "ph",
                                        "order": 1,
                                        "required": false
                                    },
                                    "to": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "End date for Passive data (YYYY-mm-dd)",
                                        "key": "to",
                                        "order": 3,
                                        "required": false
                                    }
                                },
                                "product_name": "PassiveTotal",
                                "product_vendor": "PassiveTotal",
                                "targets": "8",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "ip reputation"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def ip_reputation_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('ip_reputation_2() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'ip_reputation_2' call\n    results_data_1 = phantom.collect2(container=container, datapath=['geolocate_ip:action_result.parameter.ip', 'geolocate_ip:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'ip_reputation_2' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                'ph': \"\",\n                'to': \"\",\n                'from': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"ip reputation\", parameters=parameters, assets=['passivetotal'], callback=join_format_results, name=\"ip_reputation_2\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "whois ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "Gather reputation information about the IP from PassiveTotal",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "672d282b-7a34-40da-aab8-d72b9e14fa29",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 214,
                        "line_start": 188,
                        "message": "Configuring now",
                        "name": "ip reputation",
                        "notes": "Gather reputation information about the IP from PassiveTotal",
                        "number": 2,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1220,
                            "y": 400
                        },
                        "previous_function": "",
                        "previous_name": "ip_reputation_2",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 790
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'filter_current_answer' block\n    filter_current_answer(container=container)\n\n    # call 'filter_query' block\n    filter_query(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fb656ce5-6bb6-4598-89ec-3a1fa425da4a",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 19,
                        "line_start": 8,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 80,
                            "y": 280
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 798
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".border": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def filter_current_answer(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_current_answer() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.current_answer\", \"!=\", \"\"],\n        ],\n        name=\"filter_current_answer:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        geolocate_ip(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "filter_current_answer",
                        "description": "Filter down to artifacts with the current answer of the DNS request as seen in Splunk",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "579d254e-f7e0-4713-9ff1-ffe6e95159e3",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 258,
                        "line_start": 241,
                        "name": "filter",
                        "notes": "Filter down to artifacts with the current answer of the DNS request as seen in Splunk",
                        "number": 1,
                        "order": 10,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.current_answer",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 220,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "filter_current_answer",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 799
                    },
                    {
                        "action": "lookup ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "geolocate_ip:action_result.parameter.ip"
                        },
                        "angle": 0,
                        "app": "Censys",
                        "appid": "97C8DF6F-C870-4482-B6CA-B6C31745FBAB",
                        "approver": "",
                        "assets": [
                            {
                                "action": "lookup ip",
                                "active": true,
                                "app_name": "Censys",
                                "app_version": "1.0.19",
                                "appid": "",
                                "asset_name": "censys",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "geolocate_ip:action_result.parameter.ip"
                                },
                                "has_app": true,
                                "id": 57,
                                "loaded": false,
                                "missing": false,
                                "name": "censys",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.asn",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.description",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.path",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.rir",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.autonomous_system.routed_prefix",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.continent",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.latitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.longitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.postal_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.province",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.registered_country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.registered_country_code",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.location.timezone",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.dhe.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.dhe_export.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.heartbleed.heartbeat_enabled",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.heartbleed.heartbleed_vulnerable",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.rsa_export.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.export",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.extra_clear",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.ssl_2.support",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_info_access.issuer_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.extended_key_usage",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.digital_signature",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.key_encipherment",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.names",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.locality",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject.province",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.certificate.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.authority_info_access.ocsp_urls",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.authority_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.basic_constraints.is_ca",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.basic_constraints.max_path_len",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.certificate_policies",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.crl_distribution_points",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.certificate_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.crl_sign",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.key_usage.value",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.subject_alt_name.directory_names.*.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.extensions.subject_key_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_md5",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_sha1",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.issuer_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.serial_number",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.self_signed",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.signature_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.spki_subject_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.common_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.organization",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject.organizational_unit",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_dn",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.fingerprint_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.key_algorithm.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.key_algorithm.oid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.exponent",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.subject_key_info.rsa_public_key.modulus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.tbs_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.tbs_noct_fingerprint",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validation_level",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.length",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.validity.start",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.chain.*.parsed.version",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.cipher_suite.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.cipher_suite.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.ocsp_stapling",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.server_key_exchange.ecdh_params.curve_id.id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.server_key_exchange.ecdh_params.curve_id.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.hash_algorithm",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.signature_algorithm",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.signature.valid",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.validation.browser_trusted",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.443.https.tls.version",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.body_sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.cache_control",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.connection",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.content_language",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.content_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.expires",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.pragma",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.server",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.strict_transport_security",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.unknown.*.key",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.unknown.*.value",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.vary",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.x_frame_options",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.headers.x_ua_compatible",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.status_code",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.ports.80.http.get.status_line",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.protocols",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tags",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.updated_at",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.protocols",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to get info of",
                                        "key": "ip",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Censys",
                                "product_vendor": "Censys",
                                "targets": "25",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "censys lookup ip"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def censys_lookup_ip(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('censys_lookup_ip() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'censys_lookup_ip' call\n    results_data_1 = phantom.collect2(container=container, datapath=['geolocate_ip:action_result.parameter.ip', 'geolocate_ip:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'censys_lookup_ip' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"lookup ip\", parameters=parameters, assets=['censys'], callback=filter_tls_certificate, name=\"censys_lookup_ip\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "whois ip",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "censys lookup ip",
                        "delay": "0",
                        "description": "Censys lookup of the IP address to get the TLS certificate and other information",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "3640d401-19b9-4d63-b389-f76477198916",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 284,
                        "line_start": 261,
                        "message": "Configuring now",
                        "name": "lookup ip",
                        "notes": "Censys lookup of the IP address to get the TLS certificate and other information",
                        "number": 1,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 840,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "censys_lookup_ip",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 809
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format results"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_results(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_results() called')\n    \n    template = \"\"\"GeoIP Results: {0}\nWhois Information: {1}\nSSL Certificate From IP Details\nIssuer Common Name {2}\nIssuer Country {3}\nIssuer Org {4}\nPassiveTotal IP Reputation: {5}\n\nIs domain a known malware domain list: {6}\nPassive Total Domain Reputation: {7}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"geolocate_ip:action_result.message\",\n        \"whois_ip:action_result.message\",\n        \"censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name\",\n        \"censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country\",\n        \"censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization\",\n        \"ip_reputation_2:action_result.message\",\n        \"domain_reputation_1:action_result.summary.malicious\",\n        \"domain_reputation_2:action_result.message\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_results\")\n\n    add_comment(container=container)\n    format_notable_comment(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "lookup certificate, ip reputation, domain reputation 1, domain reputation 2",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format results",
                        "description": "Format a selection of the most relevant results from the executed enrichment queries for use in a comment on Mission Control",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9be467a5-9d8f-4894-ac82-34aa649b8795",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_format_results(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_format_results() called')\n\n    # check if all connected incoming playbooks, actions, or custom functions are done i.e. have succeeded or failed\n    if phantom.completed(action_names=['lookup_certificate_1', 'ip_reputation_2', 'domain_reputation_1', 'domain_reputation_2']):\n        \n        # call connected block \"format_results\"\n        format_results(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 122,
                        "line_end": 133,
                        "line_start": 89,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Format a selection of the most relevant results from the executed enrichment queries for use in a comment on Mission Control",
                        "number": 3,
                        "order": 5,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "geolocate_ip:action_result.message"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "whois_ip:action_result.message"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.common_name"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.country"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "censys_lookup_ip:action_result.data.*.ports.443.https.tls.certificate.parsed.issuer.organization"
                            },
                            {
                                "position": 5,
                                "type": "",
                                "value": "ip_reputation_2:action_result.message"
                            },
                            {
                                "position": 7,
                                "type": "",
                                "value": "domain_reputation_1:action_result.summary.malicious"
                            },
                            {
                                "position": 8,
                                "type": "",
                                "value": "domain_reputation_2:action_result.message"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1460,
                            "y": 540
                        },
                        "previous_function": "",
                        "previous_name": "format_results",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "GeoIP Results: {0}\nWhois Information: {1}\nSSL Certificate From IP Details\nIssuer Common Name {2}\nIssuer Country {3}\nIssuer Org {4}\nPassiveTotal IP Reputation: {5}\n\nIs domain a known malware domain list: {6}\nPassive Total Domain Reputation: {7}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 812
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add comment",
                        "attrs": {
                            ".api": {
                                "text": "add comment"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def add_comment(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_comment() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_results')\n\n    phantom.comment(container=container, comment=formatted_data_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addCommentComment": "format_results:formatted_data",
                                "key": "add-comment"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "lookup certificate, ip reputation, domain reputation 1, domain reputation 2",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "add comment",
                        "description": "Add all the of the enrichment data as a comment to Mission Control ",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "da2f10c6-2cd8-427a-8d17-06c8f9496d2b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 86,
                        "line_start": 77,
                        "message": "Configuring now",
                        "name": "add comment",
                        "notes": "Add all the of the enrichment data as a comment to Mission Control ",
                        "number": 3,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1700,
                            "y": 680
                        },
                        "previous_function": "",
                        "previous_name": "add_comment",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 818
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format notable comment"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_notable_comment(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_notable_comment() called')\n    \n    template = \"\"\"Phantom gathered enrichment of this Notable Event, all of which can be viewed here: {0}\n\nThe most relevant fields from the enrichment are below:\n{1}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"container:url\",\n        \"format_results:formatted_data\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_notable_comment\")\n\n    update_notable_event(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "lookup certificate, ip reputation, domain reputation 1, domain reputation 2",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format notable comment",
                        "description": "Format a selection of the most relevant results from the executed enrichment queries for use in raising a notable event in Splunk ",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "e0a1823b-d5c4-43ef-8b51-13cb3c7de657",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 354,
                        "line_start": 334,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Format a selection of the most relevant results from the executed enrichment queries for use in raising a notable event in Splunk ",
                        "number": 4,
                        "order": 14,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "container:url"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "format_results:formatted_data"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1700,
                            "y": 540
                        },
                        "previous_function": "",
                        "previous_name": "format_notable_comment",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Phantom gathered enrichment of this Notable Event, all of which can be viewed here: {0}\n\nThe most relevant fields from the enrichment are below:\n{1}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 819
                    },
                    {
                        "action": "update event",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "comment": "format_notable_comment:formatted_data",
                            "event_ids": "artifact:*.cef.event_id",
                            "owner": "",
                            "status": "",
                            "urgency": ""
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update event",
                                "actions": [
                                    "post data",
                                    "update event",
                                    "run query",
                                    "on poll",
                                    "get host events",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.23",
                                "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                                "asset_name": "splunk_es",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "comment": "format_notable_comment:formatted_data",
                                    "event_ids": "artifact:*.cef.event_id",
                                    "integer_status": "",
                                    "owner": "",
                                    "status": "",
                                    "urgency": "",
                                    "wait_for_confirmation": ""
                                },
                                "has_app": true,
                                "id": 10,
                                "loaded": false,
                                "missing": false,
                                "name": "splunk_es",
                                "output": [
                                    {
                                        "column_name": "Status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.comment",
                                        "data_type": "string",
                                        "example_values": [
                                            "test comment"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "splunk notable event id"
                                        ],
                                        "data_path": "action_result.parameter.event_ids",
                                        "data_type": "string",
                                        "example_values": [
                                            "1542751027.136723+0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.integer_status",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.owner",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.urgency",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.wait_for_confirmation",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.failure_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "1 event updated successfully"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.success",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.success_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.updated_event_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "2CF264EE-6016-4F6A-BCC3-4B7251E113F7@@notable@@035142b19c09ab645c6bbfb847e866f4"
                                        ]
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Updated event id: 2CF264EE-6016-4F6A-BCC3-4B7251E113F7@@notable@@035142b19c09ab645c6bbfb847e866f4"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "comment": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "New comment for the event",
                                        "key": "comment",
                                        "order": 4,
                                        "required": false
                                    },
                                    "event_ids": {
                                        "contains": [
                                            "splunk notable event id"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Events IDs to update",
                                        "key": "event_ids",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    },
                                    "owner": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "New owner for the event",
                                        "key": "owner",
                                        "order": 1,
                                        "required": false
                                    },
                                    "status": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "New status for the event",
                                        "key": "status",
                                        "order": 2,
                                        "required": false,
                                        "value_list": [
                                            "",
                                            "unassigned",
                                            "new",
                                            "in progress",
                                            "pending",
                                            "resolved",
                                            "closed"
                                        ]
                                    },
                                    "urgency": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "New urgency for the event",
                                        "key": "urgency",
                                        "order": 3,
                                        "required": false,
                                        "value_list": [
                                            "informational",
                                            "low",
                                            "medium",
                                            "high",
                                            "critical"
                                        ]
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "targets": "10",
                                "type": "siem"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "update notable event"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def update_notable_event(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('update_notable_event() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'update_notable_event' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.event_id', 'artifact:*.id'])\n    formatted_data_1 = phantom.get_format_data(name='format_notable_comment')\n\n    parameters = []\n    \n    # build parameters list for 'update_notable_event' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'owner': \"\",\n                'status': \"\",\n                'comment': formatted_data_1,\n                'urgency': \"\",\n                'event_ids': container_item[0],\n                'integer_status': \"\",\n                'wait_for_confirmation': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"update event\", parameters=parameters, assets=['splunk_es'], name=\"update_notable_event\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "lookup certificate, ip reputation, domain reputation 1, domain reputation 2",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "update notable event",
                        "delay": "0",
                        "description": "Updating the notable event in Splunk with the enrichment data ",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4d923913-0671-44aa-8439-0f6faefffcd8",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 387,
                        "line_start": 357,
                        "message": "Configuring now",
                        "name": "update event",
                        "notes": "Updating the notable event in Splunk with the enrichment data ",
                        "number": 1,
                        "order": 15,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1940,
                            "y": 540
                        },
                        "previous_function": "",
                        "previous_name": "update_notable_event",
                        "required_params": {
                            "event_ids": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 821
                    },
                    {
                        "action": "geolocate ip",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "artifact:*.cef.current_answer"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "",
                                "app_version": "",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "ip": "artifact:*.cef.current_answer"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "maxmind",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.continent_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Asia"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.country_iso_code",
                                        "data_type": "string",
                                        "example_values": [
                                            "IN"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.country_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "India"
                                        ],
                                        "map_info": "Country"
                                    },
                                    {
                                        "data_path": "action_result.data.*.latitude",
                                        "data_type": "numeric",
                                        "example_values": [
                                            23.0333
                                        ],
                                        "map_info": "latitude"
                                    },
                                    {
                                        "data_path": "action_result.data.*.longitude",
                                        "data_type": "numeric",
                                        "example_values": [
                                            72.6167
                                        ],
                                        "map_info": "longitude"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.139.34"
                                        ],
                                        "map_info": "IP Address"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            "203.88.139.34"
                                        ],
                                        "map_info": "name"
                                    },
                                    {
                                        "data_path": "action_result.data.*.city_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Ahmedabad"
                                        ],
                                        "map_info": "City"
                                    },
                                    {
                                        "data_path": "action_result.data.*.postal_code",
                                        "data_type": "string",
                                        "example_values": [
                                            380007
                                        ],
                                        "map_info": "Postal Code"
                                    },
                                    {
                                        "data_path": "action_result.data.*.as_org",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ],
                                        "map_info": "Organization"
                                    },
                                    {
                                        "data_path": "action_result.data.*.state_iso_code",
                                        "data_type": "string",
                                        "example_values": [
                                            "GJ"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.state_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Gujarat"
                                        ],
                                        "map_info": "State/Province"
                                    },
                                    {
                                        "data_path": "action_result.data.*.time_zone",
                                        "data_type": "string",
                                        "example_values": [
                                            "Asia/Kolkata"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.city",
                                        "data_type": "string",
                                        "example_values": [
                                            "Ahmedabad"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.state",
                                        "data_type": "string",
                                        "example_values": [
                                            "GJ"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.country",
                                        "data_type": "string",
                                        "example_values": [
                                            "India"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "City: Ahmedabad, State: GJ, Country: India"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "product_name": "",
                                "product_vendor": "",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "geolocate ip"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def geolocate_ip(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('geolocate_ip() called')\n\n    # collect data for 'geolocate_ip' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.current_answer', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'geolocate_ip' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'ip': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"geolocate ip\", parameters=parameters, assets=['maxmind'], callback=whois_ip, name=\"geolocate_ip\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "#654796",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "geolocate ip",
                        "delay": 0,
                        "description": "Geolocate the IP address using MaxMind",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7611cb89-72b4-48c2-b47f-3c36f3782911",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 238,
                        "line_start": 217,
                        "message": "Configuring now",
                        "name": "geolocate ip",
                        "notes": "Geolocate the IP address using MaxMind",
                        "number": 2,
                        "order": 9,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "geolocate_ip",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 822
                    }
                ]
            },
            "notes": "This playbook uses the following Apps:\n - MaxMind (geolocate ip) [asset name = maxmind] - geolocates IP addresses and displays them on a map\n - WHOIS (whois ip) [asset name = whois] - queries the WHOIS database for basic registration information about an IP address\n - Censys (lookup ip, lookup certificate) [asset name = censys] - lookup IP addresses and pass them to a certificate lookup to check Issuers\n - PassiveTotal (ip reputation, domain reputation) [asset name = passivetotal] - query the reputation of the pointing IP and Domain\n - Malware Domain List (domain reputation) [asset name = malware_domain_list] - query the reputation of the domain\n - Splunk (update event) [asset name = splunk_es] - post a comment back to the originating Notable Event with the enrichment and a link to Phantom's Mission Control for this event"
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.0.40961"
    },
    "create_time": "2021-01-19T21:39:16.467190+00:00",
    "draft_mode": false,
    "labels": [
        "events"
    ],
    "tags": [],
    "misc": {
        "apps_list": [
            "Passivetotal",
            "WHOIS",
            "MaxMind",
            "Censys",
            "Malware Domain List",
            "Splunk"
        ]
    }
}