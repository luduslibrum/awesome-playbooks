{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Use Cases",
    "misc": { "apps_list": ["Cisco Umbrella Investigate"] },
    "coa": {
        "data": {
            "clean": true,
            "code_block": "",
            "description": "Extract and enrich domain names in a suspicious email. This operates on domain names automatically extracted at email ingestion as well as domain names extracted within this playbook using the regex_extract_email custom function. Once the domain names are extracted, Cisco Umbrella Investigate is used to gather reputation information, including risk scores, which are presented in a note within the event.",
            "hash": "1041b53b5210959bb13357fb29f97624e0d9a42b",
            "joint": {
                "cells": [
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'extracted_domains' block\n    extracted_domains(container=container)\n\n    # call 'get_full_event_text' block\n    get_full_event_text(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5fc67fe9-1291-4cb3-8a5b-99c534e4219e",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 19,
                        "line_start": 8,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -120,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 1
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "email domain rep, artifact domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "00fdc722-6feb-4401-b7ce-d7b8545fba33",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 296,
                        "line_start": 283,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 13,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1380,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 2
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6c6126e5-d106-491b-85a1-ce312306a774",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5fc67fe9-1291-4cb3-8a5b-99c534e4219e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "fe049840-7466-4bd0-92ee-df613840c592",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 16
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1140df41-cd33-474d-b061-ddc9a0d2ebfa",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fe049840-7466-4bd0-92ee-df613840c592",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d32faaeb-9211-4676-90c8-7c4ac28c513f",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 18
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "09ddcb21-d5c8-4458-a74d-e3a41a742900",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "988a7d12-458f-4598-8ab7-e51e81fb0462",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "37db2c70-6f8c-4454-84cb-5cf9d447a1a0",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 30
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6ecef9af-1763-4882-bd24-9969549dcc2b",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5fc67fe9-1291-4cb3-8a5b-99c534e4219e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4e4580be-48bc-4d77-bb34-02fb1699b162",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 41
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "750ff1d1-b2c5-4af9-a01a-1ea4e0cc6cc9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4e4580be-48bc-4d77-bb34-02fb1699b162",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "988a7d12-458f-4598-8ab7-e51e81fb0462",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 44
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d30e34f3-debf-45a4-997b-a87a08381780",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "37db2c70-6f8c-4454-84cb-5cf9d447a1a0",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "41cba7d6-30c2-4e73-8fee-0aeac428d084",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 50
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "06463edc-f69f-45c3-a35c-7a9a4f4ec6f9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d32faaeb-9211-4676-90c8-7c4ac28c513f",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "5aceef81-a21f-4d70-ade6-3088996b1221",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 56
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "34445587-9d61-4e7f-a684-3714b8ddcfac",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5aceef81-a21f-4d70-ade6-3088996b1221",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "56ac2735-564e-4013-9769-271e188590d9",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 70
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5de83d1d-9696-46d4-85d0-9cb663411a93",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "56ac2735-564e-4013-9769-271e188590d9",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "953cd2ad-bc0f-4189-8a95-97eb7378b741",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 72
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "73431f89-4a99-4f5e-860c-f9e857974dc3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "41cba7d6-30c2-4e73-8fee-0aeac428d084",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ed866020-fbc5-480a-8b55-27c09266b57b",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 76
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d7756d5f-fc22-430e-8f3c-ce2701ac62f8",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ed866020-fbc5-480a-8b55-27c09266b57b",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6ef95621-f6f9-4fa8-9173-3d8839457f93",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 81
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def extracted_non_malicious(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extracted_non_malicious() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"email_domain_rep:action_result.data.*.status_desc\", \"!=\", \"NON MALICIOUS\"],\n        ],\n        name=\"extracted_non_malicious:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        format_email_note(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "email domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "extracted non malicious",
                        "description": "Proceed for all domains that are not known to be safe.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "41cba7d6-30c2-4e73-8fee-0aeac428d084",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 176,
                        "line_start": 158,
                        "name": "filter",
                        "notes": "Proceed for all domains that are not known to be safe.",
                        "number": 3,
                        "order": 7,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "email_domain_rep:action_result.data.*.status_desc",
                                        "value": "NON MALICIOUS"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 740,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "extracted_non_malicious",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 92
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format email note"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_email_note(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_email_note() called')\n    \n    template = \"\"\"The following domains were extracted from email addresses in the event and queried in Cisco Umbrella Investigate:\n\n| Domain | Status | Risk Score | Category |\n|---|---|---|---|\n%%\n| {0} | {1} | {2} | {3} |\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.parameter.domain\",\n        \"filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.status_desc\",\n        \"filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.risk_score\",\n        \"filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.category\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_email_note\", separator=\", \")\n\n    add_email_note(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "email domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format email note",
                        "delimiter": ", ",
                        "description": "Construct a note with the domain reputation results.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ed866020-fbc5-480a-8b55-27c09266b57b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 204,
                        "line_start": 179,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Construct a note with the domain reputation results.",
                        "number": 1,
                        "order": 8,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.parameter.domain"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.status_desc"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.risk_score"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "filtered-data:extracted_non_malicious:condition_1:email_domain_rep:action_result.data.*.category"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 880,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "format_email_note",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "The following domains were extracted from email addresses in the event and queried in Cisco Umbrella Investigate:\n\n| Domain | Status | Risk Score | Category |\n|---|---|---|---|\n%%\n| {0} | {1} | {2} | {3} |\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 94
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f9cf07d0-5b9a-425f-9077-eb153be8b485",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6ef95621-f6f9-4fa8-9173-3d8839457f93",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "00fdc722-6feb-4401-b7ce-d7b8545fba33",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 102
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a68f668a-6f58-4a78-8497-e115f17890dd",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "953cd2ad-bc0f-4189-8a95-97eb7378b741",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "00fdc722-6feb-4401-b7ce-d7b8545fba33",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 103
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 4
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def artifact_non_malicious(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('artifact_non_malicious() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact_domain_rep:action_result.data.*.status_desc\", \"!=\", \"NON MALICIOUS\"],\n        ],\n        name=\"artifact_non_malicious:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        format_artifact_note(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "artifact domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "artifact non malicious",
                        "description": "Proceed for all domains that are not known to be safe.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5aceef81-a21f-4d70-ade6-3088996b1221",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 225,
                        "line_start": 207,
                        "name": "filter",
                        "notes": "Proceed for all domains that are not known to be safe.",
                        "number": 4,
                        "order": 9,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact_domain_rep:action_result.data.*.status_desc",
                                        "value": "NON MALICIOUS"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 500,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "artifact_non_malicious",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 114
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format artifact note"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_artifact_note(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_artifact_note() called')\n    \n    template = \"\"\"The following domains were present in artifacts in the event and queried in Cisco Umbrella Investigate:\n\n| Domain | Status | Risk Score | Category |\n|---|---|---|---|\n%%\n| {0} | {1} | {2} | {3} |\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.parameter.domain\",\n        \"filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.status_desc\",\n        \"filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.risk_score\",\n        \"filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.category\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_artifact_note\", separator=\", \")\n\n    add_artifact_note(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "artifact domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format artifact note",
                        "delimiter": ", ",
                        "description": "Construct a note with the domain reputation results.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "56ac2735-564e-4013-9769-271e188590d9",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 253,
                        "line_start": 228,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Construct a note with the domain reputation results.",
                        "number": 2,
                        "order": 10,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.parameter.domain"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.status_desc"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.risk_score"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "filtered-data:artifact_non_malicious:condition_1:artifact_domain_rep:action_result.data.*.category"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 640,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "format_artifact_note",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "The following domains were present in artifacts in the event and queried in Cisco Umbrella Investigate:\n\n| Domain | Status | Risk Score | Category |\n|---|---|---|---|\n%%\n| {0} | {1} | {2} | {3} |\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 115
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "add artifact note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def add_artifact_note(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_artifact_note() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_artifact_note')\n\n    note_title = \"Domain reputations from extracted email domains\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "format_artifact_note:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "Domain reputations from extracted email domains",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "artifact domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "add artifact note",
                        "description": "Post the note to the container.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "953cd2ad-bc0f-4189-8a95-97eb7378b741",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 268,
                        "line_start": 256,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "Post the note to the container.",
                        "number": 1,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 880,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "add_artifact_note",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 116
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "add email note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def add_email_note(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_email_note() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_email_note')\n\n    note_title = \"Domain reputations from email addresses\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "format_email_note:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "Domain reputations from email addresses",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "email domain rep",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "add email note",
                        "description": "Post the note to the container.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "6ef95621-f6f9-4fa8-9173-3d8839457f93",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 283,
                        "line_start": 271,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "Post the note to the container.",
                        "number": 2,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1140,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "add_email_note",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 117
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "extract_email_domains:custom_function_result.data.*.domain"
                        },
                        "angle": 0,
                        "app": "Cisco Umbrella Investigate",
                        "appid": "5fc14867-8c8e-4cc2-8198-641df784bf1a",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "actions": [
                                    "whois domain",
                                    "ip reputation",
                                    "domain reputation",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Cisco Umbrella Investigate",
                                "app_version": "1.0.0",
                                "appid": "5fc14867-8c8e-4cc2-8198-641df784bf1a",
                                "asset_name": "umbrella_investigate",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "domain": "extract_email_domains:custom_function_result.data.*.domain"
                                },
                                "has_app": true,
                                "id": 22,
                                "loaded": false,
                                "missing": false,
                                "name": "umbrella_investigate",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string",
                                        "example_values": [
                                            "testdomain.com"
                                        ]
                                    },
                                    {
                                        "column_name": "Categories",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "Search Engines",
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.category_info.content_categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Search Engines"
                                        ]
                                    },
                                    {
                                        "column_name": "Security Categories",
                                        "column_order": 4,
                                        "data_path": "action_result.data.*.category_info.security_categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.category_info.status",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            -1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.indicator",
                                        "data_type": "string",
                                        "example_values": [
                                            "Geo Popularity Score",
                                            "Keyword Score",
                                            "Lexical"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.normalized_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2,
                                            60,
                                            100
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -3.610878170000002,
                                            0.09264255482489717,
                                            0.606
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.relative_links.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4289
                                        ]
                                    },
                                    {
                                        "column_name": "Risk Score",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.risk_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.asn_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -0.03286849936319416,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.attack",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "DGA Score",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.security_info.dga_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            -15.55033332819711
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1.91829583405449,
                                            2.75
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.fastflux",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.found",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.0001,
                                            0.1429
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity_normalized",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity_normalized.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.0003299100640734098,
                                            0.009745995689748824
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geoscore",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            0.002894054671255598
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.handlings.normal",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.ks_test",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            0.2846253137451792
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.pagerank",
                                        "data_type": "numeric",
                                        "example_values": [
                                            60.32995,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.perplexity",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.1878675610437336,
                                            1.122248102917671
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.popularity",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.prefix_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -0.1054320152441063,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.rip_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -3.051340626556875,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.securerank2",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            -0.004050008137296145
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.threat_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.tld_geodiversity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.tld_geodiversity.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.01008192795884705
                                        ]
                                    },
                                    {
                                        "column_name": "Status",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.status_desc",
                                        "data_type": "string",
                                        "example_values": [
                                            "SAFE",
                                            "MALICIOUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.attacks",
                                        "data_type": "string",
                                        "example_values": [
                                            "Rig"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.category",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.period.begin",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.period.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.threatTypes",
                                        "data_type": "string",
                                        "example_values": [
                                            "Exploit Kit"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.timestamp",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1428593707849,
                                            1496547887014
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.summary.domain_status",
                                        "data_type": "string",
                                        "example_values": [
                                            "SAFE",
                                            "MALICIOUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.risk_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            6
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_co_occurances",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_relative_links",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_tag_info",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total co occurances: 0, Domain status: SAFE, Total tag info: 1, Total relative links: 100",
                                            "Total co occurances: 0\nDomain status: MALICIOUS\nTotal tag info: 2\nTotal relative links: 0"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain to query",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Cisco Umbrella Investigate",
                                "product_vendor": "Cisco",
                                "targets": "22",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "email domain rep"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def email_domain_rep(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('email_domain_rep() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'email_domain_rep' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['extract_email_domains:custom_function_result.data.*.domain'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'email_domain_rep' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        if custom_function_results_item_1[0]:\n            parameters.append({\n                'domain': custom_function_results_item_1[0],\n            })\n\n    phantom.act(action=\"domain reputation\", parameters=parameters, assets=['umbrella_investigate'], callback=extracted_non_malicious, name=\"email_domain_rep\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "extract email domains",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "email domain rep",
                        "delay": 0,
                        "description": "Using the domain portion of the extracted emails, gather the reputation of those domain names.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "37db2c70-6f8c-4454-84cb-5cf9d447a1a0",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 116,
                        "line_start": 95,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "Using the domain portion of the extracted emails, gather the reputation of those domain names.",
                        "number": 3,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 500,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "email_domain_rep",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 121
                    },
                    {
                        "action": "domain reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "domain": "filtered-data:extracted_domains:condition_1:artifact:*.cef.destinationDnsDomain"
                        },
                        "angle": 0,
                        "app": "Cisco Umbrella Investigate",
                        "appid": "5fc14867-8c8e-4cc2-8198-641df784bf1a",
                        "approver": "",
                        "assets": [
                            {
                                "action": "domain reputation",
                                "actions": [
                                    "whois domain",
                                    "ip reputation",
                                    "domain reputation",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Cisco Umbrella Investigate",
                                "app_version": "1.0.0",
                                "appid": "5fc14867-8c8e-4cc2-8198-641df784bf1a",
                                "asset_name": "umbrella_investigate",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "domain": "filtered-data:extracted_domains:condition_1:artifact:*.cef.destinationDnsDomain"
                                },
                                "has_app": true,
                                "id": 22,
                                "loaded": false,
                                "missing": false,
                                "name": "umbrella_investigate",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "column_name": "Domain",
                                        "column_order": 0,
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.parameter.domain",
                                        "data_type": "string",
                                        "example_values": [
                                            "testdomain.com"
                                        ]
                                    },
                                    {
                                        "column_name": "Categories",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "Search Engines",
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.category_info.content_categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Search Engines"
                                        ]
                                    },
                                    {
                                        "column_name": "Security Categories",
                                        "column_order": 4,
                                        "data_path": "action_result.data.*.category_info.security_categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.category_info.status",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            -1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.indicator",
                                        "data_type": "string",
                                        "example_values": [
                                            "Geo Popularity Score",
                                            "Keyword Score",
                                            "Lexical"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.normalized_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2,
                                            60,
                                            100
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.indicators.*.score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -3.610878170000002,
                                            0.09264255482489717,
                                            0.606
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.relative_links.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4289
                                        ]
                                    },
                                    {
                                        "column_name": "Risk Score",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.risk_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.asn_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -0.03286849936319416,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.attack",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "DGA Score",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.security_info.dga_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            -15.55033332819711
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1.91829583405449,
                                            2.75
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.fastflux",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.found",
                                        "data_type": "boolean",
                                        "example_values": [
                                            false,
                                            true
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.0001,
                                            0.1429
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity_normalized",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geodiversity_normalized.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.0003299100640734098,
                                            0.009745995689748824
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.geoscore",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            0.002894054671255598
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.handlings.normal",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.ks_test",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            0.2846253137451792
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.pagerank",
                                        "data_type": "numeric",
                                        "example_values": [
                                            60.32995,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.perplexity",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.1878675610437336,
                                            1.122248102917671
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.popularity",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.prefix_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -0.1054320152441063,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.rip_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -3.051340626556875,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.securerank2",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            -0.004050008137296145
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.threat_type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.tld_geodiversity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.security_info.tld_geodiversity.*",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0.01008192795884705
                                        ]
                                    },
                                    {
                                        "column_name": "Status",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.status_desc",
                                        "data_type": "string",
                                        "example_values": [
                                            "SAFE",
                                            "MALICIOUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.attacks",
                                        "data_type": "string",
                                        "example_values": [
                                            "Rig"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.categories",
                                        "data_type": "string",
                                        "example_values": [
                                            "Malware"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.category",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.period.begin",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.period.end",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.threatTypes",
                                        "data_type": "string",
                                        "example_values": [
                                            "Exploit Kit"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.tag_info.*.timestamp",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1428593707849,
                                            1496547887014
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.summary.domain_status",
                                        "data_type": "string",
                                        "example_values": [
                                            "SAFE",
                                            "MALICIOUS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.risk_score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0,
                                            6
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_co_occurances",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_relative_links",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100,
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.total_tag_info",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1,
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total co occurances: 0, Domain status: SAFE, Total tag info: 1, Total relative links: 100",
                                            "Total co occurances: 0\nDomain status: MALICIOUS\nTotal tag info: 2\nTotal relative links: 0"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "domain": {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Domain to query",
                                        "key": "domain",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Cisco Umbrella Investigate",
                                "product_vendor": "Cisco",
                                "targets": "22",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "artifact domain rep"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def artifact_domain_rep(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('artifact_domain_rep() called')\n\n    # collect data for 'artifact_domain_rep' call\n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:extracted_domains:condition_1:artifact:*.cef.destinationDnsDomain', 'filtered-data:extracted_domains:condition_1:artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'artifact_domain_rep' call\n    for filtered_artifacts_item_1 in filtered_artifacts_data_1:\n        if filtered_artifacts_item_1[0]:\n            parameters.append({\n                'domain': filtered_artifacts_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': filtered_artifacts_item_1[1]},\n            })\n\n    phantom.act(action=\"domain reputation\", parameters=parameters, assets=['umbrella_investigate'], callback=artifact_non_malicious, name=\"artifact_domain_rep\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "artifact domain rep",
                        "delay": 0,
                        "description": "Using the domains that were automatically extracted from the email at ingestion, gather the reputation of those domain names.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d32faaeb-9211-4676-90c8-7c4ac28c513f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 92,
                        "line_start": 71,
                        "message": "Configuring now",
                        "name": "domain reputation",
                        "notes": "Using the domains that were automatically extracted from the email at ingestion, gather the reputation of those domain names.",
                        "number": 1,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 260,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "artifact_domain_rep",
                        "required_params": {
                            "domain": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 122
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def extracted_domains(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extracted_domains() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.destinationDnsDomain\", \"!=\", \"\"],\n        ],\n        name=\"extracted_domains:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        artifact_domain_rep(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "extracted domains",
                        "description": "Proceed with domains extracted into artifacts at ingestion.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fe049840-7466-4bd0-92ee-df613840c592",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 68,
                        "line_start": 51,
                        "name": "filter",
                        "notes": "Proceed with domains extracted into artifacts at ingestion.",
                        "number": 2,
                        "order": 3,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.destinationDnsDomain",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 120,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "extracted_domains",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 123
                    },
                    {
                        ".scmName/text": "community",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "get full event text"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "community"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_code_dark_on.svg"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def get_full_event_text(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_full_event_text() called')\n    \n    parameters = []\n\n    parameters.append({\n        'input_1': None,\n        'input_2': None,\n        'input_3': None,\n        'input_4': None,\n        'input_5': None,\n        'input_6': None,\n        'input_7': None,\n        'input_8': None,\n        'input_9': None,\n        'input_10': None,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    container_url = phantom.build_phantom_rest_url('/container/{}'.format(container['id']))\n    artifact_url = phantom.build_phantom_rest_url('/container/{}/artifacts'.format(container['id']))\n                                                   \n    container_and_artifacts = phantom.requests.get(container_url, verify=False).text + phantom.requests.get(artifact_url, verify=False).text\n    parameters[0]['input_1'] = container_and_artifacts\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"community/passthrough\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='community/passthrough', parameters=parameters, name='get_full_event_text', callback=extract_email_domains)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "community/passthrough",
                        "cfInputs": {
                            "input_1": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_10": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_2": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_3": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_4": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_5": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_6": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_7": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_8": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_9": {
                                "dataPath": "",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 20,
                        "customFunction": "community/passthrough",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "get full event text",
                        "delay": 0,
                        "description": "Fetch the full text of the event, including all the artifacts.",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4e4580be-48bc-4d77-bb34-02fb1699b162",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 155,
                        "line_start": 119,
                        "message": "Configuring now",
                        "name": "passthrough",
                        "notes": "Fetch the full text of the event, including all the artifacts.",
                        "number": 1,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 20,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "get_full_event_text",
                        "selectedCustomFunction": {
                            "description": "Return the inputs as outputs. This is useful for publishing pieces of data for other blocks in the playbook to use.",
                            "draftMode": false,
                            "id": 8,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 31,
                                    "input_type": "list",
                                    "name": "input_1",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 32,
                                    "input_type": "list",
                                    "name": "input_2",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 33,
                                    "input_type": "list",
                                    "name": "input_3",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 34,
                                    "input_type": "list",
                                    "name": "input_4",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 35,
                                    "input_type": "list",
                                    "name": "input_5",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 36,
                                    "input_type": "list",
                                    "name": "input_6",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 37,
                                    "input_type": "list",
                                    "name": "input_7",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 38,
                                    "input_type": "list",
                                    "name": "input_8",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 39,
                                    "input_type": "list",
                                    "name": "input_9",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "description": "",
                                    "id": 40,
                                    "input_type": "list",
                                    "name": "input_10",
                                    "placeholder": ""
                                }
                            ],
                            "name": "passthrough",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 8,
                                    "data_path": "*.item",
                                    "description": "The output item for each input",
                                    "id": 11
                                },
                                {
                                    "_pretty_custom_function": "passthrough",
                                    "contains_type": [],
                                    "custom_function": 8,
                                    "data_path": "*.input_name",
                                    "description": "The corresponding input name for each output",
                                    "id": 12
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/copy_file_to_s3",
                                        "draft_mode": false,
                                        "id": 147,
                                        "name": "copy_file_to_s3",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 1,
                            "scmName": "community"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "\n    container_url = phantom.build_phantom_rest_url('/container/{}'.format(container['id']))\n    artifact_url = phantom.build_phantom_rest_url('/container/{}/artifacts'.format(container['id']))\n                                                   \n    container_and_artifacts = phantom.requests.get(container_url, verify=False).text + phantom.requests.get(artifact_url, verify=False).text\n    parameters[0]['input_1'] = container_and_artifacts\n\n",
                        "warn": false,
                        "z": 124
                    },
                    {
                        ".scmName/text": "community",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "extract email domains"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "community"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def extract_email_domains(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extract_email_domains() called')\n    \n    custom_function_result_0 = phantom.collect2(container=container, datapath=['get_full_event_text:custom_function_result.data.*.item'], action_results=results )\n\n    parameters = []\n\n    for item0 in custom_function_result_0:\n        parameters.append({\n            'input_string': item0[0],\n        })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"community/regex_extract_email\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='community/regex_extract_email', parameters=parameters, name='extract_email_domains', callback=email_domain_rep)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "community/regex_extract_email",
                        "cfInputs": {
                            "input_string": {
                                "collectionType": "custom_function_result",
                                "dataPath": "get_full_event_text:custom_function_result.data.*.item",
                                "paramName": "item0[0]",
                                "type": "item"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "get full event text",
                        "connection_type": "action",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 14,
                        "customFunction": "community/regex_extract_email",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "extract email domains",
                        "delay": 0,
                        "description": "Use a regular expression to extract all email addresses from the full text of the event.",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "988a7d12-458f-4598-8ab7-e51e81fb0462",
                        "inPorts": [
                            "in"
                        ],
                        "input_string-0": "get_full_event_text:custom_function_result.data.*.item",
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 48,
                        "line_start": 22,
                        "message": "Configuring now",
                        "name": "regex_extract_email",
                        "notes": "Use a regular expression to extract all email addresses from the full text of the event.",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 260,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "extract_email_domains",
                        "selectedCustomFunction": {
                            "description": "Provide a string with one or more email addresses in it to be extracted.\nCan be helpful with strings from the To or CC fields of an email: \"<other_email@domain.com>, 'Name' <e-mail@domain.com>\"",
                            "draftMode": false,
                            "id": 62,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "regex_extract_email",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 62,
                                    "description": "String containing email addresses",
                                    "id": 179,
                                    "input_type": "item",
                                    "name": "input_string",
                                    "placeholder": ""
                                }
                            ],
                            "name": "regex_extract_email",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "regex_extract_email",
                                    "contains_type": [
                                        "email"
                                    ],
                                    "custom_function": 62,
                                    "data_path": "*.email_address",
                                    "description": "Parsed email addresses",
                                    "id": 161
                                },
                                {
                                    "_pretty_custom_function": "regex_extract_email",
                                    "contains_type": [
                                        "domain"
                                    ],
                                    "custom_function": 62,
                                    "data_path": "*.domain",
                                    "description": "Domain names of the parsed email addresses (everything after the \"@\")",
                                    "id": 162
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": []
                            },
                            "scmId": 1,
                            "scmName": "community"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...",
                        "warn": false,
                        "z": 125
                    }
                ]
            },
            "notes": "This playbook uses the following Apps:\n - Cisco Umbrella Investigate (domain reputation) [asset name = umbrella_investigate] - query for domain reputation\n\nDeployment Notes:\n - processes emails that are ingested from apps such as imap, GMail, or Microsoft Exchange\n - if the suspicious email is sent as an attachment on another email, additional steps would be needed at the start of this playbook to extract indicators from the attachment\n - get_full_event_text uses the Phantom REST API to access the full text of the container and artifacts, including all data fields"
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.4.56260"
    },
    "create_time": "2021-06-23T19:55:24.951559+00:00",
    "draft_mode": false,
    "labels": [
        "email"
    ],
    "tags": []
}
