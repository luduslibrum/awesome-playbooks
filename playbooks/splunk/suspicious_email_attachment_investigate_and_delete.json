{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Use Cases",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "import socket",
            "description": "Investigate an email with a suspicious file attachment detected by Splunk Enterprise Security. Detonate the file attachment in a sandbox, gather network behavior from the sandbox results, and pivot on those network indicators with both external reputation queries and internal Splunk Common Information Model searches. After confirming the results with an analyst prompt, delete the email from the user's inbox, hopefully before they have opened it.",
            "hash": "b39f5d0947ef52f5b450e4fb53e61a2fcfafb9df",
            "joint": {
                "cells": [
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "484392ce-91ca-4580-9809-76855b709cbc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7d63d9fc-dc58-4dc1-8d18-c2a49b0b23ea",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "vertices": [],
                        "z": 486
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "64a67e1c-f9ef-4c49-84bb-c25ca7665ade",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "8d846e75-8ec7-45d6-a274-86ec3ea7db16",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "fdba437e-bc9b-4a9b-a26f-e699f34dbad9",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 511
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "c1100cdd-36a9-4b27-a4b9-4bb2940c7e2f",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fdba437e-bc9b-4a9b-a26f-e699f34dbad9",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "65290e12-6d86-4560-82ca-613c170cec0d",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 513
                    },
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'get_email_1' block\n    get_email_1(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fe18945c-bc07-4723-978d-814e77470159",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 24,
                        "line_start": 16,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -280,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 606
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5ad88fae-3964-4196-88e3-3aad6d4e4266",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fdba437e-bc9b-4a9b-a26f-e699f34dbad9",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "843514b0-6482-4f91-808b-1418df0781e0",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 654
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bd5bf092-1c71-4773-9981-dd4c3f17824f",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "843514b0-6482-4f91-808b-1418df0781e0",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0309ed1f-d09d-488c-91f5-87be9eb8fa07",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 656
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "send recipient email",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fa6e4601-0485-429a-b7d5-2481405ca228",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 675,
                        "line_start": 662,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 24,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2440,
                            "y": 800
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 660
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a47fc3dd-a350-44e1-af48-95d9e953e4a3",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "8d846e75-8ec7-45d6-a274-86ec3ea7db16",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "vertices": [],
                        "z": 690
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#6C7A89",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#6a6c8a",
                                "stroke": "#6a6c8a"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0ea629d5-ad79-4320-a9d2-d27eda60eeec",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0309ed1f-d09d-488c-91f5-87be9eb8fa07",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "fa6e4601-0485-429a-b7d5-2481405ca228",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 790
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d0eaed02-5d95-4bdc-8fa2-a052ab2de463",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "eb22e655-7394-46d4-9ff0-57884164c9f6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "06d0be3c-1f6b-47fe-a8bc-543fd8dca9f3",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 856
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "650fc8f7-11d4-4339-a498-a5d271eb9507",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "06d0be3c-1f6b-47fe-a8bc-543fd8dca9f3",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "9276fc79-85c2-4818-8ef6-71c2b27f0803",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 872
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "424ddb69-9b44-4c0c-bc9c-0dd3e300f10e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9276fc79-85c2-4818-8ef6-71c2b27f0803",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0f31c954-63a3-4f5c-aaf6-01d9d1424010",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 908
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "3d785330-1b05-4dfc-b271-da3c0ca597b1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "9276fc79-85c2-4818-8ef6-71c2b27f0803",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "bdb392cc-0b3e-4450-94d5-e3b5fcf13279",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 915
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "53d8036e-41dd-46b0-a614-cea9f4ccd1b4",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "bdb392cc-0b3e-4450-94d5-e3b5fcf13279",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ef7f4d66-4633-4e27-b999-3ab1d7b57f84",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 921
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0fda35e9-e8c3-4f26-b669-135b739db84c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ef7f4d66-4633-4e27-b999-3ab1d7b57f84",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "83cd6e00-fe8b-4cc9-bd64-4be8803f9426",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 923
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "26e695e8-26e6-462d-bfa7-45ad56759639",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0f31c954-63a3-4f5c-aaf6-01d9d1424010",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "bbfb98a7-a234-4a02-9d2b-498665ba162e",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 925
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6eaa1195-c0ad-4a21-86ea-5a0a2edcffcc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "bbfb98a7-a234-4a02-9d2b-498665ba162e",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "589424ab-09e1-48c9-a86d-6490b2670b59",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 927
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "578b451c-22a7-4e33-99d2-4e60a629d931",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "589424ab-09e1-48c9-a86d-6490b2670b59",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "d1944c5a-7def-4b6a-9698-630f62b5fffb",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 934
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f4f6af14-78c7-45aa-85e6-0cc31bfc74a5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "83cd6e00-fe8b-4cc9-bd64-4be8803f9426",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2d82139a-aadc-4b96-a362-16295bae402d",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 936
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0281cb71-c240-4be7-9144-242c194f5439",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "2d82139a-aadc-4b96-a362-16295bae402d",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 957
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1eab52f3-c8fb-43ea-8b99-6d1499d0e0bc",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "d1944c5a-7def-4b6a-9698-630f62b5fffb",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 958
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "785d95a5-9ea3-414e-a49e-e27e09f344ed",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "84bd61d3-b11b-454f-9110-c4b09fdf0a50",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 963
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "1d4971b0-6ba0-4bbd-8480-43b541f51013",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "8de359c3-a12c-4c42-80b9-612999c4ccf4",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                            "port": "in",
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 967
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b327d4b9-d2f4-4e39-9d50-25597ff09054",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "fe18945c-bc07-4723-978d-814e77470159",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "eb22e655-7394-46d4-9ff0-57884164c9f6",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 986
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "extract attachment info"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def extract_attachment_info(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('extract_attachment_info() called')\n    \n    id_value = container.get('id', None)\n\n    extract_attachment_info__vault_id = None\n    extract_attachment_info__attachment_file_name = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.vaultId', 'artifact:*.cef.fileName', 'artifact:*.id'], scope='all')\n    for container_item in container_data:\n        if container_item[0]:\n            phantom.debug(\"found file with vaultId: {}\".format(container_item[0]))\n            extract_attachment_info__vault_id = container_item[0]\n            extract_attachment_info__attachment_file_name = container_item[1]\n\n    phantom.debug(\"detonating file with vaultId: {}\".format(extract_attachment_info__vault_id))\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='extract_attachment_info:vault_id', value=json.dumps(extract_attachment_info__vault_id))\n    phantom.save_run_data(key='extract_attachment_info:attachment_file_name', value=json.dumps(extract_attachment_info__attachment_file_name))\n    detonate_file_1(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "get email",
                        "connection_type": "action",
                        "customCodeEndLineOffset": 8,
                        "customCodeStartLine": 11,
                        "custom_callback": "",
                        "custom_code": "def extract_attachment_info(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('fetch_email_metadata() called')\n    id_value = container.get('id', None)\n\n    extract_attachment_info__vault_id = None\n    extract_attachment_info__attachment_file_name = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.vaultId', 'artifact:*.cef.fileName', 'artifact:*.id'], scope='all')\n    for container_item in container_data:\n        if container_item[0]:\n            phantom.debug(\"found file with vaultId: {}\".format(container_item[0]))\n            extract_attachment_info__vault_id = container_item[0]\n            extract_attachment_info__attachment_file_name = container_item[1]\n\n    phantom.debug(\"detonating file with vaultId: {}\".format(extract_attachment_info__vault_id))\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='fetch_email_metadata:vault_id', value=json.dumps(extract_attachment_info__vault_id))\n    phantom.save_run_data(key='fetch_email_metadata:attachment_file_name', value=json.dumps(extract_attachment_info__attachment_file_name))\n    detonate_file_1(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "extract attachment info",
                        "description": "Extract the vault ID and attachment filename to use in \"detonate file\" and other blocks.",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "06d0be3c-1f6b-47fe-a8bc-543fd8dca9f3",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "legacy": true,
                        "line_end": 340,
                        "line_start": 309,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "Extract the vault ID and attachment filename to use in \"detonate file\" and other blocks.",
                        "number": 1,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "vault_id"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "attachment_file_name"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "container:id"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 100,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "extract_attachment_info",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.vaultId', 'artifact:*.cef.fileName', 'artifact:*.id'], scope='all')\n    for container_item in container_data:\n        if container_item[0]:\n            phantom.debug(\"found file with vaultId: {}\".format(container_item[0]))\n            extract_attachment_info__vault_id = container_item[0]\n            extract_attachment_info__attachment_file_name = container_item[1]\n\n    phantom.debug(\"detonating file with vaultId: {}\".format(extract_attachment_info__vault_id))\n",
                        "warn": false,
                        "z": 1007
                    },
                    {
                        "action": "detonate file",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "file_name": "extract_attachment_info:custom_function:attachment_file_name",
                            "vault_id": "extract_attachment_info:custom_function:vault_id"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "Cuckoo",
                                "app_version": "1.3.1",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "file_name": "extract_attachment_info:custom_function:attachment_file_name",
                                    "vault_id": "extract_attachment_info:custom_function:vault_id"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "cuckoo",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "column_name": "file_name",
                                        "column_order": 1,
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.parameter.file_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "vault_id",
                                        "column_order": 0,
                                        "contains": [
                                            "vault id",
                                            "sha1"
                                        ],
                                        "data_path": "action_result.parameter.vault_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "ac8682258ec2a9556c5b06dac4b70aa7f408146b"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.CopyFileA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.CreateServiceA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.FindResourceExW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            16
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetFileAttributesW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetFileSize",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetFileType",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetSystemInfo",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetSystemMetrics",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetSystemTimeAsFileTime",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetSystemWindowsDirectoryW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetTempPathW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.GetTimeZoneInformation",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.LdrGetDllHandle",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.LdrGetProcedureAddress",
                                        "data_type": "numeric",
                                        "example_values": [
                                            548
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.LdrLoadDll",
                                        "data_type": "numeric",
                                        "example_values": [
                                            35
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.LoadResource",
                                        "data_type": "numeric",
                                        "example_values": [
                                            14
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.LoadStringA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            49
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtAllocateVirtualMemory",
                                        "data_type": "numeric",
                                        "example_values": [
                                            14
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtClose",
                                        "data_type": "numeric",
                                        "example_values": [
                                            17
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtCreateFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            8
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtCreateMutant",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtCreateSection",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtCreateThreadEx",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtDelayExecution",
                                        "data_type": "numeric",
                                        "example_values": [
                                            71680
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtDuplicateObject",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtFreeVirtualMemory",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtMapViewOfSection",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtOpenKey",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtOpenMutant",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtProtectVirtualMemory",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtQueryAttributesFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtQueryInformationFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtQueryValueKey",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtReadFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            22
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtResumeThread",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.NtWriteFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            22
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.OpenSCManagerA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.OutputDebugStringA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegCloseKey",
                                        "data_type": "numeric",
                                        "example_values": [
                                            5
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegOpenKeyExA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegOpenKeyExW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegQueryValueExA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegQueryValueExW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.RegSetValueExA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetEndOfFile",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetFileAttributesW",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetFilePointer",
                                        "data_type": "numeric",
                                        "example_values": [
                                            10
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetFileTime",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetUnhandledExceptionFilter",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.SetWindowsHookExA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.apistats.984.StartServiceA",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.generic.*.first_seen",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509432420.046875
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.pid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.ppid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1104
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.process_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.process_path",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.dll_loaded",
                                        "data_type": "string",
                                        "example_values": [
                                            "COMCTL32.DLL"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_copied.*",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_created",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_exists",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_opened",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_read",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_recreated",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\rql71B0.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.file_written",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.mutex",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.regkey_opened",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_CURRENT_USER\\Software\\Borland\\Delphi\\Locales"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.regkey_read",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Security_HKLM_only"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.generic.*.summary.regkey_written",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\Abcdef Hijklmno Qrs\\Description"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.api",
                                        "data_type": "string",
                                        "example_values": [
                                            "LdrLoadDll"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.access",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00020019"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.allocation_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            8192
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.base_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x01e30000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.base_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x80000001"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.basename",
                                        "data_type": "string",
                                        "example_values": [
                                            "Kernel32"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.buffer",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.callback_function",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00451ebc"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.commit_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.create_disposition",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.create_options",
                                        "data_type": "numeric",
                                        "example_values": [
                                            96
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.database_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.desired_access",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x80100080"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.dirpath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Abcdef Hijklmno Qrstuvwx Abcd"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.error_control",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.fail_if_exists",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.file_attributes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.file_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x0000006c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.file_size_low",
                                        "data_type": "numeric",
                                        "example_values": [
                                            420314
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.filepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name",
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.filepath_r",
                                        "data_type": "string",
                                        "example_values": [
                                            "\\??\\C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.flags",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.free_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            32768
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.function_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x77031410"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.function_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "CloseHandle"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000070"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.handle_attributes",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.hook_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            65398
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.index",
                                        "data_type": "numeric",
                                        "example_values": [
                                            74
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.information_class",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.initial_owner",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.key_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x0000006c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.key_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.language_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.length",
                                        "data_type": "numeric",
                                        "example_values": [
                                            10240
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.machine_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.milliseconds",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.module",
                                        "data_type": "string",
                                        "example_values": [
                                            "kernel32"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.module_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x77020000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.module_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00450000"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name",
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.module_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Kernel32.dll"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.move_method",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.mutant_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000000"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.mutant_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Residented"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "#12"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.newfilepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.newfilepath_r",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.object_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.offset",
                                        "data_type": "numeric",
                                        "example_values": [
                                            244186
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.oldfilepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.oldfilepath_r",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.options",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.ordinal",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.parameter",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x005d4c10"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.password",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.pointer",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x004b5da0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.process_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0xffffffff"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.process_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.processor_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.protection",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.reg_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.region_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1048576
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.regkey",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.regkey_r",
                                        "data_type": "string",
                                        "example_values": [
                                            "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.resource_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x004c24b0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.section_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x000000a4"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.section_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.section_offset",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.service_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x005d1dd0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.service_manager_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x005d1e70"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.service_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Abcdef Hijklmno Qrs"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.service_start_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.service_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            272
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.share_access",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1835008
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.skipped",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.source_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000100"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.source_process_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0xffffffff"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.source_process_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.stack_zero_bits",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.start_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.status_info",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.string",
                                        "data_type": "string",
                                        "example_values": [
                                            "Exception in safecall method"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.suspend_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.suspended",
                                        "data_type": "numeric",
                                        "example_values": [
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.target_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000104"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.target_process_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0xffffffff"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.target_process_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.thread_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00000100"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.thread_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.thread_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x0018ec1c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "#32761"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.value",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.view_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2945024
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.arguments.win32_protect",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "system"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.allocation_type",
                                        "data_type": "string",
                                        "example_values": [
                                            "MEM_RESERVE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.create_disposition",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_OPEN"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.create_options",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_NON_DIRECTORY_FILE|FILE_SYNCHRONOUS_IO_NONALERT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.desired_access",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_READ_ATTRIBUTES|SYNCHRONIZE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.file_attributes",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_ATTRIBUTE_READONLY"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.hook_identifier",
                                        "data_type": "string",
                                        "example_values": [
                                            "WH_CALLWNDPROC"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.index",
                                        "data_type": "string",
                                        "example_values": [
                                            "SM_MIDEASTENABLED"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.information_class",
                                        "data_type": "string",
                                        "example_values": [
                                            "KeyValueFullInformation"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.protection",
                                        "data_type": "string",
                                        "example_values": [
                                            "PAGE_NOACCESS"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.reg_type",
                                        "data_type": "string",
                                        "example_values": [
                                            "REG_NONE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.share_access",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_SHARE_READ"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.status_info",
                                        "data_type": "string",
                                        "example_values": [
                                            "FILE_OPENED"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.flags.win32_protect",
                                        "data_type": "string",
                                        "example_values": [
                                            "PAGE_READONLY"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.last_error",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.nt_status",
                                        "data_type": "numeric",
                                        "example_values": [
                                            -1073741772
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.return_value",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.status",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.tid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            800
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.calls.*.time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509432420.530875
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.command_line",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\system32\\lsass.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.first_seen",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509432418.0625
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.modules.*.baseaddr",
                                        "data_type": "string",
                                        "example_values": [
                                            "0xff180000"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.modules.*.basename",
                                        "data_type": "string",
                                        "example_values": [
                                            "lsass.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.modules.*.filepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\system32\\lsass.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.modules.*.imgsize",
                                        "data_type": "numeric",
                                        "example_values": [
                                            49152
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.pid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            444
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.ppid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            340
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.process_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "lsass.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processes.*.process_path",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\System32\\lsass.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.tid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1604
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.track",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processes.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "process"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.command_line",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\system32\\lsass.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.first_seen",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509432418.0625
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.pid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            444
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.ppid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            340
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.process_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "lsass.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.processtree.*.track",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.summary.dll_loaded",
                                        "data_type": "string",
                                        "example_values": [
                                            "COMCTL32.DLL"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_copied.*",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_created",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_exists",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_opened",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_read",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_recreated",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\rql71B0.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.file_written",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\aul9806.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.behavior.summary.mutex",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.summary.regkey_opened",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_CURRENT_USER\\Software\\Borland\\Delphi\\Locales"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.summary.regkey_read",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Security_HKLM_only"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.behavior.summary.regkey_written",
                                        "data_type": "string",
                                        "example_values": [
                                            "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\services\\Abcdef Hijklmno Qrs\\Description"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.debug.cuckoo",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:49:15,341 [cuckoo.core.plugins] DEBUG: Analysis matched signature: pe_features\n"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.debug.log",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:48:59,125 [analyzer] INFO: Analysis completed.\n"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.crc32",
                                        "data_type": "string",
                                        "example_values": [
                                            "CB1602FC"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path"
                                        ],
                                        "data_path": "action_result.data.*.report.dropped.*.filepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Users\\cuser2\\AppData\\Local\\Temp\\rql71B0.tmp"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.report.dropped.*.md5",
                                        "data_type": "string",
                                        "example_values": [
                                            "685f1cbd4af30a1d0c25f252d399a666"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "0e478c95a7a07570_rql71b0.tmp"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.path",
                                        "data_type": "string",
                                        "example_values": [
                                            "/home/cuckoo/.cuckoo/storage/analyses/27/files/0e478c95a7a07570_rql71b0.tmp"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.pids",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.report.dropped.*.sha1",
                                        "data_type": "string",
                                        "example_values": [
                                            "6a1b978f5e6150b88c8634146f1406ed97d2f134"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.dropped.*.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "0e478c95a7a07570a69e6061e7c1da9001bccad9cc454f2ed4da58824a13e0f4"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.sha512",
                                        "data_type": "string",
                                        "example_values": [
                                            "6555ad6b4f4f26105ca8aad64501d74519a3e091f559b4b563d6ffb20a2ddfcde65e4fe94971a9bc65e86db577f2548ca00f9920d341c8ea808b04c0947d61d9"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            176128
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.dropped.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "PE32 executable (DLL) (GUI) Intel 80386 (stripped to external PDB), for MS Windows"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.added",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509407217.087696
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "file"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.custom",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.duration",
                                        "data_type": "numeric",
                                        "example_values": [
                                            132
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.ended",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509407349.736956
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.git.fetch_head",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.git.head",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            27
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.label",
                                        "data_type": "string",
                                        "example_values": [
                                            "cuckoo2"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.manager",
                                        "data_type": "string",
                                        "example_values": [
                                            "VirtualBox"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "cuckoo2"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.shutdown_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:49:09"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.started_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:46:57"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.machine.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "stopped"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.report.info.monitor",
                                        "data_type": "string",
                                        "example_values": [
                                            "2bd01ede5c5258d5fce2e38bc58348a62c11ce33"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.options",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.owner",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.package",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.platform",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.route",
                                        "data_type": "string",
                                        "example_values": [
                                            "none"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.score",
                                        "data_type": "numeric",
                                        "example_values": [
                                            3
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.started",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509407217.208121
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.info.version",
                                        "data_type": "string",
                                        "example_values": [
                                            "2.0.3"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.metadata.output.dropped.*.basename",
                                        "data_type": "string",
                                        "example_values": [
                                            "0e478c95a7a07570_rql71b0.tmp"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.metadata.output.dropped.*.dirname",
                                        "data_type": "string",
                                        "example_values": [
                                            "files"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.metadata.output.dropped.*.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "0e478c95a7a07570a69e6061e7c1da9001bccad9cc454f2ed4da58824a13e0f4"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.metadata.output.pcap.basename",
                                        "data_type": "string",
                                        "example_values": [
                                            "dump.pcap"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.metadata.output.pcap.dirname",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.metadata.output.pcap.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "08d4daf8f1d393aa6cceff4235dc666465f49cbe3c01a9aea9f7e4c8e9be8c43"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.dns.*.answers.*.data",
                                        "data_type": "string",
                                        "example_values": [
                                            "120.210.207.151"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.dns.*.answers.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "A"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.dns.*.request",
                                        "data_type": "string",
                                        "example_values": [
                                            "zebing520.vicp.cc"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.dns.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "A"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.dns_servers",
                                        "data_type": "string",
                                        "example_values": [
                                            "8.8.8.8"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.report.network.domains.*.domain",
                                        "data_type": "string",
                                        "example_values": [
                                            "teredo.ipv6.microsoft.com"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.domains.*.ip",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.hosts",
                                        "data_type": "string",
                                        "example_values": [
                                            "72.21.91.29"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.network.pcap_sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "08d4daf8f1d393aa6cceff4235dc666465f49cbe3c01a9aea9f7e4c8e9be8c43"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.network.sorted_pcap_sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "819ac5fcbe6aa7f4d49795a5c0c47bf52feb3be3d24b47c28e79a7ecd9eba9c4"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.udp.*.dport",
                                        "data_type": "numeric",
                                        "example_values": [
                                            5355
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.udp.*.dst",
                                        "data_type": "string",
                                        "example_values": [
                                            "224.0.0.252"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.udp.*.offset",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1822
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.udp.*.sport",
                                        "data_type": "numeric",
                                        "example_values": [
                                            51966
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.report.network.udp.*.src",
                                        "data_type": "string",
                                        "example_values": [
                                            "192.168.56.11"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.network.udp.*.time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6.255922079086304
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.screenshots.*.ocr",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.screenshots.*.path",
                                        "data_type": "string",
                                        "example_values": [
                                            "/home/cuckoo/.cuckoo/storage/analyses/27/shots/0001.jpg"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.description",
                                        "data_type": "string",
                                        "example_values": [
                                            "The executable contains unknown PE section names indicative of a packer (could be a false positive)"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.families",
                                        "data_type": "string",
                                        "example_values": [
                                            "nitol"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.markcount",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.api",
                                        "data_type": "string",
                                        "example_values": [
                                            "NtAllocateVirtualMemory"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.allocation_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4096
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.base_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x004e0000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.desired_access",
                                        "data_type": "numeric",
                                        "example_values": [
                                            983551
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.display_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Abcdef Hijklmno Qrstuvwx Abcd"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.error_control",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.filepath",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\update.exe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.filepath_r",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\update.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.password",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.process_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0xffffffff"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.process_identifier",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.protection",
                                        "data_type": "numeric",
                                        "example_values": [
                                            64
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.region_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4096
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.service_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x005d1dd0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.service_manager_handle",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x005d1e70"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.service_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Abcdef Hijklmno Qrs"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.service_start_name",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.service_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            272
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.arguments.start_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "process"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.flags.allocation_type",
                                        "data_type": "string",
                                        "example_values": [
                                            "MEM_COMMIT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.flags.protection",
                                        "data_type": "string",
                                        "example_values": [
                                            "PAGE_EXECUTE_READWRITE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.return_value",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.status",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.tid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            800
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.call.time",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1509432420.843875
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "section"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.cid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            575
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.description",
                                        "data_type": "string",
                                        "example_values": [
                                            "A section with a high entropy has been found"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7.888327654005668
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.filetype",
                                        "data_type": "string",
                                        "example_values": [
                                            "data"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.ioc",
                                        "data_type": "string",
                                        "example_values": [
                                            ".tqn\\x07"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.language",
                                        "data_type": "string",
                                        "example_values": [
                                            "LANG_CHINESE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "RT_BITMAP"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.offset",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00036b80"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "pid"
                                        ],
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.pid",
                                        "data_type": "numeric",
                                        "example_values": [
                                            984
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.section.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            7.888327654005668
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.section.name",
                                        "data_type": "string",
                                        "example_values": [
                                            ".reloc"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.section.size_of_data",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00007600"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.section.virtual_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00038000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.section.virtual_size",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00007a00"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.service_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Abcdef Hijklmno Qrs"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file path",
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.service_path",
                                        "data_type": "string",
                                        "example_values": [
                                            "C:\\Windows\\update.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.size",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x000004e8"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.sublanguage",
                                        "data_type": "string",
                                        "example_values": [
                                            "SUBLANG_CHINESE_SIMPLIFIED"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.marks.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "ioc"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "pe_features"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.report.signatures.*.references",
                                        "data_type": "string",
                                        "example_values": [
                                            "http://virii.es/U/Using%20Entropy%20Analysis%20to%20Find%20Encrypted%20and%20Packed%20Malware.pdf"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.signatures.*.severity",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.imported_dll_count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_exports.*.address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x40162c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_exports.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Exetest"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_exports.*.ordinal",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.report.static.pe_imphash",
                                        "data_type": "string",
                                        "example_values": [
                                            "3134150f803531d1ecfdf79165357a25"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.static.pe_imports.*.dll",
                                        "data_type": "string",
                                        "example_values": [
                                            "KERNEL32.dll"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_imports.*.imports.*.address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x41f12c"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_imports.*.imports.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "LoadLibraryA"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.filetype",
                                        "data_type": "string",
                                        "example_values": [
                                            "data"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.language",
                                        "data_type": "string",
                                        "example_values": [
                                            "LANG_CHINESE"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "RT_BITMAP"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.offset",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00036b80"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.size",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x000004e8"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_resources.*.sublanguage",
                                        "data_type": "string",
                                        "example_values": [
                                            "SUBLANG_CHINESE_SIMPLIFIED"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_sections.*.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6.629141043894987
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_sections.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            ".text"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_sections.*.size_of_data",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00007000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_sections.*.virtual_address",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00001000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_sections.*.virtual_size",
                                        "data_type": "string",
                                        "example_values": [
                                            "0x00007000"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_timestamp",
                                        "data_type": "string",
                                        "example_values": [
                                            "2009-12-04 13:35:59"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.static.pe_versioninfo.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "LegalCopyright"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.static.pe_versioninfo.*.value",
                                        "data_type": "string",
                                        "example_values": [
                                            "Copyright(C) 2004-2015 KuGou-Inc.All Rights Reserved"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.strings",
                                        "data_type": "string",
                                        "example_values": [
                                            "Translation"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "file"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.file.crc32",
                                        "data_type": "string",
                                        "example_values": [
                                            "04D96C4B"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.report.target.file.md5",
                                        "data_type": "string",
                                        "example_values": [
                                            "6b6fa473cd53b3b1d20fb7d0d7d94dd2"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.report.target.file.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.file.path",
                                        "data_type": "string",
                                        "example_values": [
                                            "/home/cuckoo/.cuckoo/storage/binaries/e4a5f740683ce26d8312c336e1a2d50aa5b56efe61fc793ff3f9dc08af2da30d"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.report.target.file.sha1",
                                        "data_type": "string",
                                        "example_values": [
                                            "ac8682258ec2a9556c5b06dac4b70aa7f408146b"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.report.target.file.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "e4a5f740683ce26d8312c336e1a2d50aa5b56efe61fc793ff3f9dc08af2da30d"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.file.sha512",
                                        "data_type": "string",
                                        "example_values": [
                                            "59a132a04c621aad34c2130895e1c33f8a988a1d400b91ab712c4058ab6fefda698d01f395dd88f15cc8382f6826eee6550296b00981581a5b8abb10682fe9b0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.file.size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            420314
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.report.target.file.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "PE32 executable (GUI) Intel 80386, for MS Windows"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.added_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mon, 30 Oct 2017 23:46:57 GMT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "file"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.clock",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mon, 30 Oct 2017 23:46:57 GMT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.completed_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mon, 30 Oct 2017 23:49:09 GMT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.custom",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.duration",
                                        "data_type": "numeric",
                                        "example_values": [
                                            132
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.enforce_timeout",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            27
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.label",
                                        "data_type": "string",
                                        "example_values": [
                                            "cuckoo2"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.manager",
                                        "data_type": "string",
                                        "example_values": [
                                            "VirtualBox"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "cuckoo2"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.shutdown_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:49:09"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.started_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "2017-10-30 23:46:57"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "stopped"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.guest.task_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            27
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            27
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.machine",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.memory",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.owner",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.package",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.platform",
                                        "data_type": "string",
                                        "example_values": [
                                            ""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.priority",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.route",
                                        "data_type": "string",
                                        "example_values": [
                                            "none"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample.crc32",
                                        "data_type": "string",
                                        "example_values": [
                                            "04D96C4B"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample.file_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            420314
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample.file_type",
                                        "data_type": "string",
                                        "example_values": [
                                            "PE32 executable (GUI) Intel 80386, for MS Windows"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            15
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.task_status.sample.md5",
                                        "data_type": "string",
                                        "example_values": [
                                            "6b6fa473cd53b3b1d20fb7d0d7d94dd2"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.task_status.sample.sha1",
                                        "data_type": "string",
                                        "example_values": [
                                            "ac8682258ec2a9556c5b06dac4b70aa7f408146b"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.task_status.sample.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "e4a5f740683ce26d8312c336e1a2d50aa5b56efe61fc793ff3f9dc08af2da30d"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample.sha512",
                                        "data_type": "string",
                                        "example_values": [
                                            "59a132a04c621aad34c2130895e1c33f8a988a1d400b91ab712c4058ab6fefda698d01f395dd88f15cc8382f6826eee6550296b00981581a5b8abb10682fe9b0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.sample_id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            15
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.started_on",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mon, 30 Oct 2017 23:46:57 GMT"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "reported"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.task_status.target",
                                        "data_type": "string",
                                        "example_values": [
                                            "/tmp/cuckoo-tmp/tmpbKwc78/Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.task_status.timeout",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "cuckoo task id"
                                        ],
                                        "data_path": "action_result.summary.id",
                                        "data_type": "numeric",
                                        "example_values": [
                                            27
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.summary.results_url",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://10.16.6.42:8000/analysis/27/summary"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.summary.target",
                                        "data_type": "string",
                                        "example_values": [
                                            "Mh.exe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Successfully retrieved report"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "product_name": "Cuckoo",
                                "product_vendor": "Cuckoo",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "detonate file"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def detonate_file_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('detonate_file_1() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    extract_attachment_info__vault_id = json.loads(phantom.get_run_data(key='extract_attachment_info:vault_id'))\n    extract_attachment_info__attachment_file_name = json.loads(phantom.get_run_data(key='extract_attachment_info:attachment_file_name'))\n    # collect data for 'detonate_file_1' call\n\n    parameters = []\n    \n    # build parameters list for 'detonate_file_1' call\n    parameters.append({\n        'vault_id': extract_attachment_info__vault_id,\n        'file_name': extract_attachment_info__attachment_file_name,\n    })\n\n    phantom.act(action=\"detonate file\", parameters=parameters, assets=['cuckoo'], callback=detonate_file_1_callback, name=\"detonate_file_1\")\n\n    return",
                        "callback_code": "def detonate_file_1_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('detonate_file_1_callback() called')\n    \n    url_reputation(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    ip_reputation(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 126,
                        "callsback": true,
                        "color": "#654796",
                        "connected_to_start": true,
                        "connection_name": "get email",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": "0",
                        "description": "Detonate the file attachment in a sandbox to determine its behavior.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "9276fc79-85c2-4818-8ef6-71c2b27f0803",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 134,
                        "line_start": 105,
                        "message": "Configuring now",
                        "name": "detonate file",
                        "notes": "Detonate the file attachment in a sandbox to determine its behavior.",
                        "number": 1,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 340,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "detonate_file_1",
                        "required_params": {
                            "vault_id": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1008
                    },
                    {
                        "action": "get email",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "",
                            "email": "",
                            "id": "artifact:*.cef.message_id",
                            "ingest_email": "True",
                            "use_current_container": "True",
                            "vault_id": ""
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "EWS for Exchange",
                                "app_version": "1.0.100",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "container_id": "",
                                    "email": "",
                                    "id": "artifact:*.cef.message_id",
                                    "ingest_email": "True",
                                    "use_current_container": "True",
                                    "vault_id": ""
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "exchange",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "phantom container id"
                                        ],
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Email ID",
                                        "column_order": 3,
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_path": "action_result.parameter.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.ingest_email",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.parameter.use_current_container",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.vault_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Content-Type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Date",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Delivered-To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.From",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Importance",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.MIME-Version",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Mail-Filter-Gateway",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.Message-ID",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Received",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Return-Path",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Sender",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Account-Key",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-CTCH-RefID",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-From",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-ID",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-SpamDetectionEngine",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-SpamScore",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.X-Mail-Filter-Gateway-To",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mailer",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-MimeOLE",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Mozilla-Keys",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Priority",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-SOHU-Antispam-Bayes",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-SOHU-Antispam-Language",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-Spam-Status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.X-UIDL",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Body.#text",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Body.@BodyType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeCreated",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeReceived",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_DateTimeSent",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_From.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_HasAttachments",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "internet message id"
                                        ],
                                        "data_path": "action_result.data.*.t_InternetMessageId",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsAssociated",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsDeliveryReceiptRequested",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsRead",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_IsReadReceiptRequested",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@ChangeKey",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ItemId.@Id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_LastModifiedTime",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_MimeContent.#text",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_MimeContent.@CharacterSet",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ForwardItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ReplyAllToItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ResponseObjects.t_ReplyToItem",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sender.t_Mailbox.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Sensitivity",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Size",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_Subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_MailboxType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_Name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.t_ToRecipients.t_Mailbox.*.t_RoutingType",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "phantom container id"
                                        ],
                                        "data_path": "action_result.summary.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "column_name": "Create Time",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.create_time",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_path": "action_result.summary.email_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "column_name": "Sent Time",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.sent_time",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Subject",
                                        "column_order": 0,
                                        "data_path": "action_result.summary.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "product_name": "Exchange",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "get email"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def get_email_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('get_email_1() called')\n\n    # collect data for 'get_email_1' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.cef.message_id', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'get_email_1' call\n    for container_item in container_data:\n        parameters.append({\n            'id': container_item[0],\n            'email': \"\",\n            'vault_id': \"\",\n            'container_id': \"\",\n            'ingest_email': True,\n            'use_current_container': True,\n            # context (artifact id) is added to associate results with the artifact\n            'context': {'artifact_id': container_item[1]},\n        })\n\n    phantom.act(action=\"get email\", parameters=parameters, assets=['exchange'], callback=extract_attachment_info, name=\"get_email_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 507,
                        "callsback": true,
                        "color": "#654796",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "Use the IMAP message ID from the Splunk Common Information Model to fetch the whole email including headers and attachments.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "eb22e655-7394-46d4-9ff0-57884164c9f6",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 306,
                        "line_start": 281,
                        "message": "Configuring now",
                        "name": "get email",
                        "notes": "Use the IMAP message ID from the Splunk Common Information Model to fetch the whole email including headers and attachments.",
                        "number": 1,
                        "order": 10,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -140,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "get_email_1",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1012
                    },
                    {
                        "action": "url reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "url": "detonate_file_1:action_result.data.*.report.network.http.*.uri"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "url reputation",
                                "actions": [
                                    "detonate url",
                                    "detonate file",
                                    "get file",
                                    "test connectivity",
                                    "file reputation",
                                    "url reputation",
                                    "domain reputation",
                                    "ip reputation",
                                    "get report"
                                ],
                                "active": true,
                                "app_name": "VirusTotal",
                                "app_version": "1.2.52",
                                "appid": "11f676a4-f3d4-4db0-8587-f4e942c07c7c",
                                "asset_name": "virustotal",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "url": "detonate_file_1:action_result.data.*.report.network.http.*.uri"
                                },
                                "has_app": true,
                                "id": 14,
                                "loaded": false,
                                "missing": false,
                                "name": "virustotal",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.parameter.url",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.test.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.filescan_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.permalink",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.test.com/url/d0e196a0c25d35dd0a84593cbae0f38333aa58529936444ea26453eab28dfc86/analysis/1549011607/"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.positives",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "column_name": "Url",
                                        "column_order": 0,
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.resource",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.test.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.response_code",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scan_date",
                                        "data_type": "string",
                                        "example_values": [
                                            "2019-02-01 09:00:07"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "virustotal scan id"
                                        ],
                                        "data_path": "action_result.data.*.scan_id",
                                        "data_type": "string",
                                        "example_values": [
                                            "d0e196a0c25d35dd0a84593cbae0f38333aa58529936444ea26453eab28dfc86-1549011607"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.*.detected",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.*.result",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ADMINUSLabs.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ADMINUSLabs.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AegisLab WebGuard.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AegisLab WebGuard.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AlienVault.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AlienVault.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Antiy-AVL.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Antiy-AVL.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AutoShun.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.AutoShun.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Avira.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Avira.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Baidu-International.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Baidu-International.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.BitDefender.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.BitDefender.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Blueliv.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Blueliv.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.C-SIRT.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.C-SIRT.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CLEAN MX.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CLEAN MX.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Certly.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Certly.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Comodo Site Inspector.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Comodo Site Inspector.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CyRadar.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CyRadar.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CyberCrime.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.CyberCrime.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.DNS8.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.DNS8.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Dr.Web.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Dr.Web.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ESET.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ESET.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Emsisoft.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Emsisoft.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Forcepoint ThreatSeeker.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Forcepoint ThreatSeeker.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Fortinet.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Fortinet.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.FraudScore.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.FraudScore.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.FraudSense.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.FraudSense.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.G-Data.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.G-Data.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Google Safebrowsing.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Google Safebrowsing.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.K7AntiVirus.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.K7AntiVirus.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Kaspersky.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Kaspersky.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.scans.Malc0de Database.detail",
                                        "data_type": "string",
                                        "example_values": [
                                            "http://malc0de.com/database/index.php?search=www.test.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malc0de Database.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malc0de Database.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malekal.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malekal.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malware Domain Blocklist.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malware Domain Blocklist.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.scans.MalwareDomainList.detail",
                                        "data_type": "string",
                                        "example_values": [
                                            "http://www.malwaredomainlist.com/mdl.php?search=www.test.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.MalwareDomainList.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.MalwareDomainList.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.MalwarePatrol.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.MalwarePatrol.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malwarebytes hpHosts.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malwarebytes hpHosts.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malwared.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Malwared.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Netcraft.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Netcraft.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.NotMining.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.NotMining.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Nucleon.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Nucleon.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.OpenPhish.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.OpenPhish.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Opera.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Opera.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.PhishLabs.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.PhishLabs.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Phishtank.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Phishtank.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Quttera.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Quttera.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Rising.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Rising.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.SCUMWARE.org.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.SCUMWARE.org.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.SecureBrain.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.SecureBrain.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Sophos.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Sophos.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Spam404.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Spam404.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.StopBadware.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.StopBadware.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Sucuri SiteCheck.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Sucuri SiteCheck.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Tencent.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Tencent.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ThreatHive.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ThreatHive.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Trustwave.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Trustwave.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.URLQuery.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.URLQuery.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "unrated site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.VX Vault.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.VX Vault.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Virusdie External Site Scan.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Virusdie External Site Scan.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Web Security Guard.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Web Security Guard.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.scans.Yandex Safebrowsing.detail",
                                        "data_type": "string",
                                        "example_values": [
                                            "http://yandex.com/infected?l10n=en&url=https://www.test.com/"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Yandex Safebrowsing.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Yandex Safebrowsing.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZCloudsec.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZCloudsec.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZDB Zeus.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZDB Zeus.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZeroCERT.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZeroCERT.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Zerofox.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.Zerofox.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.scans.ZeusTracker.detail",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://zeustracker.abuse.ch/monitor.php?host=www.test.com"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZeusTracker.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.ZeusTracker.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.desenmascara.me.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.desenmascara.me.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.malwares.com URL checker.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.malwares.com URL checker.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.securolytics.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.securolytics.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.zvelo.detected",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.scans.zvelo.result",
                                        "data_type": "string",
                                        "example_values": [
                                            "clean site"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.total",
                                        "data_type": "numeric",
                                        "example_values": [
                                            66
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.url",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.test.com/"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.verbose_msg",
                                        "data_type": "string",
                                        "example_values": [
                                            "Scan finished, scan information embedded in this object"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.detections",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.summary.found",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "column_name": "Positives",
                                        "column_order": 2,
                                        "data_path": "action_result.summary.positives",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "column_name": "Total Scans",
                                        "column_order": 1,
                                        "data_path": "action_result.summary.total_scans",
                                        "data_type": "numeric",
                                        "example_values": [
                                            66
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Positives: 0, Total scans: 66"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_positives",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "url": {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "URL to query",
                                        "key": "url",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "VirusTotal",
                                "product_vendor": "VirusTotal",
                                "targets": "14",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "url reputation"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def url_reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('url_reputation() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'url_reputation' call\n    results_data_1 = phantom.collect2(container=container, datapath=['detonate_file_1:action_result.data.*.report.network.http.*.uri', 'detonate_file_1:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'url_reputation' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'url': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"url reputation\", parameters=parameters, assets=['virustotal'], callback=url_reputation_callback, name=\"url_reputation\", parent_action=action)\n\n    return",
                        "callback_code": "def url_reputation_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('url_reputation_callback() called')\n    \n    filter_virustotal_positives(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    defang_url(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 366,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "detonate file",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "url reputation",
                        "delay": 0,
                        "description": "Check the reputation of URLs requested by the file attachment when it executed in the sandbox.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0f31c954-63a3-4f5c-aaf6-01d9d1424010",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 374,
                        "line_start": 343,
                        "message": "Configuring now",
                        "name": "url reputation",
                        "notes": "Check the reputation of URLs requested by the file attachment when it executed in the sandbox.",
                        "number": 3,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 580,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "url_reputation",
                        "required_params": {
                            "url": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1021
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "71d42bcd-8843-4c40-9e4c-e54223e8dc37",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0f31c954-63a3-4f5c-aaf6-01d9d1424010",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "aab07423-b68a-43f2-8837-b8de7bc1db83",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 1026
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "ae8a7c80-36b4-4742-9665-cb18e1f05b11",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "aab07423-b68a-43f2-8837-b8de7bc1db83",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "84bd61d3-b11b-454f-9110-c4b09fdf0a50",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 1032
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 6
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def filter_virustotal_positives(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_virustotal_positives() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"url_reputation:action_result.data.*.positives\", \">\", 3],\n        ],\n        name=\"filter_virustotal_positives:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        format_web_search(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "url reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "filter virustotal positives",
                        "description": "Only do further processing on URLs that exceed a threshold of positive threat detections.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "bbfb98a7-a234-4a02-9d2b-498665ba162e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 466,
                        "line_start": 448,
                        "name": "filter",
                        "notes": "Only do further processing on URLs that exceed a threshold of positive threat detections.",
                        "number": 6,
                        "order": 16,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": ">",
                                        "data_type": "",
                                        "param": "url_reputation:action_result.data.*.positives",
                                        "value": "3"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 820,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "filter_virustotal_positives",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 1041
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format web search"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_web_search(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_web_search() called')\n    \n    template = \"\"\"%%\n| datamodel Web search | search Web.url=\\\"{0}\\\"\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_virustotal_positives:condition_1:url_reputation:action_result.parameter.url\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_web_search\")\n\n    run_web_search(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "url reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format web search",
                        "description": "Build a Splunk search to check for HTTP requests to the potentially malicious URLs.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "589424ab-09e1-48c9-a86d-6490b2670b59",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 487,
                        "line_start": 469,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Build a Splunk search to check for HTTP requests to the potentially malicious URLs.",
                        "number": 13,
                        "order": 17,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_virustotal_positives:condition_1:url_reputation:action_result.parameter.url"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "format_web_search",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "%%\n| datamodel Web search | search Web.url=\"{0}\"\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1044
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "defang url"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def defang_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('defang_url() called')\n    \n    results_data_1 = phantom.collect2(container=container, datapath=['url_reputation:action_result.parameter.url'], action_results=results)\n    results_item_1_0 = [item[0] for item in results_data_1]\n\n    defang_url__defanged_url = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    defang_url__defanged_url = []\n    \n    phantom.debug(\"defanging URLs:\")\n    for url in results_item_1_0:\n        defanged_url = url.replace(\"http\", \"hXXp\").replace(\".\", \"[.]\")\n        phantom.debug(\"defanged {} into {}\".format(url, defanged_url))\n        defang_url__defanged_url.append(defanged_url)\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='defang_url:defanged_url', value=json.dumps(defang_url__defanged_url))\n    format_url_reputation(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "url reputation",
                        "connection_type": "action",
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 11,
                        "custom_callback": "",
                        "custom_code": "def defang_url(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('defang_url() called')\n    results_data_1 = phantom.collect2(container=container, datapath=['url_reputation:action_result.parameter.url'], action_results=results)\n    results_item_1_0 = [item[0] for item in results_data_1]\n\n    defang_url__defanged_url = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    defang_url__defanged_url = []\n    \n    phantom.debug(\"defanging URLs:\")\n    for url in results_item_1_0:\n        defanged_url = url.replace(\"http\", \"hXXp\").replace(\".\", \"[.]\")\n        phantom.debug(\"defanged {} into {}\".format(url, defanged_url))\n        defang_url__defanged_url.append(defanged_url)\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='defang_url:defanged_url', value=json.dumps(defang_url__defanged_url))\n    format_url_reputation(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "defang url",
                        "description": "Defang the URLs by substituting hXXp fot http and [.] for . to prevent notifications from showing the actual clickable URL (which could be malicious).",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "aab07423-b68a-43f2-8837-b8de7bc1db83",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "legacy": true,
                        "line_end": 625,
                        "line_start": 596,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "Defang the URLs by substituting hXXp fot http and [.] for . to prevent notifications from showing the actual clickable URL (which could be malicious).",
                        "number": 2,
                        "order": 22,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "defanged_url"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "url_reputation:action_result.parameter.url"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "defang_url",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    defang_url__defanged_url = []\n    \n    phantom.debug(\"defanging URLs:\")\n    for url in results_item_1_0:\n        defanged_url = url.replace(\"http\", \"hXXp\").replace(\".\", \"[.]\")\n        phantom.debug(\"defanged {} into {}\".format(url, defanged_url))\n        defang_url__defanged_url.append(defanged_url)\n",
                        "warn": false,
                        "z": 1046
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format url reputation"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_url_reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_url_reputation() called')\n    \n    template = \"\"\"VirusTotal scores of URLs detected in file detonation:\n\n%%\nURL: {0}\nVirusTotal Analysis Permalink: {1}\nScore: {2}\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"defang_url:custom_function:defanged_url\",\n        \"url_reputation:action_result.data.*.permalink\",\n        \"url_reputation:action_result.message\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_url_reputation\")\n\n    join_format_analyst_message(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "url reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format url reputation",
                        "description": "Gather the key results from the URL reputation  query into a formatted text block.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "84bd61d3-b11b-454f-9110-c4b09fdf0a50",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 566,
                        "line_start": 542,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Gather the key results from the URL reputation  query into a formatted text block.",
                        "number": 14,
                        "order": 20,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "defang_url:custom_function:defanged_url"
                            },
                            {
                                "position": 0,
                                "type": "",
                                "value": "url_reputation:action_result.data.*.permalink"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "url_reputation:action_result.message"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1200,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "format_url_reputation",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "VirusTotal scores of URLs detected in file detonation:\n\n%%\nURL: {0}\nVirusTotal Analysis Permalink: {1}\nScore: {2}\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1048
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".border": {
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 4
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def prompt_response_filter(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('prompt_response_filter() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"suspicious_email_attachment_prompt:action_result.summary.responses.0\", \"==\", \"Yes\"],\n        ],\n        name=\"prompt_response_filter:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        delete_email_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n        format_recipient_email(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "suspicious_email_attachment_prompt",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "prompt_response_filter",
                        "description": "Check the response from the prompt.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "fdba437e-bc9b-4a9b-a26f-e699f34dbad9",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 46,
                        "line_start": 27,
                        "name": "filter",
                        "notes": "Check the response from the prompt.",
                        "number": 4,
                        "order": 2,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "suspicious_email_attachment_prompt:action_result.summary.responses.0",
                                        "value": "Yes"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1820,
                            "y": 640
                        },
                        "previous_function": "",
                        "previous_name": "prompt_response_filter",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 1060
                    },
                    {
                        "action": "send email",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attachments": "",
                            "body": "format_11:formatted_data",
                            "from": "phantom",
                            "subject": "Phishing Email Deleted",
                            "to": "get_email_1:action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "SMTP",
                                "app_version": "1.2.29",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "attachments": "",
                                    "bcc": "",
                                    "body": "format_recipient_email:formatted_data",
                                    "cc": "",
                                    "from": "phantom",
                                    "headers": "",
                                    "subject": "Phishing Email Deleted",
                                    "to": "get_email_1:action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "exchange_smtp",
                                "output": [
                                    {
                                        "column_name": "Status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.attachments",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.bcc",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.cc",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.headers",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "product_name": "SMTP",
                                "product_vendor": "Generic",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "send recipient email"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def send_recipient_email(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('send_recipient_email() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'send_recipient_email' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_email_1:action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress', 'get_email_1:action_result.parameter.context.artifact_id'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='format_recipient_email')\n\n    parameters = []\n    \n    # build parameters list for 'send_recipient_email' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'cc': \"\",\n                'to': results_item_1[0],\n                'bcc': \"\",\n                'body': formatted_data_1,\n                'from': \"phantom\",\n                'headers': \"\",\n                'subject': \"Phishing Email Deleted\",\n                'attachments': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"send email\", parameters=parameters, assets=['exchange_smtp'], name=\"send_recipient_email\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "#5094D4",
                        "connected_to_start": true,
                        "connection_name": "suspicious_email_attachment_prompt",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "send recipient email",
                        "delay": 0,
                        "description": "Send an email to the recipient explaining that a suspicious email was deleted.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0309ed1f-d09d-488c-91f5-87be9eb8fa07",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 188,
                        "line_start": 157,
                        "message": "Configuring now",
                        "name": "send email",
                        "notes": "Send an email to the recipient explaining that a suspicious email was deleted.",
                        "number": 4,
                        "order": 7,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 2200,
                            "y": 780
                        },
                        "previous_function": "",
                        "previous_name": "send_recipient_email",
                        "required_params": {
                            "body": true,
                            "to": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "asset",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1065
                    },
                    {
                        "action": "send email",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "attachments": "",
                            "bcc": "",
                            "body": "format_analyst_message:formatted_data",
                            "cc": "",
                            "from": "charlie@corp.contoso.com",
                            "headers": "",
                            "subject": "Splunk detected suspicious email",
                            "to": "charlie@corp.contoso.com"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "SMTP",
                                "app_version": "1.2.29",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "attachments": "",
                                    "bcc": "",
                                    "body": "format_analyst_message:formatted_data",
                                    "cc": "",
                                    "from": "charlie@corp.contoso.com",
                                    "headers": "",
                                    "subject": "Splunk detected suspicious email",
                                    "to": "charlie@corp.contoso.com"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "exchange_smtp",
                                "output": [
                                    {
                                        "column_name": "Status",
                                        "column_order": 0,
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "vault id"
                                        ],
                                        "data_path": "action_result.parameter.attachments",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.bcc",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.body",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.cc",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.from",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.headers",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.subject",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.to",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "product_name": "SMTP",
                                "product_vendor": "Generic",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "send analyst email"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def send_analyst_email(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('send_analyst_email() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'send_analyst_email' call\n    formatted_data_1 = phantom.get_format_data(name='format_analyst_message')\n\n    parameters = []\n    \n    # build parameters list for 'send_analyst_email' call\n    parameters.append({\n        'cc': \"\",\n        'to': \"charlie@corp.contoso.com\",\n        'bcc': \"\",\n        'body': formatted_data_1,\n        'from': \"charlie@corp.contoso.com\",\n        'headers': \"\",\n        'subject': \"Splunk detected suspicious email\",\n        'attachments': \"\",\n    })\n\n    phantom.act(action=\"send email\", parameters=parameters, assets=['exchange_smtp'], name=\"send_analyst_email\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "#5094D4",
                        "connected_to_start": true,
                        "connection_name": "run dns search, run web search, url reputation, ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "send analyst email",
                        "delay": 0,
                        "description": "Send an email to the analyst for this event notifying them that the playbook is running and the prompt is waiting for a response.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7d63d9fc-dc58-4dc1-8d18-c2a49b0b23ea",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 102,
                        "line_start": 76,
                        "message": "Configuring now",
                        "name": "send email",
                        "notes": "Send an email to the analyst for this event notifying them that the playbook is running and the prompt is waiting for a response.",
                        "number": 2,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1960,
                            "y": 500
                        },
                        "previous_function": "",
                        "previous_name": "send_analyst_email",
                        "required_params": {
                            "body": true,
                            "to": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1066
                    },
                    {
                        "action": "delete email",
                        "action_type": "contain",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "email": "",
                            "id": "get_email_1:action_result.parameter.id"
                        },
                        "angle": 0,
                        "app": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "",
                                "active": true,
                                "app_name": "EWS for Exchange",
                                "app_version": "1.0.100",
                                "appid": "",
                                "config_type": "asset",
                                "fields": {
                                    "email": "",
                                    "id": "get_email_1:action_result.parameter.id"
                                },
                                "has_app": true,
                                "id": "-",
                                "loaded": false,
                                "missing": false,
                                "name": "exchange",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "email"
                                        ],
                                        "data_path": "action_result.parameter.email",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message ID",
                                        "column_order": 0,
                                        "contains": [
                                            "exchange email id"
                                        ],
                                        "data_path": "action_result.parameter.id",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Status Message",
                                        "column_order": 1,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "product_name": "Exchange",
                                "product_vendor": "Microsoft",
                                "type": ""
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "delete email"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".border": {
                                "height": 88
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Contain"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_contain.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            },
                            "rect.warn-background": {
                                "fill": "#FFFFFF"
                            },
                            "text.icon": {
                                "fill": "#FFFFFF"
                            }
                        },
                        "block_code": "def delete_email_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('delete_email_1() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'delete_email_1' call\n    results_data_1 = phantom.collect2(container=container, datapath=['get_email_1:action_result.parameter.id', 'get_email_1:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'delete_email_1' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'id': results_item_1[0],\n                'email': \"\",\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"delete email\", parameters=parameters, assets=['exchange'], name=\"delete_email_1\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "#3D9959",
                        "connected_to_start": true,
                        "connection_name": "suspicious_email_attachment_prompt",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "Delete the suspicious email from the user's inbox.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "65290e12-6d86-4560-82ca-613c170cec0d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 73,
                        "line_start": 49,
                        "message": "Configuring now",
                        "name": "delete email",
                        "notes": "Delete the suspicious email from the user's inbox.",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1960,
                            "y": 640
                        },
                        "previous_function": "",
                        "previous_name": "delete_email_1",
                        "required_params": {
                            "id": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 112,
                            "width": 168
                        },
                        "state": "asset",
                        "status": "",
                        "title": "Contain",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1067
                    },
                    {
                        "action": "run query",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "display": "",
                            "query": "format_web_search:formatted_data.*"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run query",
                                "actions": [
                                    "get host events",
                                    "test connectivity",
                                    "on poll",
                                    "run query",
                                    "update event",
                                    "post data"
                                ],
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.23",
                                "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                                "asset_name": "splunk_es_209",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "command": "",
                                    "display": "",
                                    "parse_only": "",
                                    "query": "format_web_search:formatted_data.*"
                                },
                                "has_app": true,
                                "id": 7,
                                "loaded": false,
                                "missing": false,
                                "name": "splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string",
                                        "example_values": [
                                            "savedsearch"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.display",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.parse_only",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "splunk query"
                                        ],
                                        "data_path": "action_result.parameter.query",
                                        "data_type": "string",
                                        "example_values": [
                                            "\"Send to Phantom\""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*._bkt",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._cd",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._indextime",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Raw",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*._raw",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._serial",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._si",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._sourcetype",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Time",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*._time",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Host",
                                        "column_order": 0,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.host",
                                        "data_type": "string",
                                        "example_values": [
                                            "10.1.67.187:8088"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.linecount",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.sourcetype",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.splunk_server",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.total_events",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total events: 2"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "display": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Display fields (comma separated)",
                                        "key": "display",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "query": {
                                        "contains": [
                                            "splunk query"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Query to run (in Splunk search language)",
                                        "key": "query",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "targets": "7",
                                "type": "siem"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "run web search"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def run_web_search(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('run_web_search() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'run_web_search' call\n    formatted_data_1 = phantom.get_format_data(name='format_web_search__as_list')\n\n    parameters = []\n    \n    # build parameters list for 'run_web_search' call\n    for formatted_part_1 in formatted_data_1:\n        parameters.append({\n            'query': formatted_part_1,\n            'command': \"\",\n            'display': \"\",\n            'parse_only': \"\",\n        })\n\n    phantom.act(action=\"run query\", parameters=parameters, assets=['splunk'], callback=join_format_analyst_message, name=\"run_web_search\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "url reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "run web search",
                        "delay": 0,
                        "description": "Run a Splunk search to check for HTTP requests to the potentially malicious URLs.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "d1944c5a-7def-4b6a-9698-630f62b5fffb",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 513,
                        "line_start": 490,
                        "message": "Configuring now",
                        "name": "run query",
                        "notes": "Run a Splunk search to check for HTTP requests to the potentially malicious URLs.",
                        "number": 3,
                        "order": 18,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1200,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "run_web_search",
                        "required_params": {
                            "query": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1069
                    },
                    {
                        "action": "run query",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "display": "",
                            "query": "format_dns_search:formatted_data.*"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "run query",
                                "actions": [
                                    "get host events",
                                    "test connectivity",
                                    "on poll",
                                    "run query",
                                    "update event",
                                    "post data"
                                ],
                                "active": true,
                                "app_name": "Splunk",
                                "app_version": "1.3.23",
                                "appid": "91883aa8-9c81-470b-97a1-5d8f7995f560",
                                "asset_name": "splunk_es_209",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "command": "",
                                    "display": "",
                                    "parse_only": "",
                                    "query": "format_dns_search:formatted_data.*"
                                },
                                "has_app": true,
                                "id": 7,
                                "loaded": false,
                                "missing": false,
                                "name": "splunk",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.command",
                                        "data_type": "string",
                                        "example_values": [
                                            "savedsearch"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.display",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.parse_only",
                                        "data_type": "boolean",
                                        "example_values": [
                                            true,
                                            false
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "splunk query"
                                        ],
                                        "data_path": "action_result.parameter.query",
                                        "data_type": "string",
                                        "example_values": [
                                            "\"Send to Phantom\""
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*._bkt",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._cd",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._indextime",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Raw",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*._raw",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._serial",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._si",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*._sourcetype",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Time",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*._time",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Host",
                                        "column_order": 0,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.host",
                                        "data_type": "string",
                                        "example_values": [
                                            "10.1.67.187:8088"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.index",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.linecount",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.source",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.sourcetype",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.splunk_server",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.total_events",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Total events: 2"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "display": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Display fields (comma separated)",
                                        "key": "display",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "query": {
                                        "contains": [
                                            "splunk query"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Query to run (in Splunk search language)",
                                        "key": "query",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Splunk Enterprise",
                                "product_vendor": "Splunk Inc.",
                                "targets": "7",
                                "type": "siem"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "run dns search"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def run_dns_search(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('run_dns_search() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'run_dns_search' call\n    formatted_data_1 = phantom.get_format_data(name='format_dns_search__as_list')\n\n    parameters = []\n    \n    # build parameters list for 'run_dns_search' call\n    for formatted_part_1 in formatted_data_1:\n        parameters.append({\n            'query': formatted_part_1,\n            'command': \"\",\n            'display': \"\",\n            'parse_only': \"\",\n        })\n\n    phantom.act(action=\"run query\", parameters=parameters, assets=['splunk'], callback=join_format_analyst_message, name=\"run_dns_search\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "run dns search",
                        "delay": 0,
                        "description": "Run a Splunk search to check for other systems receiving DNS answers matching the suspicious IP addresses.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "2d82139a-aadc-4b96-a362-16295bae402d",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 539,
                        "line_start": 516,
                        "message": "Configuring now",
                        "name": "run query",
                        "notes": "Run a Splunk search to check for other systems receiving DNS answers matching the suspicious IP addresses.",
                        "number": 4,
                        "order": 19,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1200,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "run_dns_search",
                        "required_params": {
                            "query": true
                        },
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1075
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 5
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def filter_deepsight_behaviours(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_deepsight_behaviours() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"Malware\", \"in\", \"ip_reputation:action_result.data.*.behaviours.*.behaviour\"],\n            [\"Phish_Host\", \"in\", \"ip_reputation:action_result.data.*.behaviours.*.behaviour\"],\n        ],\n        logical_operator='or',\n        name=\"filter_deepsight_behaviours:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        format_dns_search(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n        format_behaviors(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "filter deepsight behaviours",
                        "description": "Only process the IP addresses that matched malicious categories.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ef7f4d66-4633-4e27-b999-3ab1d7b57f84",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 424,
                        "line_start": 403,
                        "name": "filter",
                        "notes": "Only process the IP addresses that matched malicious categories.",
                        "number": 5,
                        "order": 14,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "in",
                                        "data_type": "",
                                        "param": "Malware",
                                        "value": "ip_reputation:action_result.data.*.behaviours.*.behaviour"
                                    },
                                    {
                                        "comparison": "in",
                                        "data_type": "",
                                        "param": "Phish_Host",
                                        "value": "ip_reputation:action_result.data.*.behaviours.*.behaviour"
                                    }
                                ],
                                "display": "If",
                                "logic": "or",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 820,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "filter_deepsight_behaviours",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 1080
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "b68a8161-03c2-41e3-9d76-919146eb5b4c",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ef7f4d66-4633-4e27-b999-3ab1d7b57f84",
                            "port": "out-1",
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "56380d36-0651-4a8b-91e3-023188151a3b",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 1088
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a5d9b9a5-3759-4537-b0fd-80835d263d1e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "56380d36-0651-4a8b-91e3-023188151a3b",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "8de359c3-a12c-4c42-80b9-612999c4ccf4",
                            "port": null,
                            "selector": "g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 1091
                    },
                    {
                        "action": "ip reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "ip": "detonate_file_1:action_result.data.*.report.network.dns.*.answers.*.data"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "",
                        "approver": "",
                        "assets": [
                            {
                                "action": "ip reputation",
                                "actions": [
                                    "test connectivity",
                                    "on poll",
                                    "domain reputation",
                                    "file reputation",
                                    "url reputation",
                                    "ip reputation",
                                    "hunt file",
                                    "get report"
                                ],
                                "active": true,
                                "app_name": "DeepSight",
                                "app_version": "1.0.19",
                                "appid": "15eb32db-8a9f-4f57-8002-055ddbbcfa7f",
                                "asset_name": "symantec_deepsight",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "ip": "detonate_file_1:action_result.data.*.report.network.dns.*.answers.*.data"
                                },
                                "has_app": true,
                                "id": 21,
                                "loaded": false,
                                "missing": false,
                                "name": "symantec_deepsight",
                                "output": [
                                    {
                                        "data_path": "action_result.data.*.schemaVersion",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.data.*.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.whitelisted",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data.*.firstSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.lastSeen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.reputationValues.reputation",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.reputationValues.confidence",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.reputationValues.hostility",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "deepsight report id"
                                        ],
                                        "data_path": "action_result.data.*.matiReports.*.id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.matiReports.*.title",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.matiReports.*.date",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.matiReports.*.uri",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.organization.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.organization.type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.organization.naics",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.organization.isic",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.carrier",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.asn",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.lineSpeed",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.ipRouting",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.anonymizerStatus",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.proxyType",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.proxyLevel",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.network.proxyLastDetected",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.geolocation.country",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.geolocation.city",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.geolocation.latitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.geolocation.longitude",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.behaviours.*.behaviour",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.behaviours.*.type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.behaviours.*.description",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "domain"
                                        ],
                                        "data_path": "action_result.data.*.domains.*.domain",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.domains.*.uri",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.urls.*.url",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.urls.*.uri",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.targetCountries",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.targetIndustries.*.naics",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.targetIndustries.*.name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_path": "action_result.parameter.ip",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.reputation",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.confidence",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.hostility",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.whitelisted",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.summary.last_seen",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "ip": {
                                        "contains": [
                                            "ip"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "IP to query",
                                        "key": "ip",
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "DeepSight",
                                "product_vendor": "Symantec",
                                "targets": "21",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "ip reputation"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def ip_reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('ip_reputation() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'ip_reputation' call\n    results_data_1 = phantom.collect2(container=container, datapath=['detonate_file_1:action_result.data.*.report.network.dns.*.answers.*.data', 'detonate_file_1:action_result.parameter.context.artifact_id'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'ip_reputation' call\n    for results_item_1 in results_data_1:\n        if results_item_1[0]:\n            parameters.append({\n                'ip': results_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': results_item_1[1]},\n            })\n\n    phantom.act(action=\"ip reputation\", parameters=parameters, assets=['symantec_deepsight'], callback=filter_deepsight_behaviours, name=\"ip_reputation\", parent_action=action)\n\n    return",
                        "callback_code": "",
                        "callback_start": 400,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "detonate file",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "ip reputation",
                        "delay": 0,
                        "description": "Check the reputation of IP addresses contacted by the file attachment when it executed in the sandbox.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "bdb392cc-0b3e-4450-94d5-e3b5fcf13279",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 400,
                        "line_start": 377,
                        "message": "Configuring now",
                        "name": "ip reputation",
                        "notes": "Check the reputation of IP addresses contacted by the file attachment when it executed in the sandbox.",
                        "number": 3,
                        "order": 13,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 580,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "ip_reputation",
                        "required_params": {
                            "ip": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 1094
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "approver": "Administrator",
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def suspicious_email_attachment_prompt(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('suspicious_email_attachment_prompt() called')\n    \n    # set user and message variables for phantom.prompt call\n    user = \"Administrator\"\n    message = \"\"\"Please review the investigation and decide whether or not to delete the email from the user's inbox.\"\"\"\n\n    #responses:\n    response_types = [\n        {\n            \"prompt\": \"\",\n            \"options\": {\n                \"type\": \"list\",\n                \"choices\": [\n                    \"Yes\",\n                    \"No\",\n                ]\n            },\n        },\n    ]\n\n    phantom.prompt2(container=container, user=user, message=message, respond_in_mins=30, name=\"suspicious_email_attachment_prompt\", response_types=response_types, callback=prompt_response_filter)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "connected_to_start": true,
                        "connection_name": "run dns search, run web search, url reputation, ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "suspicious_email_attachment_prompt",
                        "description": "Wait for an analyst to decide whether or not to delete the email from the user's inbox.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "8d846e75-8ec7-45d6-a274-86ec3ea7db16",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 216,
                        "line_start": 191,
                        "message": "Please review the investigation and decide whether or not to delete the email from the user's inbox.",
                        "name": "prompt",
                        "notes": "Wait for an analyst to decide whether or not to delete the email from the user's inbox.",
                        "number": 1,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "parameters": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1680,
                            "y": 640
                        },
                        "previous_function": "",
                        "previous_name": "suspicious_email_attachment_prompt",
                        "respond_in": "30",
                        "response_key": "Yes/No",
                        "response_options": [
                            "Yes",
                            "No"
                        ],
                        "response_type": "list",
                        "responses": [
                            {
                                "response_key": "Yes/No",
                                "response_options": [
                                    "Yes",
                                    "No"
                                ],
                                "response_prompt": "",
                                "response_type": "list"
                            }
                        ],
                        "show_number": true,
                        "size": {
                            "height": 80,
                            "width": 80
                        },
                        "state": "prompt",
                        "status": "",
                        "type": "coa.Prompt",
                        "warn": false,
                        "z": 1099
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format recipient email"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".number": {
                                "text": 11
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_recipient_email(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_recipient_email() called')\n    \n    template = \"\"\"The security department has detected a malicious phishing email sent to this email address from {0} with the subject \\\"{1}\\\". The email has been deleted. Please contact the security department if you have any questions.\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"get_email_1:action_result.data.*.t_From.t_Mailbox.t_EmailAddress\",\n        \"get_email_1:action_result.data.*.t_Subject\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_recipient_email\")\n\n    send_recipient_email(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "suspicious_email_attachment_prompt",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format recipient email",
                        "description": "Build the body of an email to the recipient explaining that a suspicious email was deleted.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "843514b0-6482-4f91-808b-1418df0781e0",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 154,
                        "line_start": 137,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Build the body of an email to the recipient explaining that a suspicious email was deleted.",
                        "number": 11,
                        "order": 6,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "get_email_1:action_result.data.*.t_From.t_Mailbox.t_EmailAddress"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "get_email_1:action_result.data.*.t_Subject"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1960,
                            "y": 780
                        },
                        "previous_function": "",
                        "previous_name": "format_recipient_email",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "format",
                        "status": "",
                        "template": "The security department has detected a malicious phishing email sent to this email address from {0} with the subject \"{1}\". The email has been deleted. Please contact the security department if you have any questions.",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1100
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format dns search"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_dns_search(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_dns_search() called')\n    \n    template = \"\"\"%%\n| datamodel Network_Resolution search | search DNS.answer=\\\"{0}\\\"\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.parameter.ip\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_dns_search\")\n\n    run_dns_search(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format dns search",
                        "description": "Build a Splunk search to check for other systems receiving DNS answers matching the suspicious IP addresses.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "83cd6e00-fe8b-4cc9-bd64-4be8803f9426",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 445,
                        "line_start": 427,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Build a Splunk search to check for other systems receiving DNS answers matching the suspicious IP addresses.",
                        "number": 12,
                        "order": 15,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.parameter.ip"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 360
                        },
                        "previous_function": "",
                        "previous_name": "format_dns_search",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "%%\n| datamodel Network_Resolution search | search DNS.answer=\"{0}\"\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1102
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format analyst message"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "fill": "#FFFFFF",
                                "font-size": 12,
                                "font-weight": 300,
                                "opacity": 0,
                                "ref": ".background",
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".number": {
                                "text": 9
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block",
                                "opacity": 1
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_analyst_message(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_analyst_message() called')\n    \n    template = \"\"\"A Splunk correlation search discovered a suspicious email file attachment:\n\nemail sender: {0}\nemail recipient: {1}\nemail subject: {2}\n\nattachment file name: {3}\nattachment SHA1 file hash: {4}\nCuckoo summary score of detonated email attachment: {5}\n\n{6}\n\n{7}\n\nHostnames of endpoints that have communicated with suspicious URLs:\n{8}\n\nHostnames of endpoints that have communicated with suspicious IP addresses:\n{9}\n\nSee the full context and respond to the analyst prompt within Phantom:\n{10}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"get_email_1:action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress\",\n        \"get_email_1:action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress\",\n        \"get_email_1:action_result.data.*.t_Subject\",\n        \"detonate_file_1:action_result.parameter.file_name\",\n        \"detonate_file_1:action_result.parameter.vault_id\",\n        \"detonate_file_1:action_result.data.*.report.info.score\",\n        \"format_url_reputation:formatted_data\",\n        \"format_ip_reputation:formatted_data\",\n        \"run_web_search:action_result.data.*.host\",\n        \"run_dns_search:action_result.data.*.host\",\n        \"container:url\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_analyst_message\")\n\n    send_analyst_email(container=container)\n    suspicious_email_attachment_prompt(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "run dns search, run web search, url reputation, ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format analyst message",
                        "description": "Gather all the key pieces of information collected so far and format them for an email to the analyst.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "2fcc899e-9e0c-423f-9863-175475adda49",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_format_analyst_message(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_format_analyst_message() called')\n\n    # check if all connected incoming playbooks, actions, or custom functions are done i.e. have succeeded or failed\n    if phantom.completed(action_names=['run_dns_search', 'run_web_search', 'url_reputation', 'ip_reputation']):\n        \n        # call connected block \"format_analyst_message\"\n        format_analyst_message(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 267,
                        "line_end": 278,
                        "line_start": 219,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Gather all the key pieces of information collected so far and format them for an email to the analyst.",
                        "number": 9,
                        "order": 9,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "get_email_1:action_result.data.*.t_Sender.t_Mailbox.t_EmailAddress"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "get_email_1:action_result.data.*.t_ToRecipients.t_Mailbox.*.t_EmailAddress"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "get_email_1:action_result.data.*.t_Subject"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "detonate_file_1:action_result.parameter.file_name"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "detonate_file_1:action_result.parameter.vault_id"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "detonate_file_1:action_result.data.*.report.info.score"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "format_url_reputation:formatted_data"
                            },
                            {
                                "position": 5,
                                "type": "",
                                "value": "format_ip_reputation:formatted_data"
                            },
                            {
                                "position": 6,
                                "type": "",
                                "value": "run_web_search:action_result.data.*.host"
                            },
                            {
                                "position": 9,
                                "type": "",
                                "value": "run_dns_search:action_result.data.*.host"
                            },
                            {
                                "position": 10,
                                "type": "",
                                "value": "container:url"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1440,
                            "y": 500
                        },
                        "previous_function": "",
                        "previous_name": "format_analyst_message",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "format",
                        "status": "",
                        "template": "A Splunk correlation search discovered a suspicious email file attachment:\n\nemail sender: {0}\nemail recipient: {1}\nemail subject: {2}\n\nattachment file name: {3}\nattachment SHA1 file hash: {4}\nCuckoo summary score of detonated email attachment: {5}\n\n{6}\n\n{7}\n\nHostnames of endpoints that have communicated with suspicious URLs:\n{8}\n\nHostnames of endpoints that have communicated with suspicious IP addresses:\n{9}\n\nSee the full context and respond to the analyst prompt within Phantom:\n{10}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1115
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format ip reputation"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_ip_reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_ip_reputation() called')\n    \n    template = \"\"\"Symantec DeepSight analysis of IP addresses detected in file detonation:\n\n%%\nIP: {0}\nBehaviors:\n{1}\n\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.data.*.ip\",\n        \"format_behaviors:custom_function:behaviors\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_ip_reputation\")\n\n    join_format_analyst_message(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "ip reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "format ip reputation",
                        "description": "Gather together the key fields from the results of the IP reputation query for any suspicious IP addresses.",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "8de359c3-a12c-4c42-80b9-612999c4ccf4",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 593,
                        "line_start": 569,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Gather together the key fields from the results of the IP reputation query for any suspicious IP addresses.",
                        "number": 15,
                        "order": 21,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.data.*.ip"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "format_behaviors:custom_function:behaviors"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1200,
                            "y": 500
                        },
                        "previous_function": "",
                        "previous_name": "format_ip_reputation",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "Symantec DeepSight analysis of IP addresses detected in file detonation:\n\n%%\nIP: {0}\nBehaviors:\n{1}\n\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 1124
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "format behaviors"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def format_behaviors(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_behaviors() called')\n    \n    filtered_results_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.data.*.behaviours'])\n    filtered_results_item_1_0 = [item[0] for item in filtered_results_data_1]\n\n    format_behaviors__behaviors = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    format_behaviors__behaviors = []\n    for ip in filtered_results_item_1_0:\n        behavior = \"\"\n        lines = json.dumps(ip, indent=4).split('\\n')\n        for line in lines:\n            # only use the lines with keys and values, not the json {} and [] characters\n            if 1 not in [c in line for c in '{}[]']:\n                behavior += line + '\\n'\n        format_behaviors__behaviors.append(behavior)\n    \n    phantom.debug('Symantec Deepsight behaviors:')\n    phantom.debug(format_behaviors__behaviors)\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='format_behaviors:behaviors', value=json.dumps(format_behaviors__behaviors))\n    format_ip_reputation(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "ip reputation",
                        "connection_type": "action",
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 11,
                        "custom_callback": "",
                        "custom_code": "def format_behaviors(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None):\n    phantom.debug('format_behaviors() called')\n    filtered_results_data_1 = phantom.collect2(container=container, datapath=[\"filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.data.*.behaviours\"])\n    filtered_results_item_1_0 = [item[0] for item in filtered_results_data_1]\n\n    format_behaviors__behaviors = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    format_behaviors__behaviors = []\n    for ip in filtered_results_item_1_0:\n        behavior = \"\"\n        lines = json.dumps(ip, indent=4).split('\\n')\n        for line in lines:\n            # only use the lines with keys and values, not the json {} and [] characters\n            if 1 not in [c in line for c in '{}[]']:\n                behavior += line + '\\n'\n        format_behaviors__behaviors.append(behavior)\n    \n    phantom.debug('Symantec Deepsight behaviors:')\n    phantom.debug(format_behaviors__behaviors)\n    \n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='format_behaviors:behaviors', value=json.dumps(format_behaviors__behaviors))\n    format_ip_reputation(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "format behaviors",
                        "description": "Collect and format the behavioral information from Deepsight relating to the queried IP addresses.",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "56380d36-0651-4a8b-91e3-023188151a3b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "legacy": true,
                        "line_end": 662,
                        "line_start": 628,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "Collect and format the behavioral information from Deepsight relating to the queried IP addresses.",
                        "number": 3,
                        "order": 23,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "behaviors"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 1,
                                "type": "",
                                "value": "filtered-data:filter_deepsight_behaviours:condition_1:ip_reputation:action_result.data.*.behaviours"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 500
                        },
                        "previous_function": "",
                        "previous_name": "format_behaviors",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    format_behaviors__behaviors = []\n    for ip in filtered_results_item_1_0:\n        behavior = \"\"\n        lines = json.dumps(ip, indent=4).split('\\n')\n        for line in lines:\n            # only use the lines with keys and values, not the json {} and [] characters\n            if 1 not in [c in line for c in '{}[]']:\n                behavior += line + '\\n'\n        format_behaviors__behaviors.append(behavior)\n    \n    phantom.debug('Symantec Deepsight behaviors:')\n    phantom.debug(format_behaviors__behaviors)\n    \n",
                        "warn": false,
                        "z": 1126
                    }
                ]
            },
            "notes": "This playbook uses the following Apps:\n - Microsoft Exchange (get email, delete email) [asset name = exchange] - read and delete emails from an on-premise Exchange server\n - SMTP (send email) [asset name = exchange_smtp] - send emails through the on-premise Exchange server\n - Cuckoo (detonate file) [asset name = cuckoo] - send the file to Cuckoo to execute, monitor behavior, and return a report\n - Virsutotal (url reputation) [asset name = virustotal] - check the url against all of VirusTotal's integrated scanners\n - Symantec Deepsight (ip reputation) [ asset name = opendns_investigate] - check the ip against the Symantec Deepsight threat intelligence service\n - Splunk ES (run query) [asset name = splunk] - look for internal hosts communicating with the suspicious URLs and IP addresses\n\nDeployment Notes:\n - By default the prompt is assigned to the Administrator role, which should be changed to the appropriate analyst user or role\n\n- The block called \"format recipient email\" uses the term \"the security department\", which should be substituted for something more specific to your organization\n\n- The Splunk searches rely on the Web and Network Resolution datamodels to be populated with events"
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.0.40961"
    },
    "create_time": "2021-01-26T17:16:42.146202+00:00",
    "draft_mode": false,
    "labels": [
        "events"
    ],
    "tags": [],
    "misc": {
        "apps_list": [
            "Exchange",
            "SMTP",
            "Cuckoo",
            "Splunk",
            "VirusTotal",
            "DeepSight"
        ]
    }
}