{
  "definitionVersion" : "1.0.0",
  "name" : "Palo Alto Wildfire Malware Triage (File)",
  "panX" : 263.0,
  "panY" : 20.0,
  "logLevel" : "WARN",
  "description" : "This Playbook template lets users detonate a file in Palo Alto Wildfire from ThreatConnect. If the file is malicious an incident is created in ThreatConnect and the any relevant indicators are saved and associated to the Incident. Additionally, it downloads and associates the PDF version of the report as a Document.",
  "jobList" : [ {
    "id" : 13393,
    "appCatalogItem" : {
      "programName" : "TCPB - DocumentDownload v1.0",
      "displayName" : "Get ThreatConnect Document",
      "programVersion" : "1.0.16"
    },
    "name" : "Get Document File",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Document"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_id"
      },
      "value" : "#Trigger:1245:trg.action.entity!TCEntity"
    } ],
    "locationLeft" : -740.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"tc.document.entity\",\"type\":\"Binary\"},{\"name\":\"tc.document.archive_password\",\"type\":\"String\"},{\"name\":\"tc.document.filename\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false,
    "playbookRetryDelayMinutes" : 5,
    "playbookRetryMaxRetries" : 12
  }, {
    "id" : 13394,
    "appCatalogItem" : {
      "programName" : "TCPB - WildfireDetonateFile v1.0",
      "displayName" : "Detonate File with Wildfire",
      "programVersion" : "1.0.5"
    },
    "name" : "Detonate File with Wildfire",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "file_name"
      },
      "value" : "#App:13393:tc.document.filename!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "wildfire_api_key"
      },
      "value" : "${ORGANIZATION:KEYCHAIN:Wildfire API Key}"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "file_content"
      },
      "value" : "#App:13393:tc.document.entity!Binary"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "zip_password"
      },
      "value" : "#App:13393:tc.document.archive_password!String"
    } ],
    "locationLeft" : -510.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"wildfire.file.md5\",\"type\":\"String\"},{\"name\":\"wildfire.file.filename\",\"type\":\"String\"},{\"name\":\"wildfire.file.sha256\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13395,
    "appCatalogItem" : {
      "programName" : "TCPB - WildfireGetVerdict v1.0",
      "displayName" : "Get Wildfire Verdict",
      "programVersion" : "1.0.5"
    },
    "name" : "Get Wildfire Verdict",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "wildfire_api_key"
      },
      "value" : "${ORGANIZATION:KEYCHAIN:Wildfire API Key}"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "hash"
      },
      "value" : "#App:13394:wildfire.file.md5!String"
    } ],
    "locationLeft" : -280.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"wildfire.verdict.verdict\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : true,
    "playbookRetryDelayMinutes" : 1,
    "playbookRetryMaxRetries" : 10
  }, {
    "id" : 13396,
    "appCatalogItem" : {
      "programName" : "If / Else",
      "displayName" : "If / Else",
      "programVersion" : "1.0.0"
    },
    "name" : "If malicious",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "operator"
      },
      "value" : "equals"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_numeric"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "operand_2"
      },
      "value" : "1"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "operand_1"
      },
      "value" : "#App:13395:wildfire.verdict.verdict!String"
    } ],
    "locationLeft" : -30.0,
    "locationTop" : 660.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13397,
    "appCatalogItem" : {
      "programName" : "TCPB - TagCreate v1.0",
      "displayName" : "Create ThreatConnect Tag",
      "programVersion" : "1.0.7"
    },
    "name" : "Create TC Tag (Wildfire Benign)",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "tag"
      },
      "value" : "Wildfire Benign"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "entity"
      },
      "value" : "#Trigger:1245:trg.action.entity!TCEntity"
    } ],
    "locationLeft" : 120.0,
    "locationTop" : 440.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13398,
    "appCatalogItem" : {
      "programName" : "TCPB - TagCreate v1.0",
      "displayName" : "Create ThreatConnect Tag",
      "programVersion" : "1.0.7"
    },
    "name" : "Create TC Tag (Wildfire Malicious)",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "tag"
      },
      "value" : "Wildfire Malicious"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "entity"
      },
      "value" : "#Trigger:1245:trg.action.entity!TCEntity"
    } ],
    "locationLeft" : 120.0,
    "locationTop" : 530.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13399,
    "appCatalogItem" : {
      "programName" : "TCPB - WildfireGetReport v1.0",
      "displayName" : "Get Wildfire Report",
      "programVersion" : "1.0.5"
    },
    "name" : "Get Wildfire Report",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "wildfire_api_key"
      },
      "value" : "${ORGANIZATION:KEYCHAIN:Wildfire API Key}"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "hash"
      },
      "value" : "#App:13394:wildfire.file.md5!String"
    } ],
    "locationLeft" : 150.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"wildfire.report.registry.reg_key\",\"type\":\"StringArray\"},{\"name\":\"wildfire.report.dns.queries\",\"type\":\"StringArray\"},{\"name\":\"wildfire.report.tcp.ips\",\"type\":\"StringArray\"},{\"name\":\"wildfire.report.sha256\",\"type\":\"String\"},{\"name\":\"wildfire.report.summary_details\",\"type\":\"StringArray\"},{\"name\":\"wildfire.report.md5\",\"type\":\"String\"},{\"name\":\"wildfire.report.urls\",\"type\":\"StringArray\"},{\"name\":\"wildfire.report.url.user_agents\",\"type\":\"StringArray\"}]",
    "playbookRetryEnabled" : true,
    "playbookRetryDelayMinutes" : 1,
    "playbookRetryMaxRetries" : 2
  }, {
    "id" : 13400,
    "appCatalogItem" : {
      "programName" : "Add Attribute",
      "displayName" : "Create ThreatConnect Attribute",
      "programVersion" : "1.0.0"
    },
    "name" : "Create TC Behaviors Attribute",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "indicator_name"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attribute_content"
      },
      "value" : "*Malware Behaviors:*\n\n#App:13423:j.summary_details!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "update"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attribute_type"
      },
      "value" : "Additional Analysis and Context"
    } ],
    "locationLeft" : 870.0,
    "locationTop" : 440.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13401,
    "appCatalogItem" : {
      "programName" : "Join Array",
      "displayName" : "Join Array",
      "programVersion" : "1.0.0"
    },
    "name" : "Join Array reg_key",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "join_on"
      },
      "value" : ","
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_array"
      },
      "value" : "#App:13399:wildfire.report.registry.reg_key!StringArray"
    } ],
    "locationLeft" : 840.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"join_array.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13402,
    "appCatalogItem" : {
      "programName" : "Split String",
      "displayName" : "Split String",
      "programVersion" : "1.0.0"
    },
    "name" : "Split String reg_key",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "split_on"
      },
      "value" : ","
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_content"
      },
      "value" : "#App:13403:set_variable.output!String"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 1040.0,
    "outputVariables" : "[{\"name\":\"split_string.output\",\"type\":\"StringArray\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13403,
    "appCatalogItem" : {
      "programName" : "Set Variable",
      "displayName" : "Set Variable",
      "programVersion" : "1.0.0"
    },
    "name" : "Append ::REG_NONE",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "value"
      },
      "value" : "#App:13410:find_replace.output!String::REG_NONE"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 920.0,
    "outputVariables" : "[{\"name\":\"set_variable.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13404,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKU",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKU"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13409:find_replace.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_USERS"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 680.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13405,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKLM",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13408:find_replace.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_LOCAL_MACHINE"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKLM"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 440.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13406,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKCC",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKCC"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_CURRENT_CONFIG"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13407:find_replace.output!String"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 200.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13407,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKCR",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13401:join_array.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_CLASSES_ROOT"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKCR"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 80.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13408,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKCU",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_CURRENT_USER"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13406:find_replace.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKCU"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 320.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13409,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace HKPD",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13405:find_replace.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "HKEY_PERFORMANCE_DATA"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : "HKPD"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 560.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13410,
    "appCatalogItem" : {
      "programName" : "Find / Replace",
      "displayName" : "Find and Replace",
      "programVersion" : "1.0.0"
    },
    "name" : "Find Replace ::REG_NONE,",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "find_regex"
      },
      "value" : ","
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "as_regex"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "input_text"
      },
      "value" : "#App:13404:find_replace.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "replace_regex"
      },
      "value" : "::REG_NONE,"
    } ],
    "locationLeft" : 1230.0,
    "locationTop" : 800.0,
    "outputVariables" : "[{\"name\":\"find_replace.output\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13411,
    "appCatalogItem" : {
      "programName" : "Merge",
      "displayName" : "Merge",
      "programVersion" : "1.0.0"
    },
    "name" : "Merge Verdict",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "output_array"
      },
      "value" : "[{\"key\":\"m.verdict\",\"value\":\"#App:13422:verdict.benign!String\"},{\"key\":\"m.verdict\",\"value\":\"#App:13421:verdict.malicious!String\"}]"
    } ],
    "locationLeft" : 540.0,
    "locationTop" : 280.0,
    "outputVariables" : "[{\"name\":\"m.verdict\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13412,
    "appCatalogItem" : {
      "programName" : "If / Else",
      "displayName" : "If / Else",
      "programVersion" : "1.0.0"
    },
    "name" : "If NOT NULL",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "as_numeric"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "operand_2"
      },
      "value" : ","
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "operand_1"
      },
      "value" : "#App:13401:join_array.output!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "match_case"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "operator"
      },
      "value" : "contains"
    } ],
    "locationLeft" : 1070.0,
    "locationTop" : 650.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13413,
    "appCatalogItem" : {
      "programName" : "TCPB - FileCreate v1.1",
      "displayName" : "Create ThreatConnect File",
      "programVersion" : "1.1.16"
    },
    "name" : "Create TC File Indicator",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "sha1"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "File"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "sha256"
      },
      "value" : "#App:13394:wildfire.file.sha256!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "file_size"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "occurrence_path"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "occurrence_date"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "occurrence_name"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "#App:13399:wildfire.report.md5!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 540.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13414,
    "appCatalogItem" : {
      "programName" : "Set Variable",
      "displayName" : "Set Variable",
      "programVersion" : "1.0.0"
    },
    "name" : "Set False",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "value"
      },
      "value" : "False"
    } ],
    "locationLeft" : 1000.0,
    "locationTop" : 800.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13415,
    "appCatalogItem" : {
      "programName" : "TCPB - AddressCreate v1.1",
      "displayName" : "Create ThreatConnect Address",
      "programVersion" : "1.1.16"
    },
    "name" : "Create TC Address Indicators",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Address"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "#App:13399:wildfire.report.tcp.ips!StringArray"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 760.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13416,
    "appCatalogItem" : {
      "programName" : "TCPB - HostCreate v1.1",
      "displayName" : "Create ThreatConnect Host",
      "programVersion" : "1.1.16"
    },
    "name" : "Create TC Host Indicators",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Host"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "dns_active"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      },
      "value" : ""
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "#App:13399:wildfire.report.dns.queries!StringArray"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "whois_active"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 860.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13417,
    "appCatalogItem" : {
      "programName" : "TCPB - UrlCreate v1.1",
      "displayName" : "Create ThreatConnect URL",
      "programVersion" : "1.1.16"
    },
    "name" : "Create TC URLs",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "#App:13399:wildfire.report.urls!StringArray"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "URL"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 960.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13418,
    "appCatalogItem" : {
      "programName" : "TCPB - UserAgentCreate v1.1",
      "displayName" : "Create ThreatConnect User Agent",
      "programVersion" : "1.1.16"
    },
    "name" : "Create TC User Agent Indicators",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "User Agent"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "#App:13399:wildfire.report.url.user_agents!StringArray"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 1060.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13419,
    "appCatalogItem" : {
      "programName" : "TCPB - HTTP Client v2.0",
      "displayName" : "HTTP Client",
      "programVersion" : "2.0.2"
    },
    "name" : "Get Wildfire Report PDF",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "url"
      },
      "value" : "https://wildfire.paloaltonetworks.com/publicapi/get/report/"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "verify_ssl"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "params"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "proxies_enabled"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "advanced"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "multipart"
      },
      "value" : "[{\"key\":\"apikey\",\"value\":\"${ORGANIZATION:KEYCHAIN:Wildfire API Key}\"},{\"key\":\"hash\",\"value\":\"#App:13399:wildfire.report.sha256!String\"},{\"key\":\"format\",\"value\":\"pdf\"}]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "http_method"
      },
      "value" : "POST"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "headers"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "body"
      }
    } ],
    "locationLeft" : 890.0,
    "locationTop" : 1200.0,
    "outputVariables" : "[{\"name\":\"http.content\",\"type\":\"Binary\"}]",
    "playbookRetryEnabled" : false,
    "playbookRetryDelayMinutes" : 1,
    "playbookRetryMaxRetries" : 5
  }, {
    "id" : 13420,
    "appCatalogItem" : {
      "programName" : "TCPB - IncidentCreate v1.0",
      "displayName" : "Create ThreatConnect Incident",
      "programVersion" : "1.0.16"
    },
    "name" : "Create TC Incident",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "Wildfire File Report: #App:13394:wildfire.file.filename!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#Trigger:1245:trg.action.entity!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "incident_event_date"
      },
      "value" : "#Global:0:gbl.timestamp.iso!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Incident"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "true"
    } ],
    "locationLeft" : 380.0,
    "locationTop" : 670.0,
    "outputVariables" : "[{\"name\":\"tc.incident\",\"type\":\"TCEntity\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13421,
    "appCatalogItem" : {
      "programName" : "TCPB - SetVariable v1.0",
      "displayName" : "Set Variable",
      "programVersion" : "1.0.5"
    },
    "name" : "Set Malicious Verdict",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "variable_mapping"
      },
      "value" : "[{\"key\":\"verdict.malicious\",\"value\":\"Wildfire Verdict \\u003d Malicious\"}]"
    } ],
    "locationLeft" : 320.0,
    "locationTop" : 530.0,
    "outputVariables" : "[{\"name\":\"verdict.malicious\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13422,
    "appCatalogItem" : {
      "programName" : "TCPB - SetVariable v1.0",
      "displayName" : "Set Variable",
      "programVersion" : "1.0.5"
    },
    "name" : "Set Benign Verdict",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "variable_mapping"
      },
      "value" : "[{\"key\":\"verdict.benign\",\"value\":\"Wildfire Verdict \\u003d Benign\"}]"
    } ],
    "locationLeft" : 320.0,
    "locationTop" : 440.0,
    "outputVariables" : "[{\"name\":\"verdict.benign\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13423,
    "appCatalogItem" : {
      "programName" : "TCPB - JoinArray v1.0",
      "displayName" : "Join Array",
      "programVersion" : "1.0.5"
    },
    "name" : "Join summary_details Array",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "array_mapping"
      },
      "value" : "[{\"key\":\"j.summary_details\",\"value\":\"#App:13399:wildfire.report.summary_details!StringArray\"}]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "delimiter"
      },
      "value" : ","
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 440.0,
    "outputVariables" : "[{\"name\":\"j.summary_details\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13424,
    "appCatalogItem" : {
      "programName" : "TCPB - IndicatorCreate v1.1",
      "displayName" : "Create ThreatConnect Indicator",
      "programVersion" : "1.1.17"
    },
    "name" : "Create TC Reg Key Indicators",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "batch_halt_on_error"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "additional_fields"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "use_batch"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "rating"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "confidence"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Registry Key"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_values"
      },
      "value" : "#App:13402:split_string.output!StringArray"
    } ],
    "locationLeft" : 1520.0,
    "locationTop" : 680.0,
    "playbookRetryEnabled" : false
  }, {
    "id" : 13425,
    "appCatalogItem" : {
      "programName" : "TCPB - SetVariable v1.0",
      "displayName" : "Set Variable",
      "programVersion" : "1.0.5"
    },
    "name" : "Set Report fileName",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "variable_mapping"
      },
      "value" : "[{\"key\":\"report.filename\",\"value\":\"#App:13394:wildfire.file.md5!String.pdf\"}]"
    } ],
    "locationLeft" : 660.0,
    "locationTop" : 1200.0,
    "outputVariables" : "[{\"name\":\"report.filename\",\"type\":\"String\"}]",
    "playbookRetryEnabled" : false
  }, {
    "id" : 13426,
    "appCatalogItem" : {
      "programName" : "TCPB - DocumentCreate v1.0",
      "displayName" : "Create ThreatConnect Document",
      "programVersion" : "1.0.16"
    },
    "name" : "Save Report as TC Document",
    "jobParameterList" : [ {
      "appCatalogItemParameter" : {
        "paramName" : "resource_name"
      },
      "value" : "Wildfire PDF Report [#App:13399:wildfire.report.md5!String]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "fail_on_error"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags"
      }
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "attributes"
      },
      "value" : "[]"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "tags_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "owner"
      },
      "value" : "Playground A"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "vault_pw"
      },
      "value" : ""
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels_all"
      },
      "value" : "true"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "add_to_malware"
      },
      "value" : "false"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_data"
      },
      "value" : "#App:13419:http.content!Binary"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "resource_type"
      },
      "value" : "Document"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "document_file_name"
      },
      "value" : "#App:13425:report.filename!String"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "associations"
      },
      "value" : "#App:13420:tc.incident!TCEntity"
    }, {
      "appCatalogItemParameter" : {
        "paramName" : "labels"
      }
    } ],
    "locationLeft" : 1120.0,
    "locationTop" : 1200.0,
    "playbookRetryEnabled" : false
  } ],
  "playbookConnectionList" : [ {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13393,
    "targetJobId" : 13394
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13394,
    "targetJobId" : 13395
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13395,
    "targetJobId" : 13396
  }, {
    "type" : "Fail",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13396,
    "targetJobId" : 13397
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13396,
    "targetJobId" : 13398
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13396,
    "targetJobId" : 13399
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13407,
    "targetJobId" : 13406
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13406,
    "targetJobId" : 13408
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13408,
    "targetJobId" : 13405
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13405,
    "targetJobId" : 13409
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13409,
    "targetJobId" : 13404
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13404,
    "targetJobId" : 13410
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13410,
    "targetJobId" : 13403
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13403,
    "targetJobId" : 13402
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "targetJobId" : 13393,
    "sourceTriggerId" : 1245
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : true,
    "sourceJobId" : 13411,
    "targetTriggerId" : 1245
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13401,
    "targetJobId" : 13412
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13412,
    "targetJobId" : 13407
  }, {
    "type" : "Fail",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13412,
    "targetJobId" : 13414
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13399,
    "targetJobId" : 13420
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13413
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13401
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13415
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13416
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13417
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13418
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13397,
    "targetJobId" : 13422
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13398,
    "targetJobId" : 13421
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13422,
    "targetJobId" : 13411
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13421,
    "targetJobId" : 13411
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13423
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13423,
    "targetJobId" : 13400
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13402,
    "targetJobId" : 13424
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13420,
    "targetJobId" : 13425
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13425,
    "targetJobId" : 13419
  }, {
    "type" : "Pass",
    "isCircularOnTarget" : false,
    "sourceJobId" : 13419,
    "targetJobId" : 13426
  } ],
  "playbookTriggerList" : [ {
    "id" : 1245,
    "name" : "Detonate with Wildfire",
    "type" : "UserAction",
    "eventType" : "External",
    "locationLeft" : -470.0,
    "locationTop" : 400.0,
    "httpBasicAuthEnable" : false,
    "httpResponseHeader" : "[]",
    "httpResponseBody" : "#App:13411:m.verdict!String",
    "anyOrg" : true,
    "orFilters" : false,
    "fireOnDuplicate" : false,
    "userActionTypes" : "Document",
    "renderBodyAsTip" : true,
    "outputVariables" : "[{\"name\":\"trg.action.entity\",\"type\":\"TCEntity\"}]"
  } ],
  "dateExported" : "2/23/18 8:55 PM"
}