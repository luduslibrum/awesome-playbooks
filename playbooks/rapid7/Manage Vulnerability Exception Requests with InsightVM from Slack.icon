{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:55:52.818970218Z",
    "workflowVersions": [
      {
        "name": "Manage Vulnerability Exception Requests with InsightVM from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nPush new vulnerability exception requests to Slack for expedited decision-making and response. Vulnerability risk data, exclusion submitter comments, expiration dates, and more details are included in the Slack message to provide contextual details to the reviewer without the need to log into the InsightVM Console.\n\n# Key Features\n\n* Receive Slack messages immediately upon a user submitting a new vulnerability exception\n* Review vulnerability exception details in a well-formatted Slack message\n* Decide to approve or reject the exception request from Slack\n\n# Requirements\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* InsightVM or Nexpose\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nAfter import, edit the workflow parameters. Edit the `Channel` parameter and add the Slack channel of your choice. The workflow will post new vulnerability exception requests to this channel. Also adjust the `Threshold` parameter to indicate the maximum CVSS score for which vulnerability exception requests will be automatically approved. By default, this workflow will automatically approve vulnerability exception requests for vulnerabilities with a CVSS risk score equal to 0. To ensure no exception requests are approved automatically, set this value to a negative number (eg, -1). \n\nOnce your environmental settings have been applied, activate the workflow. It will trigger upon newly submitted vulnerability exception requests.\n\nNOTE: This workflow will NOT trigger on *re*submitted exception requests at this time. Please rely on conventional methods, such as talking to each other, to manage resubmissions.\n\n## Usage\n\nThis workflow will trigger automatically on new vulnerability exception requests in the InsightVM Console.\n\n## Technical Details\n\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 InsightVM|4.9.0|11|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.1.0 - Added workflow parameters, removed uncessary steps, updated plugins\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Slack](https://slack.com/)\n",
        "graph": {
          "edges": {
            "086a0695-111c-4e43-86dc-1aafc44e6e63": {
              "id": "086a0695-111c-4e43-86dc-1aafc44e6e63",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6edda294-c793-4dcf-a6cb-66078fbc48a5",
              "toNodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75"
            },
            "118527c1-c4a9-4e20-829c-d2134f90b1fb": {
              "id": "118527c1-c4a9-4e20-829c-d2134f90b1fb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "33221742-8e7f-45be-9f09-20ce95ecb95b",
              "toNodeId": "a275708d-92f1-46bc-be6c-a26eda99b55d"
            },
            "150cb16c-f52b-4261-9920-9dbe7d67de52": {
              "id": "150cb16c-f52b-4261-9920-9dbe7d67de52",
              "name": "global",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ed59d774-63fd-435e-a798-0d243b52b7de",
              "toNodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75"
            },
            "32715fc1-6f5f-49fc-8c9f-7f86b69fe977": {
              "id": "32715fc1-6f5f-49fc-8c9f-7f86b69fe977",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a275708d-92f1-46bc-be6c-a26eda99b55d",
              "toNodeId": ""
            },
            "3bb53358-5db4-4d85-8117-768f6b5508ef": {
              "id": "3bb53358-5db4-4d85-8117-768f6b5508ef",
              "name": "Remove the Exception",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d37420b4-9da9-4d6b-8573-0db3a5ffae52",
              "toNodeId": "8dbcbd9c-e405-433b-896b-17932abaf56b"
            },
            "3cce55cf-3885-4e89-891f-544fd26f67e7": {
              "id": "3cce55cf-3885-4e89-891f-544fd26f67e7",
              "name": "site",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ed59d774-63fd-435e-a798-0d243b52b7de",
              "toNodeId": "dd2028ee-9a6c-46bd-9ba6-ec4c18169092"
            },
            "3d078183-a910-4dd1-8e63-db3334e4e5c8": {
              "id": "3d078183-a910-4dd1-8e63-db3334e4e5c8",
              "name": "Reject",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6",
              "toNodeId": "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9"
            },
            "47c18568-40fd-435e-9fed-f7e060758e1f": {
              "id": "47c18568-40fd-435e-9fed-f7e060758e1f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7b2484c0-8139-4e39-afa8-4639c42a434a",
              "toNodeId": "62a9d330-13e0-469a-a489-4622b7251c75"
            },
            "52775207-6cdc-493d-8d56-10451ce405c0": {
              "id": "52775207-6cdc-493d-8d56-10451ce405c0",
              "name": "asset or instance",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ed59d774-63fd-435e-a798-0d243b52b7de",
              "toNodeId": "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1"
            },
            "5b4832a1-cf12-43c9-9c3b-1743039718c2": {
              "id": "5b4832a1-cf12-43c9-9c3b-1743039718c2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "62a9d330-13e0-469a-a489-4622b7251c75",
              "toNodeId": "38c59f04-439f-44ba-a8f9-b18a6ab100a2"
            },
            "5bc33516-b519-409b-9866-e0275890df03": {
              "id": "5bc33516-b519-409b-9866-e0275890df03",
              "name": "No Answer",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6",
              "toNodeId": ""
            },
            "6f8ebf7c-bf36-4681-b3c1-a3f3f4c5c2df": {
              "id": "6f8ebf7c-bf36-4681-b3c1-a3f3f4c5c2df",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8dbcbd9c-e405-433b-896b-17932abaf56b",
              "toNodeId": ""
            },
            "71a1c309-edd5-4432-b091-5e55542776d5": {
              "id": "71a1c309-edd5-4432-b091-5e55542776d5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1",
              "toNodeId": "6edda294-c793-4dcf-a6cb-66078fbc48a5"
            },
            "7e664927-20c3-4f10-af3b-b134bbe10dda": {
              "id": "7e664927-20c3-4f10-af3b-b134bbe10dda",
              "name": "yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b724898b-75ce-46da-ae2c-8b969bc28895",
              "toNodeId": "33221742-8e7f-45be-9f09-20ce95ecb95b"
            },
            "875eb3c0-d1b4-4e94-8118-9d22fc281c41": {
              "id": "875eb3c0-d1b4-4e94-8118-9d22fc281c41",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "25d39d29-2651-4b27-af1c-ee3482012263",
              "toNodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75"
            },
            "97a53cc4-f3ec-41a1-8c28-e16367a7d462": {
              "id": "97a53cc4-f3ec-41a1-8c28-e16367a7d462",
              "name": "request",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b326d2db-9d73-49dd-aa2e-dbc8f16f5116",
              "toNodeId": "b724898b-75ce-46da-ae2c-8b969bc28895"
            },
            "97b8ade4-4a9c-45cf-81d9-f7804d5f8067": {
              "id": "97b8ade4-4a9c-45cf-81d9-f7804d5f8067",
              "name": "asset group",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ed59d774-63fd-435e-a798-0d243b52b7de",
              "toNodeId": "25d39d29-2651-4b27-af1c-ee3482012263"
            },
            "9bccae3b-1df5-42d2-81d7-db08dcc2ea86": {
              "id": "9bccae3b-1df5-42d2-81d7-db08dcc2ea86",
              "name": "approved",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b326d2db-9d73-49dd-aa2e-dbc8f16f5116",
              "toNodeId": "d37420b4-9da9-4d6b-8573-0db3a5ffae52"
            },
            "9ca99c6b-fcb9-4d3c-9bbc-e665f08bacb2": {
              "id": "9ca99c6b-fcb9-4d3c-9bbc-e665f08bacb2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9",
              "toNodeId": ""
            },
            "ae4fd23e-1ae5-4bca-b975-98848c671e80": {
              "id": "ae4fd23e-1ae5-4bca-b975-98848c671e80",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75",
              "toNodeId": "173a7cef-e3a8-4163-aa29-1fa4bff7bb76"
            },
            "b6bb5ffe-5f64-48da-b79d-870aae423e4c": {
              "id": "b6bb5ffe-5f64-48da-b79d-870aae423e4c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "173a7cef-e3a8-4163-aa29-1fa4bff7bb76",
              "toNodeId": "b326d2db-9d73-49dd-aa2e-dbc8f16f5116"
            },
            "c367079c-ed62-432d-8e5a-60b48819cdae": {
              "id": "c367079c-ed62-432d-8e5a-60b48819cdae",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "851f5071-e68e-4e3e-bb88-f80e8891d5f2",
              "toNodeId": ""
            },
            "c37e7ea3-f4e6-46ef-b51e-c23736eaf859": {
              "id": "c37e7ea3-f4e6-46ef-b51e-c23736eaf859",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dd2028ee-9a6c-46bd-9ba6-ec4c18169092",
              "toNodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75"
            },
            "c4199a6e-0f8e-4094-a044-f1f2a6cb0f6f": {
              "id": "c4199a6e-0f8e-4094-a044-f1f2a6cb0f6f",
              "name": "Approve",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6",
              "toNodeId": "851f5071-e68e-4e3e-bb88-f80e8891d5f2"
            },
            "ca074ff6-b04a-4b8a-81a7-5b5a945b6b73": {
              "id": "ca074ff6-b04a-4b8a-81a7-5b5a945b6b73",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "38c59f04-439f-44ba-a8f9-b18a6ab100a2",
              "toNodeId": "ed59d774-63fd-435e-a798-0d243b52b7de"
            },
            "cc4df61c-29d4-4c0a-94b4-67991d1a3561": {
              "id": "cc4df61c-29d4-4c0a-94b4-67991d1a3561",
              "name": "no",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b724898b-75ce-46da-ae2c-8b969bc28895",
              "toNodeId": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6"
            },
            "df1fab68-be95-4eb1-a083-768531aa74f3": {
              "id": "df1fab68-be95-4eb1-a083-768531aa74f3",
              "name": "Confirm Exception",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d37420b4-9da9-4d6b-8573-0db3a5ffae52",
              "toNodeId": ""
            }
          },
          "nodes": {
            "173a7cef-e3a8-4163-aa29-1fa4bff7bb76": {
              "id": "173a7cef-e3a8-4163-aa29-1fa4bff7bb76",
              "parentNodeId": ""
            },
            "25d39d29-2651-4b27-af1c-ee3482012263": {
              "id": "25d39d29-2651-4b27-af1c-ee3482012263",
              "parentNodeId": ""
            },
            "33221742-8e7f-45be-9f09-20ce95ecb95b": {
              "id": "33221742-8e7f-45be-9f09-20ce95ecb95b",
              "parentNodeId": ""
            },
            "38c59f04-439f-44ba-a8f9-b18a6ab100a2": {
              "id": "38c59f04-439f-44ba-a8f9-b18a6ab100a2",
              "parentNodeId": ""
            },
            "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9": {
              "id": "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9",
              "parentNodeId": ""
            },
            "62a9d330-13e0-469a-a489-4622b7251c75": {
              "id": "62a9d330-13e0-469a-a489-4622b7251c75",
              "parentNodeId": ""
            },
            "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1": {
              "id": "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1",
              "parentNodeId": ""
            },
            "6edda294-c793-4dcf-a6cb-66078fbc48a5": {
              "id": "6edda294-c793-4dcf-a6cb-66078fbc48a5",
              "parentNodeId": ""
            },
            "79f6eb3a-744f-43a1-b232-6d6d32880a75": {
              "id": "79f6eb3a-744f-43a1-b232-6d6d32880a75",
              "parentNodeId": ""
            },
            "7b2484c0-8139-4e39-afa8-4639c42a434a": {
              "id": "7b2484c0-8139-4e39-afa8-4639c42a434a",
              "parentNodeId": ""
            },
            "851f5071-e68e-4e3e-bb88-f80e8891d5f2": {
              "id": "851f5071-e68e-4e3e-bb88-f80e8891d5f2",
              "parentNodeId": ""
            },
            "8dbcbd9c-e405-433b-896b-17932abaf56b": {
              "id": "8dbcbd9c-e405-433b-896b-17932abaf56b",
              "parentNodeId": ""
            },
            "a275708d-92f1-46bc-be6c-a26eda99b55d": {
              "id": "a275708d-92f1-46bc-be6c-a26eda99b55d",
              "parentNodeId": ""
            },
            "b326d2db-9d73-49dd-aa2e-dbc8f16f5116": {
              "id": "b326d2db-9d73-49dd-aa2e-dbc8f16f5116",
              "parentNodeId": ""
            },
            "b724898b-75ce-46da-ae2c-8b969bc28895": {
              "id": "b724898b-75ce-46da-ae2c-8b969bc28895",
              "parentNodeId": ""
            },
            "d37420b4-9da9-4d6b-8573-0db3a5ffae52": {
              "id": "d37420b4-9da9-4d6b-8573-0db3a5ffae52",
              "parentNodeId": ""
            },
            "dd2028ee-9a6c-46bd-9ba6-ec4c18169092": {
              "id": "dd2028ee-9a6c-46bd-9ba6-ec4c18169092",
              "parentNodeId": ""
            },
            "ed59d774-63fd-435e-a798-0d243b52b7de": {
              "id": "ed59d774-63fd-435e-a798-0d243b52b7de",
              "parentNodeId": ""
            },
            "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6": {
              "id": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "173a7cef-e3a8-4163-aa29-1fa4bff7bb76": {
            "nodeId": "173a7cef-e3a8-4163-aa29-1fa4bff7bb76",
            "name": "Share Report Details",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Vulnerability Exception Requested*\n\n:man: *Requester* :woman:\n```* Name: {{[62a9d330-13e0-469a-a489-4622b7251c75].[user].[name]}}\n* Email: {{[62a9d330-13e0-469a-a489-4622b7251c75].[user].[email]}}\n* Username: {{[62a9d330-13e0-469a-a489-4622b7251c75].[user].[login]}}```\n\n:scroll: *Vulnerability Information* :unlock:\n```* Vulnerability: {{[38c59f04-439f-44ba-a8f9-b18a6ab100a2].[vulnerability].[title]}}\n* Vulnerability Risk Score: {{[38c59f04-439f-44ba-a8f9-b18a6ab100a2].[vulnerability].[riskScore]}}\n* CVSS Score: {{[38c59f04-439f-44ba-a8f9-b18a6ab100a2].[vulnerability].[cvss].[v2].[score]}}\n* CVSS Vector: {{[38c59f04-439f-44ba-a8f9-b18a6ab100a2].[vulnerability].[cvss].[v2].[vector]}}```\n\n:mag: *Exception Scope* :telescope:\n```* Exception Type: {{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[type]}}\n{{#if [79f6eb3a-744f-43a1-b232-6d6d32880a75].[name]}}* Exception Scope: {{[79f6eb3a-744f-43a1-b232-6d6d32880a75].[name]}}{{/if}}\n{{#if [7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[port]}}* Port: {{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[port]}}{{/if}}```\n{{#if [79f6eb3a-744f-43a1-b232-6d6d32880a75].[detail]}}{{[79f6eb3a-744f-43a1-b232-6d6d32880a75].[detail]}}{{/if}}\n\n:speaking_head_in_silhouette: *Comment* :speech_balloon:\n```{{#if [7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[submit].[comment]}}{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[submit].[comment]}}{{else}}none{{/if}}```\n\n:spiral_calendar_pad: *Expiration* :x:\n```{{#if [7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[expires]}}{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[expires]}}{{else}}Does Not Expire{{/if}}```\n\n:link: *Link to Exception Request* :computer:\n```{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[links].[0].[href]}}```",
                "recipient": "{{$workflow.[Channel]}}",
                "thread_ts": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "25d39d29-2651-4b27-af1c-ee3482012263": {
            "nodeId": "25d39d29-2651-4b27-af1c-ee3482012263",
            "name": "Asset Group",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_asset_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "Asset group ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "asset_group": {
                  "properties": {
                    "assets": {
                      "description": "Site asset count",
                      "order": 1,
                      "title": "Assets",
                      "type": "integer"
                    },
                    "description": {
                      "description": "Asset group description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Site ID",
                      "order": 3,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Asset group name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Site risk score",
                      "order": 6,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "searchCriteria": {
                      "description": "Asset group search criteria",
                      "order": 7,
                      "title": "Search Criteria",
                      "type": "object"
                    },
                    "type": {
                      "description": "Asset group type",
                      "order": 8,
                      "title": "Type",
                      "type": "string"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities_count",
                      "description": "Asset group vulnerability counts",
                      "order": 9,
                      "title": "Vulnerabilities"
                    }
                  },
                  "required": [
                    "riskScore",
                    "type",
                    "links",
                    "name",
                    "id",
                    "vulnerabilities",
                    "assets"
                  ],
                  "title": "Asset Group",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "asset_group": {
                  "$ref": "#/definitions/asset_group",
                  "description": "Asset group",
                  "order": 1,
                  "title": "Asset Group"
                }
              },
              "required": [
                "asset_group"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "33221742-8e7f-45be-9f09-20ce95ecb95b": {
            "nodeId": "33221742-8e7f-45be-9f09-20ce95ecb95b",
            "name": "Auto-approve",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "review_exception",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "Exception auto-approved by InsightConnect because the vulnerability risk was under or equal to the configured threshold of {{$workflow.[Threshold]}}.",
                "exception": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[id]}}",
                "review": "Approved"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to include in the review",
                  "order": 3,
                  "title": "Review Comment",
                  "type": "string"
                },
                "exception": {
                  "description": "The vulnerability exception ID to approve or reject",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                },
                "review": {
                  "description": "Approval or rejection of the exception",
                  "enum": [
                    "Approved",
                    "Rejected"
                  ],
                  "order": 2,
                  "title": "Review Outcome",
                  "type": "string"
                }
              },
              "required": [
                "review",
                "exception"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "38c59f04-439f-44ba-a8f9-b18a6ab100a2": {
            "nodeId": "38c59f04-439f-44ba-a8f9-b18a6ab100a2",
            "name": "Vulnerability Details",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_vulnerability",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[vulnerability]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "The identifier of the vulnerability to retrieve from InsightVM",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "cvss": {
                  "properties": {
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 1,
                      "title": "Links",
                      "type": "array"
                    },
                    "v2": {
                      "$ref": "#/definitions/cvss_v2",
                      "description": "CVSSv2 details",
                      "order": 2,
                      "title": "V2"
                    },
                    "v3": {
                      "$ref": "#/definitions/cvss_v3",
                      "description": "CVSSv3 details",
                      "order": 3,
                      "title": "V3"
                    }
                  },
                  "title": "Cvss",
                  "type": "object"
                },
                "cvss_v2": {
                  "properties": {
                    "accessComplexity": {
                      "description": "CVSSv2 access complexity metric",
                      "order": 1,
                      "title": "Access Complexity",
                      "type": "string"
                    },
                    "accessVector": {
                      "description": "CVSSv2 access vector metric",
                      "order": 2,
                      "title": "Access Vector",
                      "type": "string"
                    },
                    "authentication": {
                      "description": "CVSSv2 authentication metric",
                      "order": 3,
                      "title": "Authentication",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv2 availability impact metric",
                      "order": 4,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv2 confidentiality impact metric",
                      "order": 5,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv2 combined exploit metric score (Access Complexity/Access Vector/Authentication)",
                      "order": 6,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 7,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv2 integrity impact metric",
                      "order": 8,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv2 score",
                      "order": 9,
                      "title": "Score",
                      "type": "number"
                    },
                    "vector": {
                      "description": "CVSSv2 combined vector string",
                      "order": 10,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V2",
                  "type": "object"
                },
                "cvss_v3": {
                  "properties": {
                    "attackComplexity": {
                      "description": "CVSSv3 attack complexity metric",
                      "order": 1,
                      "title": "Attack Complexity",
                      "type": "string"
                    },
                    "attackVector": {
                      "description": "CVSSv3 attack vector metric",
                      "order": 2,
                      "title": "Attack Vector",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv3 availability impact metric",
                      "order": 3,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv3 confidentiality impact metric",
                      "order": 4,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv3 combined exploit metric score (Attack Complexity/Attack Vector/Privilege Required/Scope/User Interaction)",
                      "order": 5,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 6,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv3 integrity impact metric",
                      "order": 7,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "privilegeRequired": {
                      "description": "CVSSv3 privilege required metric",
                      "order": 8,
                      "title": "Privilege Required",
                      "type": "string"
                    },
                    "scope": {
                      "description": "CVSSv3 scope metric",
                      "order": 9,
                      "title": "Scope",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv3 score",
                      "order": 10,
                      "title": "Score",
                      "type": "number"
                    },
                    "userInteraction": {
                      "description": "CVSSv3 user interaction metric",
                      "order": 11,
                      "title": "User Interaction",
                      "type": "string"
                    },
                    "vector": {
                      "description": "CVSSv3 combined vector string",
                      "order": 12,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V3",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "pci": {
                  "properties": {
                    "adjustedCVSSScore": {
                      "description": "PCI adjusted CVSS score",
                      "order": 1,
                      "title": "Adjusted CVSS score",
                      "type": "integer"
                    },
                    "adjustedSeverityScore": {
                      "description": "PCI adjusted severity score",
                      "order": 2,
                      "title": "Adjusted severity score",
                      "type": "integer"
                    },
                    "fail": {
                      "description": "Whether this vulnerability results in a PCI assessment failure",
                      "order": 3,
                      "title": "Fail",
                      "type": "boolean"
                    },
                    "specialNotes": {
                      "description": "PCI special notes",
                      "order": 4,
                      "title": "Special Notes",
                      "type": "string"
                    },
                    "status": {
                      "description": "PCI status",
                      "order": 5,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Pci",
                  "type": "object"
                },
                "vulnerability": {
                  "properties": {
                    "added": {
                      "description": "Date that the vulnerability was added to InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Added",
                      "type": "string"
                    },
                    "categories": {
                      "description": "List of vulnerabilities categories with which this vulnerability is affiliated",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Categories",
                      "type": "array"
                    },
                    "cves": {
                      "description": "List of CVE identifiers associated with this vulnerability",
                      "items": {
                        "type": "string"
                      },
                      "order": 17,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "cvss": {
                      "$ref": "#/definitions/cvss",
                      "description": "Vulnerability CVSS details",
                      "order": 15,
                      "title": "CVSS"
                    },
                    "denialOfService": {
                      "description": "Whether the vulnerability is a denial of service vulnerability",
                      "order": 7,
                      "title": "Denial of Service",
                      "type": "boolean"
                    },
                    "description": {
                      "$ref": "#/definitions/vulnerability_description",
                      "description": "Vulnerability description",
                      "order": 3,
                      "title": "Description"
                    },
                    "exploits": {
                      "description": "Exploit count",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 9,
                      "title": "ID",
                      "type": "string"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "malwareKits": {
                      "description": "Malware kit count",
                      "order": 6,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "modified": {
                      "description": "Date the vulnerability was last modified in InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 8,
                      "title": "Modified",
                      "type": "string"
                    },
                    "pci": {
                      "$ref": "#/definitions/pci",
                      "description": "Vulnerability PCI details",
                      "order": 11,
                      "title": "PCI"
                    },
                    "published": {
                      "description": "Date the vulnerability was published",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 12,
                      "title": "Published",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Vulnerability risk score using the configured risk scoring strategy (RealRisk by default)",
                      "order": 14,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "severity": {
                      "description": "Vulnerability severity string (Moderate/Severe/Critical)",
                      "order": 13,
                      "title": "Severity",
                      "type": "string"
                    },
                    "severityScore": {
                      "description": "Vulnerability severity score",
                      "order": 10,
                      "title": "Severity Score",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Vulnerability title",
                      "order": 5,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability",
                  "type": "object"
                },
                "vulnerability_description": {
                  "properties": {
                    "html": {
                      "description": "Vulnerability description HTML",
                      "order": 1,
                      "title": "HTML",
                      "type": "string"
                    },
                    "text": {
                      "description": "Vulnerability description raw text",
                      "order": 2,
                      "title": "Text",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Description",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability": {
                  "$ref": "#/definitions/vulnerability",
                  "description": "The details of the vulnerability requested",
                  "order": 1,
                  "title": "Vulnerability Details"
                }
              },
              "required": [
                "vulnerability"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9": {
            "nodeId": "43a8f6a0-26b5-41b9-9f5d-0b76b9e289d9",
            "name": "Reject Exception",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "review_exception",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "Vulnerability Exception was rejected via InsightConnect by {{[f3c13f69-ac5c-4f31-8635-00e0de5e7ec6].[user]}}.",
                "exception": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[id]}}",
                "review": "Rejected"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to include in the review",
                  "order": 3,
                  "title": "Review Comment",
                  "type": "string"
                },
                "exception": {
                  "description": "The vulnerability exception ID to approve or reject",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                },
                "review": {
                  "description": "Approval or rejection of the exception",
                  "enum": [
                    "Approved",
                    "Rejected"
                  ],
                  "order": 2,
                  "title": "Review Outcome",
                  "type": "string"
                }
              },
              "required": [
                "review",
                "exception"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "62a9d330-13e0-469a-a489-4622b7251c75": {
            "nodeId": "62a9d330-13e0-469a-a489-4622b7251c75",
            "name": "IVM Submitter",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[submit].[user]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "User account ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authentication_source": {
                  "properties": {
                    "external": {
                      "description": "Whether the authentication source is external (true) or internal (false)",
                      "order": 1,
                      "title": "External",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "Authentication source identifier",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 3,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Authentication source name",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Authentication source type",
                      "enum": [
                        "normal",
                        "kerberos",
                        "ldap",
                        "saml",
                        "admin"
                      ],
                      "order": 5,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id",
                    "links",
                    "name",
                    "type",
                    "external"
                  ],
                  "title": "Authentication Source",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "user_account": {
                  "properties": {
                    "authentication": {
                      "$ref": "#/definitions/authentication_source",
                      "description": "The authentication source used to authenticate the user",
                      "order": 1,
                      "title": "Authentication"
                    },
                    "email": {
                      "description": "The email address of the user",
                      "order": 2,
                      "title": "Email",
                      "type": "string"
                    },
                    "enabled": {
                      "description": "Whether the user account is enabled",
                      "order": 3,
                      "title": "Enabled",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "The identifier of the user",
                      "order": 4,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 5,
                      "title": "Links",
                      "type": "array"
                    },
                    "locale": {
                      "$ref": "#/definitions/user_account_locale",
                      "description": "The locale and language preferences for the user",
                      "order": 6,
                      "title": "Locale"
                    },
                    "locked": {
                      "description": "Whether the user account is locked (exceeded maximum password retry attempts)",
                      "order": 7,
                      "title": "Locked",
                      "type": "boolean"
                    },
                    "login": {
                      "description": "The login name of the user",
                      "order": 8,
                      "title": "Login",
                      "type": "string"
                    },
                    "name": {
                      "description": "The full name of the user",
                      "order": 9,
                      "title": "Name",
                      "type": "string"
                    },
                    "role": {
                      "$ref": "#/definitions/user_account_role",
                      "description": "The privileges and role the user is assigned",
                      "order": 10,
                      "title": "Role"
                    }
                  },
                  "required": [
                    "locked",
                    "login",
                    "name"
                  ],
                  "title": "User Account",
                  "type": "object"
                },
                "user_account_locale": {
                  "properties": {
                    "default": {
                      "description": "Default locale",
                      "order": 1,
                      "title": "Default",
                      "type": "string"
                    },
                    "reports": {
                      "description": "Reports locale",
                      "order": 2,
                      "title": "Reports",
                      "type": "string"
                    }
                  },
                  "required": [
                    "default",
                    "reports"
                  ],
                  "title": "User Account Locale",
                  "type": "object"
                },
                "user_account_role": {
                  "properties": {
                    "allAssetGroups": {
                      "description": "Whether the user has access to all asset groups",
                      "order": 1,
                      "title": "All Asset Groups",
                      "type": "boolean"
                    },
                    "allSites": {
                      "description": "Whether the user has access to all sites",
                      "order": 2,
                      "title": "All Sites",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "The identifier of the role the user is assigned to",
                      "order": 3,
                      "title": "ID",
                      "type": "string"
                    },
                    "privileges": {
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Privileges",
                      "type": "array"
                    },
                    "superuser": {
                      "description": "Whether the user is a superuser",
                      "order": 5,
                      "title": "Superuser",
                      "type": "boolean"
                    }
                  },
                  "title": "User Account Role",
                  "type": "object"
                }
              },
              "properties": {
                "user": {
                  "$ref": "#/definitions/user_account",
                  "description": "User account details",
                  "order": 1,
                  "title": "User"
                }
              },
              "required": [
                "user"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1": {
            "nodeId": "63fdb5ac-51b0-4cda-ac9c-e3684e3debf1",
            "name": "Asset",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_asset",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "Get an asset by ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address": {
                  "properties": {
                    "ip": {
                      "description": "IPv4 or IPv6 address",
                      "order": 1,
                      "title": "IP",
                      "type": "string"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 2,
                      "title": "MAC",
                      "type": "string"
                    }
                  },
                  "title": "Address",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "addresses": {
                      "description": "All addresses discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/address"
                      },
                      "order": 1,
                      "title": "Addresses",
                      "type": "array"
                    },
                    "assessedForPolicies": {
                      "description": "Whether the asset has been assessed for policies at least once",
                      "order": 2,
                      "title": "Assessed for Policies",
                      "type": "boolean"
                    },
                    "assessedForVulnerabilities": {
                      "description": "Whether the asset has been assessed for vulnerabilities at least once",
                      "order": 3,
                      "title": "Assessed for Vulnerabilities",
                      "type": "boolean"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 4,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 5,
                      "title": "Databases",
                      "type": "array"
                    },
                    "files": {
                      "description": "Files discovered with searching on the asset",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 6,
                      "title": "Files",
                      "type": "array"
                    },
                    "history": {
                      "description": "History of changes to the asset over time",
                      "items": {
                        "$ref": "#/definitions/history"
                      },
                      "order": 7,
                      "title": "History",
                      "type": "array"
                    },
                    "hostName": {
                      "description": "Primary host name (local or FQDN) of the asset",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "hostNames": {
                      "description": "All hostnames or aliases discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/hostName"
                      },
                      "order": 9,
                      "title": "Hostnames",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of the asset",
                      "order": 10,
                      "title": "ID",
                      "type": "integer"
                    },
                    "ids": {
                      "description": "Unique identifiers found on the asset, such as hardware or operating system identifiers",
                      "items": {
                        "$ref": "#/definitions/id"
                      },
                      "order": 11,
                      "title": "IDs",
                      "type": "array"
                    },
                    "ip": {
                      "description": "Primary IPv4 or IPv6 address of the asset",
                      "order": 12,
                      "title": "IP",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 13,
                      "title": "Links",
                      "type": "array"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 14,
                      "title": "MAC",
                      "type": "string"
                    },
                    "os": {
                      "description": "Full description of the operating system of the asset",
                      "order": 15,
                      "title": "OS",
                      "type": "string"
                    },
                    "osFingerprint": {
                      "$ref": "#/definitions/osFingerprint",
                      "description": "Details of the operating system of the asset",
                      "order": 16,
                      "title": "OS Fingerprint"
                    },
                    "rawRiskScore": {
                      "description": "Base risk score of the asset",
                      "order": 17,
                      "title": "Raw Risk Score",
                      "type": "number"
                    },
                    "riskScore": {
                      "description": "Risk score (with criticality adjustments) of the asset",
                      "order": 18,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "services": {
                      "description": "Services discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/service"
                      },
                      "order": 19,
                      "title": "Services",
                      "type": "array"
                    },
                    "software": {
                      "description": "Software discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/software"
                      },
                      "order": 20,
                      "title": "Software",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type of asset e.g. unknown, guest, hypervisor, physical, mobile",
                      "order": 21,
                      "title": "Type",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User group accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 22,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "User accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 23,
                      "title": "Users",
                      "type": "array"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities",
                      "description": " Summary information for vulnerabilities on the asset",
                      "order": 24,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Asset",
                  "type": "object"
                },
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "cpe": {
                  "properties": {
                    "edition": {
                      "description": "Edition-related terms applied by the vendor to the product",
                      "order": 1,
                      "title": "Edition",
                      "type": "string"
                    },
                    "language": {
                      "description": "Defines the language supported in the user interface of the product being described. The format of the language tag adheres to RFC 5646",
                      "order": 2,
                      "title": "Language",
                      "type": "string"
                    },
                    "other": {
                      "description": "Captures any other general descriptive or identifying information which is vendor- or product-specific and which does not logically fit in any other attribute value",
                      "order": 3,
                      "title": "Other",
                      "type": "string"
                    },
                    "part": {
                      "description": "A single letter code that designates the particular platform part that is being identified",
                      "order": 4,
                      "title": "Part",
                      "type": "string"
                    },
                    "product": {
                      "description": "Most common and recognizable title or name of the product",
                      "order": 5,
                      "title": "Product",
                      "type": "string"
                    },
                    "swEdition": {
                      "description": "Characterizes how the product is tailored to a particular market or class of end users",
                      "order": 6,
                      "title": "Software Edition",
                      "type": "string"
                    },
                    "targetHW": {
                      "description": "Characterize the instruction set architecture on which the product operates",
                      "order": 7,
                      "title": "Target Hardware",
                      "type": "string"
                    },
                    "targetSW": {
                      "description": "Characterizes the software computing environment within which the product operates",
                      "order": 8,
                      "title": "Target Software",
                      "type": "string"
                    },
                    "update": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular update, service pack, or point release of the product",
                      "order": 9,
                      "title": "Update",
                      "type": "string"
                    },
                    "v2.2": {
                      "description": "The full CPE string in the CPE 2.2 format",
                      "order": 10,
                      "title": "Version 2.2",
                      "type": "string"
                    },
                    "v2.3": {
                      "description": "The full CPE string in the CPE 2.3 format",
                      "order": 11,
                      "title": "Version 2.3",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "The person or organization that manufactured or created the product",
                      "order": 12,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular release version of the product",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Cpe",
                  "type": "object"
                },
                "database": {
                  "properties": {
                    "description": {
                      "description": "Description of the database instance",
                      "order": 1,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the database",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the database instance",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Database",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "history": {
                  "properties": {
                    "date": {
                      "description": "Date the asset information was collected or changed",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "description": {
                      "description": "Additional information describing the change",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "scanId": {
                      "description": "If a scan-oriented change, the identifier of the corresponding scan the asset was scanned in",
                      "order": 3,
                      "title": "Scan ID",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type, for additional information see the help section of this plugin",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    },
                    "user": {
                      "description": "User",
                      "order": 5,
                      "title": "User",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version",
                      "order": 6,
                      "title": "Version",
                      "type": "integer"
                    },
                    "vulnerabilityExceptionId": {
                      "description": "Vulnerability exception ID",
                      "order": 7,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    }
                  },
                  "title": "History",
                  "type": "object"
                },
                "hostName": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "HostName",
                  "type": "object"
                },
                "id": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Id",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "osFingerprint": {
                  "properties": {
                    "architecture": {
                      "description": "The architecture of the operating system",
                      "order": 1,
                      "title": "Architecture",
                      "type": "string"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the operating system",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 2,
                      "title": "Configuration",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "Common Platform Enumeration",
                      "order": 3,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "The description of the operating system (containing vendor, family, product, version and architecture in a single string)",
                      "order": 4,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the operating system",
                      "order": 5,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the operating system",
                      "order": 6,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Name of the operating system",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "systemName": {
                      "description": "A combination of vendor and family (with redundancies removed), suitable for grouping",
                      "order": 8,
                      "title": "System Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of operating system",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the operating system",
                      "order": 10,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the operating system",
                      "order": 11,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "OsFingerprint",
                  "type": "object"
                },
                "page": {
                  "properties": {
                    "linkType": {
                      "description": "Type of link used to traverse or detect the page",
                      "order": 1,
                      "title": "Link Type",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path to the page (URI)",
                      "order": 2,
                      "title": "Path",
                      "type": "string"
                    },
                    "response": {
                      "description": "HTTP response code observed with retrieving the page",
                      "order": 3,
                      "title": "Response",
                      "type": "integer"
                    }
                  },
                  "title": "Page",
                  "type": "object"
                },
                "service": {
                  "properties": {
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 2,
                      "title": "Databases",
                      "type": "array"
                    },
                    "family": {
                      "description": "Family of the service",
                      "order": 3,
                      "title": "Family",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name of the service",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "port": {
                      "description": "Port of the service",
                      "order": 6,
                      "title": "Port",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product running the service",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service",
                      "order": 8,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User groups",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 9,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 10,
                      "title": "Users",
                      "type": "array"
                    },
                    "vendor": {
                      "description": "Vendor of the service",
                      "order": 11,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the service",
                      "order": 12,
                      "title": "Version",
                      "type": "string"
                    },
                    "webApplications": {
                      "description": "Web applications found on the service",
                      "items": {
                        "$ref": "#/definitions/webApplication"
                      },
                      "order": 13,
                      "title": "Web Applications",
                      "type": "array"
                    }
                  },
                  "title": "Service",
                  "type": "object"
                },
                "software": {
                  "properties": {
                    "configurations": {
                      "description": "Configurations",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "CPE",
                      "order": 2,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "Description of the software",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the software",
                      "order": 4,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 5,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product of the software",
                      "order": 6,
                      "title": "Product",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of the software",
                      "order": 7,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the software",
                      "order": 8,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the software",
                      "order": 9,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Software",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "fullName": {
                      "description": "Full name of the user account",
                      "order": 1,
                      "title": "Full Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the user account",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user account",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                },
                "userGroup": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the user group",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user group",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "UserGroup",
                  "type": "object"
                },
                "vulnerabilities": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "exploits": {
                      "description": "Number of distinct exploits that can exploit any of the vulnerabilities on the asset",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "malwareKits": {
                      "description": "Number of distinct malware kits that vulnerabilities on the asset are susceptible to",
                      "order": 3,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 4,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 5,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total number of vulnerabilities",
                      "order": 6,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities",
                  "type": "object"
                },
                "webApplication": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the web application",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "pages": {
                      "description": "Pages",
                      "items": {
                        "$ref": "#/definitions/page"
                      },
                      "order": 2,
                      "title": "Pages",
                      "type": "array"
                    },
                    "root": {
                      "description": "Web root of the web application",
                      "order": 3,
                      "title": "Root",
                      "type": "string"
                    },
                    "virtualHost": {
                      "description": "Virtual host of the web application",
                      "order": 4,
                      "title": "Virtual Host",
                      "type": "string"
                    }
                  },
                  "title": "WebApplication",
                  "type": "object"
                }
              },
              "properties": {
                "asset": {
                  "$ref": "#/definitions/asset",
                  "description": "Asset details",
                  "order": 1,
                  "title": "Asset"
                }
              },
              "required": [
                "asset"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "6edda294-c793-4dcf-a6cb-66078fbc48a5": {
            "nodeId": "6edda294-c793-4dcf-a6cb-66078fbc48a5",
            "name": "Tags",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_asset_tags",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "asset_id": "{{[63fdb5ac-51b0-4cda-ac9c-e3684e3debf1].[asset].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "asset_id": {
                  "description": "Identifier of asset",
                  "order": 1,
                  "title": "Asset ID",
                  "type": "integer"
                }
              },
              "required": [
                "asset_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "tag": {
                  "properties": {
                    "color": {
                      "description": "Tag color",
                      "order": 1,
                      "title": "Color",
                      "type": "string"
                    },
                    "created": {
                      "description": "Tag creation date",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 2,
                      "title": "Created",
                      "type": "string"
                    },
                    "id": {
                      "description": "Tag ID",
                      "order": 3,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Tag name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "riskModifier": {
                      "description": "Tag risk score modifier",
                      "order": 6,
                      "title": "Risk Modifier",
                      "type": "string"
                    },
                    "searchCriteria": {
                      "description": "Tag search criteria",
                      "order": 7,
                      "title": "Search Criteria",
                      "type": "object"
                    },
                    "source": {
                      "description": "Tag source",
                      "order": 8,
                      "title": "Source",
                      "type": "string"
                    },
                    "type": {
                      "description": "Tag type",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id",
                    "type",
                    "name"
                  ],
                  "title": "Tag",
                  "type": "object"
                }
              },
              "properties": {
                "tags": {
                  "description": "List of tags",
                  "items": {
                    "$ref": "#/definitions/tag"
                  },
                  "order": 1,
                  "title": "Tags",
                  "type": "array"
                }
              },
              "required": [
                "tags"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "79f6eb3a-744f-43a1-b232-6d6d32880a75": {
            "nodeId": "79f6eb3a-744f-43a1-b232-6d6d32880a75",
            "name": "Scope Details",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "150cb16c-f52b-4261-9920-9dbe7d67de52",
                "875eb3c0-d1b4-4e94-8118-9d22fc281c41",
                "c37e7ea3-f4e6-46ef-b51e-c23736eaf859",
                "086a0695-111c-4e43-86dc-1aafc44e6e63"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "name",
                  "type": "string",
                  "variables": {
                    "086a0695-111c-4e43-86dc-1aafc44e6e63": "{{[63fdb5ac-51b0-4cda-ac9c-e3684e3debf1].[asset].[hostName]}}",
                    "150cb16c-f52b-4261-9920-9dbe7d67de52": "{{[ed59d774-63fd-435e-a798-0d243b52b7de].[undefined]}}",
                    "875eb3c0-d1b4-4e94-8118-9d22fc281c41": "{{[25d39d29-2651-4b27-af1c-ee3482012263].[asset_group].[name]}}",
                    "c37e7ea3-f4e6-46ef-b51e-c23736eaf859": "{{[dd2028ee-9a6c-46bd-9ba6-ec4c18169092].[site].[name]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "detail",
                  "type": "string",
                  "variables": {
                    "086a0695-111c-4e43-86dc-1aafc44e6e63": "Tags: \n{{#each [6edda294-c793-4dcf-a6cb-66078fbc48a5].[tags]}}{{this.[name]}}\n{{/each}}",
                    "150cb16c-f52b-4261-9920-9dbe7d67de52": "{{[ed59d774-63fd-435e-a798-0d243b52b7de].[undefined]}}",
                    "875eb3c0-d1b4-4e94-8118-9d22fc281c41": "{{[25d39d29-2651-4b27-af1c-ee3482012263].[asset_group].[assets]}} Assets",
                    "c37e7ea3-f4e6-46ef-b51e-c23736eaf859": "{{[dd2028ee-9a6c-46bd-9ba6-ec4c18169092].[site].[assets]}} Assets"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "detail": {
                  "description": "Emitted variable \"detail\"",
                  "order": 2,
                  "title": "detail",
                  "type": "string"
                },
                "name": {
                  "description": "Emitted variable \"name\"",
                  "order": 1,
                  "title": "name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "detail": {
                  "description": "Emitted variable \"detail\"",
                  "order": 2,
                  "title": "detail",
                  "type": "string"
                },
                "name": {
                  "description": "Emitted variable \"name\"",
                  "order": 1,
                  "title": "name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "7b2484c0-8139-4e39-afa8-4639c42a434a": {
            "nodeId": "7b2484c0-8139-4e39-afa8-4639c42a434a",
            "name": "Vulnerability Exception Request",
            "type": "trigger",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "new_exception_request",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "frequency": 1,
                "status_filter": [
                  "Under Review",
                  "Approved"
                ]
              }
            },
            "triggerId": "9c4476fb-3e18-436c-a9a4-4025ba744c6f",
            "defaultInputJSONSchema": {
              "properties": {
                "frequency": {
                  "default": 5,
                  "description": "How often the trigger should check for new vulnerability exception requests",
                  "order": 1,
                  "title": "Frequency",
                  "type": "integer"
                },
                "status_filter": {
                  "default": [
                    "Under Review"
                  ],
                  "description": "List of vulnerability statuses to match against. Options include: Under Review and Approved",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Status Filter",
                  "type": "array"
                }
              },
              "required": [
                "frequency"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "vulnerability_exception": {
                  "properties": {
                    "expires": {
                      "description": "The date and time the vulnerability exception is set to expire",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Expires",
                      "type": "string"
                    },
                    "id": {
                      "description": "The ID uniquely identifying the vulnerability exception",
                      "order": 3,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 7,
                      "title": "Links",
                      "type": "array"
                    },
                    "review": {
                      "description": "Details of the exception review",
                      "order": 6,
                      "title": "Review Details",
                      "type": "object"
                    },
                    "scope": {
                      "description": "Details of the scope of the exception",
                      "order": 4,
                      "title": "Exception Scope",
                      "type": "object"
                    },
                    "state": {
                      "description": "The state of the vulnerability exception",
                      "enum": [
                        "deleted",
                        "expired",
                        "approved",
                        "rejected",
                        "under review"
                      ],
                      "order": 2,
                      "title": "State",
                      "type": "string"
                    },
                    "submit": {
                      "description": "Details of the exception submission",
                      "order": 5,
                      "title": "Submission Details",
                      "type": "object"
                    }
                  },
                  "required": [
                    "state",
                    "id",
                    "scope",
                    "submit"
                  ],
                  "title": "Vulnerability Exception",
                  "type": "object"
                }
              },
              "properties": {
                "exception": {
                  "$ref": "#/definitions/vulnerability_exception",
                  "description": "InsightVM vulnerability exception",
                  "order": 1,
                  "title": "Vulnerability Exception"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "851f5071-e68e-4e3e-bb88-f80e8891d5f2": {
            "nodeId": "851f5071-e68e-4e3e-bb88-f80e8891d5f2",
            "name": "Approve Exception",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "review_exception",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "Vulnerability exception approved via InsightConnect by {{[f3c13f69-ac5c-4f31-8635-00e0de5e7ec6].[responding_user]}}.",
                "exception": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[id]}}",
                "review": "Approved"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to include in the review",
                  "order": 3,
                  "title": "Review Comment",
                  "type": "string"
                },
                "exception": {
                  "description": "The vulnerability exception ID to approve or reject",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                },
                "review": {
                  "description": "Approval or rejection of the exception",
                  "enum": [
                    "Approved",
                    "Rejected"
                  ],
                  "order": 2,
                  "title": "Review Outcome",
                  "type": "string"
                }
              },
              "required": [
                "review",
                "exception"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8dbcbd9c-e405-433b-896b-17932abaf56b": {
            "nodeId": "8dbcbd9c-e405-433b-896b-17932abaf56b",
            "name": "Delete Rogue Exception Request",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "delete_exception",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "exception_id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "exception_id": {
                  "description": "Vulnerability exception ID to delete",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                }
              },
              "required": [
                "exception_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a275708d-92f1-46bc-be6c-a26eda99b55d": {
            "nodeId": "a275708d-92f1-46bc-be6c-a26eda99b55d",
            "name": "Notify of Auto-Approval",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Exception auto-approved because the vulnerability risk was under or equal to the configured threshold of {{$workflow.[Threshold]}}.",
                "recipient": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[channel_id]}}",
                "thread_ts": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "b326d2db-9d73-49dd-aa2e-dbc8f16f5116": {
            "nodeId": "b326d2db-9d73-49dd-aa2e-dbc8f16f5116",
            "name": "What state is the exception in?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "97a53cc4-f3ec-41a1-8c28-e16367a7d462",
              "stepControlParams": [
                {
                  "edgeId": "97a53cc4-f3ec-41a1-8c28-e16367a7d462",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9bccae3b-1df5-42d2-81d7-db08dcc2ea86",
                  "expression": {
                    "left": {
                      "name": "7b2484c0-8139-4e39-afa8-4639c42a434a.exception.state",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": "approved"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[state]}} == \"approved\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b724898b-75ce-46da-ae2c-8b969bc28895": {
            "nodeId": "b724898b-75ce-46da-ae2c-8b969bc28895",
            "name": "auto-approve",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "cc4df61c-29d4-4c0a-94b4-67991d1a3561",
              "stepControlParams": [
                {
                  "edgeId": "7e664927-20c3-4f10-af3b-b134bbe10dda",
                  "expression": {
                    "left": {
                      "name": "38c59f04-439f-44ba-a8f9-b18a6ab100a2.vulnerability.riskScore",
                      "type": "variable"
                    },
                    "op": "<=",
                    "right": {
                      "name": "$workflow.Threshold",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[38c59f04-439f-44ba-a8f9-b18a6ab100a2].[vulnerability].[riskScore]}} <= {{$workflow.[Threshold]}}"
                },
                {
                  "edgeId": "cc4df61c-29d4-4c0a-94b4-67991d1a3561",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "d37420b4-9da9-4d6b-8573-0db3a5ffae52": {
            "nodeId": "d37420b4-9da9-4d6b-8573-0db3a5ffae52",
            "name": "Prompt for Deletion",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "The vulnerability was self-approved by {{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[submit].[name]}}.  ",
              "messageType": "button",
              "options": [
                {
                  "answer": "Remove the Exception",
                  "buttonStyle": "danger",
                  "confirmation": "Exception was deleted",
                  "edgeId": "3bb53358-5db4-4d85-8117-768f6b5508ef",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Confirm Exception",
                  "buttonStyle": "primary",
                  "confirmation": "Self-approved Exception Request was Confirmed",
                  "edgeId": "df1fab68-be95-4eb1-a083-768531aa74f3",
                  "isTimeoutOnly": false
                }
              ],
              "question": "Is this okay or should the exception be removed?",
              "recipient": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[channel_id]}}",
              "threadTimestamp": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[timestamp]}}",
              "timeout": 3600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "df1fab68-be95-4eb1-a083-768531aa74f3"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "dd2028ee-9a6c-46bd-9ba6-ec4c18169092": {
            "nodeId": "dd2028ee-9a6c-46bd-9ba6-ec4c18169092",
            "name": "Site",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_site",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "Site ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "site": {
                  "properties": {
                    "assets": {
                      "description": "Site asset count",
                      "order": 1,
                      "title": "Assets",
                      "type": "integer"
                    },
                    "connectionType": {
                      "description": "Site discovery connection type (if applicable)",
                      "order": 2,
                      "title": "Connection Type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Site description",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the site",
                      "order": 4,
                      "title": "ID",
                      "type": "integer"
                    },
                    "importance": {
                      "description": "Site importance, used with the 'weighted' risk scoring strategy",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "lastScanTime": {
                      "description": "Site last scan time",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 6,
                      "title": "Last Scan Time",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 7,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Site name",
                      "order": 8,
                      "title": "Name",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Site risk score",
                      "order": 9,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "scanEngine": {
                      "description": "Site default scan engine ID",
                      "order": 10,
                      "title": "Scan Engine",
                      "type": "integer"
                    },
                    "scanTemplate": {
                      "description": "Site default scan template",
                      "order": 11,
                      "title": "Scan Template",
                      "type": "string"
                    },
                    "type": {
                      "description": "Site type",
                      "order": 12,
                      "title": "Type",
                      "type": "string"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities_count",
                      "description": "Site vulnerability counts",
                      "order": 13,
                      "title": "Vulnerabilities"
                    }
                  },
                  "required": [
                    "riskScore",
                    "scanEngine",
                    "vulnerabilities",
                    "assets",
                    "importance",
                    "id",
                    "links",
                    "name",
                    "scanTemplate",
                    "type"
                  ],
                  "title": "Site",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "site": {
                  "$ref": "#/definitions/site",
                  "description": "Site details",
                  "order": 1,
                  "title": "Site"
                }
              },
              "required": [
                "site"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ed59d774-63fd-435e-a798-0d243b52b7de": {
            "nodeId": "ed59d774-63fd-435e-a798-0d243b52b7de",
            "name": "Scope of Exception?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "150cb16c-f52b-4261-9920-9dbe7d67de52",
              "stepControlParams": [
                {
                  "edgeId": "150cb16c-f52b-4261-9920-9dbe7d67de52",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "3cce55cf-3885-4e89-891f-544fd26f67e7",
                  "expression": {
                    "left": {
                      "name": "7b2484c0-8139-4e39-afa8-4639c42a434a.exception.scope.type",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": "site"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[type]}} == 'site'"
                },
                {
                  "edgeId": "52775207-6cdc-493d-8d56-10451ce405c0",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "7b2484c0-8139-4e39-afa8-4639c42a434a.exception.scope.type",
                        "type": "variable"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": "asset"
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "name": "7b2484c0-8139-4e39-afa8-4639c42a434a.exception.scope.type",
                        "type": "variable"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": "instance"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[type]}} == 'asset' or {{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[type]}} == 'instance'"
                },
                {
                  "edgeId": "97b8ade4-4a9c-45cf-81d9-f7804d5f8067",
                  "expression": {
                    "left": {
                      "name": "7b2484c0-8139-4e39-afa8-4639c42a434a.exception.scope.type",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": "asset group"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[7b2484c0-8139-4e39-afa8-4639c42a434a].[exception].[scope].[type]}} == 'asset group'"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6": {
            "nodeId": "f3c13f69-ac5c-4f31-8635-00e0de5e7ec6",
            "name": "Approve or Reject?",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "",
              "messageType": "button",
              "options": [
                {
                  "answer": "Approve",
                  "buttonStyle": "primary",
                  "confirmation": "Exception Approved :+1:",
                  "edgeId": "c4199a6e-0f8e-4094-a044-f1f2a6cb0f6f",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Reject",
                  "buttonStyle": "danger",
                  "confirmation": "Exception Rejected :no_entry:",
                  "edgeId": "3d078183-a910-4dd1-8e63-db3334e4e5c8",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "No Answer",
                  "buttonStyle": null,
                  "confirmation": null,
                  "edgeId": "5bc33516-b519-409b-9866-e0275890df03",
                  "isTimeoutOnly": true
                }
              ],
              "question": "Approve or Reject Exception?",
              "recipient": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[channel_id]}}",
              "threadTimestamp": "{{[173a7cef-e3a8-4163-aa29-1fa4bff7bb76].[timestamp]}}",
              "timeout": 3600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "5bc33516-b519-409b-9866-e0275890df03"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          }
        },
        "tags": [
          "Rapid7",
          "Slack",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channel": {
                "type": "string",
                "description": "Channel used to manage vulnerability exceptions."
              },
              "Threshold": {
                "type": "integer",
                "description": "Vulnerability exceptions equal to or below this number will be auto-approved. Set to a negative number to remove auto-approval."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "9c4476fb-3e18-436c-a9a4-4025ba744c6f",
        "identifier": "new_exception_request",
        "name": "Vulnerability Exception Request",
        "description": "",
        "input": {
          "frequency": 1,
          "status_filter": [
            "Under Review",
            "Approved"
          ]
        },
        "inputJsonSchema": {
          "properties": {
            "frequency": {
              "default": 5,
              "description": "How often the trigger should check for new vulnerability exception requests",
              "order": 1,
              "title": "Frequency",
              "type": "integer"
            },
            "status_filter": {
              "default": [
                "Under Review"
              ],
              "description": "List of vulnerability statuses to match against. Options include: Under Review and Approved",
              "items": {
                "type": "string"
              },
              "order": 2,
              "title": "Status Filter",
              "type": "array"
            }
          },
          "required": [
            "frequency"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "link": {
              "properties": {
                "href": {
                  "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                },
                "rel": {
                  "description": "Link relation type following RFC 5988",
                  "order": 2,
                  "title": "Rel",
                  "type": "string"
                }
              },
              "title": "Link",
              "type": "object"
            },
            "vulnerability_exception": {
              "properties": {
                "expires": {
                  "description": "The date and time the vulnerability exception is set to expire",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Expires",
                  "type": "string"
                },
                "id": {
                  "description": "The ID uniquely identifying the vulnerability exception",
                  "order": 3,
                  "title": "Vulnerability Exception ID",
                  "type": "integer"
                },
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 7,
                  "title": "Links",
                  "type": "array"
                },
                "review": {
                  "description": "Details of the exception review",
                  "order": 6,
                  "title": "Review Details",
                  "type": "object"
                },
                "scope": {
                  "description": "Details of the scope of the exception",
                  "order": 4,
                  "title": "Exception Scope",
                  "type": "object"
                },
                "state": {
                  "description": "The state of the vulnerability exception",
                  "enum": [
                    "deleted",
                    "expired",
                    "approved",
                    "rejected",
                    "under review"
                  ],
                  "order": 2,
                  "title": "State",
                  "type": "string"
                },
                "submit": {
                  "description": "Details of the exception submission",
                  "order": 5,
                  "title": "Submission Details",
                  "type": "object"
                }
              },
              "required": [
                "state",
                "id",
                "scope",
                "submit"
              ],
              "title": "Vulnerability Exception",
              "type": "object"
            }
          },
          "properties": {
            "exception": {
              "$ref": "#/definitions/vulnerability_exception",
              "description": "InsightVM vulnerability exception",
              "order": 1,
              "title": "Vulnerability Exception"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Rapid7 InsightVM",
          "slugVendor": "rapid7",
          "slugName": "rapid7_insightvm",
          "slugVersion": "4.9.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
        }
      }
    ]
  }
}