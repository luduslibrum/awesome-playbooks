{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:51:51.380171581Z",
    "workflowVersions": [
      {
        "name": "Lookup Vulnerability from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nLookup a vulnerability to receive an overview, including risk, publish date, description, and solutions for remediation. This workflow helps teams share vulnerability intelligence through shared Slack channels.\n\nSample Slack trigger commands:\n\n`@Rapid7 InsightConnect lookup-vuln CVE-2020-0674`\n\n`@Rapid7 InsightConnect lookup-vuln bluekeep`\n\n# Key Features\n\n* Lookup vulnerability information from Slack\n* Find all vulnerabilities that match a search term\n* Get severity, description, publish date, and solution information in a Slack message\n\n# Requirements\n\n* InsightConnect License\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere is one parameter you will need to configure in order to complete setup of your workflow:\n\n* Channel: The Slack channel name in your environment where the workflow should be triggered\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameter, activate the workflow in order to trigger it.\n\n## Usage\n\n*This workflow will trigger in any direct messages to your Chatbot **or** any message in a channel directed @ your Chatbot. Note the Chatbot must be in the channel in order to trigger the workflow this way.*\n\nTo run the workflow, send a direct message to your InsightConnect Slack Chatbot or @ your Chatbot in a public channel starting with the command `lookup-vuln`.\n\nFor example, in a direct message to your Chatbot:\n* `lookup-vuln CVE-2020-0674`\n\nOr in a channel including your Chatbot:\n* `@Rapid7 InsightConnect lookup-vuln bluekeep`\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 Vulnerability & Exploit Database|2.1.0|2|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.0 - Leverage workflow parameters feature | Update documentation | Update Rapid7 Vulnerability & Exploit Database plugin to version 2.1.0\n* 1.1.4 - Update workflow to be entirely cloud based\n* 1.1.3 - Updated trigger syntax, updated Rapid7 Vuln DB plugin, updated documentation\n* 1.1.2 - Updated documentation\n* 1.1.1 - Updated plugin versions in help.md\n* 1.1.0 - Updated workflow to work with v2.0.2 of the Rapid7 Vulnerability & Exploit Database plugin | Added a Final Report workflow artifact including a summary of workflow results\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 Vulnerability Database](https://www.rapid7.com/db)\n* [Slack](https://slack.com)\n",
        "graph": {
          "edges": {
            "0a9405d6-fd98-4087-bed8-f61b0093ec5a": {
              "id": "0a9405d6-fd98-4087-bed8-f61b0093ec5a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0",
              "toNodeId": "9cce9c34-c46b-417d-afbe-f23770f526c1"
            },
            "0f1a9e6a-d175-45a7-838f-0113dffff989": {
              "id": "0f1a9e6a-d175-45a7-838f-0113dffff989",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9cce9c34-c46b-417d-afbe-f23770f526c1",
              "toNodeId": "bec9701c-1f1c-4170-b788-405266227c57"
            },
            "0f7040a8-5843-4f32-99d1-1ff9197e28db": {
              "id": "0f7040a8-5843-4f32-99d1-1ff9197e28db",
              "name": "",
              "description": "",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "fromNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "toNodeId": "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4"
            },
            "104731b2-9ac4-43aa-ab37-540f160585f1": {
              "id": "104731b2-9ac4-43aa-ab37-540f160585f1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "437915c3-0bc9-4b17-af80-a970e11cecae",
              "toNodeId": "8b5feaf1-cab9-4d65-9bec-00858dd6e71c"
            },
            "180c3182-39c4-4830-a611-40bb2b80195a": {
              "id": "180c3182-39c4-4830-a611-40bb2b80195a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "toNodeId": "efa7a832-554c-4e98-bd77-c72f9f2693fe"
            },
            "2ac9b486-da27-4230-be4c-ea37d0764bca": {
              "id": "2ac9b486-da27-4230-be4c-ea37d0764bca",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "804203b8-9147-40d3-9ad5-c5f2bb2eb13b",
              "toNodeId": "5807a169-4818-4a46-b239-2ed60bb880af"
            },
            "4b055f08-aecb-4092-9cb8-3348e1e56cfa": {
              "id": "4b055f08-aecb-4092-9cb8-3348e1e56cfa",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "804203b8-9147-40d3-9ad5-c5f2bb2eb13b",
              "toNodeId": "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0"
            },
            "4ddb051e-7b42-4169-af8f-6ba58e592fe5": {
              "id": "4ddb051e-7b42-4169-af8f-6ba58e592fe5",
              "name": "",
              "description": "",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "fromNodeId": "dc3bf1cf-f588-44d0-b811-674f548a6187",
              "toNodeId": ""
            },
            "54a3467c-eaec-4b0e-bbc3-454cb1ca1fac": {
              "id": "54a3467c-eaec-4b0e-bbc3-454cb1ca1fac",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9ea386ef-9c22-49f7-bfbe-5858222e3686",
              "toNodeId": "601e80b2-8c9f-4112-bb3a-c27789558903"
            },
            "59e22407-7c93-446e-98b9-93c8da8f4c85": {
              "id": "59e22407-7c93-446e-98b9-93c8da8f4c85",
              "name": "",
              "description": "",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "fromNodeId": "a856be9c-48d8-41cc-8f69-d3340c1e06b1",
              "toNodeId": "e949f2c0-f8fe-450c-bbce-518f003752c2"
            },
            "75690a4c-0bff-42bf-9bfc-52ef4b672b63": {
              "id": "75690a4c-0bff-42bf-9bfc-52ef4b672b63",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5807a169-4818-4a46-b239-2ed60bb880af",
              "toNodeId": ""
            },
            "78ee22cd-6b02-4443-a369-b1e6ce2d087d": {
              "id": "78ee22cd-6b02-4443-a369-b1e6ce2d087d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "toNodeId": "437915c3-0bc9-4b17-af80-a970e11cecae"
            },
            "87998d92-238c-4af4-b7e8-bd2298f559a1": {
              "id": "87998d92-238c-4af4-b7e8-bd2298f559a1",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0",
              "toNodeId": "cffac4ed-dc5a-4deb-8a22-643d7e71d959"
            },
            "9288c085-4e2e-4949-83d7-79b96b6b6328": {
              "id": "9288c085-4e2e-4949-83d7-79b96b6b6328",
              "name": "",
              "description": "",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "fromNodeId": "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4",
              "toNodeId": "a856be9c-48d8-41cc-8f69-d3340c1e06b1"
            },
            "a4b457fc-6e34-4f26-ac16-c7cb493dcb7a": {
              "id": "a4b457fc-6e34-4f26-ac16-c7cb493dcb7a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "601e80b2-8c9f-4112-bb3a-c27789558903",
              "toNodeId": ""
            },
            "a66f02dd-8f1c-4f63-8d1d-da384336166e": {
              "id": "a66f02dd-8f1c-4f63-8d1d-da384336166e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8b5feaf1-cab9-4d65-9bec-00858dd6e71c",
              "toNodeId": "d846453a-8c38-489e-ae8b-188e2e950e27"
            },
            "af89127f-1487-465b-b208-3852faa918c9": {
              "id": "af89127f-1487-465b-b208-3852faa918c9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "efa7a832-554c-4e98-bd77-c72f9f2693fe",
              "toNodeId": "af13816b-ffa0-4828-b5ef-061ae719fda3"
            },
            "c1bbc78a-a6e0-4338-a15c-3e5cf18c736a": {
              "id": "c1bbc78a-a6e0-4338-a15c-3e5cf18c736a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "af13816b-ffa0-4828-b5ef-061ae719fda3",
              "toNodeId": ""
            },
            "ca3b571a-48db-485a-b637-62b840cd5df1": {
              "id": "ca3b571a-48db-485a-b637-62b840cd5df1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cffac4ed-dc5a-4deb-8a22-643d7e71d959",
              "toNodeId": "9cce9c34-c46b-417d-afbe-f23770f526c1"
            },
            "d05879c7-1bbb-495d-a89a-119cca575e1f": {
              "id": "d05879c7-1bbb-495d-a89a-119cca575e1f",
              "name": "",
              "description": "",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57",
              "fromNodeId": "e949f2c0-f8fe-450c-bbce-518f003752c2",
              "toNodeId": "dc3bf1cf-f588-44d0-b811-674f548a6187"
            },
            "d2ce041d-c7f0-4298-af86-3ca043c98cb6": {
              "id": "d2ce041d-c7f0-4298-af86-3ca043c98cb6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d846453a-8c38-489e-ae8b-188e2e950e27",
              "toNodeId": "9ea386ef-9c22-49f7-bfbe-5858222e3686"
            },
            "dee9212d-6ba0-403f-8826-69f08985f070": {
              "id": "dee9212d-6ba0-403f-8826-69f08985f070",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9ea386ef-9c22-49f7-bfbe-5858222e3686",
              "toNodeId": "804203b8-9147-40d3-9ad5-c5f2bb2eb13b"
            }
          },
          "nodes": {
            "437915c3-0bc9-4b17-af80-a970e11cecae": {
              "id": "437915c3-0bc9-4b17-af80-a970e11cecae",
              "parentNodeId": ""
            },
            "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0": {
              "id": "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0",
              "parentNodeId": ""
            },
            "5807a169-4818-4a46-b239-2ed60bb880af": {
              "id": "5807a169-4818-4a46-b239-2ed60bb880af",
              "parentNodeId": ""
            },
            "601e80b2-8c9f-4112-bb3a-c27789558903": {
              "id": "601e80b2-8c9f-4112-bb3a-c27789558903",
              "parentNodeId": ""
            },
            "804203b8-9147-40d3-9ad5-c5f2bb2eb13b": {
              "id": "804203b8-9147-40d3-9ad5-c5f2bb2eb13b",
              "parentNodeId": ""
            },
            "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
              "id": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "parentNodeId": ""
            },
            "8b5feaf1-cab9-4d65-9bec-00858dd6e71c": {
              "id": "8b5feaf1-cab9-4d65-9bec-00858dd6e71c",
              "parentNodeId": ""
            },
            "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4": {
              "id": "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57"
            },
            "9cce9c34-c46b-417d-afbe-f23770f526c1": {
              "id": "9cce9c34-c46b-417d-afbe-f23770f526c1",
              "parentNodeId": ""
            },
            "9ea386ef-9c22-49f7-bfbe-5858222e3686": {
              "id": "9ea386ef-9c22-49f7-bfbe-5858222e3686",
              "parentNodeId": ""
            },
            "a856be9c-48d8-41cc-8f69-d3340c1e06b1": {
              "id": "a856be9c-48d8-41cc-8f69-d3340c1e06b1",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57"
            },
            "af13816b-ffa0-4828-b5ef-061ae719fda3": {
              "id": "af13816b-ffa0-4828-b5ef-061ae719fda3",
              "parentNodeId": ""
            },
            "bec9701c-1f1c-4170-b788-405266227c57": {
              "id": "bec9701c-1f1c-4170-b788-405266227c57",
              "parentNodeId": ""
            },
            "cffac4ed-dc5a-4deb-8a22-643d7e71d959": {
              "id": "cffac4ed-dc5a-4deb-8a22-643d7e71d959",
              "parentNodeId": ""
            },
            "d846453a-8c38-489e-ae8b-188e2e950e27": {
              "id": "d846453a-8c38-489e-ae8b-188e2e950e27",
              "parentNodeId": ""
            },
            "dc3bf1cf-f588-44d0-b811-674f548a6187": {
              "id": "dc3bf1cf-f588-44d0-b811-674f548a6187",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57"
            },
            "e949f2c0-f8fe-450c-bbce-518f003752c2": {
              "id": "e949f2c0-f8fe-450c-bbce-518f003752c2",
              "parentNodeId": "bec9701c-1f1c-4170-b788-405266227c57"
            },
            "efa7a832-554c-4e98-bd77-c72f9f2693fe": {
              "id": "efa7a832-554c-4e98-bd77-c72f9f2693fe",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "437915c3-0bc9-4b17-af80-a970e11cecae": {
            "nodeId": "437915c3-0bc9-4b17-af80-a970e11cecae",
            "name": "Extract Argument",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "lookup-vuln\\s+{{argument:/.*/}}",
              "expressions": [
                {
                  "type": "text",
                  "value": "lookup-vuln\\s+"
                },
                {
                  "type": "variable",
                  "value": {
                    "ident": "argument",
                    "regex": ".*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[text]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0": {
            "nodeId": "45d927a2-3ef9-4e92-8f4e-80ad9af52bd0",
            "name": "Were Multiple Vulnerability Results Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "87998d92-238c-4af4-b7e8-bd2298f559a1",
              "stepControlParams": [
                {
                  "edgeId": "87998d92-238c-4af4-b7e8-bd2298f559a1",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "0a9405d6-fd98-4087-bed8-f61b0093ec5a",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "d846453a-8c38-489e-ae8b-188e2e950e27.search_results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[d846453a-8c38-489e-ae8b-188e2e950e27].[search_results]}}) == 1"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "5807a169-4818-4a46-b239-2ed60bb880af": {
            "nodeId": "5807a169-4818-4a46-b239-2ed60bb880af",
            "name": "Post No Vulnerability Matches Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "No results matching `{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}` were found in Rapid7's Vulnerability Database.\n",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "601e80b2-8c9f-4112-bb3a-c27789558903": {
            "nodeId": "601e80b2-8c9f-4112-bb3a-c27789558903",
            "name": "Post VulnDB Lookup Failed",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "An error occurred while searching Rapid7 VulnDB - see the following URL for more information: {{[$job].[URL]}}",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "804203b8-9147-40d3-9ad5-c5f2bb2eb13b": {
            "nodeId": "804203b8-9147-40d3-9ad5-c5f2bb2eb13b",
            "name": "Were Vulnerabilities Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "4b055f08-aecb-4092-9cb8-3348e1e56cfa",
              "stepControlParams": [
                {
                  "edgeId": "4b055f08-aecb-4092-9cb8-3348e1e56cfa",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "2ac9b486-da27-4230-be4c-ea37d0764bca",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "d846453a-8c38-489e-ae8b-188e2e950e27.search_results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[d846453a-8c38-489e-ae8b-188e2e950e27].[search_results]}}) == 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
            "nodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
            "name": "lookup-vuln Trigger",
            "description": "Trigger this workflow by entering a Slack command in the following format:\n\"@Rapid7 InsightConnect lookup-vuln CVE-XXXX-XXXX\"\nOR\n\"@Rapid7 InsightConnect lookup-vuln heartbleed\"",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "{{$workflow.[Channel]}}",
                "matchText": "lookup-vuln",
                "type": "any"
              }
            },
            "triggerId": "7e7d1d3f-f2ec-42f8-b538-3c39c72d9fa1",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "8b5feaf1-cab9-4d65-9bec-00858dd6e71c": {
            "nodeId": "8b5feaf1-cab9-4d65-9bec-00858dd6e71c",
            "name": "Searching Notification",
            "type": "action_chatops",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_Searching for `{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}`..._",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4": {
            "nodeId": "8fbba8e7-c150-4d8a-a4ed-c077a6078ae4",
            "name": "Get Basename",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{basename:/[^\\/]*$/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "basename",
                    "regex": "[^\\/]*$"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[bec9701c-1f1c-4170-b788-405266227c57].[$item].[link]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "9cce9c34-c46b-417d-afbe-f23770f526c1": {
            "nodeId": "9cce9c34-c46b-417d-afbe-f23770f526c1",
            "name": "Execute VulnDB Results Processing",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "ca3b571a-48db-485a-b637-62b840cd5df1",
                "0a9405d6-fd98-4087-bed8-f61b0093ec5a"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "9ea386ef-9c22-49f7-bfbe-5858222e3686": {
            "nodeId": "9ea386ef-9c22-49f7-bfbe-5858222e3686",
            "name": "Did VulnDB Search Succeed",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "dee9212d-6ba0-403f-8826-69f08985f070",
              "stepControlParams": [
                {
                  "edgeId": "54a3467c-eaec-4b0e-bbc3-454cb1ca1fac",
                  "expression": {
                    "left": {
                      "name": "d846453a-8c38-489e-ae8b-188e2e950e27.$success",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[d846453a-8c38-489e-ae8b-188e2e950e27].[$success]}} == false"
                },
                {
                  "edgeId": "dee9212d-6ba0-403f-8826-69f08985f070",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a856be9c-48d8-41cc-8f69-d3340c1e06b1": {
            "nodeId": "a856be9c-48d8-41cc-8f69-d3340c1e06b1",
            "name": "Get VulnDB Contents for Result",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.1.0/icon.png"
            },
            "identifier": "get_content",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "identifier": "{{[8fbba8e7-c150-4d8a-a4ed-c077a6078ae4].[basename]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "identifier": {
                  "description": "Rapid7 vulnerability/module identifier",
                  "order": 1,
                  "title": "Identifier",
                  "type": "string"
                }
              },
              "required": [
                "identifier"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "content": {
                  "properties": {
                    "alternate_ids": {
                      "description": "List of alternative identifiers for the vulnerability",
                      "order": 12,
                      "title": "Alternative Identifiers",
                      "type": "string"
                    },
                    "architectures": {
                      "description": "List of applicable architectures for the module",
                      "order": 4,
                      "title": "architectures",
                      "type": "string"
                    },
                    "authors": {
                      "description": "List of module authors",
                      "order": 7,
                      "title": "Authors",
                      "type": "string"
                    },
                    "content_type": {
                      "description": "Type of returned content for module or vulnerability",
                      "order": 3,
                      "title": "Content type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Brief summary of the returned content",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 5,
                      "title": "Published_at",
                      "type": "string"
                    },
                    "rank": {
                      "description": "Rank of module",
                      "order": 8,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "references": {
                      "description": "List of references",
                      "order": 6,
                      "title": "References",
                      "type": "string"
                    },
                    "reliability": {
                      "description": "Reliability of module",
                      "order": 9,
                      "title": "Reliability",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity of vulnerability",
                      "order": 10,
                      "title": "Severity",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 11,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of Vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                }
              },
              "properties": {
                "content_result": {
                  "$ref": "#/definitions/content",
                  "description": "Content record for the vulnerability or module",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "content_result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "af13816b-ffa0-4828-b5ef-061ae719fda3": {
            "nodeId": "af13816b-ffa0-4828-b5ef-061ae719fda3",
            "name": "Post VulnDB Workflow Complete",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Workflow complete!",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "bec9701c-1f1c-4170-b788-405266227c57": {
            "nodeId": "bec9701c-1f1c-4170-b788-405266227c57",
            "name": "Process VulnDB Results",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "0f7040a8-5843-4f32-99d1-1ff9197e28db",
              "nextEdgeId": "180c3182-39c4-4830-a611-40bb2b80195a",
              "repeatVariable": "{{[d846453a-8c38-489e-ae8b-188e2e950e27].[search_results]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "cffac4ed-dc5a-4deb-8a22-643d7e71d959": {
            "nodeId": "cffac4ed-dc5a-4deb-8a22-643d7e71d959",
            "name": "Post Multiple Vulnerability Results Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "There are multiple search results for `{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}` in Rapid7's vulnerability database. Click one of the links in this thread for more information. \n\n_You can also try a more specific search term for more information on one vulnerability. For example, you may try `{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}} Ubuntu` or `{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}} Chrome`._",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "d846453a-8c38-489e-ae8b-188e2e950e27": {
            "nodeId": "d846453a-8c38-489e-ae8b-188e2e950e27",
            "name": "Search Vuln DB",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.1.0/icon.png"
            },
            "identifier": "search_db",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "database": "Vulnerability Database",
                "search": "{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "database": {
                  "description": "Name of the database",
                  "enum": [
                    "Vulnerability Database",
                    "Metasploit Modules"
                  ],
                  "order": 1,
                  "title": "Database",
                  "type": "string"
                },
                "search": {
                  "description": "Search parameter for database",
                  "order": 2,
                  "title": "Search",
                  "type": "string"
                }
              },
              "required": [
                "database",
                "search"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "search_result": {
                  "properties": {
                    "identifier": {
                      "description": "Content identifier for module or vulnerability",
                      "order": 4,
                      "title": "Content Identifier",
                      "type": "string"
                    },
                    "link": {
                      "description": "Link to vulnerability",
                      "order": 2,
                      "title": "Link",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 3,
                      "title": "Published At",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 5,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Search Result",
                  "type": "object"
                }
              },
              "properties": {
                "results_found": {
                  "description": "Will return false if no results are found",
                  "order": 2,
                  "title": "Results Found",
                  "type": "boolean"
                },
                "search_results": {
                  "description": "Vulnerability and exploits found",
                  "items": {
                    "$ref": "#/definitions/search_result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "required": [
                "results_found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "dc3bf1cf-f588-44d0-b811-674f548a6187": {
            "nodeId": "dc3bf1cf-f588-44d0-b811-674f548a6187",
            "name": "Link Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[bec9701c-1f1c-4170-b788-405266227c57].[$item].[link]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e949f2c0-f8fe-450c-bbce-518f003752c2": {
            "nodeId": "e949f2c0-f8fe-450c-bbce-518f003752c2",
            "name": "Post VulnDB Result Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_*Vulnerability found:*_\n *Title*: `{{[a856be9c-48d8-41cc-8f69-d3340c1e06b1].[content_result].[title]}}`\n *Severity*: `{{[a856be9c-48d8-41cc-8f69-d3340c1e06b1].[content_result].[severity]}}`\n *Published*: \n`{{[a856be9c-48d8-41cc-8f69-d3340c1e06b1].[content_result].[published_at]}}`\n*Solutions*: \n```{{[a856be9c-48d8-41cc-8f69-d3340c1e06b1].[content_result].[solutions]}}```\n*Description*:\n```{{[a856be9c-48d8-41cc-8f69-d3340c1e06b1].[content_result].[description]}}```\n*Search Result(s)*: https://rapid7.com/db/vulnerabilities/{{[bec9701c-1f1c-4170-b788-405266227c57].[$item].[identifier]}}\n\n",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "efa7a832-554c-4e98-bd77-c72f9f2693fe": {
            "nodeId": "efa7a832-554c-4e98-bd77-c72f9f2693fe",
            "name": "Final Vulnerability Report Findings",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Trigger\n_{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[user]}}_ started Vuln Check from Slack workflow with search term _{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}_ in the _{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}_ channel at _{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[timestamp]}}_. \n\n# Search Results\n_{{[437915c3-0bc9-4b17-af80-a970e11cecae].[argument]}}_ yielded the following search results in Rapid7's Vulnerability Database:\n{{#each [d846453a-8c38-489e-ae8b-188e2e950e27].[search_results]}}\n{{this.[title]}}\n{{/each}}\n\n# Outcome\nWorkflow posted vulnerability details to Slack channel _{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel]}}_."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Rapid7",
          "Slack",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channel": {
                "type": "string",
                "description": "The Slack channel name in your environment where the workflow should be triggered"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "7e7d1d3f-f2ec-42f8-b538-3c39c72d9fa1",
        "name": "lookup-vuln Trigger",
        "description": "Trigger this workflow by entering a Slack command in the following format:\n\"@Rapid7 InsightConnect lookup-vuln CVE-XXXX-XXXX\"\nOR\n\"@Rapid7 InsightConnect lookup-vuln heartbleed\"",
        "input": {
          "matchChannel": "{{$workflow.[Channel]}}",
          "matchText": "lookup-vuln",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}