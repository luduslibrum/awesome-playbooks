{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:44:12.041618742Z",
    "workflowVersions": [
      {
        "name": "Enrich and Contain Suspicious Users from InsightIDR UBA Alerts with Netskope and Active Directory",
        "type": "runnable",
        "version": "",
        "description": "# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Workflow Control Panel in InsightConnect. Create or select Connections and rename the Workflow as necessary.\n\n## Usage\n\nThis workflow can be paired to any InsightIDR UBA Alerts. It can be set to run automatically upon UBA Alert generation, and/or manually from the Take Action dropdown of an Investigation in InsightIDR. Once you've imported the workflow into InsightConnect, refer to the Manual and Automatic trigger instructions on the Workflow Details tab of your Workflow Control panel.\n\nWhen this workflow runs, it will parse out the user(s) associated with the alert and check for their Netskope User Confidence Index score by email address. If found, the score will be presented in an Artifact, and you will be presented with a choice in the form of a Human Decision step - whether you would like to force a password reset for that user in Active Directory LDAP, or do nothing. If you do not make a choice within 10 minutes, the workflow will automatically do nothing; this setting can be changed within the Workflow Builder when viewing the \"Password Decision\" step inside the \"Get User Confidence Scores\" Loop.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|\n|----|----|\n|Datetime|3.0.0|\n|Netskope|1.0.1|\n|Active Directory LDAP|5.3.3|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n",
        "graph": {
          "edges": {
            "0c465b26-712a-4b67-9aae-6b69d7f64e46": {
              "id": "0c465b26-712a-4b67-9aae-6b69d7f64e46",
              "name": "No",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "e6e07e7d-b44e-4e58-b369-59313e1371a9",
              "toNodeId": "83e8ae20-b196-4548-a6c4-dc7df08082a8"
            },
            "176d77a9-69bc-465c-a3bd-fa603580c268": {
              "id": "176d77a9-69bc-465c-a3bd-fa603580c268",
              "name": "Yes",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "e6e07e7d-b44e-4e58-b369-59313e1371a9",
              "toNodeId": "05333c19-4fbd-4cc0-a013-59e0744e71b8"
            },
            "1a3f0c49-c644-4d95-b4e2-81c7062f7197": {
              "id": "1a3f0c49-c644-4d95-b4e2-81c7062f7197",
              "name": "Do Nothing",
              "description": "If chosen, InsightConnect will do nothing.",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad",
              "toNodeId": "41b07ea2-232f-424a-b476-6e904c31bf06"
            },
            "2eba9652-3226-4262-9856-bdd00f7c13d8": {
              "id": "2eba9652-3226-4262-9856-bdd00f7c13d8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "531d551d-7d06-4a91-b414-2d1213b0788c",
              "toNodeId": "0b823b40-9ecf-4eff-8942-4c1549e2b4b8"
            },
            "40aedb53-71b8-4396-b222-c0ee07428216": {
              "id": "40aedb53-71b8-4396-b222-c0ee07428216",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "43697657-9987-4ae5-acf7-e1ee15024bbc",
              "toNodeId": "e6e07e7d-b44e-4e58-b369-59313e1371a9"
            },
            "4c520233-c7f4-4c01-991d-67d265d655c3": {
              "id": "4c520233-c7f4-4c01-991d-67d265d655c3",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "2b03500a-aa5f-4a90-af44-bd555588e69c",
              "toNodeId": ""
            },
            "751cb08c-8612-4881-bbe8-07601f217392": {
              "id": "751cb08c-8612-4881-bbe8-07601f217392",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "776ea831-d943-4f06-972a-3aa640d37040",
              "toNodeId": "2f5eff6f-8294-4fac-9b5f-2552ec5361d1"
            },
            "7a752ee8-0c21-4e4b-8888-d287587588de": {
              "id": "7a752ee8-0c21-4e4b-8888-d287587588de",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "toNodeId": "776ea831-d943-4f06-972a-3aa640d37040"
            },
            "808517a8-6e18-4874-9681-c7776b4c41b0": {
              "id": "808517a8-6e18-4874-9681-c7776b4c41b0",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "2f5eff6f-8294-4fac-9b5f-2552ec5361d1",
              "toNodeId": "bfbc3357-b672-43c2-88fa-8be2317576aa"
            },
            "99b5eea3-dd42-4909-982f-a4f5dbdd39b6": {
              "id": "99b5eea3-dd42-4909-982f-a4f5dbdd39b6",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "bfbc3357-b672-43c2-88fa-8be2317576aa",
              "toNodeId": "43697657-9987-4ae5-acf7-e1ee15024bbc"
            },
            "9f2c9024-ce21-4415-9adc-054e1c95253c": {
              "id": "9f2c9024-ce21-4415-9adc-054e1c95253c",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "5a6b9fd0-e429-4e23-9566-ddb34cc3c008",
              "toNodeId": ""
            },
            "c064bd54-82ee-402c-8de0-2ac0d936f249": {
              "id": "c064bd54-82ee-402c-8de0-2ac0d936f249",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "41b07ea2-232f-424a-b476-6e904c31bf06",
              "toNodeId": ""
            },
            "c4c85714-f3b7-4c4a-83c0-5a31eb4d180c": {
              "id": "c4c85714-f3b7-4c4a-83c0-5a31eb4d180c",
              "name": "Force Password Reset",
              "description": "If chosen, InsightConnect will force a password reset automatically using Active Directory LDAP.",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad",
              "toNodeId": "b4d76cce-0a0a-46f8-87c2-90e894204aa5"
            },
            "e5c6b042-c61d-4137-b613-41f81cb04bec": {
              "id": "e5c6b042-c61d-4137-b613-41f81cb04bec",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "toNodeId": ""
            },
            "f56eb81e-a924-4491-af49-88f6554795eb": {
              "id": "f56eb81e-a924-4491-af49-88f6554795eb",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "83e8ae20-b196-4548-a6c4-dc7df08082a8",
              "toNodeId": ""
            },
            "f6190f16-51e9-422a-a0ed-c4ae54bc0975": {
              "id": "f6190f16-51e9-422a-a0ed-c4ae54bc0975",
              "name": "Success",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "9deaa517-7091-483d-a7f3-c3c8f19095dc",
              "toNodeId": "5a6b9fd0-e429-4e23-9566-ddb34cc3c008"
            },
            "fdfdc117-b65a-49d5-b6fa-1a2445eb82f0": {
              "id": "fdfdc117-b65a-49d5-b6fa-1a2445eb82f0",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "b4d76cce-0a0a-46f8-87c2-90e894204aa5",
              "toNodeId": "9deaa517-7091-483d-a7f3-c3c8f19095dc"
            },
            "fe8b7bb1-d2f0-4608-b11a-4fb987570b46": {
              "id": "fe8b7bb1-d2f0-4608-b11a-4fb987570b46",
              "name": "",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "05333c19-4fbd-4cc0-a013-59e0744e71b8",
              "toNodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad"
            },
            "feaf45a8-75fe-47c5-82b6-2bc1573877da": {
              "id": "feaf45a8-75fe-47c5-82b6-2bc1573877da",
              "name": "Failure",
              "description": "",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "fromNodeId": "9deaa517-7091-483d-a7f3-c3c8f19095dc",
              "toNodeId": "2b03500a-aa5f-4a90-af44-bd555588e69c"
            },
            "ff2dd462-7ee5-403b-b158-df1644d4e662": {
              "id": "ff2dd462-7ee5-403b-b158-df1644d4e662",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0b823b40-9ecf-4eff-8942-4c1549e2b4b8",
              "toNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            }
          },
          "nodes": {
            "05333c19-4fbd-4cc0-a013-59e0744e71b8": {
              "id": "05333c19-4fbd-4cc0-a013-59e0744e71b8",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "0b823b40-9ecf-4eff-8942-4c1549e2b4b8": {
              "id": "0b823b40-9ecf-4eff-8942-4c1549e2b4b8",
              "parentNodeId": ""
            },
            "2b03500a-aa5f-4a90-af44-bd555588e69c": {
              "id": "2b03500a-aa5f-4a90-af44-bd555588e69c",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "2f5eff6f-8294-4fac-9b5f-2552ec5361d1": {
              "id": "2f5eff6f-8294-4fac-9b5f-2552ec5361d1",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "41b07ea2-232f-424a-b476-6e904c31bf06": {
              "id": "41b07ea2-232f-424a-b476-6e904c31bf06",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "43697657-9987-4ae5-acf7-e1ee15024bbc": {
              "id": "43697657-9987-4ae5-acf7-e1ee15024bbc",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "4ce8d9ce-a5ff-4595-a121-8b9803f775ad": {
              "id": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "531d551d-7d06-4a91-b414-2d1213b0788c": {
              "id": "531d551d-7d06-4a91-b414-2d1213b0788c",
              "parentNodeId": ""
            },
            "53d85cd7-7a72-4fd0-8647-d76ed9594132": {
              "id": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
              "parentNodeId": ""
            },
            "5a6b9fd0-e429-4e23-9566-ddb34cc3c008": {
              "id": "5a6b9fd0-e429-4e23-9566-ddb34cc3c008",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "776ea831-d943-4f06-972a-3aa640d37040": {
              "id": "776ea831-d943-4f06-972a-3aa640d37040",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "83e8ae20-b196-4548-a6c4-dc7df08082a8": {
              "id": "83e8ae20-b196-4548-a6c4-dc7df08082a8",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "9deaa517-7091-483d-a7f3-c3c8f19095dc": {
              "id": "9deaa517-7091-483d-a7f3-c3c8f19095dc",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "b4d76cce-0a0a-46f8-87c2-90e894204aa5": {
              "id": "b4d76cce-0a0a-46f8-87c2-90e894204aa5",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "bfbc3357-b672-43c2-88fa-8be2317576aa": {
              "id": "bfbc3357-b672-43c2-88fa-8be2317576aa",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            },
            "e6e07e7d-b44e-4e58-b369-59313e1371a9": {
              "id": "e6e07e7d-b44e-4e58-b369-59313e1371a9",
              "parentNodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132"
            }
          }
        },
        "steps": {
          "05333c19-4fbd-4cc0-a013-59e0744e71b8": {
            "nodeId": "05333c19-4fbd-4cc0-a013-59e0744e71b8",
            "name": "Netskope Lookup Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect attempted to pull the Netskope User Confidence Index for `{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[emails].[0]}}`, and the search was successful.\n\nThis user's most recent Confidence Index is `{{[43697657-9987-4ae5-acf7-e1ee15024bbc].[confidences].[0].[confidenceScore]}}`. Reference [this Netskope article](https://docs.netskope.com/en/behavior-analytics-user-confidence-index.html) for more information about the User Confidence Index score."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0b823b40-9ecf-4eff-8942-4c1549e2b4b8": {
            "nodeId": "0b823b40-9ecf-4eff-8942-4c1549e2b4b8",
            "name": "Alert Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Investigation Overview: {{[531d551d-7d06-4a91-b414-2d1213b0788c].[name]}}\n\nInvestigation created at: {{[531d551d-7d06-4a91-b414-2d1213b0788c].[timestamp]}}\n\nInvestigation link: {{[531d551d-7d06-4a91-b414-2d1213b0788c].[link]}}\n\nInvestigation ID: {{[531d551d-7d06-4a91-b414-2d1213b0788c].[investigationId]}}\n\n{{#each [531d551d-7d06-4a91-b414-2d1213b0788c].[actors].[users]}}\nUser involved: {{name}}\n{{/each}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "2b03500a-aa5f-4a90-af44-bd555588e69c": {
            "nodeId": "2b03500a-aa5f-4a90-af44-bd555588e69c",
            "name": "Password Not Reset",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect attempted to force a password reset for the user `{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[distinguishedName]}}`, but the action was not successful.\n\nTo inspect the error further, navigate to the \"All Outputs\" tab of the Job, locate the \"Force Password Reset\" action and select the \"Log\" tab. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "2f5eff6f-8294-4fac-9b5f-2552ec5361d1": {
            "nodeId": "2f5eff6f-8294-4fac-9b5f-2552ec5361d1",
            "name": "Subtract 30 Days",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "subtract_from_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "base_time": "{{[776ea831-d943-4f06-972a-3aa640d37040].[datetime]}}",
                "days": 30,
                "hours": 0,
                "minutes": 0,
                "months": 0,
                "seconds": 0,
                "years": 0
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "base_time": {
                  "description": "Datetime from which to subtract from",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Base Time",
                  "type": "string"
                },
                "days": {
                  "default": 0,
                  "description": "How many days to subtract from the specified Datetime",
                  "order": 4,
                  "title": "Days",
                  "type": "integer"
                },
                "hours": {
                  "default": 0,
                  "description": "How many hours to subtract from the specified Datetime",
                  "order": 5,
                  "title": "Hours",
                  "type": "integer"
                },
                "minutes": {
                  "default": 0,
                  "description": "How many minutes to subtract from the specified Datetime",
                  "order": 6,
                  "title": "Minutes",
                  "type": "integer"
                },
                "months": {
                  "default": 0,
                  "description": "How many months to subtract from the specified Datetime",
                  "order": 3,
                  "title": "Months",
                  "type": "integer"
                },
                "seconds": {
                  "default": 0,
                  "description": "How many seconds to subtract from the specified Datetime",
                  "order": 7,
                  "title": "Seconds",
                  "type": "integer"
                },
                "years": {
                  "default": 0,
                  "description": "How many years to subtract from the specified Datetime",
                  "order": 2,
                  "title": "Years",
                  "type": "integer"
                }
              },
              "required": [
                "days",
                "hours",
                "minutes",
                "seconds",
                "base_time",
                "years",
                "months"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "date": {
                  "description": "The Datetime after subtraction",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Date",
                  "type": "string"
                }
              },
              "required": [
                "date"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "41b07ea2-232f-424a-b476-6e904c31bf06": {
            "nodeId": "41b07ea2-232f-424a-b476-6e904c31bf06",
            "name": "No Password Reset",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "You've chosen not to force a password reset for the user `{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[distinguishedName]}}`."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "43697657-9987-4ae5-acf7-e1ee15024bbc": {
            "nodeId": "43697657-9987-4ae5-acf7-e1ee15024bbc",
            "name": "Get User Confidence Index",
            "type": "action",
            "plugin": {
              "name": "Netskope",
              "slugVendor": "rapid7",
              "slugName": "netskope",
              "slugVersion": "1.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/netskope/1.0.1/icon.png"
            },
            "identifier": "get_single_user_confidence_index",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "fromTime": "{{[bfbc3357-b672-43c2-88fa-8be2317576aa].[epoch]}}",
                "username": "{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[emails].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "fromTime": {
                  "description": "Numeric value representing the time in epoch timestamp from the beginning of which confidence score values are taken until now (in miliseconds)",
                  "order": 2,
                  "title": "From Time",
                  "type": "integer"
                },
                "username": {
                  "description": "Username of an existing user",
                  "order": 1,
                  "title": "Username",
                  "type": "string"
                }
              },
              "required": [
                "username",
                "fromTime"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "confidence": {
                  "properties": {
                    "confidenceScore": {
                      "description": "Numeric value representing user's confidence score",
                      "order": 2,
                      "title": "Confidence Score",
                      "type": "integer"
                    },
                    "start": {
                      "description": "Numeric value representing epoch timestamp",
                      "order": 1,
                      "title": "Start",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "start",
                    "confidenceScore"
                  ],
                  "title": "Confidence",
                  "type": "object"
                }
              },
              "properties": {
                "confidences": {
                  "description": "Contains User Confidence Index with starting score and confidence score",
                  "items": {
                    "$ref": "#/definitions/confidence"
                  },
                  "order": 2,
                  "title": "Confidences",
                  "type": "array"
                },
                "userId": {
                  "description": "Identifier of user",
                  "order": 1,
                  "title": "User ID",
                  "type": "string"
                }
              },
              "required": [
                "confidences",
                "userId"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4ce8d9ce-a5ff-4595-a121-8b9803f775ad": {
            "nodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad",
            "name": "Password Decision",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "notifications": {
                "artifactIds": null,
                "userIdsForEmail": []
              },
              "stepControlParams": [
                {
                  "edgeId": "1a3f0c49-c644-4d95-b4e2-81c7062f7197",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad"
                },
                {
                  "edgeId": "c4c85714-f3b7-4c4a-83c0-5a31eb4d180c",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "4ce8d9ce-a5ff-4595-a121-8b9803f775ad"
                }
              ],
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "1a3f0c49-c644-4d95-b4e2-81c7062f7197"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "531d551d-7d06-4a91-b414-2d1213b0788c": {
            "nodeId": "531d551d-7d06-4a91-b414-2d1213b0788c",
            "name": "InsightIDR UBA Alert Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "10e748cd-64a8-484e-a41e-602f88ec3143",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "53d85cd7-7a72-4fd0-8647-d76ed9594132": {
            "nodeId": "53d85cd7-7a72-4fd0-8647-d76ed9594132",
            "name": "Get User Confidence Scores",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "7a752ee8-0c21-4e4b-8888-d287587588de",
              "nextEdgeId": "e5c6b042-c61d-4137-b613-41f81cb04bec",
              "repeatVariable": "{{[531d551d-7d06-4a91-b414-2d1213b0788c].[actors].[users]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "5a6b9fd0-e429-4e23-9566-ddb34cc3c008": {
            "nodeId": "5a6b9fd0-e429-4e23-9566-ddb34cc3c008",
            "name": "Password Reset Successfully",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect was able to successfully force a password reset for the user `{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[distinguishedName]}}`."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "776ea831-d943-4f06-972a-3aa640d37040": {
            "nodeId": "776ea831-d943-4f06-972a-3aa640d37040",
            "name": "Get Current Time",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "83e8ae20-b196-4548-a6c4-dc7df08082a8": {
            "nodeId": "83e8ae20-b196-4548-a6c4-dc7df08082a8",
            "name": "Netskope Lookup Unsuccessful",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect attempted to pull the Netskope User Confidence Index for `{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[emails].[0]}}`, but the search was not successful. \n\nTo inspect the error further, navigate to the \"All Outputs\" tab of this Job, locate the \"Get User Confidence Index\" step, and view the Log tab."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "9deaa517-7091-483d-a7f3-c3c8f19095dc": {
            "nodeId": "9deaa517-7091-483d-a7f3-c3c8f19095dc",
            "name": "Password Reset Check",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "feaf45a8-75fe-47c5-82b6-2bc1573877da",
              "stepControlParams": [
                {
                  "edgeId": "f6190f16-51e9-422a-a0ed-c4ae54bc0975",
                  "expression": {
                    "left": {
                      "name": "b4d76cce-0a0a-46f8-87c2-90e894204aa5.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[b4d76cce-0a0a-46f8-87c2-90e894204aa5].[success]}}=true"
                },
                {
                  "edgeId": "feaf45a8-75fe-47c5-82b6-2bc1573877da",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b4d76cce-0a0a-46f8-87c2-90e894204aa5": {
            "nodeId": "b4d76cce-0a0a-46f8-87c2-90e894204aa5",
            "name": "Force Password Reset",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "5.3.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/5.3.3/icon.png"
            },
            "identifier": "force_password_reset",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "distinguished_name": "{{[53d85cd7-7a72-4fd0-8647-d76ed9594132].[$item].[distinguishedName]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "distinguished_name": {
                  "description": "The distinguished name of the user who will be forced to reset",
                  "order": 1,
                  "title": "Distinguished Name",
                  "type": "string"
                }
              },
              "required": [
                "distinguished_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Operation status",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "bfbc3357-b672-43c2-88fa-8be2317576aa": {
            "nodeId": "bfbc3357-b672-43c2-88fa-8be2317576aa",
            "name": "Convert to Epoch",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "epoch_from_date",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "datetime": "{{[2f5eff6f-8294-4fac-9b5f-2552ec5361d1].[date]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Date in RFC3339 format",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                }
              },
              "required": [
                "datetime"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "epoch": {
                  "description": "Epoch after conversion",
                  "order": 1,
                  "title": "Epoch",
                  "type": "integer"
                }
              },
              "required": [
                "epoch"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e6e07e7d-b44e-4e58-b369-59313e1371a9": {
            "nodeId": "e6e07e7d-b44e-4e58-b369-59313e1371a9",
            "name": "Check for Success",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "176d77a9-69bc-465c-a3bd-fa603580c268",
              "stepControlParams": [
                {
                  "edgeId": "176d77a9-69bc-465c-a3bd-fa603580c268",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "0c465b26-712a-4b67-9aae-6b69d7f64e46",
                  "expression": {
                    "left": {
                      "name": "43697657-9987-4ae5-acf7-e1ee15024bbc.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[43697657-9987-4ae5-acf7-e1ee15024bbc].[$success]}} = false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Endpoint Detection & Response",
          "Identity & Access Management"
        ],
        "humanCostSeconds": 1200,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "10e748cd-64a8-484e-a41e-602f88ec3143",
        "name": "InsightIDR UBA Alert Trigger",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}