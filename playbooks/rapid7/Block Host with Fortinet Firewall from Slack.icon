{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:32:25.921634227Z",
    "workflowVersions": [
      {
        "name": "Block Host with Fortinet Firewall from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow blocks or unblocks a host with Fortinet Firewall via Slack command and reports information back to Slack.\n\nSample Slack Trigger Commands:\n\n`@Rapid7 InsightConnect block-host 198.51.100.100/32`\n\n`@Rapid7 InsightConnect block-host 198.51.100.0/24`\n\n`@Rapid7 InsightConnect block-host example.com`\n\n`@Rapid7 InsightConnect unblock-host 198.51.100.100/32`\n\n`@Rapid7 InsightConnect unblock-host 198.51.100.0/24`\n\n`@Rapid7 InsightConnect unblock-host example.com`\n\n# Key Features\n\n* Block and unblock hosts \n\n# Requirements\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* A Fortigate firewall\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are three parameters you will need to configure in order to complete setup of your workflow:\n\n* Channel: The Slack channel name in your environment where the workflow should be triggered\n* Group Name: The group name for blocked IPv4 addresses and domains\n* IPv6 Group Name: The group name for blocked IPv6 addresses\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n \nAn optional whitelist can be added in the `Create Address Object` step. To add this list add IP's or domains in the following format `[\"198.51.100.100\", \"example.com\", \"198.51.100.1\"]` and they will not be blocked.\n\nBy default, this workflow will automatically skip blocking private IP addresses, if you’d like to block these as well, set `Skip RFC 1918` option to false in the `Create Address Object` step.\n\nAfter configuring the parameters, activate the workflow in order to trigger it.\n\n### Usage\n\n*This workflow will only trigger in the channel specified in the workflow parameters.*\n\nTo run the workflow, send a message to the specified Slack channel starting with the command `@Rapid7 InsightConnect block-host` or `@Rapid7 InsightConnect unblock-host`.\n\nYour chatbot will reply when the workflow completes.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Fortinet FortiGate|6.0.0|4|\n\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.0 - Leverage workflow parameters feature | Update documentation | Update Fortinet FortiGate plugin to version 6.0.0\n* 1.1.1 - Update plugins to latest version\n* 1.1.0 - Update workflow to handle block requests for address that already exists | Update workflow to send Slack message when a job failure has occurred\n* 1.0.2 - Pass channel name from trigger to all subsequent steps so user only has to configure channel once\n* 1.0.1 - Help amendments\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Fortigate](https://www.fortinet.com/products/next-generation-firewall.html)\n* [Rapid7 Slack Chatbot](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n",
        "graph": {
          "edges": {
            "064f5acb-9581-4618-bb58-145547b4a515": {
              "id": "064f5acb-9581-4618-bb58-145547b4a515",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77",
              "toNodeId": "936ed547-527b-4184-85ea-f3ccfb4466b1"
            },
            "1005a369-061f-45fd-b405-2a323bfb2973": {
              "id": "1005a369-061f-45fd-b405-2a323bfb2973",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3",
              "toNodeId": ""
            },
            "11ec5444-eceb-47b5-b4e0-20b31c9eaa42": {
              "id": "11ec5444-eceb-47b5-b4e0-20b31c9eaa42",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "769171ab-e338-49db-9057-53f6da19c37a",
              "toNodeId": "d3ce49c3-79ee-4a9d-bec2-ddf62866a359"
            },
            "17ef140b-006f-4490-ae2a-eecaf17d344d": {
              "id": "17ef140b-006f-4490-ae2a-eecaf17d344d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4cff4374-3354-4e3a-9143-dbf60966c341",
              "toNodeId": "f555d0c4-ff83-4210-bc11-97fa8720b790"
            },
            "18feee59-c202-4aa2-a5fc-977c4e7ded83": {
              "id": "18feee59-c202-4aa2-a5fc-977c4e7ded83",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "decb42d6-f84f-4d7a-9fb4-990e955b7c5e",
              "toNodeId": "ebaa672f-650f-41f0-bb16-e3f6c56c0aca"
            },
            "1b08012e-5839-4c00-9a2c-e1773c6b6053": {
              "id": "1b08012e-5839-4c00-9a2c-e1773c6b6053",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9fed5588-2be5-4114-928e-1eb0f8843c4e",
              "toNodeId": "af855b2c-0b66-4d0d-961f-06e32a91d591"
            },
            "1d891611-5a5e-45e0-8f42-cf19aa7cc95c": {
              "id": "1d891611-5a5e-45e0-8f42-cf19aa7cc95c",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f555d0c4-ff83-4210-bc11-97fa8720b790",
              "toNodeId": "e1214265-784e-4df2-85c6-43a20adf5ccc"
            },
            "224c6579-4e83-443e-9907-24b322031c45": {
              "id": "224c6579-4e83-443e-9907-24b322031c45",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e1214265-784e-4df2-85c6-43a20adf5ccc",
              "toNodeId": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8"
            },
            "22f9c496-de33-43c2-b9be-fbc93230dd8d": {
              "id": "22f9c496-de33-43c2-b9be-fbc93230dd8d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1ffdf0eb-caa2-44fc-81c5-eeea3960369b",
              "toNodeId": ""
            },
            "2722203f-23eb-4457-b3e4-4db68a62369d": {
              "id": "2722203f-23eb-4457-b3e4-4db68a62369d",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7d17e566-e05c-449e-8c6c-7c20ccae3455",
              "toNodeId": "b3aeb54a-4919-48dd-907b-a97947f0fa4c"
            },
            "28f57779-b7fd-41f7-ae5d-44edb6ac54ab": {
              "id": "28f57779-b7fd-41f7-ae5d-44edb6ac54ab",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "26a9a0e4-3375-4229-b698-81f045ae8af8",
              "toNodeId": "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77"
            },
            "3b4b51f8-ceab-44e1-ab40-be277b85c25c": {
              "id": "3b4b51f8-ceab-44e1-ab40-be277b85c25c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a457570c-0e21-4e1d-b062-ace6b371b5f8",
              "toNodeId": ""
            },
            "416bf4be-093b-4be8-8c68-7876cbbb8249": {
              "id": "416bf4be-093b-4be8-8c68-7876cbbb8249",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "26a9a0e4-3375-4229-b698-81f045ae8af8",
              "toNodeId": "9fed5588-2be5-4114-928e-1eb0f8843c4e"
            },
            "441f9ff2-6891-4fc8-9e18-8c7b48be1e80": {
              "id": "441f9ff2-6891-4fc8-9e18-8c7b48be1e80",
              "name": "Block",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0fecc5a7-267e-4fc1-a6d4-759caefc7345",
              "toNodeId": "4cff4374-3354-4e3a-9143-dbf60966c341"
            },
            "4990bb16-eefb-45cc-8258-492a877bef69": {
              "id": "4990bb16-eefb-45cc-8258-492a877bef69",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "769171ab-e338-49db-9057-53f6da19c37a",
              "toNodeId": "decb42d6-f84f-4d7a-9fb4-990e955b7c5e"
            },
            "4fc70727-8b4a-42b5-8e06-a482c7c90639": {
              "id": "4fc70727-8b4a-42b5-8e06-a482c7c90639",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5dc60d63-ed88-4691-a548-59021b2c6171",
              "toNodeId": ""
            },
            "5383371b-9c6b-4680-b010-9df19480c7ef": {
              "id": "5383371b-9c6b-4680-b010-9df19480c7ef",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b3aeb54a-4919-48dd-907b-a97947f0fa4c",
              "toNodeId": "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d"
            },
            "544960fe-1d9d-42a1-8b02-4d44dc614a46": {
              "id": "544960fe-1d9d-42a1-8b02-4d44dc614a46",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f555d0c4-ff83-4210-bc11-97fa8720b790",
              "toNodeId": "b6be898d-28ee-4ead-93a1-ac177ced8973"
            },
            "5dc92b17-6a99-4578-bf9c-b3bf165d9c17": {
              "id": "5dc92b17-6a99-4578-bf9c-b3bf165d9c17",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c807b0a0-c0d3-4fc6-889a-536eaa9554d5",
              "toNodeId": ""
            },
            "6f153571-4280-4f1c-b00d-2f721a933d2d": {
              "id": "6f153571-4280-4f1c-b00d-2f721a933d2d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1",
              "toNodeId": "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3"
            },
            "7c0314cb-ed10-459a-b42b-0f74b5f386d6": {
              "id": "7c0314cb-ed10-459a-b42b-0f74b5f386d6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d",
              "toNodeId": ""
            },
            "89aabfc5-e9be-46cc-81a2-a12e4a9bdf7d": {
              "id": "89aabfc5-e9be-46cc-81a2-a12e4a9bdf7d",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "41e91ba2-a546-46c0-9244-a3799bd9d216",
              "toNodeId": "900b55f4-e7ed-4489-a46c-743e57b4aa66"
            },
            "8d4e218f-ade9-421a-8a4c-db41d9186a09": {
              "id": "8d4e218f-ade9-421a-8a4c-db41d9186a09",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e9b1856c-bb86-4f4d-9de5-5a2802ff526d",
              "toNodeId": ""
            },
            "95713a37-e1b9-4ae7-a1c7-45188a2971a6": {
              "id": "95713a37-e1b9-4ae7-a1c7-45188a2971a6",
              "name": "Unblock",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0fecc5a7-267e-4fc1-a6d4-759caefc7345",
              "toNodeId": "dbaf4fba-860b-470a-8cab-b778152fd609"
            },
            "97754be7-552f-401f-a36e-eaef73da00fc": {
              "id": "97754be7-552f-401f-a36e-eaef73da00fc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8",
              "toNodeId": "769171ab-e338-49db-9057-53f6da19c37a"
            },
            "9adc2d03-ee02-4e44-a4ae-b74133e9d35b": {
              "id": "9adc2d03-ee02-4e44-a4ae-b74133e9d35b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "900b55f4-e7ed-4489-a46c-743e57b4aa66",
              "toNodeId": "e9b1856c-bb86-4f4d-9de5-5a2802ff526d"
            },
            "9d0e1be0-5d26-4f35-b14a-ff6a5d0054a9": {
              "id": "9d0e1be0-5d26-4f35-b14a-ff6a5d0054a9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dbaf4fba-860b-470a-8cab-b778152fd609",
              "toNodeId": "7d17e566-e05c-449e-8c6c-7c20ccae3455"
            },
            "aecbf470-f9a0-4fe1-b265-73ac8c00d0f0": {
              "id": "aecbf470-f9a0-4fe1-b265-73ac8c00d0f0",
              "name": "Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "41e91ba2-a546-46c0-9244-a3799bd9d216",
              "toNodeId": "0fecc5a7-267e-4fc1-a6d4-759caefc7345"
            },
            "b9b6339c-1c70-45f3-a37e-2078f940a70a": {
              "id": "b9b6339c-1c70-45f3-a37e-2078f940a70a",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "decb42d6-f84f-4d7a-9fb4-990e955b7c5e",
              "toNodeId": "d00d5c3b-0e54-468b-977b-cbbb21960ca1"
            },
            "bbee6bc1-5e05-41b4-a82b-1f67bc0a6567": {
              "id": "bbee6bc1-5e05-41b4-a82b-1f67bc0a6567",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "936ed547-527b-4184-85ea-f3ccfb4466b1",
              "toNodeId": ""
            },
            "be51ea0f-e65e-4aa6-beb6-a75165dd2d58": {
              "id": "be51ea0f-e65e-4aa6-beb6-a75165dd2d58",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d3ce49c3-79ee-4a9d-bec2-ddf62866a359",
              "toNodeId": "1ffdf0eb-caa2-44fc-81c5-eeea3960369b"
            },
            "c11d683b-1bcb-4f53-b4af-467a26d0a129": {
              "id": "c11d683b-1bcb-4f53-b4af-467a26d0a129",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7d17e566-e05c-449e-8c6c-7c20ccae3455",
              "toNodeId": "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1"
            },
            "c4ce4909-04b0-482b-a753-2f5ef12c0a40": {
              "id": "c4ce4909-04b0-482b-a753-2f5ef12c0a40",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd",
              "toNodeId": "41e91ba2-a546-46c0-9244-a3799bd9d216"
            },
            "cfcce393-3f89-44b6-b952-e67fa0d0ccca": {
              "id": "cfcce393-3f89-44b6-b952-e67fa0d0ccca",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "af855b2c-0b66-4d0d-961f-06e32a91d591",
              "toNodeId": "5dc60d63-ed88-4691-a548-59021b2c6171"
            },
            "d19f9d72-c4bf-45ea-94f0-d4795a1bb1e3": {
              "id": "d19f9d72-c4bf-45ea-94f0-d4795a1bb1e3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ebaa672f-650f-41f0-bb16-e3f6c56c0aca",
              "toNodeId": "c807b0a0-c0d3-4fc6-889a-536eaa9554d5"
            },
            "e16547e3-55b5-4911-b116-4bd3396c7b38": {
              "id": "e16547e3-55b5-4911-b116-4bd3396c7b38",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9fed5588-2be5-4114-928e-1eb0f8843c4e",
              "toNodeId": "e1214265-784e-4df2-85c6-43a20adf5ccc"
            },
            "ebd59070-3189-4b45-921c-6dd2bf371d20": {
              "id": "ebd59070-3189-4b45-921c-6dd2bf371d20",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b6be898d-28ee-4ead-93a1-ac177ced8973",
              "toNodeId": "26a9a0e4-3375-4229-b698-81f045ae8af8"
            },
            "f87e78b5-9c1a-41af-8d1d-402b57cf8373": {
              "id": "f87e78b5-9c1a-41af-8d1d-402b57cf8373",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d00d5c3b-0e54-468b-977b-cbbb21960ca1",
              "toNodeId": "a457570c-0e21-4e1d-b062-ace6b371b5f8"
            }
          },
          "nodes": {
            "0fecc5a7-267e-4fc1-a6d4-759caefc7345": {
              "id": "0fecc5a7-267e-4fc1-a6d4-759caefc7345",
              "parentNodeId": ""
            },
            "1ffdf0eb-caa2-44fc-81c5-eeea3960369b": {
              "id": "1ffdf0eb-caa2-44fc-81c5-eeea3960369b",
              "parentNodeId": ""
            },
            "26a9a0e4-3375-4229-b698-81f045ae8af8": {
              "id": "26a9a0e4-3375-4229-b698-81f045ae8af8",
              "parentNodeId": ""
            },
            "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3": {
              "id": "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3",
              "parentNodeId": ""
            },
            "41e91ba2-a546-46c0-9244-a3799bd9d216": {
              "id": "41e91ba2-a546-46c0-9244-a3799bd9d216",
              "parentNodeId": ""
            },
            "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77": {
              "id": "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77",
              "parentNodeId": ""
            },
            "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd": {
              "id": "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd",
              "parentNodeId": ""
            },
            "4cff4374-3354-4e3a-9143-dbf60966c341": {
              "id": "4cff4374-3354-4e3a-9143-dbf60966c341",
              "parentNodeId": ""
            },
            "5dc60d63-ed88-4691-a548-59021b2c6171": {
              "id": "5dc60d63-ed88-4691-a548-59021b2c6171",
              "parentNodeId": ""
            },
            "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1": {
              "id": "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1",
              "parentNodeId": ""
            },
            "769171ab-e338-49db-9057-53f6da19c37a": {
              "id": "769171ab-e338-49db-9057-53f6da19c37a",
              "parentNodeId": ""
            },
            "7d17e566-e05c-449e-8c6c-7c20ccae3455": {
              "id": "7d17e566-e05c-449e-8c6c-7c20ccae3455",
              "parentNodeId": ""
            },
            "900b55f4-e7ed-4489-a46c-743e57b4aa66": {
              "id": "900b55f4-e7ed-4489-a46c-743e57b4aa66",
              "parentNodeId": ""
            },
            "936ed547-527b-4184-85ea-f3ccfb4466b1": {
              "id": "936ed547-527b-4184-85ea-f3ccfb4466b1",
              "parentNodeId": ""
            },
            "9fed5588-2be5-4114-928e-1eb0f8843c4e": {
              "id": "9fed5588-2be5-4114-928e-1eb0f8843c4e",
              "parentNodeId": ""
            },
            "a457570c-0e21-4e1d-b062-ace6b371b5f8": {
              "id": "a457570c-0e21-4e1d-b062-ace6b371b5f8",
              "parentNodeId": ""
            },
            "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d": {
              "id": "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d",
              "parentNodeId": ""
            },
            "af855b2c-0b66-4d0d-961f-06e32a91d591": {
              "id": "af855b2c-0b66-4d0d-961f-06e32a91d591",
              "parentNodeId": ""
            },
            "b3aeb54a-4919-48dd-907b-a97947f0fa4c": {
              "id": "b3aeb54a-4919-48dd-907b-a97947f0fa4c",
              "parentNodeId": ""
            },
            "b6be898d-28ee-4ead-93a1-ac177ced8973": {
              "id": "b6be898d-28ee-4ead-93a1-ac177ced8973",
              "parentNodeId": ""
            },
            "c807b0a0-c0d3-4fc6-889a-536eaa9554d5": {
              "id": "c807b0a0-c0d3-4fc6-889a-536eaa9554d5",
              "parentNodeId": ""
            },
            "d00d5c3b-0e54-468b-977b-cbbb21960ca1": {
              "id": "d00d5c3b-0e54-468b-977b-cbbb21960ca1",
              "parentNodeId": ""
            },
            "d3ce49c3-79ee-4a9d-bec2-ddf62866a359": {
              "id": "d3ce49c3-79ee-4a9d-bec2-ddf62866a359",
              "parentNodeId": ""
            },
            "dbaf4fba-860b-470a-8cab-b778152fd609": {
              "id": "dbaf4fba-860b-470a-8cab-b778152fd609",
              "parentNodeId": ""
            },
            "decb42d6-f84f-4d7a-9fb4-990e955b7c5e": {
              "id": "decb42d6-f84f-4d7a-9fb4-990e955b7c5e",
              "parentNodeId": ""
            },
            "e1214265-784e-4df2-85c6-43a20adf5ccc": {
              "id": "e1214265-784e-4df2-85c6-43a20adf5ccc",
              "parentNodeId": ""
            },
            "e9b1856c-bb86-4f4d-9de5-5a2802ff526d": {
              "id": "e9b1856c-bb86-4f4d-9de5-5a2802ff526d",
              "parentNodeId": ""
            },
            "ebaa672f-650f-41f0-bb16-e3f6c56c0aca": {
              "id": "ebaa672f-650f-41f0-bb16-e3f6c56c0aca",
              "parentNodeId": ""
            },
            "f555d0c4-ff83-4210-bc11-97fa8720b790": {
              "id": "f555d0c4-ff83-4210-bc11-97fa8720b790",
              "parentNodeId": ""
            },
            "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8": {
              "id": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0fecc5a7-267e-4fc1-a6d4-759caefc7345": {
            "nodeId": "0fecc5a7-267e-4fc1-a6d4-759caefc7345",
            "name": "Which Action?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "441f9ff2-6891-4fc8-9e18-8c7b48be1e80",
              "stepControlParams": [
                {
                  "edgeId": "441f9ff2-6891-4fc8-9e18-8c7b48be1e80",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "95713a37-e1b9-4ae7-a1c7-45188a2971a6",
                  "expression": {
                    "left": {
                      "name": "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd.message.first_word",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": "unblock-host"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[first_word]}} == \"unblock-host\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "1ffdf0eb-caa2-44fc-81c5-eeea3960369b": {
            "nodeId": "1ffdf0eb-caa2-44fc-81c5-eeea3960369b",
            "name": "Add Host to Be Blocked Failed Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[d3ce49c3-79ee-4a9d-bec2-ddf62866a359].[content]}}\n\nSee {{[$job].[URL]}} for more information",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel_id]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "26a9a0e4-3375-4229-b698-81f045ae8af8": {
            "nodeId": "26a9a0e4-3375-4229-b698-81f045ae8af8",
            "name": "Create Address Object Failed?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "28f57779-b7fd-41f7-ae5d-44edb6ac54ab",
              "stepControlParams": [
                {
                  "edgeId": "28f57779-b7fd-41f7-ae5d-44edb6ac54ab",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "416bf4be-093b-4be8-8c68-7876cbbb8249",
                  "expression": {
                    "left": {
                      "name": "b6be898d-28ee-4ead-93a1-ac177ced8973.$success",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[b6be898d-28ee-4ead-93a1-ac177ced8973].[$success]}} == true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3": {
            "nodeId": "3a7c97aa-2324-4a41-9fc8-d9ea0f4c0dc3",
            "name": "Remove Host Failed Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1].[content]}}\n\nSee {{[$job].[URL]}} for more information.",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel_id]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "41e91ba2-a546-46c0-9244-a3799bd9d216": {
            "nodeId": "41e91ba2-a546-46c0-9244-a3799bd9d216",
            "name": "Host Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "89aabfc5-e9be-46cc-81a2-a12e4a9bdf7d",
              "stepControlParams": [
                {
                  "edgeId": "89aabfc5-e9be-46cc-81a2-a12e4a9bdf7d",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "aecbf470-f9a0-4fe1-b265-73ac8c00d0f0",
                  "expression": {
                    "name": "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd.message.words.1",
                    "type": "variable"
                  },
                  "expressionText": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77": {
            "nodeId": "4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77",
            "name": "Create Address Object Failed Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unable to create an address object for the host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} in the FortiGate firewall."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd": {
            "nodeId": "4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd",
            "name": "Block Request",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "{{$workflow.[Channel]}}",
                "matchText": "(block-host.*|unblock-host.*)",
                "type": "any"
              }
            },
            "triggerId": "5b30dc87-f6df-4525-9769-a7786923933d",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "4cff4374-3354-4e3a-9143-dbf60966c341": {
            "nodeId": "4cff4374-3354-4e3a-9143-dbf60966c341",
            "name": "Check if Address Object Exists",
            "type": "action",
            "plugin": {
              "name": "Fortinet FortiGate",
              "slugVendor": "rapid7",
              "slugName": "fortinet_fortigate",
              "slugVersion": "6.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/fortinet_fortigate/6.0.0/icon.png"
            },
            "identifier": "get_address_objects",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "fqdn_filter": "",
                "ipv6_subnet_filter": "",
                "name_filter": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}",
                "subnet_filter": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "fqdn_filter": {
                  "description": "Optional FQDN to filter on",
                  "order": 3,
                  "title": "FQDN Filter",
                  "type": "string"
                },
                "ipv6_subnet_filter": {
                  "description": "Optional IPv6 subnet to filter on",
                  "order": 4,
                  "title": "IPv6 Subnet Filter",
                  "type": "string"
                },
                "name_filter": {
                  "description": "Optional name to filter on",
                  "order": 1,
                  "title": "Name Filter",
                  "type": "string"
                },
                "subnet_filter": {
                  "description": "Optional subnet to filter on",
                  "order": 2,
                  "title": "Subnet Filter",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address_object": {
                  "properties": {
                    "allow-routing": {
                      "description": "Allow-routing",
                      "order": 15,
                      "title": "Allow-Routing",
                      "type": "string"
                    },
                    "cache-ttl": {
                      "description": "Cache-TTL",
                      "order": 1,
                      "title": "Cache-TTL",
                      "type": "integer"
                    },
                    "clearpass-spt": {
                      "description": "Clear Pass-spt",
                      "order": 17,
                      "title": "Clear Pass-Spt",
                      "type": "string"
                    },
                    "color": {
                      "description": "Color",
                      "order": 8,
                      "title": "Color",
                      "type": "integer"
                    },
                    "comment": {
                      "description": "Comment",
                      "order": 2,
                      "title": "Comment",
                      "type": "string"
                    },
                    "end-mac": {
                      "description": "End-MAC",
                      "order": 12,
                      "title": "End-MAC",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "FQDN",
                      "order": 7,
                      "title": "FQDN",
                      "type": "string"
                    },
                    "fsso-group": {
                      "description": "FSSO-group",
                      "items": {
                        "type": "object"
                      },
                      "order": 4,
                      "title": "FSSO-Group",
                      "type": "array"
                    },
                    "list": {
                      "description": "List",
                      "items": {
                        "type": "object"
                      },
                      "order": 10,
                      "title": "List",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "q_origin_key": {
                      "description": "Q origin key",
                      "order": 3,
                      "title": "Q Origin Key",
                      "type": "string"
                    },
                    "sdn-addr-type": {
                      "description": "Sdn-addr-type",
                      "order": 9,
                      "title": "Sdn-Addr-Type",
                      "type": "string"
                    },
                    "start-mac": {
                      "description": "Start-MAC",
                      "order": 11,
                      "title": "Start-MAC",
                      "type": "string"
                    },
                    "sub-type": {
                      "description": "Sub-type",
                      "order": 13,
                      "title": "Sub-Type",
                      "type": "string"
                    },
                    "subnet": {
                      "description": "Subnet",
                      "order": 6,
                      "title": "Subnet",
                      "type": "string"
                    },
                    "tagging": {
                      "description": "Tagging",
                      "items": {
                        "type": "object"
                      },
                      "order": 18,
                      "title": "Tagging",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type",
                      "order": 16,
                      "title": "Type",
                      "type": "string"
                    },
                    "uuid": {
                      "description": "UUID",
                      "order": 19,
                      "title": "UUID",
                      "type": "string"
                    },
                    "visibility": {
                      "description": "Visibility",
                      "order": 14,
                      "title": "Visibility",
                      "type": "string"
                    }
                  },
                  "title": "Address Object",
                  "type": "object"
                },
                "ipv6_address_object": {
                  "properties": {
                    "cache-ttl": {
                      "description": "Cache-TTL",
                      "order": 8,
                      "title": "Cache-TTL",
                      "type": "integer"
                    },
                    "color": {
                      "description": "Color",
                      "order": 10,
                      "title": "Color",
                      "type": "integer"
                    },
                    "comment": {
                      "description": "Comment",
                      "order": 14,
                      "title": "Comment",
                      "type": "string"
                    },
                    "end-ip": {
                      "description": "End IP",
                      "order": 7,
                      "title": "End-IP",
                      "type": "string"
                    },
                    "host": {
                      "description": "Host",
                      "order": 19,
                      "title": "Host",
                      "type": "string"
                    },
                    "host-type": {
                      "description": "Host type",
                      "order": 18,
                      "title": "Host-type",
                      "type": "string"
                    },
                    "ip6": {
                      "description": "IPv6 address",
                      "order": 5,
                      "title": "IPv6 Address",
                      "type": "string"
                    },
                    "list": {
                      "description": "List",
                      "items": {
                        "$ref": "#/definitions/list"
                      },
                      "order": 12,
                      "title": "List",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "obj-id": {
                      "description": "Object ID for NSX",
                      "order": 11,
                      "title": "Obj-ID",
                      "type": "string"
                    },
                    "q_origin_key": {
                      "description": "Q origin key",
                      "order": 17,
                      "title": "Q Origin Key",
                      "type": "string"
                    },
                    "sdn": {
                      "description": "SDN",
                      "order": 4,
                      "title": "SDN",
                      "type": "string"
                    },
                    "start-ip": {
                      "description": "Start IP",
                      "order": 6,
                      "title": "Start-IP",
                      "type": "string"
                    },
                    "subnet-segment": {
                      "description": "Subnet segment",
                      "items": {
                        "$ref": "#/definitions/segments"
                      },
                      "order": 16,
                      "title": "Subnet-segment",
                      "type": "array"
                    },
                    "tagging": {
                      "description": "Tagging",
                      "items": {
                        "$ref": "#/definitions/tagging"
                      },
                      "order": 13,
                      "title": "Tagging",
                      "type": "array"
                    },
                    "template": {
                      "description": "Template",
                      "order": 15,
                      "title": "Template",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type",
                      "order": 3,
                      "title": "Type",
                      "type": "string"
                    },
                    "uuid": {
                      "description": "UUID",
                      "order": 2,
                      "title": "UUID",
                      "type": "string"
                    },
                    "visibility": {
                      "description": "Visibility",
                      "order": 9,
                      "title": "Visibility",
                      "type": "string"
                    }
                  },
                  "title": "Ipv6 Address Object",
                  "type": "object"
                },
                "list": {
                  "properties": {
                    "ip": {
                      "description": "IP address",
                      "order": 1,
                      "title": "IP Address",
                      "type": "string"
                    },
                    "net-id": {
                      "description": "Network ID",
                      "order": 3,
                      "title": "Net-ID",
                      "type": "string"
                    },
                    "obj-id": {
                      "description": "Object ID",
                      "order": 2,
                      "title": "Obj-ID",
                      "type": "string"
                    }
                  },
                  "title": "List",
                  "type": "object"
                },
                "segments": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 3,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Segments",
                  "type": "object"
                },
                "tagging": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "$ref": "#/definitions/tags"
                      },
                      "order": 3,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "title": "Tagging",
                  "type": "object"
                },
                "tags": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Tags",
                  "type": "object"
                }
              },
              "properties": {
                "address_objects": {
                  "description": "A list of address objects",
                  "items": {
                    "$ref": "#/definitions/address_object"
                  },
                  "order": 1,
                  "title": "Address Objects",
                  "type": "array"
                },
                "ipv6_address_objects": {
                  "description": "A list of IPv6 address objects",
                  "items": {
                    "$ref": "#/definitions/ipv6_address_object"
                  },
                  "order": 2,
                  "title": "IPv6 Address Objects",
                  "type": "array"
                }
              },
              "required": [
                "address_objects",
                "ipv6_address_objects"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "5dc60d63-ed88-4691-a548-59021b2c6171": {
            "nodeId": "5dc60d63-ed88-4691-a548-59021b2c6171",
            "name": "Host is Whitelisted or Private Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[af855b2c-0b66-4d0d-961f-06e32a91d591].[content]}}",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel_id]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1": {
            "nodeId": "6e0a1c6d-0654-4b94-9e19-fcbe1a0092e1",
            "name": "Remove Host Failed Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} was not removed from the blocking group.\n\nThis is often caused by an attempt to remove a host from a group it does not belong to."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "769171ab-e338-49db-9057-53f6da19c37a": {
            "nodeId": "769171ab-e338-49db-9057-53f6da19c37a",
            "name": "Add Host to Group Failed?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "11ec5444-eceb-47b5-b4e0-20b31c9eaa42",
              "stepControlParams": [
                {
                  "edgeId": "11ec5444-eceb-47b5-b4e0-20b31c9eaa42",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "4990bb16-eefb-45cc-8258-492a877bef69",
                  "expression": {
                    "left": {
                      "name": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8.$success",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[fcc8fb43-cddf-4e7d-9a33-89e6f78240f8].[$success]}} == true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "7d17e566-e05c-449e-8c6c-7c20ccae3455": {
            "nodeId": "7d17e566-e05c-449e-8c6c-7c20ccae3455",
            "name": "Remove Host from Group Failed?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c11d683b-1bcb-4f53-b4af-467a26d0a129",
              "stepControlParams": [
                {
                  "edgeId": "2722203f-23eb-4457-b3e4-4db68a62369d",
                  "expression": {
                    "left": {
                      "name": "dbaf4fba-860b-470a-8cab-b778152fd609.$success",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[dbaf4fba-860b-470a-8cab-b778152fd609].[$success]}} == true"
                },
                {
                  "edgeId": "c11d683b-1bcb-4f53-b4af-467a26d0a129",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "900b55f4-e7ed-4489-a46c-743e57b4aa66": {
            "nodeId": "900b55f4-e7ed-4489-a46c-743e57b4aa66",
            "name": "Host Not Found Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The input could not be correctly parsed.\n\nYour input was {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[text]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "936ed547-527b-4184-85ea-f3ccfb4466b1": {
            "nodeId": "936ed547-527b-4184-85ea-f3ccfb4466b1",
            "name": "Create Address Object Failed Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[4b8fd8fd-a4fe-4d8f-a190-e844b4d5fb77].[content]}}\n\nSee {{[$job].[URL]}} for more information.",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel_id]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "9fed5588-2be5-4114-928e-1eb0f8843c4e": {
            "nodeId": "9fed5588-2be5-4114-928e-1eb0f8843c4e",
            "name": "Is Host Whitelisted or Private?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "1b08012e-5839-4c00-9a2c-e1773c6b6053",
              "stepControlParams": [
                {
                  "edgeId": "1b08012e-5839-4c00-9a2c-e1773c6b6053",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "e16547e3-55b5-4911-b116-4bd3396c7b38",
                  "expression": {
                    "left": {
                      "name": "b6be898d-28ee-4ead-93a1-ac177ced8973.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[b6be898d-28ee-4ead-93a1-ac177ced8973].[success]}} = true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a457570c-0e21-4e1d-b062-ace6b371b5f8": {
            "nodeId": "a457570c-0e21-4e1d-b062-ace6b371b5f8",
            "name": "Host Not Added to Block List Address Group Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[d00d5c3b-0e54-468b-977b-cbbb21960ca1].[content]}}",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d": {
            "nodeId": "a7b191c4-5e2f-4246-9adc-0b06e5a3ec6d",
            "name": "Remove Host from Block Group Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "✅ {{[b3aeb54a-4919-48dd-907b-a97947f0fa4c].[content]}}",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "af855b2c-0b66-4d0d-961f-06e32a91d591": {
            "nodeId": "af855b2c-0b66-4d0d-961f-06e32a91d591",
            "name": "Host is Whitelisted or Private Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[b6be898d-28ee-4ead-93a1-ac177ced8973].[response_object].[message]}}\n\nThe host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} was not added to the blocked group."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b3aeb54a-4919-48dd-907b-a97947f0fa4c": {
            "nodeId": "b3aeb54a-4919-48dd-907b-a97947f0fa4c",
            "name": "Remove Host from Block Group Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} was removed from the address group {{[dbaf4fba-860b-470a-8cab-b778152fd609].[result_object].[mkey]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b6be898d-28ee-4ead-93a1-ac177ced8973": {
            "nodeId": "b6be898d-28ee-4ead-93a1-ac177ced8973",
            "name": "Create Address Object",
            "type": "action",
            "plugin": {
              "name": "Fortinet FortiGate",
              "slugVendor": "rapid7",
              "slugName": "fortinet_fortigate",
              "slugVersion": "6.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/fortinet_fortigate/6.0.0/icon.png"
            },
            "identifier": "create_address_object",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}",
                "address_object": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}",
                "skip_rfc1918": true,
                "whitelist": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The address to assign to the Address Object. This can be an IP address, CIDR IP address e.g. 198.51.100.0/24, or a domain name",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "address_object": {
                  "description": "Optional name to give this address object. If not provided, the name will be the value of address input field",
                  "order": 2,
                  "title": "Address Object",
                  "type": "string"
                },
                "skip_rfc1918": {
                  "default": true,
                  "description": "Skip private IP addresses as defined in RFC 1918",
                  "order": 4,
                  "title": "Skip RFC 1918 (Private) IP Addresses",
                  "type": "boolean"
                },
                "whitelist": {
                  "description": "This list contains a set of network object that should not be blocked. This can be an IP address, CIDR IP address e.g. 198.51.100.0/24, or a domain name",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Whitelist",
                  "type": "array"
                }
              },
              "required": [
                "address",
                "skip_rfc1918"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "response_object": {
                  "description": "Information about the operation that was performed",
                  "order": 2,
                  "title": "Response Object",
                  "type": "object"
                },
                "success": {
                  "description": "Boolean value indicating the success of the operation",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "response_object",
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c807b0a0-c0d3-4fc6-889a-536eaa9554d5": {
            "nodeId": "c807b0a0-c0d3-4fc6-889a-536eaa9554d5",
            "name": "Host Added to Block List Address Group Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "✅ {{[ebaa672f-650f-41f0-bb16-e3f6c56c0aca].[content]}}",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "d00d5c3b-0e54-468b-977b-cbbb21960ca1": {
            "nodeId": "d00d5c3b-0e54-468b-977b-cbbb21960ca1",
            "name": "Host Not Added to Block List Address Group Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} was not added to the address group {{[fcc8fb43-cddf-4e7d-9a33-89e6f78240f8].[result_object].[mkey]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "d3ce49c3-79ee-4a9d-bec2-ddf62866a359": {
            "nodeId": "d3ce49c3-79ee-4a9d-bec2-ddf62866a359",
            "name": "Add Host to Be Blocked Failed Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unable to add the host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} to the blocking group.\n\nThis is often caused by trying to add a host to a group it already belongs to."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "dbaf4fba-860b-470a-8cab-b778152fd609": {
            "nodeId": "dbaf4fba-860b-470a-8cab-b778152fd609",
            "name": "Remove Host from Group",
            "type": "action",
            "plugin": {
              "name": "Fortinet FortiGate",
              "slugVendor": "rapid7",
              "slugName": "fortinet_fortigate",
              "slugVersion": "6.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/fortinet_fortigate/6.0.0/icon.png"
            },
            "identifier": "remove_address_object_from_group",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address_object": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}",
                "group": "{{$workflow.[Group Name]}}",
                "ipv6_group": "{{$workflow.[IPv6 Group Name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "Address object",
                  "order": 3,
                  "title": "Address Object",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "ipv6_group": {
                  "description": "The name of the IPv6 address group",
                  "order": 2,
                  "title": "IPv6 Group",
                  "type": "string"
                }
              },
              "required": [
                "group",
                "ipv6_group",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result_object": {
                  "description": "An object containing the results of the action",
                  "order": 2,
                  "title": "Result Object",
                  "type": "object"
                },
                "success": {
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success",
                "result_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "decb42d6-f84f-4d7a-9fb4-990e955b7c5e": {
            "nodeId": "decb42d6-f84f-4d7a-9fb4-990e955b7c5e",
            "name": "Host Added?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b9b6339c-1c70-45f3-a37e-2078f940a70a",
              "stepControlParams": [
                {
                  "edgeId": "18feee59-c202-4aa2-a5fc-977c4e7ded83",
                  "expression": {
                    "left": {
                      "name": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[fcc8fb43-cddf-4e7d-9a33-89e6f78240f8].[success]}} = true"
                },
                {
                  "edgeId": "b9b6339c-1c70-45f3-a37e-2078f940a70a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "e1214265-784e-4df2-85c6-43a20adf5ccc": {
            "nodeId": "e1214265-784e-4df2-85c6-43a20adf5ccc",
            "name": "Host Already in FortiGate",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "1d891611-5a5e-45e0-8f42-cf19aa7cc95c",
                "e16547e3-55b5-4911-b116-4bd3396c7b38"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "e9b1856c-bb86-4f4d-9de5-5a2802ff526d": {
            "nodeId": "e9b1856c-bb86-4f4d-9de5-5a2802ff526d",
            "name": "Host Not Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "⚠️ {{[900b55f4-e7ed-4489-a46c-743e57b4aa66].[content]}}",
                "recipient": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[channel]}}",
                "thread_ts": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "ebaa672f-650f-41f0-bb16-e3f6c56c0aca": {
            "nodeId": "ebaa672f-650f-41f0-bb16-e3f6c56c0aca",
            "name": "Host Added to Block List Address Group Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The host {{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}} was added to the address group {{[fcc8fb43-cddf-4e7d-9a33-89e6f78240f8].[result_object].[mkey]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "f555d0c4-ff83-4210-bc11-97fa8720b790": {
            "nodeId": "f555d0c4-ff83-4210-bc11-97fa8720b790",
            "name": "Address Object Already Exists?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "544960fe-1d9d-42a1-8b02-4d44dc614a46",
              "stepControlParams": [
                {
                  "edgeId": "1d891611-5a5e-45e0-8f42-cf19aa7cc95c",
                  "expression": {
                    "left": {
                      "name": "4cff4374-3354-4e3a-9143-dbf60966c341.address_objects",
                      "type": "variable"
                    },
                    "op": "OR",
                    "right": {
                      "name": "4cff4374-3354-4e3a-9143-dbf60966c341.ipv6_address_objects",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[4cff4374-3354-4e3a-9143-dbf60966c341].[address_objects]}} or {{[4cff4374-3354-4e3a-9143-dbf60966c341].[ipv6_address_objects]}}"
                },
                {
                  "edgeId": "544960fe-1d9d-42a1-8b02-4d44dc614a46",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8": {
            "nodeId": "fcc8fb43-cddf-4e7d-9a33-89e6f78240f8",
            "name": "Add Host to Blocked Address Group",
            "type": "action",
            "plugin": {
              "name": "Fortinet FortiGate",
              "slugVendor": "rapid7",
              "slugName": "fortinet_fortigate",
              "slugVersion": "6.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/fortinet_fortigate/6.0.0/icon.png"
            },
            "identifier": "add_address_object_to_address_group",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address_object": "{{[4bacdaed-cdf2-42dc-b24a-ccbef8dce9bd].[message].[words].[1]}}",
                "group": "{{$workflow.[Group Name]}}",
                "ipv6_group": "{{$workflow.[IPv6 Group Name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "Address object",
                  "order": 3,
                  "title": "Address Object",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "ipv6_group": {
                  "description": "The name of the IPv6 address group",
                  "order": 2,
                  "title": "IPv6 Group",
                  "type": "string"
                }
              },
              "required": [
                "group",
                "ipv6_group",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result_object": {
                  "description": "An object containing the results of the action",
                  "order": 2,
                  "title": "Result Object",
                  "type": "object"
                },
                "success": {
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success",
                "result_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Fortinet",
          "Network & Firewall",
          "Slack"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channel": {
                "type": "string",
                "description": "The Slack channel name in your environment where the workflow should be triggered."
              },
              "Group Name": {
                "type": "string",
                "description": "The group name for blocked IPv4 addresses and domains."
              },
              "IPv6 Group Name": {
                "type": "string",
                "description": "The group name for blocked IPv6 addresses."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "5b30dc87-f6df-4525-9769-a7786923933d",
        "name": "Block Request",
        "description": "Slack message received trigger",
        "input": {
          "matchChannel": "{{$workflow.[Channel]}}",
          "matchText": "(block-host.*|unblock-host.*)",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}