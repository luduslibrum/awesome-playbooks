{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:55:33.105469275Z",
    "workflowVersions": [
      {
        "name": "Manage Expiring Vulnerability Exceptions with InsightVM and Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nNotify a user weekly via Microsoft Teams message of expiring exceptions.\n\n# Key Features\n\n* Quick management of exceptions with InsightVM through Microsoft Teams\n\n# Requirements\n\n* [Microsoft Teams](https://docs.rapid7.com/insightconnect/microsoft-teams/)\n* InsightVM\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nAfter import, adjust the date and frequency in the `Weekly Timer` step as necessary.\n\nUpdate the Parameters to change the channel and team to the channel in your environment where you would like reminders posted.\n\n## Usage\n\nThis workflow will trigger automatically with the frequency set in the `Weekly Timer` step.\n\n## Technical Details\n\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Microsoft Teams|3.1.2|3|\n|Rapid7 InsightVM|4.9.0|1|\n|Timers|2.0.5|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.3 - Update keywords\n* 1.0.2 - Added parameters, updated plugins\n* 1.0.1 - Update Microsoft Teams to version 3.1.0\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Teams](https://docs.rapid7.com/insightconnect/microsoft-teams/)\n",
        "graph": {
          "edges": {
            "09f1906a-7cd4-43bb-9f5a-115578db69af": {
              "id": "09f1906a-7cd4-43bb-9f5a-115578db69af",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2874f393-5cbc-4d34-84b6-47a652617c03",
              "toNodeId": ""
            },
            "1860bffb-1f92-4989-aa29-5699bf9cbd9a": {
              "id": "1860bffb-1f92-4989-aa29-5699bf9cbd9a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ab6b2ea4-a963-48c4-8a58-51f9141e0d24",
              "toNodeId": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a"
            },
            "595c473c-74af-4c92-83ef-57c43cd0063b": {
              "id": "595c473c-74af-4c92-83ef-57c43cd0063b",
              "name": "5 or less",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7595f444-5c98-457b-ba52-b38863ae878a",
              "toNodeId": "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9"
            },
            "5e92f64d-76ad-4f1d-8992-573c3ca8d1a3": {
              "id": "5e92f64d-76ad-4f1d-8992-573c3ca8d1a3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "684a5328-e9cf-4d16-9f3a-a7edc8fafb37",
              "toNodeId": ""
            },
            "77a880aa-1555-41d2-bd54-9ec4b74afa25": {
              "id": "77a880aa-1555-41d2-bd54-9ec4b74afa25",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a",
              "toNodeId": "715f6f94-06c6-4ae0-8861-b50e0c332166"
            },
            "7f0add3c-20c8-4d6d-84de-872841c9677b": {
              "id": "7f0add3c-20c8-4d6d-84de-872841c9677b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9",
              "toNodeId": ""
            },
            "b082b439-e203-478a-80ab-9b33aa770d4e": {
              "id": "b082b439-e203-478a-80ab-9b33aa770d4e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "715f6f94-06c6-4ae0-8861-b50e0c332166",
              "toNodeId": "7595f444-5c98-457b-ba52-b38863ae878a"
            },
            "bf76fc19-108c-4dd7-80db-3c1f62e89ae0": {
              "id": "bf76fc19-108c-4dd7-80db-3c1f62e89ae0",
              "name": "Zero",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7595f444-5c98-457b-ba52-b38863ae878a",
              "toNodeId": "2874f393-5cbc-4d34-84b6-47a652617c03"
            },
            "d635d795-9f9c-47d0-ac1b-d6145f5e344f": {
              "id": "d635d795-9f9c-47d0-ac1b-d6145f5e344f",
              "name": "More than 5",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7595f444-5c98-457b-ba52-b38863ae878a",
              "toNodeId": "684a5328-e9cf-4d16-9f3a-a7edc8fafb37"
            }
          },
          "nodes": {
            "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9": {
              "id": "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9",
              "parentNodeId": ""
            },
            "2874f393-5cbc-4d34-84b6-47a652617c03": {
              "id": "2874f393-5cbc-4d34-84b6-47a652617c03",
              "parentNodeId": ""
            },
            "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a": {
              "id": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a",
              "parentNodeId": ""
            },
            "684a5328-e9cf-4d16-9f3a-a7edc8fafb37": {
              "id": "684a5328-e9cf-4d16-9f3a-a7edc8fafb37",
              "parentNodeId": ""
            },
            "715f6f94-06c6-4ae0-8861-b50e0c332166": {
              "id": "715f6f94-06c6-4ae0-8861-b50e0c332166",
              "parentNodeId": ""
            },
            "7595f444-5c98-457b-ba52-b38863ae878a": {
              "id": "7595f444-5c98-457b-ba52-b38863ae878a",
              "parentNodeId": ""
            },
            "ab6b2ea4-a963-48c4-8a58-51f9141e0d24": {
              "id": "ab6b2ea4-a963-48c4-8a58-51f9141e0d24",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9": {
            "nodeId": "1c2c78af-7bef-4a14-bee1-1c8eec8faeb9",
            "name": "5 or less message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel]}}",
                "message_content": "⚠&ensp;<b>Expiring Exceptions</b>&ensp;⚠<br>\n<br>\n<table>\n<tr>\n<th>ID</th>\n<th>Name</th>\n<th>Expires</th>\n</tr>\n{{#each [4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}\n<tr>\n<td>{{this.[id]}}</td>\n<td>{{this.[scope].[vulnerability]}}</td>\n<td>{{this.[expires]}}</td>\n</tr>\n{{/each}}\n</table>",
                "team_name": "{{$workflow.[Team]}}",
                "thread_id": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2874f393-5cbc-4d34-84b6-47a652617c03": {
            "nodeId": "2874f393-5cbc-4d34-84b6-47a652617c03",
            "name": "No Exceptions Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel]}}",
                "message_content": "✅&ensp;<b>No expiring exceptions found</b>&ensp;✅",
                "team_name": "{{$workflow.[Team]}}",
                "thread_id": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a": {
            "nodeId": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a",
            "name": "Get Expiring Exceptions",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.0/icon.png"
            },
            "identifier": "get_expiring_vulnerability_exceptions",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "expires_in_less_than": 14
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "expires_in_less_than": {
                  "default": 7,
                  "description": "Number of days left until the exception expires",
                  "order": 1,
                  "title": "Expires in Less Than",
                  "type": "integer"
                }
              },
              "required": [
                "expires_in_less_than"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "vulnerability_exception": {
                  "properties": {
                    "expires": {
                      "description": "The date and time the vulnerability exception is set to expire",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Expires",
                      "type": "string"
                    },
                    "id": {
                      "description": "The ID uniquely identifying the vulnerability exception",
                      "order": 3,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 7,
                      "title": "Links",
                      "type": "array"
                    },
                    "review": {
                      "description": "Details of the exception review",
                      "order": 6,
                      "title": "Review Details",
                      "type": "object"
                    },
                    "scope": {
                      "description": "Details of the scope of the exception",
                      "order": 4,
                      "title": "Exception Scope",
                      "type": "object"
                    },
                    "state": {
                      "description": "The state of the vulnerability exception",
                      "enum": [
                        "deleted",
                        "expired",
                        "approved",
                        "rejected",
                        "under review"
                      ],
                      "order": 2,
                      "title": "State",
                      "type": "string"
                    },
                    "submit": {
                      "description": "Details of the exception submission",
                      "order": 5,
                      "title": "Submission Details",
                      "type": "object"
                    }
                  },
                  "required": [
                    "state",
                    "id",
                    "scope",
                    "submit"
                  ],
                  "title": "Vulnerability Exception",
                  "type": "object"
                }
              },
              "properties": {
                "exceptions": {
                  "description": "Exceptions about to expire",
                  "items": {
                    "$ref": "#/definitions/vulnerability_exception"
                  },
                  "order": 1,
                  "title": "Exceptions",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "684a5328-e9cf-4d16-9f3a-a7edc8fafb37": {
            "nodeId": "684a5328-e9cf-4d16-9f3a-a7edc8fafb37",
            "name": "More than 5 exceptions message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel]}}",
                "message_content": "⚠&ensp;<b>Expiring Exceptions</b>&ensp;⚠<br>\n<br>\n<table>\n<tr>\n<th>ID</th>\n<th>Name</th>\n<th>Expires</th>\n</tr>\n{{#each [4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}\n<tr>\n<td>{{this.[id]}}</td>\n<td>{{this.[scope].[vulnerability]}}</td>\n<td>{{this.[expires]}}</td>\n</tr>\n{{/each}}\n</table><br>\n<br>\n... More than 5 expiring exceptions found. The complete list can be found here: <br>\n<a href=\"{{[$job].[URL]}}\">Link</a>",
                "team_name": "{{$workflow.[Team]}}",
                "thread_id": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "715f6f94-06c6-4ae0-8861-b50e0c332166": {
            "nodeId": "715f6f94-06c6-4ae0-8861-b50e0c332166",
            "name": "Create CSV",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#each [4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}\n{{this.[id]}},{{this.[expires]}},{{this.[scope].[vulnerability]}},{{this.[links].[0].[href]}}\n{{/each}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7595f444-5c98-457b-ba52-b38863ae878a": {
            "nodeId": "7595f444-5c98-457b-ba52-b38863ae878a",
            "name": "How many exceptions",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "d635d795-9f9c-47d0-ac1b-d6145f5e344f",
              "stepControlParams": [
                {
                  "edgeId": "595c473c-74af-4c92-83ef-57c43cd0063b",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "<",
                      "right": {
                        "type": "literal",
                        "value": 6
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "args": [
                          {
                            "name": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": ">",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) < 6 AND length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) > 0"
                },
                {
                  "edgeId": "bf76fc19-108c-4dd7-80db-3c1f62e89ae0",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a.exceptions",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[4bf56fd5-2e45-4ab2-90ca-d8df5ba5971a].[exceptions]}}) == 0"
                },
                {
                  "edgeId": "d635d795-9f9c-47d0-ac1b-d6145f5e344f",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "ab6b2ea4-a963-48c4-8a58-51f9141e0d24": {
            "nodeId": "ab6b2ea4-a963-48c4-8a58-51f9141e0d24",
            "name": "Weekly Timer",
            "type": "trigger",
            "plugin": {
              "name": "Timers",
              "slugVendor": "rapid7",
              "slugName": "timers",
              "slugVersion": "2.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/2.0.5/icon.png"
            },
            "identifier": "weekly",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "day": "Monday",
                "message": "",
                "times_in_utc": "00:00:01"
              }
            },
            "triggerId": "8230625d-862e-4584-94c5-0d68f5238e18",
            "defaultInputJSONSchema": {
              "properties": {
                "day": {
                  "description": "Names of the day that you want the trigger to run",
                  "order": 1,
                  "title": "Day",
                  "type": "string"
                },
                "message": {
                  "description": "The message to send (optional)",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "times_in_utc": {
                  "description": "A comma-separated list of UTC times on those days when you want the trigger to occur",
                  "order": 2,
                  "title": "Time in UTC",
                  "type": "string"
                }
              },
              "required": [
                "day",
                "times_in_utc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "message": {
                  "description": "Message",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "time": {
                  "description": "Time",
                  "order": 2,
                  "title": "Time",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": [
          "Microsoft",
          "Rapid7",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 1800,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Team": {
                "type": "string",
                "description": "Team to use for Notifications"
              },
              "Channel": {
                "type": "string",
                "description": "Channel to use for notifications"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "8230625d-862e-4584-94c5-0d68f5238e18",
        "identifier": "weekly",
        "name": "Weekly Timer",
        "description": "",
        "input": {
          "day": "Monday",
          "message": "",
          "times_in_utc": "00:00:01"
        },
        "inputJsonSchema": {
          "properties": {
            "day": {
              "description": "Names of the day that you want the trigger to run",
              "order": 1,
              "title": "Day",
              "type": "string"
            },
            "message": {
              "description": "The message to send (optional)",
              "order": 3,
              "title": "Message",
              "type": "string"
            },
            "times_in_utc": {
              "description": "A comma-separated list of UTC times on those days when you want the trigger to occur",
              "order": 2,
              "title": "Time in UTC",
              "type": "string"
            }
          },
          "required": [
            "day",
            "times_in_utc"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "properties": {
            "message": {
              "description": "Message",
              "order": 1,
              "title": "Message",
              "type": "string"
            },
            "time": {
              "description": "Time",
              "order": 2,
              "title": "Time",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Timers",
          "slugVendor": "rapid7",
          "slugName": "timers",
          "slugVersion": "2.0.5",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/2.0.5/icon.png"
        }
      }
    ]
  }
}