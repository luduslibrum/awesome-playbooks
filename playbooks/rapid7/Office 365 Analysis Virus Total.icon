{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:54:48.798279231Z",
    "workflowVersions": [
      {
        "name": "Office 365 Analysis Virus Total",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow is designed to automatically analyze incoming emails to determine if they are malicious. This workflow assumes a user is using their report phishing button to send an email to an administrative account with the suspicious email attached. The workflow will then analyze the attached email for any suspicious links or files. If any malicious indicators are found the email will be remediated across the organization.\n\n# Key Features\n\n* Identifies malicious emails\n* Removes identified emails from the entire organization\n* Blocks sender from the organization\n\n# Requirements\n\nAPI and account credentials for\n\n* Microsoft Office365\n* VirusTotal\n\n# Documentation\n\n## Setup\n\nOnce the workflow has been downloaded, login to InsightConnect and “Import” it into the workflow builder. Once imported, you will initially be prompted to configure the connections for each of the plugins.\n\nThe remediation steps are disabled due to their destructive nature. To use them, they must be manually enabled after importing the workflow.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Basename|1.0.0|1|\n|ExtractIt|1.1.6|1|\n|HashIt|2.0.1|1|\n|Microsoft Office 365 Email|4.0.0|2|\n|Microsoft Office365 Email Security|2.1.0|2|\n|Storage|1.0.0|6|\n|VirusTotal|7.0.0|5|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.1.0 - Update VirusTotal plugin\n* 1.0.1 - Update workflow title to enrichment\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Office365](https://www.office.com)\n",
        "graph": {
          "edges": {
            "035a7f86-3850-47e4-9055-373c4c9f3a7a": {
              "id": "035a7f86-3850-47e4-9055-373c4c9f3a7a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "419e96fc-d195-4e15-ba31-c98036bd8617",
              "toNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c"
            },
            "093d30cf-aff0-4f0b-8194-8587ec40789b": {
              "id": "093d30cf-aff0-4f0b-8194-8587ec40789b",
              "name": "True",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "toNodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc"
            },
            "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76": {
              "id": "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76",
              "name": "True",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "toNodeId": "36750222-5693-4152-a83e-2196bf5571e0"
            },
            "1271a174-3543-4407-91ce-df80e79c04a6": {
              "id": "1271a174-3543-4407-91ce-df80e79c04a6",
              "name": "VT Scan Malicious",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "640b894e-8bc3-47b3-8468-ebc9efa310fb",
              "toNodeId": "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87"
            },
            "1370aeb1-247b-426d-af1e-fced15c43b23": {
              "id": "1370aeb1-247b-426d-af1e-fced15c43b23",
              "name": "Does Not Have Attachments",
              "description": "The triggering email did not have any attachments. ",
              "parentNodeId": "",
              "fromNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "toNodeId": ""
            },
            "13fbb508-9e1e-4861-ad70-5a84210c4f57": {
              "id": "13fbb508-9e1e-4861-ad70-5a84210c4f57",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
              "toNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193"
            },
            "14fad1f4-5e4f-492f-9499-5f2882826e67": {
              "id": "14fad1f4-5e4f-492f-9499-5f2882826e67",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117",
              "toNodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9"
            },
            "1b0439d2-c571-43c0-8db0-e0d43582e5e3": {
              "id": "1b0439d2-c571-43c0-8db0-e0d43582e5e3",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
              "toNodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f"
            },
            "1b54caa9-a17f-4c0e-97c6-4b1209f7ccdb": {
              "id": "1b54caa9-a17f-4c0e-97c6-4b1209f7ccdb",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
              "toNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e"
            },
            "1d2aecc6-3962-4d50-bf5b-59987a1e6002": {
              "id": "1d2aecc6-3962-4d50-bf5b-59987a1e6002",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
              "toNodeId": "5e08635d-9729-4867-9150-4d012f64b852"
            },
            "2ed90599-2810-466c-aef1-5a370cd17ddd": {
              "id": "2ed90599-2810-466c-aef1-5a370cd17ddd",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "2c394058-05b0-4322-ba5c-48c63ea1a927",
              "toNodeId": "20748ce0-1592-4828-9c21-7ebb3f46083a"
            },
            "3ffbd486-f9e4-41dc-8651-99e69cc04489": {
              "id": "3ffbd486-f9e4-41dc-8651-99e69cc04489",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "toNodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68"
            },
            "4214039f-4fda-4d33-a837-29280ccb6df2": {
              "id": "4214039f-4fda-4d33-a837-29280ccb6df2",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "3747b60f-4236-4393-a4da-bc760bbf86d6",
              "toNodeId": "6b947305-1f10-4bca-86e7-25333ab90671"
            },
            "4b5263cb-ea27-479c-af7b-673384988e5e": {
              "id": "4b5263cb-ea27-479c-af7b-673384988e5e",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
              "toNodeId": ""
            },
            "563c9f5c-44b4-41e9-8b03-839eb4bc71c5": {
              "id": "563c9f5c-44b4-41e9-8b03-839eb4bc71c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "toNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90"
            },
            "5a102bcc-e4ae-4fbe-b3b1-0a4daddbe9b7": {
              "id": "5a102bcc-e4ae-4fbe-b3b1-0a4daddbe9b7",
              "name": "File Found, Was Malicious",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "6b947305-1f10-4bca-86e7-25333ab90671",
              "toNodeId": "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9"
            },
            "60f29ae3-190d-41ff-889a-03c218de920d": {
              "id": "60f29ae3-190d-41ff-889a-03c218de920d",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "a1a97629-e864-453e-a675-1fc6774842cf",
              "toNodeId": "6751b0d1-78c0-4f7f-8e16-1dbf9c882333"
            },
            "610a5118-6d16-4d71-ad39-d083897f41f3": {
              "id": "610a5118-6d16-4d71-ad39-d083897f41f3",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "36750222-5693-4152-a83e-2196bf5571e0",
              "toNodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d"
            },
            "654f8e10-d66f-41a1-8a91-a53ee896fda1": {
              "id": "654f8e10-d66f-41a1-8a91-a53ee896fda1",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87",
              "toNodeId": "a1a97629-e864-453e-a675-1fc6774842cf"
            },
            "65c194fa-a3b7-432d-abca-5a4f1438fd42": {
              "id": "65c194fa-a3b7-432d-abca-5a4f1438fd42",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "toNodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4"
            },
            "7124236c-2317-4341-9e55-8f79b0b61036": {
              "id": "7124236c-2317-4341-9e55-8f79b0b61036",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a",
              "toNodeId": "640b894e-8bc3-47b3-8468-ebc9efa310fb"
            },
            "721b924a-2524-4a9a-85b9-b3474697dcd9": {
              "id": "721b924a-2524-4a9a-85b9-b3474697dcd9",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "toNodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3"
            },
            "73687b5a-204d-44c7-8371-efe2cd91699d": {
              "id": "73687b5a-204d-44c7-8371-efe2cd91699d",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9",
              "toNodeId": "2c394058-05b0-4322-ba5c-48c63ea1a927"
            },
            "7885e52a-a487-4510-9364-751a0efcff17": {
              "id": "7885e52a-a487-4510-9364-751a0efcff17",
              "name": "False",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": ""
            },
            "795a059f-1749-4ed1-8ce3-6cb1a6ada15f": {
              "id": "795a059f-1749-4ed1-8ce3-6cb1a6ada15f",
              "name": "VT Scan not Malicious",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "640b894e-8bc3-47b3-8468-ebc9efa310fb",
              "toNodeId": ""
            },
            "79f782d4-d168-4e5e-b17d-35256d2c142d": {
              "id": "79f782d4-d168-4e5e-b17d-35256d2c142d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "47496fd4-9310-4fac-b631-ef321f7ef064",
              "toNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "7c575794-d88b-49ef-a4da-70dc542c4a6b": {
              "id": "7c575794-d88b-49ef-a4da-70dc542c4a6b",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
              "toNodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a"
            },
            "824e0984-e6fa-41be-82b5-87d1cbe761fe": {
              "id": "824e0984-e6fa-41be-82b5-87d1cbe761fe",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46",
              "toNodeId": "419e96fc-d195-4e15-ba31-c98036bd8617"
            },
            "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544": {
              "id": "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "toNodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46"
            },
            "9207685a-61a1-45a1-8977-9bff1c8ae631": {
              "id": "9207685a-61a1-45a1-8977-9bff1c8ae631",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "5e08635d-9729-4867-9150-4d012f64b852",
              "toNodeId": "66edc4da-f487-4623-836c-97faea6384c9"
            },
            "9748c50c-303f-4b5b-8f9e-bf50286ad86b": {
              "id": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
              "name": "False",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "toNodeId": ""
            },
            "9874185c-9678-48a2-bc37-69254d4f82f7": {
              "id": "9874185c-9678-48a2-bc37-69254d4f82f7",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "0d009b62-123a-4cbc-b741-2eea71fddc28",
              "toNodeId": "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a"
            },
            "9a5afefa-a91d-4af5-b7a9-6db1642420ec": {
              "id": "9a5afefa-a91d-4af5-b7a9-6db1642420ec",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "6751b0d1-78c0-4f7f-8e16-1dbf9c882333",
              "toNodeId": ""
            },
            "9e8a3175-fc54-4817-9beb-73c6ca4b94bc": {
              "id": "9e8a3175-fc54-4817-9beb-73c6ca4b94bc",
              "name": "Has Attachments",
              "description": "The triggering email has attachments",
              "parentNodeId": "",
              "fromNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "toNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "9ed559c0-3edb-49d2-8f44-41498851ae43": {
              "id": "9ed559c0-3edb-49d2-8f44-41498851ae43",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
              "toNodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117"
            },
            "a4a14e4f-c104-490c-885a-d0ed5477720f": {
              "id": "a4a14e4f-c104-490c-885a-d0ed5477720f",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a",
              "toNodeId": ""
            },
            "ab7059a9-41b2-4e0f-a965-f1921253f17c": {
              "id": "ab7059a9-41b2-4e0f-a965-f1921253f17c",
              "name": "File Found, Was not Malicious",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "6b947305-1f10-4bca-86e7-25333ab90671",
              "toNodeId": ""
            },
            "af99ac93-3b18-47bf-98cb-5e6b39ea0801": {
              "id": "af99ac93-3b18-47bf-98cb-5e6b39ea0801",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
              "toNodeId": "984bb254-4b9b-4f19-9088-40903b948dfb"
            },
            "af9a26e4-2e4a-41ec-b6c2-c5ef0f39f805": {
              "id": "af9a26e4-2e4a-41ec-b6c2-c5ef0f39f805",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "66edc4da-f487-4623-836c-97faea6384c9",
              "toNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b": {
              "id": "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "toNodeId": "47496fd4-9310-4fac-b631-ef321f7ef064"
            },
            "b0f60fdd-8950-494c-915b-1e46cd3dd118": {
              "id": "b0f60fdd-8950-494c-915b-1e46cd3dd118",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "toNodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa"
            },
            "b3cc74fe-7d84-4d55-b496-debcff297acd": {
              "id": "b3cc74fe-7d84-4d55-b496-debcff297acd",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "20748ce0-1592-4828-9c21-7ebb3f46083a",
              "toNodeId": ""
            },
            "ba365f45-f9cc-4bf7-b979-6c49b0edd9cc": {
              "id": "ba365f45-f9cc-4bf7-b979-6c49b0edd9cc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
              "toNodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0"
            },
            "bfd977f3-03cd-4715-b63c-e10ab642d490": {
              "id": "bfd977f3-03cd-4715-b63c-e10ab642d490",
              "name": "",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "toNodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3"
            },
            "c7ef1193-da58-4139-8281-1103bd076d0c": {
              "id": "c7ef1193-da58-4139-8281-1103bd076d0c",
              "name": "File Not Found",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "6b947305-1f10-4bca-86e7-25333ab90671",
              "toNodeId": "0d009b62-123a-4cbc-b741-2eea71fddc28"
            },
            "c7fc61ec-9910-4573-a5b5-9ba200b5f2e2": {
              "id": "c7fc61ec-9910-4573-a5b5-9ba200b5f2e2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
              "toNodeId": ""
            },
            "c8087cac-092e-46de-864f-3e386df3e577": {
              "id": "c8087cac-092e-46de-864f-3e386df3e577",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "toNodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd"
            },
            "d0ddd32f-6772-4265-8732-5a220d5802a8": {
              "id": "d0ddd32f-6772-4265-8732-5a220d5802a8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "984bb254-4b9b-4f19-9088-40903b948dfb",
              "toNodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19"
            },
            "da6193bb-78c9-4c8e-addf-bbcd12d5e529": {
              "id": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
              "name": "False",
              "description": "",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
              "fromNodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "toNodeId": ""
            },
            "e16c3fd8-a96f-46a3-8e5c-bde7a13e0509": {
              "id": "e16c3fd8-a96f-46a3-8e5c-bde7a13e0509",
              "name": "",
              "description": "",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "fromNodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
              "toNodeId": "3747b60f-4236-4393-a4da-bc760bbf86d6"
            },
            "e80168fa-4bda-4633-a608-b417f628eaa5": {
              "id": "e80168fa-4bda-4633-a608-b417f628eaa5",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
              "toNodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27"
            },
            "fae04247-9573-4f9e-ab83-f3829da59453": {
              "id": "fae04247-9573-4f9e-ab83-f3829da59453",
              "name": "",
              "description": "",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "fromNodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68",
              "toNodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03"
            },
            "fceaae38-58dd-4400-96b9-582929fcc93f": {
              "id": "fceaae38-58dd-4400-96b9-582929fcc93f",
              "name": "True",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8"
            }
          },
          "nodes": {
            "09d427ee-4c6e-4b3e-a94f-33323684ca27": {
              "id": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "0d009b62-123a-4cbc-b741-2eea71fddc28": {
              "id": "0d009b62-123a-4cbc-b741-2eea71fddc28",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "0df75dc8-0336-43c3-b3d7-18f080a89f19": {
              "id": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
              "parentNodeId": ""
            },
            "1074a86c-bc81-415d-8edc-3c387b774420": {
              "id": "1074a86c-bc81-415d-8edc-3c387b774420",
              "parentNodeId": ""
            },
            "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
              "id": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "parentNodeId": ""
            },
            "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87": {
              "id": "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "1a618ebf-8d61-4472-b2ee-53ac0cf3112f": {
              "id": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "1b82897d-95a2-4799-87d8-881d201d8fa8": {
              "id": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "parentNodeId": ""
            },
            "20748ce0-1592-4828-9c21-7ebb3f46083a": {
              "id": "20748ce0-1592-4828-9c21-7ebb3f46083a",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "20c2237a-ec86-4eeb-987e-d6e222c6d7e0": {
              "id": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
              "parentNodeId": ""
            },
            "29b6f6b2-baf5-45fe-aa3a-4617650163fd": {
              "id": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
              "parentNodeId": ""
            },
            "2c394058-05b0-4322-ba5c-48c63ea1a927": {
              "id": "2c394058-05b0-4322-ba5c-48c63ea1a927",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3": {
              "id": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "36750222-5693-4152-a83e-2196bf5571e0": {
              "id": "36750222-5693-4152-a83e-2196bf5571e0",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "3747b60f-4236-4393-a4da-bc760bbf86d6": {
              "id": "3747b60f-4236-4393-a4da-bc760bbf86d6",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "3ca29053-84ce-4616-acd3-6fe8fb2f2d03": {
              "id": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "419e96fc-d195-4e15-ba31-c98036bd8617": {
              "id": "419e96fc-d195-4e15-ba31-c98036bd8617",
              "parentNodeId": ""
            },
            "47496fd4-9310-4fac-b631-ef321f7ef064": {
              "id": "47496fd4-9310-4fac-b631-ef321f7ef064",
              "parentNodeId": ""
            },
            "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d": {
              "id": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
              "parentNodeId": ""
            },
            "57940a7a-4779-42cb-a785-a0d37a73ef90": {
              "id": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "parentNodeId": ""
            },
            "5e08635d-9729-4867-9150-4d012f64b852": {
              "id": "5e08635d-9729-4867-9150-4d012f64b852",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "61671b98-5732-4d0e-bb12-6fbaa469ae0e": {
              "id": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "61ee7af6-fe69-4995-975c-c69f5bd952b9": {
              "id": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
              "parentNodeId": ""
            },
            "63487857-be4e-4c1e-9302-6a8c575d9193": {
              "id": "63487857-be4e-4c1e-9302-6a8c575d9193",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "640b894e-8bc3-47b3-8468-ebc9efa310fb": {
              "id": "640b894e-8bc3-47b3-8468-ebc9efa310fb",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "66edc4da-f487-4623-836c-97faea6384c9": {
              "id": "66edc4da-f487-4623-836c-97faea6384c9",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "6751b0d1-78c0-4f7f-8e16-1dbf9c882333": {
              "id": "6751b0d1-78c0-4f7f-8e16-1dbf9c882333",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "6b947305-1f10-4bca-86e7-25333ab90671": {
              "id": "6b947305-1f10-4bca-86e7-25333ab90671",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "7578a1a6-119e-47ef-9ae9-d0e0c24794aa": {
              "id": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
              "parentNodeId": ""
            },
            "823eb1a5-9ebf-405f-9324-572605d6dd68": {
              "id": "823eb1a5-9ebf-405f-9324-572605d6dd68",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "87e72977-6289-4a6e-a73a-8e76b54b63fc": {
              "id": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "984bb254-4b9b-4f19-9088-40903b948dfb": {
              "id": "984bb254-4b9b-4f19-9088-40903b948dfb",
              "parentNodeId": ""
            },
            "a1a97629-e864-453e-a675-1fc6774842cf": {
              "id": "a1a97629-e864-453e-a675-1fc6774842cf",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "a7f3eab4-43e2-4a42-bf19-9bc95004bba3": {
              "id": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            },
            "aaebce98-efac-456a-b2a9-2eacbf70858a": {
              "id": "aaebce98-efac-456a-b2a9-2eacbf70858a",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "b56a1357-8ddb-43b5-af81-6592c15e30e4": {
              "id": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a": {
              "id": "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "d20e0fc4-3587-4970-8afe-136824f7dc46": {
              "id": "d20e0fc4-3587-4970-8afe-136824f7dc46",
              "parentNodeId": ""
            },
            "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9": {
              "id": "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9",
              "parentNodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d"
            },
            "e44548ff-3920-4b39-a193-c8edb4f6c117": {
              "id": "e44548ff-3920-4b39-a193-c8edb4f6c117",
              "parentNodeId": ""
            },
            "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
              "id": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "parentNodeId": ""
            },
            "f245b7ef-24e7-4d6d-944c-f48355930e0d": {
              "id": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
              "parentNodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f"
            },
            "f70e0bf7-cac7-4467-be3e-5fa3735ee28f": {
              "id": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
              "parentNodeId": "1074a86c-bc81-415d-8edc-3c387b774420"
            }
          }
        },
        "steps": {
          "09d427ee-4c6e-4b3e-a94f-33323684ca27": {
            "nodeId": "09d427ee-4c6e-4b3e-a94f-33323684ca27",
            "name": "Set Malicious Email to True",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "true"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "0d009b62-123a-4cbc-b741-2eea71fddc28": {
            "nodeId": "0d009b62-123a-4cbc-b741-2eea71fddc28",
            "name": "Send file to VT for Scan",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_file",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "content": "{{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content]}}",
                "filename": "{{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[file_name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "content": {
                  "description": "Base64 content of file",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File Contents",
                  "type": "string"
                },
                "filename": {
                  "description": "Filename to scan",
                  "order": 1,
                  "title": "Filename",
                  "type": "string"
                }
              },
              "required": [
                "content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "submission_response": {
                  "properties": {
                    "id": {
                      "description": "Submission ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "type": {
                      "description": "Submission type",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Submission Response",
                  "type": "object"
                }
              },
              "properties": {
                "submission_response": {
                  "$ref": "#/definitions/submission_response",
                  "description": "File submission response",
                  "order": 1,
                  "title": "Submission Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0df75dc8-0336-43c3-b3d7-18f080a89f19": {
            "nodeId": "0df75dc8-0336-43c3-b3d7-18f080a89f19",
            "name": "Has Attachments",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "1370aeb1-247b-426d-af1e-fced15c43b23",
              "stepControlParams": [
                {
                  "edgeId": "1370aeb1-247b-426d-af1e-fced15c43b23",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9e8a3175-fc54-4817-9beb-73c6ca4b94bc",
                  "expression": {
                    "name": "17edb1e0-ffca-4ff7-ad48-adbd19429a29.icon_email.has_attachments",
                    "type": "variable"
                  },
                  "expressionText": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[has_attachments]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "1074a86c-bc81-415d-8edc-3c387b774420": {
            "nodeId": "1074a86c-bc81-415d-8edc-3c387b774420",
            "name": "Email Attachment Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "bfd977f3-03cd-4715-b63c-e10ab642d490",
              "nextEdgeId": "b02fb6ba-5495-4c0a-94a5-275f5e8ee34b",
              "repeatVariable": "[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
            "nodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
            "name": "Office 365 New Email Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": true,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "test@hotmail.com",
                "subject_query": ""
              }
            },
            "triggerId": "c1964114-1e06-47e7-8b18-96138393c920",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": "",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87": {
            "nodeId": "19ee2956-27e1-4e29-ae4c-e9b8ae5ada87",
            "name": "VT Malicious Scan Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found: \nFile Name: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[file_name]}}\nFile Type: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content_type]}}\n\n---\n\nVirus Total Report Link: https://www.virustotal.com/gui/file/{{[bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a].[report].[sha256]}}/detection\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1a618ebf-8d61-4472-b2ee-53ac0cf3112f": {
            "nodeId": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f",
            "name": "Get Result",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "malicious": {
                      "order": 25,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1b82897d-95a2-4799-87d8-881d201d8fa8": {
            "nodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
            "name": "# Remediation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Remediation Goes Here\n\n(this artifact can be removed)\n\nAt this point in the workflow, we've established we have a malicious email. \n\nRemediation steps go on this branch of the flow. They can be email notifications, slack notifications for human follow up. Remediation can also go further and block the sender and delete the email from your organization. \n\nIn this example, I will send a notification via email, and use the Office Admin plugin to both delete the email and block the sender from our organization. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "20748ce0-1592-4828-9c21-7ebb3f46083a": {
            "nodeId": "20748ce0-1592-4828-9c21-7ebb3f46083a",
            "name": "Break on Malicious File",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "b3cc74fe-7d84-4d55-b496-debcff297acd",
                "expression": {
                  "type": "literal",
                  "value": true
                },
                "expressionText": "true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "20c2237a-ec86-4eeb-987e-d6e222c6d7e0": {
            "nodeId": "20c2237a-ec86-4eeb-987e-d6e222c6d7e0",
            "name": "Malicious Indicator Variable Name",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[29b6f6b2-baf5-45fe-aa3a-4617650163fd].[basename]}}-Mailicious Email"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "29b6f6b2-baf5-45fe-aa3a-4617650163fd": {
            "nodeId": "29b6f6b2-baf5-45fe-aa3a-4617650163fd",
            "name": "Job ID Basename",
            "type": "action",
            "plugin": {
              "name": "Basename",
              "slugVendor": "rapid7",
              "slugName": "basename",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/basename/1.0.0/icon.png"
            },
            "identifier": "basename",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "path": "{{[$job].[URL]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "path": {
                  "description": "URL or file path",
                  "order": 1,
                  "title": "Path",
                  "type": "string"
                }
              },
              "required": [
                "path"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "basename": {
                  "description": "Basename result",
                  "order": 1,
                  "title": "Basename",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "2c394058-05b0-4322-ba5c-48c63ea1a927": {
            "nodeId": "2c394058-05b0-4322-ba5c-48c63ea1a927",
            "name": "Malicious File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found: \nFile Name: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[file_name]}}\nFile Type: {{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content_type]}}\n\n---\n\nVirus Total Report Link: https://www.virustotal.com/gui/file/{{[3747b60f-4236-4393-a4da-bc760bbf86d6].[report].[sha256]}}/detection\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3": {
            "nodeId": "323b29a6-ce79-43e0-a0f3-0ab3671d1cd3",
            "name": "Analysis Explanation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Analysis Explanation\n\n(This artifact can be removed)\n\nFor each attached email we find, we will attempt to extract the URLs from that email and see if any are malicious. This will be the best indicator of a suspicious email. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "36750222-5693-4152-a83e-2196bf5571e0": {
            "nodeId": "36750222-5693-4152-a83e-2196bf5571e0",
            "name": "Malicious Email Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious Email Found\n\n(this artifact can be removed)\n\nAt this point, we can be sure that the email we've found is spam. Here you should take remediation steps to remove the email from your organization.\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "3747b60f-4236-4393-a4da-bc760bbf86d6": {
            "nodeId": "3747b60f-4236-4393-a4da-bc760bbf86d6",
            "name": "VT Look for Hash",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[b56a1357-8ddb-43b5-af81-6592c15e30e4].[md5]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 hash to lookup",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "alert_context": {
                  "properties": {
                    "dest_ip": {
                      "description": "Destination IP",
                      "order": 1,
                      "title": "Destination IP",
                      "type": "string"
                    },
                    "dest_port": {
                      "description": "Destination port",
                      "order": 2,
                      "title": "Destination Port",
                      "type": "integer"
                    },
                    "hostname": {
                      "description": "In case the alert is related to an HTTP event, destination hostname",
                      "order": 3,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Communication protocol",
                      "order": 4,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "src_ip": {
                      "description": "Source IP",
                      "order": 5,
                      "title": "Source IP",
                      "type": "string"
                    },
                    "src_port": {
                      "description": "Source port",
                      "order": 6,
                      "title": "Source Port",
                      "type": "integer"
                    },
                    "url": {
                      "description": "In case the alert is related to an HTTP event, destination URL",
                      "order": 7,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Alert Context",
                  "type": "object"
                },
                "crowdsourced_ids_results": {
                  "properties": {
                    "alert_context": {
                      "description": "Context for every match of that alert",
                      "items": {
                        "$ref": "#/definitions/alert_context"
                      },
                      "order": 1,
                      "title": "Alert Context",
                      "type": "array"
                    },
                    "alert_severity": {
                      "description": "Alert severity",
                      "order": 2,
                      "title": "Alert Severity",
                      "type": "string"
                    },
                    "rule_category": {
                      "description": "Alert category description",
                      "order": 3,
                      "title": "Rule Category",
                      "type": "string"
                    },
                    "rule_id": {
                      "description": "Suricata/Snort rule SID",
                      "order": 4,
                      "title": "Rule ID",
                      "type": "string"
                    },
                    "rule_msg": {
                      "description": "Alert description",
                      "order": 5,
                      "title": "Rule Message",
                      "type": "string"
                    },
                    "rule_source": {
                      "description": "Rule source, determined by SID range",
                      "order": 6,
                      "title": "Rule Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Ids Results",
                  "type": "object"
                },
                "crowdsourced_ids_stats": {
                  "properties": {
                    "high": {
                      "description": "Number of matched rules having a high severity",
                      "order": 1,
                      "title": "High",
                      "type": "integer"
                    },
                    "info": {
                      "description": "Number of matched rules having an info severity",
                      "order": 2,
                      "title": "Info",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched rules having a low severity",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched rules having a medium severity",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Crowdsourced Ids Stats",
                  "type": "object"
                },
                "crowdsourced_yara_results": {
                  "properties": {
                    "author": {
                      "description": "Rule author",
                      "order": 1,
                      "title": "Author",
                      "type": "string"
                    },
                    "description": {
                      "description": "Matched rule description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "match_in_subfile": {
                      "description": "Whether the match was in a subfile or not",
                      "order": 3,
                      "title": "Match in Subfile",
                      "type": "boolean"
                    },
                    "rule_name": {
                      "description": "Matched rule name",
                      "order": 4,
                      "title": "Rule Name",
                      "type": "string"
                    },
                    "ruleset_id": {
                      "description": "VirusTotal's ruleset ID",
                      "order": 5,
                      "title": "Ruleset ID",
                      "type": "string"
                    },
                    "ruleset_name": {
                      "description": "Matched rule's ruleset name",
                      "order": 6,
                      "title": "Ruleset Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Ruleset source",
                      "order": 7,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Yara Results",
                  "type": "object"
                },
                "file_report": {
                  "properties": {
                    "capabilities_tags": {
                      "description": "List of representative tags related to the file's capabilities",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Capabilities Tags",
                      "type": "array"
                    },
                    "creation_date": {
                      "description": "Extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "crowdsourced_ids_results": {
                      "description": "IDS (Snort and Suricata) matches for the file. If the file is not a PCAP, the matches are taken from a PCAP generated after running the file in a sandbox",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_ids_results"
                      },
                      "order": 3,
                      "title": "Crowdsourced IDS Results",
                      "type": "array"
                    },
                    "crowdsourced_ids_stats": {
                      "$ref": "#/definitions/crowdsourced_ids_stats",
                      "description": "IDS results stats",
                      "order": 4,
                      "title": "Crowdsourced IDS Stats"
                    },
                    "crowdsourced_yara_results": {
                      "description": "YARA matches for the file",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_yara_results"
                      },
                      "order": 5,
                      "title": "Crowdsourced YARA Results",
                      "type": "array"
                    },
                    "downloadable": {
                      "description": "True if the file can be downloaded, false otherwise",
                      "order": 6,
                      "title": "Downloadable",
                      "type": "boolean"
                    },
                    "first_submission_date": {
                      "description": "Date when the file was first seen in VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "last_analysis_date": {
                      "description": "Most recent scan date (UTC timestamp)",
                      "order": 8,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Latest scan results. For more information about its format, check the Analysis object results attribute",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 9,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "A summary of the latest scan results",
                      "order": 10,
                      "title": "Last Analysis Stats"
                    },
                    "last_modification_date": {
                      "description": "Date when the object itself was last modified (UTC timestamp)",
                      "order": 11,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "Most recent date the file was posted to VirusTotal (UTC timestamp)",
                      "order": 12,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "main_icon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the main icon",
                      "order": 13,
                      "title": "Main Icon"
                    },
                    "malicious": {
                      "description": "True if there are one or more votes indicating that the file is malicious",
                      "order": 32,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "File's MD5 hash",
                      "order": 14,
                      "title": "MD5",
                      "type": "string"
                    },
                    "meaningful_name": {
                      "description": "The most interesting name out of all file's names",
                      "order": 15,
                      "title": "Meaningful Name",
                      "type": "string"
                    },
                    "names": {
                      "description": "All file names associated with the file",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Names",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "File's score calculated from all votes posted by the VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "sandbox_verdicts": {
                      "description": "A summary of all sandbox verdicts for a given file",
                      "order": 18,
                      "title": "Sandbox Verdicts",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "File's SHA1 hash",
                      "order": 19,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "File's SHA256 hash",
                      "order": 20,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "sigma_analysis_stats": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules, grouped by its severity",
                      "order": 21,
                      "title": "Sigma Analysis Stats"
                    },
                    "sigma_analysis_summary": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules group by its severity",
                      "order": 22,
                      "title": "Sigma Analysis Summary"
                    },
                    "size": {
                      "description": "File size in bytes",
                      "order": 23,
                      "title": "Size",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "Tags",
                      "type": "array"
                    },
                    "times_submitted": {
                      "description": "Number of times the file has been posted to VirusTotal",
                      "order": 25,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided by harmless and malicious",
                      "order": 26,
                      "title": "Total Votes"
                    },
                    "type_description": {
                      "description": "Describes the file type",
                      "order": 27,
                      "title": "Type Description",
                      "type": "string"
                    },
                    "type_extension": {
                      "description": "Specifies file extension",
                      "order": 28,
                      "title": "Type Extension",
                      "type": "string"
                    },
                    "type_tag": {
                      "description": "Tag representing the file type",
                      "order": 29,
                      "title": "Type Tag",
                      "type": "string"
                    },
                    "unique_sources": {
                      "description": "Indicates from how many different sources the file has been posted from",
                      "order": 30,
                      "title": "Unique Sources",
                      "type": "integer"
                    },
                    "vhash": {
                      "description": "In-house similarity clustering algorithm value, based on a simple structural feature hash allowing you to find similar files",
                      "order": 31,
                      "title": "VHASH",
                      "type": "string"
                    }
                  },
                  "title": "File Report",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "sigma_analysis": {
                  "properties": {
                    "critical": {
                      "description": "Number of matched critical severity rules/rulesets",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "high": {
                      "description": "Number of matched high severity rules/rulesets",
                      "order": 2,
                      "title": "High",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched low severity rules/rulesets",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched medium severity rules/rulesets",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Sigma Analysis",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file_report",
                  "description": "Hash report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "3ca29053-84ce-4616-acd3-6fe8fb2f2d03": {
            "nodeId": "3ca29053-84ce-4616-acd3-6fe8fb2f2d03",
            "name": "VirusTotal Scan URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_url",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL to scan",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "submission_response": {
                  "properties": {
                    "id": {
                      "description": "Submission ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "type": {
                      "description": "Submission type",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Submission Response",
                  "type": "object"
                }
              },
              "properties": {
                "submission_response": {
                  "$ref": "#/definitions/submission_response",
                  "description": "URL submission response",
                  "order": 1,
                  "title": "Submission Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "419e96fc-d195-4e15-ba31-c98036bd8617": {
            "nodeId": "419e96fc-d195-4e15-ba31-c98036bd8617",
            "name": "Overall Malicious Indicator",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# MALICIOUS INDICATOR: \nWas email malicious: {{[d20e0fc4-3587-4970-8afe-136824f7dc46].[value]}}\n\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "47496fd4-9310-4fac-b631-ef321f7ef064": {
            "nodeId": "47496fd4-9310-4fac-b631-ef321f7ef064",
            "name": "File Analysis Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## File Analysis\n\n(This artifact can be removed) \n\nThis loop will analyze files and look for any malicious files. If any are found this email will be marked as malicious. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d": {
            "nodeId": "5476f0ac-2e67-40c5-a2b9-e26dd2fba99d",
            "name": "File Analysis Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "65c194fa-a3b7-432d-abca-5a4f1438fd42",
              "nextEdgeId": "8b25fca3-2cbf-4219-bf64-a2fe2e5e6544",
              "repeatVariable": "[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_files]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "57940a7a-4779-42cb-a785-a0d37a73ef90": {
            "nodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
            "name": "Overview Note",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Overview \n\n(This artifact should be removed)\n\nThis workflow assumes a standard phishing process. The user will push the phish button on a suspicious email that will then be sent to the mailbox this flow is monitoring as an attachment. \n\nWe can assume the base email is benign and any suspicious or malicious content will be in the attachment(s).\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5e08635d-9729-4867-9150-4d012f64b852": {
            "nodeId": "5e08635d-9729-4867-9150-4d012f64b852",
            "name": "Extract URLs",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "1.1.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/1.1.6/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[1074a86c-bc81-415d-8edc-3c387b774420].[$item].[body]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "61671b98-5732-4d0e-bb12-6fbaa469ae0e": {
            "nodeId": "61671b98-5732-4d0e-bb12-6fbaa469ae0e",
            "name": "Malicious URL",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
              "stepControlParams": [
                {
                  "edgeId": "0b8549a1-a6cf-44bf-ba2a-ff380cd23e76",
                  "expression": {
                    "name": "1a618ebf-8d61-4472-b2ee-53ac0cf3112f.report.malicious",
                    "type": "variable"
                  },
                  "expressionText": "{{[1a618ebf-8d61-4472-b2ee-53ac0cf3112f].[report].[malicious]}}"
                },
                {
                  "edgeId": "9748c50c-303f-4b5b-8f9e-bf50286ad86b",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "61ee7af6-fe69-4995-975c-c69f5bd952b9": {
            "nodeId": "61ee7af6-fe69-4995-975c-c69f5bd952b9",
            "name": "Purge Email from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.1.0/icon.png"
            },
            "identifier": "mass_search_and_purge",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "compliance_search_name": "Search for {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails].[0].[subject]}}",
                "content_match_query": "subject: \"{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails].[0].[subject]}}\" from: \"{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails].[0].[sender]}}\"",
                "delete_items": true,
                "query_timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "compliance_search_name": {
                  "description": "Name of compliance search",
                  "order": 1,
                  "title": "Compliance Search Name",
                  "type": "string"
                },
                "content_match_query": {
                  "description": "This parameter uses a text search string or a query that's formatted by using the Keyword Query Language (KQL). For more information about KQL, see Keyword Query Language syntax reference (https://go.microsoft.com/fwlink/p/?linkid=269603)",
                  "order": 2,
                  "title": "Content Match Query",
                  "type": "string"
                },
                "delete_items": {
                  "default": false,
                  "description": "The script only executes the delete action if this parameter is true",
                  "order": 4,
                  "title": "Delete Items",
                  "type": "boolean"
                },
                "query_timeout": {
                  "default": 60,
                  "description": "Query timeout in minutes",
                  "order": 3,
                  "title": "Query Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "compliance_search_name",
                "content_match_query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "63487857-be4e-4c1e-9302-6a8c575d9193": {
            "nodeId": "63487857-be4e-4c1e-9302-6a8c575d9193",
            "name": "Was Malicious URL Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
              "stepControlParams": [
                {
                  "edgeId": "093d30cf-aff0-4f0b-8194-8587ec40789b",
                  "expression": {
                    "left": {
                      "name": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3.value",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "true"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[a7f3eab4-43e2-4a42-bf19-9bc95004bba3].[value]}} = 'true'"
                },
                {
                  "edgeId": "da6193bb-78c9-4c8e-addf-bbcd12d5e529",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "640b894e-8bc3-47b3-8468-ebc9efa310fb": {
            "nodeId": "640b894e-8bc3-47b3-8468-ebc9efa310fb",
            "name": "Was VT Scan Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "795a059f-1749-4ed1-8ce3-6cb1a6ada15f",
              "stepControlParams": [
                {
                  "edgeId": "1271a174-3543-4407-91ce-df80e79c04a6",
                  "expression": {
                    "name": "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a.report.malicious",
                    "type": "variable"
                  },
                  "expressionText": "{{[bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a].[report].[malicious]}}"
                },
                {
                  "edgeId": "795a059f-1749-4ed1-8ce3-6cb1a6ada15f",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "66edc4da-f487-4623-836c-97faea6384c9": {
            "nodeId": "66edc4da-f487-4623-836c-97faea6384c9",
            "name": "Extracted URLs",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#each [5e08635d-9729-4867-9150-4d012f64b852].[urls]}}\n{{this}}\n{{/each}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6751b0d1-78c0-4f7f-8e16-1dbf9c882333": {
            "nodeId": "6751b0d1-78c0-4f7f-8e16-1dbf9c882333",
            "name": "Break on malicious VT Scan",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "9a5afefa-a91d-4af5-b7a9-6db1642420ec",
                "expression": {
                  "type": "literal",
                  "value": true
                },
                "expressionText": "true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "6b947305-1f10-4bca-86e7-25333ab90671": {
            "nodeId": "6b947305-1f10-4bca-86e7-25333ab90671",
            "name": "Was Malicious File Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c7ef1193-da58-4139-8281-1103bd076d0c",
              "stepControlParams": [
                {
                  "edgeId": "5a102bcc-e4ae-4fbe-b3b1-0a4daddbe9b7",
                  "expression": {
                    "left": {
                      "name": "3747b60f-4236-4393-a4da-bc760bbf86d6.$success",
                      "type": "variable"
                    },
                    "op": "AND",
                    "right": {
                      "name": "3747b60f-4236-4393-a4da-bc760bbf86d6.report.malicious",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[3747b60f-4236-4393-a4da-bc760bbf86d6].[$success]}} AND {{[3747b60f-4236-4393-a4da-bc760bbf86d6].[report].[malicious]}}"
                },
                {
                  "edgeId": "ab7059a9-41b2-4e0f-a965-f1921253f17c",
                  "expression": {
                    "left": {
                      "name": "3747b60f-4236-4393-a4da-bc760bbf86d6.$success",
                      "type": "variable"
                    },
                    "op": "AND",
                    "right": {
                      "expr": {
                        "name": "3747b60f-4236-4393-a4da-bc760bbf86d6.report.malicious",
                        "type": "variable"
                      },
                      "op": "NOT",
                      "type": "unary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[3747b60f-4236-4393-a4da-bc760bbf86d6].[$success]}} AND NOT {{[3747b60f-4236-4393-a4da-bc760bbf86d6].[report].[malicious]}}"
                },
                {
                  "edgeId": "c7ef1193-da58-4139-8281-1103bd076d0c",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "7578a1a6-119e-47ef-9ae9-d0e0c24794aa": {
            "nodeId": "7578a1a6-119e-47ef-9ae9-d0e0c24794aa",
            "name": "Send Notification Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "The following email was found to be malicious. \n\nEmail From: {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}\nEmail Subject: {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[subject]}}\n\nJob URL: {{[$job].[URL]}}",
                "cc": [],
                "email_from": "test@hotmail.com",
                "email_to": "test@hotmail.com",
                "is_html": false,
                "subject": "Malicious Email Found"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_to",
                "subject",
                "body",
                "is_html",
                "email_from"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "823eb1a5-9ebf-405f-9324-572605d6dd68": {
            "nodeId": "823eb1a5-9ebf-405f-9324-572605d6dd68",
            "name": "URL to Check",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Checking URL: {{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "87e72977-6289-4a6e-a73a-8e76b54b63fc": {
            "nodeId": "87e72977-6289-4a6e-a73a-8e76b54b63fc",
            "name": "Break Email Attachment Loop",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "4b5263cb-ea27-479c-af7b-673384988e5e",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": "true"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "true"
                  },
                  "type": "binary"
                },
                "expressionText": "\"true\" = \"true\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "984bb254-4b9b-4f19-9088-40903b948dfb": {
            "nodeId": "984bb254-4b9b-4f19-9088-40903b948dfb",
            "name": "Set Malicious Variable",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "false"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a1a97629-e864-453e-a675-1fc6774842cf": {
            "nodeId": "a1a97629-e864-453e-a675-1fc6774842cf",
            "name": "Set Malicious Indicator for VT Report",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "true"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a7f3eab4-43e2-4a42-bf19-9bc95004bba3": {
            "nodeId": "a7f3eab4-43e2-4a42-bf19-9bc95004bba3",
            "name": "Is URL Malicious",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "retrieve",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Variable to get value from",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                }
              },
              "required": [
                "variable_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "value": {
                  "description": "Value",
                  "order": 1,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "aaebce98-efac-456a-b2a9-2eacbf70858a": {
            "nodeId": "aaebce98-efac-456a-b2a9-2eacbf70858a",
            "name": "Malicious URL Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "a4a14e4f-c104-490c-885a-d0ed5477720f",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": "true"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "true"
                  },
                  "type": "binary"
                },
                "expressionText": "\"true\"=\"true\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "b56a1357-8ddb-43b5-af81-6592c15e30e4": {
            "nodeId": "b56a1357-8ddb-43b5-af81-6592c15e30e4",
            "name": "HashIT",
            "type": "action",
            "plugin": {
              "name": "HashIt",
              "slugVendor": "rapid7",
              "slugName": "hashit",
              "slugVersion": "2.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hashit/2.0.1/icon.png"
            },
            "identifier": "bytes",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "bytes": "{{[5476f0ac-2e67-40c5-a2b9-e26dd2fba99d].[$item].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "bytes": {
                  "description": "Base64 encoded file bytes to hash",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Bytes",
                  "type": "string"
                }
              },
              "required": [
                "bytes"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1 Hash",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256 Hash",
                  "type": "string"
                },
                "sha512": {
                  "description": "SHA512 hash",
                  "order": 4,
                  "title": "SHA512 Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a": {
            "nodeId": "bb5fca5c-2d71-4432-be47-8c5ee4d9ad6a",
            "name": "Get VT Scan",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_file_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[b56a1357-8ddb-43b5-af81-6592c15e30e4].[md5]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 of file",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "alert_context": {
                  "properties": {
                    "dest_ip": {
                      "description": "Destination IP",
                      "order": 1,
                      "title": "Destination IP",
                      "type": "string"
                    },
                    "dest_port": {
                      "description": "Destination port",
                      "order": 2,
                      "title": "Destination Port",
                      "type": "integer"
                    },
                    "hostname": {
                      "description": "In case the alert is related to an HTTP event, destination hostname",
                      "order": 3,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Communication protocol",
                      "order": 4,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "src_ip": {
                      "description": "Source IP",
                      "order": 5,
                      "title": "Source IP",
                      "type": "string"
                    },
                    "src_port": {
                      "description": "Source port",
                      "order": 6,
                      "title": "Source Port",
                      "type": "integer"
                    },
                    "url": {
                      "description": "In case the alert is related to an HTTP event, destination URL",
                      "order": 7,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Alert Context",
                  "type": "object"
                },
                "crowdsourced_ids_results": {
                  "properties": {
                    "alert_context": {
                      "description": "Context for every match of that alert",
                      "items": {
                        "$ref": "#/definitions/alert_context"
                      },
                      "order": 1,
                      "title": "Alert Context",
                      "type": "array"
                    },
                    "alert_severity": {
                      "description": "Alert severity",
                      "order": 2,
                      "title": "Alert Severity",
                      "type": "string"
                    },
                    "rule_category": {
                      "description": "Alert category description",
                      "order": 3,
                      "title": "Rule Category",
                      "type": "string"
                    },
                    "rule_id": {
                      "description": "Suricata/Snort rule SID",
                      "order": 4,
                      "title": "Rule ID",
                      "type": "string"
                    },
                    "rule_msg": {
                      "description": "Alert description",
                      "order": 5,
                      "title": "Rule Message",
                      "type": "string"
                    },
                    "rule_source": {
                      "description": "Rule source, determined by SID range",
                      "order": 6,
                      "title": "Rule Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Ids Results",
                  "type": "object"
                },
                "crowdsourced_ids_stats": {
                  "properties": {
                    "high": {
                      "description": "Number of matched rules having a high severity",
                      "order": 1,
                      "title": "High",
                      "type": "integer"
                    },
                    "info": {
                      "description": "Number of matched rules having an info severity",
                      "order": 2,
                      "title": "Info",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched rules having a low severity",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched rules having a medium severity",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Crowdsourced Ids Stats",
                  "type": "object"
                },
                "crowdsourced_yara_results": {
                  "properties": {
                    "author": {
                      "description": "Rule author",
                      "order": 1,
                      "title": "Author",
                      "type": "string"
                    },
                    "description": {
                      "description": "Matched rule description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "match_in_subfile": {
                      "description": "Whether the match was in a subfile or not",
                      "order": 3,
                      "title": "Match in Subfile",
                      "type": "boolean"
                    },
                    "rule_name": {
                      "description": "Matched rule name",
                      "order": 4,
                      "title": "Rule Name",
                      "type": "string"
                    },
                    "ruleset_id": {
                      "description": "VirusTotal's ruleset ID",
                      "order": 5,
                      "title": "Ruleset ID",
                      "type": "string"
                    },
                    "ruleset_name": {
                      "description": "Matched rule's ruleset name",
                      "order": 6,
                      "title": "Ruleset Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Ruleset source",
                      "order": 7,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Yara Results",
                  "type": "object"
                },
                "file_report": {
                  "properties": {
                    "capabilities_tags": {
                      "description": "List of representative tags related to the file's capabilities",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Capabilities Tags",
                      "type": "array"
                    },
                    "creation_date": {
                      "description": "Extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "crowdsourced_ids_results": {
                      "description": "IDS (Snort and Suricata) matches for the file. If the file is not a PCAP, the matches are taken from a PCAP generated after running the file in a sandbox",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_ids_results"
                      },
                      "order": 3,
                      "title": "Crowdsourced IDS Results",
                      "type": "array"
                    },
                    "crowdsourced_ids_stats": {
                      "$ref": "#/definitions/crowdsourced_ids_stats",
                      "description": "IDS results stats",
                      "order": 4,
                      "title": "Crowdsourced IDS Stats"
                    },
                    "crowdsourced_yara_results": {
                      "description": "YARA matches for the file",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_yara_results"
                      },
                      "order": 5,
                      "title": "Crowdsourced YARA Results",
                      "type": "array"
                    },
                    "downloadable": {
                      "description": "True if the file can be downloaded, false otherwise",
                      "order": 6,
                      "title": "Downloadable",
                      "type": "boolean"
                    },
                    "first_submission_date": {
                      "description": "Date when the file was first seen in VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "last_analysis_date": {
                      "description": "Most recent scan date (UTC timestamp)",
                      "order": 8,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Latest scan results. For more information about its format, check the Analysis object results attribute",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 9,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "A summary of the latest scan results",
                      "order": 10,
                      "title": "Last Analysis Stats"
                    },
                    "last_modification_date": {
                      "description": "Date when the object itself was last modified (UTC timestamp)",
                      "order": 11,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "Most recent date the file was posted to VirusTotal (UTC timestamp)",
                      "order": 12,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "main_icon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the main icon",
                      "order": 13,
                      "title": "Main Icon"
                    },
                    "malicious": {
                      "description": "True if there are one or more votes indicating that the file is malicious",
                      "order": 32,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "File's MD5 hash",
                      "order": 14,
                      "title": "MD5",
                      "type": "string"
                    },
                    "meaningful_name": {
                      "description": "The most interesting name out of all file's names",
                      "order": 15,
                      "title": "Meaningful Name",
                      "type": "string"
                    },
                    "names": {
                      "description": "All file names associated with the file",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Names",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "File's score calculated from all votes posted by the VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "sandbox_verdicts": {
                      "description": "A summary of all sandbox verdicts for a given file",
                      "order": 18,
                      "title": "Sandbox Verdicts",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "File's SHA1 hash",
                      "order": 19,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "File's SHA256 hash",
                      "order": 20,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "sigma_analysis_stats": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules, grouped by its severity",
                      "order": 21,
                      "title": "Sigma Analysis Stats"
                    },
                    "sigma_analysis_summary": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules group by its severity",
                      "order": 22,
                      "title": "Sigma Analysis Summary"
                    },
                    "size": {
                      "description": "File size in bytes",
                      "order": 23,
                      "title": "Size",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "Tags",
                      "type": "array"
                    },
                    "times_submitted": {
                      "description": "Number of times the file has been posted to VirusTotal",
                      "order": 25,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided by harmless and malicious",
                      "order": 26,
                      "title": "Total Votes"
                    },
                    "type_description": {
                      "description": "Describes the file type",
                      "order": 27,
                      "title": "Type Description",
                      "type": "string"
                    },
                    "type_extension": {
                      "description": "Specifies file extension",
                      "order": 28,
                      "title": "Type Extension",
                      "type": "string"
                    },
                    "type_tag": {
                      "description": "Tag representing the file type",
                      "order": 29,
                      "title": "Type Tag",
                      "type": "string"
                    },
                    "unique_sources": {
                      "description": "Indicates from how many different sources the file has been posted from",
                      "order": 30,
                      "title": "Unique Sources",
                      "type": "integer"
                    },
                    "vhash": {
                      "description": "In-house similarity clustering algorithm value, based on a simple structural feature hash allowing you to find similar files",
                      "order": 31,
                      "title": "VHASH",
                      "type": "string"
                    }
                  },
                  "title": "File Report",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "sigma_analysis": {
                  "properties": {
                    "critical": {
                      "description": "Number of matched critical severity rules/rulesets",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "high": {
                      "description": "Number of matched high severity rules/rulesets",
                      "order": 2,
                      "title": "High",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched low severity rules/rulesets",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched medium severity rules/rulesets",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Sigma Analysis",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file_report",
                  "description": "Hash report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d20e0fc4-3587-4970-8afe-136824f7dc46": {
            "nodeId": "d20e0fc4-3587-4970-8afe-136824f7dc46",
            "name": "Is Email Malicious",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "retrieve",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Variable to get value from",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                }
              },
              "required": [
                "variable_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "value": {
                  "description": "Value",
                  "order": 1,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9": {
            "nodeId": "d8e82411-e4c9-4c41-89f7-e43af5bb5fd9",
            "name": "Set Malicious Indicator for File",
            "type": "action",
            "plugin": {
              "name": "Storage",
              "slugVendor": "rapid7",
              "slugName": "storage",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/storage/1.0.0/icon.png"
            },
            "identifier": "store",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "variable_name": "{{[20c2237a-ec86-4eeb-987e-d6e222c6d7e0].[content]}}",
                "variable_value": "true"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "variable_name": {
                  "description": "Name of the variable to store",
                  "order": 1,
                  "title": "Variable Name",
                  "type": "string"
                },
                "variable_value": {
                  "description": "Value of the variable to store",
                  "order": 2,
                  "title": "Variable Value",
                  "type": "string"
                }
              },
              "required": [
                "variable_name",
                "variable_value"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e44548ff-3920-4b39-a193-c8edb4f6c117": {
            "nodeId": "e44548ff-3920-4b39-a193-c8edb4f6c117",
            "name": "Block Sender from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.1.0/icon.png"
            },
            "identifier": "block_sender_transport_rule",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain_or_email_to_block": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}",
                "transport_rule_name": "Block {{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[sender]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain_or_email_to_block": {
                  "description": "Domain or email address to block",
                  "order": 1,
                  "title": "Domain or Email to Block",
                  "type": "string"
                },
                "transport_rule_name": {
                  "default": "InsightConnect Block List",
                  "description": "Transport rule name",
                  "order": 2,
                  "title": "Transport Rule Name",
                  "type": "string"
                }
              },
              "required": [
                "domain_or_email_to_block",
                "transport_rule_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result",
                  "order": 1,
                  "title": "Result",
                  "type": "string"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
            "nodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
            "name": "Was Overall Mail Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "7885e52a-a487-4510-9364-751a0efcff17",
              "stepControlParams": [
                {
                  "edgeId": "7885e52a-a487-4510-9364-751a0efcff17",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "fceaae38-58dd-4400-96b9-582929fcc93f",
                  "expression": {
                    "left": {
                      "name": "d20e0fc4-3587-4970-8afe-136824f7dc46.value",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "true"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[d20e0fc4-3587-4970-8afe-136824f7dc46].[value]}} = \"true\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f245b7ef-24e7-4d6d-944c-f48355930e0d": {
            "nodeId": "f245b7ef-24e7-4d6d-944c-f48355930e0d",
            "name": "Malicious URL Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious URL Found\n\nURL: {{[f70e0bf7-cac7-4467-be3e-5fa3735ee28f].[$item]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "f70e0bf7-cac7-4467-be3e-5fa3735ee28f": {
            "nodeId": "f70e0bf7-cac7-4467-be3e-5fa3735ee28f",
            "name": "URL Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "3ffbd486-f9e4-41dc-8651-99e69cc04489",
              "nextEdgeId": "721b924a-2524-4a9a-85b9-b3474697dcd9",
              "repeatVariable": "[5e08635d-9729-4867-9150-4d012f64b852].[urls]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Microsoft",
          "Phishing",
          "Threat Intelligence",
          "Virustotal"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "c1964114-1e06-47e7-8b18-96138393c920",
        "identifier": "email_received",
        "name": "Office 365 New Email Trigger",
        "description": "",
        "input": {
          "flatten_attachments": true,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "test@hotmail.com",
          "subject_query": ""
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": "",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "file_name": {
                  "order": 1,
                  "title": "File Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "4.0.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
        }
      }
    ]
  }
}