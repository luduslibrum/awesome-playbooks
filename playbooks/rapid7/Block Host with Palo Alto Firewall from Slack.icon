{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:32:30.568129076Z",
    "workflowVersions": [
      {
        "name": "Block Host with Palo Alto Firewall from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nUse the simplicity of a chat command in Slack to block or unblock a host in your Palo Alto Firewall.\n\nMultiple hosts can be specified within one command.\n\nSample Slack Trigger Commands:\n\n`@Rapid7 InsightConnect block-host 198.51.100.100`\n\n`@Rapid7 InsightConnect block-host 198.51.100.100 198.51.100.101`\n\n`@Rapid7 InsightConnect unblock-host 198.51.100.100`\n\n# Key Features\n\n* **Block and Unblock a Host** - Use Slack and Insight Connect to make firewall rules easy. \n\n# Requirements\n\n* [Slack](https://insightconnect.help.rapid7.com/docs/chatops-step)\n* Palo Alto Firewall username and password\n\n# Documentation\n\n## Setup\n\nThe workflow works by adding and removing address objects from an address object group in your Palo Alto Firewall. When using this workflow, you will need to setup a policy on your firewall that blocks IPs from an address group. \n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow. \n\nThere are two parameters you will need to configure in order to complete setup of your workflow:\n\n* Slack Channel - enter the Slack channel name matching your environment ex: `#channelname`\n* Palo Alto Object Group Name - enter the name of the group you would like to add and remove host objects from, ex: `ICON Block List`\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameters, activate the workflow in order to trigger it.\n\nBy default this workflow will automatically skip blocking private IP addresses, if youâ€™d like to block these as well, set `Skip RFC 1918` option to false in the `Create Network Object` step.\n\n### Usage\n\n*This workflow will trigger in any direct messages to your Chatbot **or** any message in a channel directed @ your Chatbot. Note the Chatbot must be in the channel in order to trigger the workflow this way.*\n\nFor example:\n* `@Rapid7 InsightConnect block-host 198.51.100.100`\n\nYou can also unblock a host. For example: \n* `@Rapid7 InsightConnect unblock-host 198.51.100.100`\n\nYou can also block and unblock domains:\n* `@Rapid7 InsightConnect block-host www.example.com`\n\nThe workflow will reply when it completes.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Palo Alto Firewall|6.1.1|5|\n|Type Converter|1.8.1|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.1 - Update Palo Alto Firewall plugin | Update Type Converter plugin | Update `keywords`\n* 2.0.0 - Leverage Parameters Feature | Update Palo Alto Firewall to latest version | Update Type Converter to latest version\n* 1.2.0 - Add automatic indicator extraction, allow for multiple hosts\n* 1.1.1 - Pass channel name from trigger to all subsequent steps so user only has to configure channel once\n* 1.1.0 - Update Palo Alto Firewall to latest version\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Teams](https://teams.microsoft.com)\n* [Microsoft Teams Setup](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n* [Palo Alto Firewall](https://www.paloaltonetworks.com/)\n",
        "graph": {
          "edges": {
            "08376514-9a79-4a4e-b040-95068297daa0": {
              "id": "08376514-9a79-4a4e-b040-95068297daa0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0ee9fb19-8a0e-42e4-be55-703f0c1b174f",
              "toNodeId": "83a8e7c1-1f97-4467-b67c-9f1fbc189df1"
            },
            "099fa753-4993-4a08-b578-eaf6538102af": {
              "id": "099fa753-4993-4a08-b578-eaf6538102af",
              "name": "Block Host",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "252505b1-b1e2-4567-95da-cd01a0bb39f3",
              "toNodeId": "d5b71fc2-89a4-4e45-96dc-b89521e10663"
            },
            "19daedc2-9648-400b-b3dd-0ae3934b0d0f": {
              "id": "19daedc2-9648-400b-b3dd-0ae3934b0d0f",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "3f170fd6-2826-45a7-856f-f19e80125d16",
              "toNodeId": "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5"
            },
            "3189c16a-365d-4a7a-b500-64f6146033a0": {
              "id": "3189c16a-365d-4a7a-b500-64f6146033a0",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5",
              "toNodeId": ""
            },
            "33271c34-d5ba-4164-93cb-14668dfb1be6": {
              "id": "33271c34-d5ba-4164-93cb-14668dfb1be6",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "d5b71fc2-89a4-4e45-96dc-b89521e10663",
              "toNodeId": "66d66255-234a-42e3-9aa5-11d0cac8fc35"
            },
            "382fde22-4cfa-4a73-926f-778c045d36ce": {
              "id": "382fde22-4cfa-4a73-926f-778c045d36ce",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "ce6e79d3-239d-4c67-ba70-f690962e56a0",
              "toNodeId": "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4"
            },
            "38bbe58a-b562-494c-92ca-097402ac1637": {
              "id": "38bbe58a-b562-494c-92ca-097402ac1637",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "71640fb0-fd89-4e3d-b356-dd502ae96c9b",
              "toNodeId": "f30393c6-4f10-4adf-b9cb-eef3f1bc5326"
            },
            "3c5f37c3-4f39-43ca-ade6-9e3861055474": {
              "id": "3c5f37c3-4f39-43ca-ade6-9e3861055474",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "toNodeId": "252505b1-b1e2-4567-95da-cd01a0bb39f3"
            },
            "4451475e-58dd-402d-bfb4-3d0d991ba796": {
              "id": "4451475e-58dd-402d-bfb4-3d0d991ba796",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "9986ec6b-8acf-4556-b100-4b64876ec273",
              "toNodeId": "7cbadd15-c9e0-4e39-afd1-dcd102feeef7"
            },
            "4aaf1741-9541-4081-8691-d4b4fc5e9bcc": {
              "id": "4aaf1741-9541-4081-8691-d4b4fc5e9bcc",
              "name": "Yes",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "5c03da19-5012-4bf4-bddd-e8e1ac58afd0",
              "toNodeId": "486fa158-42a6-45cc-9060-dc9e64f78ab1"
            },
            "5c075c64-7589-46e1-b05a-cc9c369f91c9": {
              "id": "5c075c64-7589-46e1-b05a-cc9c369f91c9",
              "name": "Unblock Host",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "252505b1-b1e2-4567-95da-cd01a0bb39f3",
              "toNodeId": "d437ab08-6124-49f1-8450-541092718cdc"
            },
            "64bf267e-25b9-4600-9a90-b700c5fc9532": {
              "id": "64bf267e-25b9-4600-9a90-b700c5fc9532",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "031c9dd7-cb0d-439b-a2a5-28c413b62f74",
              "toNodeId": ""
            },
            "65e9268a-6149-4c80-80e4-673adbb2f693": {
              "id": "65e9268a-6149-4c80-80e4-673adbb2f693",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "83a8e7c1-1f97-4467-b67c-9f1fbc189df1",
              "toNodeId": ""
            },
            "766efd98-7cb1-40ad-a45e-ad0e3fd49485": {
              "id": "766efd98-7cb1-40ad-a45e-ad0e3fd49485",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
              "toNodeId": "59de03bc-ff23-4ec8-bc3f-579deb153568"
            },
            "7796023e-7fd6-44c8-92fc-b4755f0b0831": {
              "id": "7796023e-7fd6-44c8-92fc-b4755f0b0831",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "toNodeId": "0ee9fb19-8a0e-42e4-be55-703f0c1b174f"
            },
            "8a409b54-6b00-448c-91d3-a98949207c0f": {
              "id": "8a409b54-6b00-448c-91d3-a98949207c0f",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "486fa158-42a6-45cc-9060-dc9e64f78ab1",
              "toNodeId": "9986ec6b-8acf-4556-b100-4b64876ec273"
            },
            "aa61f0cd-0af3-428e-a492-0bb4c08243bb": {
              "id": "aa61f0cd-0af3-428e-a492-0bb4c08243bb",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "d437ab08-6124-49f1-8450-541092718cdc",
              "toNodeId": "5c03da19-5012-4bf4-bddd-e8e1ac58afd0"
            },
            "acc630f4-20de-42d6-983a-a6618f891543": {
              "id": "acc630f4-20de-42d6-983a-a6618f891543",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "59de03bc-ff23-4ec8-bc3f-579deb153568",
              "toNodeId": "71640fb0-fd89-4e3d-b356-dd502ae96c9b"
            },
            "b2d71324-9a58-455a-959d-c97bff19b2bc": {
              "id": "b2d71324-9a58-455a-959d-c97bff19b2bc",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "7cbadd15-c9e0-4e39-afd1-dcd102feeef7",
              "toNodeId": ""
            },
            "cf14ed07-f136-473d-b259-6dcdd0d87874": {
              "id": "cf14ed07-f136-473d-b259-6dcdd0d87874",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f30393c6-4f10-4adf-b9cb-eef3f1bc5326",
              "toNodeId": "031c9dd7-cb0d-439b-a2a5-28c413b62f74"
            },
            "d4ea1cf5-6f35-4265-a0f8-ee87082da5c1": {
              "id": "d4ea1cf5-6f35-4265-a0f8-ee87082da5c1",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4",
              "toNodeId": ""
            },
            "e4b6a364-09bd-4cbc-aedf-0ade1aeeb6cf": {
              "id": "e4b6a364-09bd-4cbc-aedf-0ade1aeeb6cf",
              "name": "No",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "5c03da19-5012-4bf4-bddd-e8e1ac58afd0",
              "toNodeId": "ce6e79d3-239d-4c67-ba70-f690962e56a0"
            },
            "e8a7db0e-7b02-40d5-8a49-aad5428f5122": {
              "id": "e8a7db0e-7b02-40d5-8a49-aad5428f5122",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f30393c6-4f10-4adf-b9cb-eef3f1bc5326",
              "toNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "f55cc36c-ff92-447a-85ec-20458a1e98fc": {
              "id": "f55cc36c-ff92-447a-85ec-20458a1e98fc",
              "name": "",
              "description": "",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "fromNodeId": "66d66255-234a-42e3-9aa5-11d0cac8fc35",
              "toNodeId": "3f170fd6-2826-45a7-856f-f19e80125d16"
            }
          },
          "nodes": {
            "031c9dd7-cb0d-439b-a2a5-28c413b62f74": {
              "id": "031c9dd7-cb0d-439b-a2a5-28c413b62f74",
              "parentNodeId": ""
            },
            "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5": {
              "id": "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "0ee9fb19-8a0e-42e4-be55-703f0c1b174f": {
              "id": "0ee9fb19-8a0e-42e4-be55-703f0c1b174f",
              "parentNodeId": ""
            },
            "252505b1-b1e2-4567-95da-cd01a0bb39f3": {
              "id": "252505b1-b1e2-4567-95da-cd01a0bb39f3",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "3f170fd6-2826-45a7-856f-f19e80125d16": {
              "id": "3f170fd6-2826-45a7-856f-f19e80125d16",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "486fa158-42a6-45cc-9060-dc9e64f78ab1": {
              "id": "486fa158-42a6-45cc-9060-dc9e64f78ab1",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "4d650a86-639d-4f34-8920-52d3c954152b": {
              "id": "4d650a86-639d-4f34-8920-52d3c954152b",
              "parentNodeId": ""
            },
            "59de03bc-ff23-4ec8-bc3f-579deb153568": {
              "id": "59de03bc-ff23-4ec8-bc3f-579deb153568",
              "parentNodeId": ""
            },
            "5c03da19-5012-4bf4-bddd-e8e1ac58afd0": {
              "id": "5c03da19-5012-4bf4-bddd-e8e1ac58afd0",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "634ba1d9-2e69-4adf-b15b-1c32b1559e4c": {
              "id": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
              "parentNodeId": ""
            },
            "66d66255-234a-42e3-9aa5-11d0cac8fc35": {
              "id": "66d66255-234a-42e3-9aa5-11d0cac8fc35",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "71640fb0-fd89-4e3d-b356-dd502ae96c9b": {
              "id": "71640fb0-fd89-4e3d-b356-dd502ae96c9b",
              "parentNodeId": ""
            },
            "7cbadd15-c9e0-4e39-afd1-dcd102feeef7": {
              "id": "7cbadd15-c9e0-4e39-afd1-dcd102feeef7",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "83a8e7c1-1f97-4467-b67c-9f1fbc189df1": {
              "id": "83a8e7c1-1f97-4467-b67c-9f1fbc189df1",
              "parentNodeId": ""
            },
            "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4": {
              "id": "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "9986ec6b-8acf-4556-b100-4b64876ec273": {
              "id": "9986ec6b-8acf-4556-b100-4b64876ec273",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "ce6e79d3-239d-4c67-ba70-f690962e56a0": {
              "id": "ce6e79d3-239d-4c67-ba70-f690962e56a0",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "d437ab08-6124-49f1-8450-541092718cdc": {
              "id": "d437ab08-6124-49f1-8450-541092718cdc",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "d5b71fc2-89a4-4e45-96dc-b89521e10663": {
              "id": "d5b71fc2-89a4-4e45-96dc-b89521e10663",
              "parentNodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c"
            },
            "f30393c6-4f10-4adf-b9cb-eef3f1bc5326": {
              "id": "f30393c6-4f10-4adf-b9cb-eef3f1bc5326",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "031c9dd7-cb0d-439b-a2a5-28c413b62f74": {
            "nodeId": "031c9dd7-cb0d-439b-a2a5-28c413b62f74",
            "name": "No Valid Hosts Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "ðŸš¨*Workflow not executed* ðŸš¨\n\nPlease input the correct command and at least one valid host (IP address or domain).",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5": {
            "nodeId": "0bd4c431-9fc0-49a1-bb34-e7caa137d6e5",
            "name": "Successful Block Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Block Host Success\n\nBlocked: `{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}`"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0ee9fb19-8a0e-42e4-be55-703f0c1b174f": {
            "nodeId": "0ee9fb19-8a0e-42e4-be55-703f0c1b174f",
            "name": "Commit Changes",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.1/icon.png"
            },
            "identifier": "commit",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "commit-all",
                "cmd": "<commit-all><shared-policy><validate-only></validate-only></shared-policy></commit-all>"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "default": "all",
                  "description": "Commit action (Default: 'all')",
                  "order": 2,
                  "title": "Action",
                  "type": "string"
                },
                "cmd": {
                  "description": "XML specifying any commit arguments",
                  "order": 1,
                  "title": "CMD",
                  "type": "string"
                }
              },
              "required": [
                "cmd"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "response": {
                  "description": "Response from the firewall",
                  "order": 1,
                  "title": "Response",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "252505b1-b1e2-4567-95da-cd01a0bb39f3": {
            "nodeId": "252505b1-b1e2-4567-95da-cd01a0bb39f3",
            "name": "Which Command?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "099fa753-4993-4a08-b578-eaf6538102af",
              "stepControlParams": [
                {
                  "edgeId": "099fa753-4993-4a08-b578-eaf6538102af",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "5c075c64-7589-46e1-b05a-cc9c369f91c9",
                  "expression": {
                    "left": {
                      "name": "4d650a86-639d-4f34-8920-52d3c954152b.message.first_word",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "unblock-host"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[first_word]}} = \"unblock-host\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "3f170fd6-2826-45a7-856f-f19e80125d16": {
            "nodeId": "3f170fd6-2826-45a7-856f-f19e80125d16",
            "name": "Workflow Success Message Block",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":white_check_mark: *Block Host Success* :white_check_mark:\n\nBlocked: `{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}`\n\n",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "486fa158-42a6-45cc-9060-dc9e64f78ab1": {
            "nodeId": "486fa158-42a6-45cc-9060-dc9e64f78ab1",
            "name": "Remove Address Object from Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.1/icon.png"
            },
            "identifier": "remove_address_object_from_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address_object": "{{[d437ab08-6124-49f1-8450-541092718cdc].[address_objects].[0]}}",
                "device_name": "localhost.localdomain",
                "group": "{{$workflow.[Palo Alto Object Group Name]}}",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The name of the address object to remove",
                  "order": 1,
                  "title": "Address Object",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "address_object",
                "group",
                "device_name",
                "virtual_system"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4d650a86-639d-4f34-8920-52d3c954152b": {
            "nodeId": "4d650a86-639d-4f34-8920-52d3c954152b",
            "name": "Slack Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "{{$workflow.[Slack Channel]}}",
                "matchText": "block-host.*|unblock-host.*",
                "type": "any"
              }
            },
            "triggerId": "84f1ff0d-2042-404d-be4c-96c066df1e89",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "59de03bc-ff23-4ec8-bc3f-579deb153568": {
            "nodeId": "59de03bc-ff23-4ec8-bc3f-579deb153568",
            "name": "Command Message Received",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":rocket: *Starting Workflow* :rocket:",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "5c03da19-5012-4bf4-bddd-e8e1ac58afd0": {
            "nodeId": "5c03da19-5012-4bf4-bddd-e8e1ac58afd0",
            "name": "Is IP in Group?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e4b6a364-09bd-4cbc-aedf-0ade1aeeb6cf",
              "stepControlParams": [
                {
                  "edgeId": "4aaf1741-9541-4081-8691-d4b4fc5e9bcc",
                  "expression": {
                    "name": "d437ab08-6124-49f1-8450-541092718cdc.found",
                    "type": "variable"
                  },
                  "expressionText": "{{[d437ab08-6124-49f1-8450-541092718cdc].[found]}}"
                },
                {
                  "edgeId": "e4b6a364-09bd-4cbc-aedf-0ade1aeeb6cf",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "634ba1d9-2e69-4adf-b15b-1c32b1559e4c": {
            "nodeId": "634ba1d9-2e69-4adf-b15b-1c32b1559e4c",
            "name": "Block Host Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "3c5f37c3-4f39-43ca-ade6-9e3861055474",
              "nextEdgeId": "7796023e-7fd6-44c8-92fc-b4755f0b0831",
              "repeatVariable": "{{[71640fb0-fd89-4e3d-b356-dd502ae96c9b].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "66d66255-234a-42e3-9aa5-11d0cac8fc35": {
            "nodeId": "66d66255-234a-42e3-9aa5-11d0cac8fc35",
            "name": "Add Object to Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.1/icon.png"
            },
            "identifier": "add_address_object_to_group",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address_object": [
                  "{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}"
                ],
                "device_name": "localhost.localdomain",
                "group": "{{$workflow.[Palo Alto Object Group Name]}}",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address_object": {
                  "description": "The names of the address objects to add",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Address Object",
                  "type": "array"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 3,
                  "title": "Device Name",
                  "type": "string"
                },
                "group": {
                  "description": "Group name",
                  "order": 2,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 4,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "address_object",
                "group",
                "device_name",
                "virtual_system"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "Address objects currently in group",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success",
                "address_objects"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "71640fb0-fd89-4e3d-b356-dd502ae96c9b": {
            "nodeId": "71640fb0-fd89-4e3d-b356-dd502ae96c9b",
            "name": "Combine Indicators",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[indicators].[ip_addresses].[ipv4_addresses]}}",
                "array2": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[indicators].[domains]}}",
                "array3": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[indicators].[ip_addresses].[ipv6_addresses]}}",
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7cbadd15-c9e0-4e39-afd1-dcd102feeef7": {
            "nodeId": "7cbadd15-c9e0-4e39-afd1-dcd102feeef7",
            "name": "Successful Unblock Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unblock Host Success\n\nUnblocked: `{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}`"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "83a8e7c1-1f97-4467-b67c-9f1fbc189df1": {
            "nodeId": "83a8e7c1-1f97-4467-b67c-9f1fbc189df1",
            "name": "Workflow Complete Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":rocket: *Workflow Complete* :rocket:",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4": {
            "nodeId": "96cf2a82-cb44-48d6-8f1f-9b1656ab49f4",
            "name": "Unblock Failed Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Unblock Host Failure\n\n`{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}`"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "9986ec6b-8acf-4556-b100-4b64876ec273": {
            "nodeId": "9986ec6b-8acf-4556-b100-4b64876ec273",
            "name": "Workflow Success Message Unblock",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":white_check_mark:  *Unblock Host Success*  :white_check_mark:\n\nUnblocked: `{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}`\n",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "ce6e79d3-239d-4c67-ba70-f690962e56a0": {
            "nodeId": "ce6e79d3-239d-4c67-ba70-f690962e56a0",
            "name": "Workflow Failed Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "â—*Unblock Failed*â—\n\nCould not find host `{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}` in block list\n\nMore information can be found here: \n{{[$job].[URL]}}\n",
                "recipient": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[message].[channel]}}",
                "thread_ts": "{{[4d650a86-639d-4f34-8920-52d3c954152b].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "d437ab08-6124-49f1-8450-541092718cdc": {
            "nodeId": "d437ab08-6124-49f1-8450-541092718cdc",
            "name": "Check if IP in Group",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.1/icon.png"
            },
            "identifier": "check_if_address_object_in_group",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}",
                "device_name": "localhost.localdomain",
                "enable_search": true,
                "group": "{{$workflow.[Palo Alto Object Group Name]}}",
                "virtual_system": "vsys1"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, domain) within the address object instead of matching the name",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "device_name": {
                  "default": "localhost.localdomain",
                  "description": "Device name",
                  "order": 4,
                  "title": "Device Name",
                  "type": "string"
                },
                "enable_search": {
                  "default": false,
                  "description": "When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don't know the Address Object by its name",
                  "order": 3,
                  "title": "Enable Search",
                  "type": "boolean"
                },
                "group": {
                  "description": "Group name",
                  "order": 1,
                  "title": "Group",
                  "type": "string"
                },
                "virtual_system": {
                  "default": "vsys1",
                  "description": "Virtual system name",
                  "order": 5,
                  "title": "Virtual System Name",
                  "type": "string"
                }
              },
              "required": [
                "group",
                "address",
                "enable_search",
                "device_name",
                "virtual_system"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address_objects": {
                  "description": "The names of the address objects that match or contain address",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Address Objects",
                  "type": "array"
                },
                "found": {
                  "description": "Was address found in group",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d5b71fc2-89a4-4e45-96dc-b89521e10663": {
            "nodeId": "d5b71fc2-89a4-4e45-96dc-b89521e10663",
            "name": "Create Network Object",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.1/icon.png"
            },
            "identifier": "set_address_object",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}",
                "address_object": "{{[634ba1d9-2e69-4adf-b15b-1c32b1559e4c].[$item]}}",
                "description": "InsightConnect Created Address Object",
                "skip_rfc1918": true,
                "tags": "",
                "whitelist": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "The IP address, network CIDR, or FQDN e.g. 192.168.1.1, 192.168.1.0/24, google.com google.com",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "address_object": {
                  "description": "The name of the address object",
                  "order": 2,
                  "title": "Address Object",
                  "type": "string"
                },
                "description": {
                  "description": "A description for the address object",
                  "order": 3,
                  "title": "Description",
                  "type": "string"
                },
                "skip_rfc1918": {
                  "default": false,
                  "description": "Skip private IP addresses as defined in RFC 1918",
                  "order": 5,
                  "title": "Skip RFC 1918 (Private) IP Addresses",
                  "type": "boolean"
                },
                "tags": {
                  "description": "Tags for the address object. Use commas to separate multiple tags",
                  "order": 4,
                  "title": "Tags",
                  "type": "string"
                },
                "whitelist": {
                  "description": "This list contains a set of network objects that should not be blocked. This can include IPs, CIDR notation, or domains. It can not include an IP range (such as 10.0.0.0-10.0.0.10)",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Whitelist",
                  "type": "array"
                }
              },
              "required": [
                "skip_rfc1918",
                "address",
                "address_object"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "code": {
                  "description": "Response code from the firewall",
                  "order": 2,
                  "title": "Code",
                  "type": "string"
                },
                "message": {
                  "description": "A message with more detail about the status",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "status": {
                  "description": "The status of the requested operation e.g. success, error, etc",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f30393c6-4f10-4adf-b9cb-eef3f1bc5326": {
            "nodeId": "f30393c6-4f10-4adf-b9cb-eef3f1bc5326",
            "name": "At Least 1 Valid Host?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e8a7db0e-7b02-40d5-8a49-aad5428f5122",
              "stepControlParams": [
                {
                  "edgeId": "e8a7db0e-7b02-40d5-8a49-aad5428f5122",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "cf14ed07-f136-473d-b259-6dcdd0d87874",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "71640fb0-fd89-4e3d-b356-dd502ae96c9b.combined_array",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[71640fb0-fd89-4e3d-b356-dd502ae96c9b].[combined_array]}}) = 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Network & Firewall",
          "Palo_Alto",
          "Slack"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Slack Channel": {
                "type": "string",
                "description": "Enter Slack channel name in \"Current Value\" field\n\nex: #channelname"
              },
              "Palo Alto Object Group Name": {
                "type": "string",
                "description": "Specify the name of the group you would like to add and remove host objects from, ex: ICON Block List"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "84f1ff0d-2042-404d-be4c-96c066df1e89",
        "name": "Slack Trigger",
        "description": "",
        "input": {
          "matchChannel": "{{$workflow.[Slack Channel]}}",
          "matchText": "block-host.*|unblock-host.*",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}