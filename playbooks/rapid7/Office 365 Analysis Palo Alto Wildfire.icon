{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:54:49.390653384Z",
    "workflowVersions": [
      {
        "name": "Office 365 Analysis Palo Alto Wildfire",
        "type": "runnable",
        "version": "",
        "description": "# Description\r\n\r\nThis workflow is designed to automatically analyze incoming emails to determine if they are malicious. This workflow assumes a user is using their report phishing button to send an email to an administrative account with the suspicious email attached. The workflow will then analyze the attached email for any suspicious links or files. If any malicious indicators are found the email will be remediated across the organization.\r\n\r\n# Key Features\r\n\r\n* Identifies malicious emails\r\n* Removes identified emails from the entire organization\r\n* Blocks sender from the organization\r\n\r\n# Requirements\r\n\r\nAPI and account credentials for the following:\r\n\r\n\r\n* Microsoft Office365\r\n* Palo Alto Wildfire\r\n\r\n# Documentation\r\n\r\n## Setup\r\n\r\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\r\n\r\nOnce the workflow has been imported, on the workflow overview page, provide values for the workflow parameters. \r\n\r\nAdditionally, you need to update the `[\"change_me\"]` value in **Send Notification Email** step (within the Remediate Malicious Emails loop), it accepts a list of email addresses in _JSON format_, for example:\r\n\r\n```json\r\n[\"user1@example.com\", \"user2@example.com\", \"user3@example.com\"]\r\n```\r\n\r\nThe remediation steps are disabled due to their destructive nature. To use them, they must be manually enabled after importing the workflow. To enable a step, hover your mouse over the step and click the icon to the left of the trash icon. \r\n\r\n\r\n## Technical Details\r\n\r\nPlugins utilized by workflow:\r\n\r\n|Plugin|Version|Count|\r\n|----|----|--------|\r\n|ExtractIt|2.2.1|1|\r\n|Microsoft Office 365 Email|4.0.0|1|\r\n|Microsoft Office 365 Email|5.1.0|1|\r\n|Microsoft Office365 Email Security|2.3.5|2|\r\n|Palo Alto Wildfire|1.2.0|4|\r\n|Sleep|1.0.2|2|\r\n\r\n## Troubleshooting\r\n\r\n_There is no troubleshooting information at this time_\r\n\r\n# Version History\r\n\r\n* 1.1.0 - Workflow improvements | Support for nested EML attachments\r\n* 1.0.1 - Update workflow title to enrichment\r\n* 1.0.0 - Initial workflow\r\n\r\n# Links\r\n\r\n## References\r\n\r\n* [Microsoft Office365](https://www.office.com)\r\n* [Palo Alto Wildfire](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)",
        "graph": {
          "edges": {
            "00f263d2-f504-47de-81ff-29a41cdd59be": {
              "id": "00f263d2-f504-47de-81ff-29a41cdd59be",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "721e875d-7460-4369-8bb5-60c70da053c7",
              "toNodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef"
            },
            "0e78c211-528a-437e-b1fd-9438972a3409": {
              "id": "0e78c211-528a-437e-b1fd-9438972a3409",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "toNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c"
            },
            "1c685acd-c828-4113-8c67-fea20130dc86": {
              "id": "1c685acd-c828-4113-8c67-fea20130dc86",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "b594fc33-74ac-49cc-a837-cbdac1a173b1",
              "toNodeId": "37a0304d-f836-4d95-b39e-c800344822c7"
            },
            "25c91fa1-e7e9-4ec5-a64f-58dc9a29b877": {
              "id": "25c91fa1-e7e9-4ec5-a64f-58dc9a29b877",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "a562607a-8f03-46c3-81c2-d253eb99070b",
              "toNodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98"
            },
            "2d870152-94af-4e51-8914-9b79be4d6163": {
              "id": "2d870152-94af-4e51-8914-9b79be4d6163",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "baae6427-23c7-4684-a4ea-9b17b3db3182",
              "toNodeId": "8030f309-b134-4a90-aab3-577dc9213cf7"
            },
            "2e5fbd5f-6175-4a58-8816-418363f806c5": {
              "id": "2e5fbd5f-6175-4a58-8816-418363f806c5",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33",
              "toNodeId": "c0faa121-1c25-4477-8b7c-590b90787321"
            },
            "47ce318a-ddd4-4320-a996-47c69945b1c0": {
              "id": "47ce318a-ddd4-4320-a996-47c69945b1c0",
              "name": "True",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
              "toNodeId": "baae6427-23c7-4684-a4ea-9b17b3db3182"
            },
            "4898fd7a-d20b-487f-b341-7e3ee5843a85": {
              "id": "4898fd7a-d20b-487f-b341-7e3ee5843a85",
              "name": "Safe File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995",
              "toNodeId": ""
            },
            "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91": {
              "id": "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
              "toNodeId": ""
            },
            "563c9f5c-44b4-41e9-8b03-839eb4bc71c5": {
              "id": "563c9f5c-44b4-41e9-8b03-839eb4bc71c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "toNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90"
            },
            "63a36f9f-9b12-4644-9e16-e46a5a6a8572": {
              "id": "63a36f9f-9b12-4644-9e16-e46a5a6a8572",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "d63b1949-abe6-4050-a7e8-577c385672dc",
              "toNodeId": "7174a8e1-0143-4113-a016-99c5d6acff0d"
            },
            "69a45e12-916d-4b88-b3dc-94fe2f62923d": {
              "id": "69a45e12-916d-4b88-b3dc-94fe2f62923d",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "284c098a-b66e-45bb-9bf3-90d7ba29e429",
              "toNodeId": ""
            },
            "6a85734f-8b71-4e7f-a5ce-00144e61a93e": {
              "id": "6a85734f-8b71-4e7f-a5ce-00144e61a93e",
              "name": "Malicious File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
              "toNodeId": "a562607a-8f03-46c3-81c2-d253eb99070b"
            },
            "7885e52a-a487-4510-9364-751a0efcff17": {
              "id": "7885e52a-a487-4510-9364-751a0efcff17",
              "name": "False",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8"
            },
            "7b03effc-a2c8-42a6-b978-792935514bfa": {
              "id": "7b03effc-a2c8-42a6-b978-792935514bfa",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "8030f309-b134-4a90-aab3-577dc9213cf7",
              "toNodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e"
            },
            "82200da4-4655-4acf-aa29-d5ce4cccf079": {
              "id": "82200da4-4655-4acf-aa29-d5ce4cccf079",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "toNodeId": "721e875d-7460-4369-8bb5-60c70da053c7"
            },
            "8e53d640-6d8f-421c-ab3f-28ef741bc091": {
              "id": "8e53d640-6d8f-421c-ab3f-28ef741bc091",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "toNodeId": ""
            },
            "9d5d58ef-7b5c-4128-8be4-2669cfb1dfd9": {
              "id": "9d5d58ef-7b5c-4128-8be4-2669cfb1dfd9",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "335c89e3-efe5-4741-a188-268b0aac8993",
              "toNodeId": "c2760aed-8a29-48f6-b1aa-f8009f8cca25"
            },
            "a0387fc8-d331-4d71-9f40-f9c34d51f743": {
              "id": "a0387fc8-d331-4d71-9f40-f9c34d51f743",
              "name": "Malicious File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995",
              "toNodeId": "45c210c6-7951-417d-a12d-207a28e9a39c"
            },
            "a1342d47-eacd-4e99-8e0e-fd526916be0f": {
              "id": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
              "name": "Not Malicious",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
              "toNodeId": ""
            },
            "a6be3253-1059-4777-ad5c-2b5500040345": {
              "id": "a6be3253-1059-4777-ad5c-2b5500040345",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "f9204b15-d3d0-45d2-820e-713e97a9d81e",
              "toNodeId": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33"
            },
            "ae990a5e-f632-4c36-89e0-153b9371a353": {
              "id": "ae990a5e-f632-4c36-89e0-153b9371a353",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "toNodeId": "335c89e3-efe5-4741-a188-268b0aac8993"
            },
            "b0f60fdd-8950-494c-915b-1e46cd3dd118": {
              "id": "b0f60fdd-8950-494c-915b-1e46cd3dd118",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "toNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "b667ae5a-48b3-458e-badf-060be34a524f": {
              "id": "b667ae5a-48b3-458e-badf-060be34a524f",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
              "toNodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527"
            },
            "b89c8fd5-6c9d-4f54-9a7e-4a61d3257f8d": {
              "id": "b89c8fd5-6c9d-4f54-9a7e-4a61d3257f8d",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "45c210c6-7951-417d-a12d-207a28e9a39c",
              "toNodeId": "284c098a-b66e-45bb-9bf3-90d7ba29e429"
            },
            "badda9a9-d2e3-4ddd-bbec-20fc62798b90": {
              "id": "badda9a9-d2e3-4ddd-bbec-20fc62798b90",
              "name": "Supported File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c2760aed-8a29-48f6-b1aa-f8009f8cca25",
              "toNodeId": "f9204b15-d3d0-45d2-820e-713e97a9d81e"
            },
            "bb5192d3-bf05-4cf8-a407-f57f2c825b99": {
              "id": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
              "name": "False",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
              "toNodeId": ""
            },
            "c30dd761-b3bf-4881-b791-e8d2177af761": {
              "id": "c30dd761-b3bf-4881-b791-e8d2177af761",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "7174a8e1-0143-4113-a016-99c5d6acff0d",
              "toNodeId": "b594fc33-74ac-49cc-a837-cbdac1a173b1"
            },
            "c8087cac-092e-46de-864f-3e386df3e577": {
              "id": "c8087cac-092e-46de-864f-3e386df3e577",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "toNodeId": "c34206e6-bd3c-4b35-b45d-ceb6281f373d"
            },
            "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5": {
              "id": "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "toNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "ce9fd058-cee0-44ee-91ac-229bb4089252": {
              "id": "ce9fd058-cee0-44ee-91ac-229bb4089252",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527",
              "toNodeId": ""
            },
            "d19e949b-361e-4eb2-b051-472afb737061": {
              "id": "d19e949b-361e-4eb2-b051-472afb737061",
              "name": "Unsupported File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c2760aed-8a29-48f6-b1aa-f8009f8cca25",
              "toNodeId": "645a1281-c0d0-4c79-88cf-19ee3e621c3e"
            },
            "d2ac308d-a1c1-40d2-8fc7-f5cc76525d58": {
              "id": "d2ac308d-a1c1-40d2-8fc7-f5cc76525d58",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "2418a918-0a59-4429-ab4e-522b48851486",
              "toNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "d5481036-02f9-4c2d-90bc-90896072b477": {
              "id": "d5481036-02f9-4c2d-90bc-90896072b477",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
              "toNodeId": ""
            },
            "d8245176-59e6-49e8-9e41-2995aa20188e": {
              "id": "d8245176-59e6-49e8-9e41-2995aa20188e",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "toNodeId": "2418a918-0a59-4429-ab4e-522b48851486"
            },
            "d8b4611e-5218-49bf-ad66-f34351523e45": {
              "id": "d8b4611e-5218-49bf-ad66-f34351523e45",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "ac163fce-57b1-4973-85de-3190e8c7f5df",
              "toNodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995"
            },
            "e27a92ff-247f-4f91-8e2a-1382e8496860": {
              "id": "e27a92ff-247f-4f91-8e2a-1382e8496860",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "645a1281-c0d0-4c79-88cf-19ee3e621c3e",
              "toNodeId": "ac163fce-57b1-4973-85de-3190e8c7f5df"
            },
            "eab5ef36-7a3c-4caf-acda-8db115f7d1c5": {
              "id": "eab5ef36-7a3c-4caf-acda-8db115f7d1c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c34206e6-bd3c-4b35-b45d-ceb6281f373d",
              "toNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "ed18d5d5-60ce-4070-961f-650467859b7f": {
              "id": "ed18d5d5-60ce-4070-961f-650467859b7f",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "toNodeId": "d63b1949-abe6-4050-a7e8-577c385672dc"
            },
            "ee900a2d-604a-4d95-ae02-a9bee97a4ab6": {
              "id": "ee900a2d-604a-4d95-ae02-a9bee97a4ab6",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "toNodeId": ""
            },
            "f05e1eff-e9e4-4729-b227-bdc532fd67e4": {
              "id": "f05e1eff-e9e4-4729-b227-bdc532fd67e4",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
              "toNodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44"
            },
            "f709bfc0-3279-489f-b3f7-c9244f075aaf": {
              "id": "f709bfc0-3279-489f-b3f7-c9244f075aaf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
              "toNodeId": ""
            },
            "fceaae38-58dd-4400-96b9-582929fcc93f": {
              "id": "fceaae38-58dd-4400-96b9-582929fcc93f",
              "name": "True",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8"
            }
          },
          "nodes": {
            "0e565ff0-8d8f-45f7-8d22-a64e150ee93e": {
              "id": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "13b918db-b65a-42cb-97f4-832498591da1": {
              "id": "13b918db-b65a-42cb-97f4-832498591da1",
              "parentNodeId": ""
            },
            "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
              "id": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "parentNodeId": ""
            },
            "19279ef7-3ff3-4228-ae2f-91eb49656fed": {
              "id": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "1b82897d-95a2-4799-87d8-881d201d8fa8": {
              "id": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "parentNodeId": ""
            },
            "2418a918-0a59-4429-ab4e-522b48851486": {
              "id": "2418a918-0a59-4429-ab4e-522b48851486",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "284c098a-b66e-45bb-9bf3-90d7ba29e429": {
              "id": "284c098a-b66e-45bb-9bf3-90d7ba29e429",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "2a72a629-1bcc-4910-9adf-efb271f43a15": {
              "id": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33": {
              "id": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "335c89e3-efe5-4741-a188-268b0aac8993": {
              "id": "335c89e3-efe5-4741-a188-268b0aac8993",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "37a0304d-f836-4d95-b39e-c800344822c7": {
              "id": "37a0304d-f836-4d95-b39e-c800344822c7",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "39730100-c4f1-49b7-acf9-7cfa6f53f6c8": {
              "id": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
              "parentNodeId": ""
            },
            "45c210c6-7951-417d-a12d-207a28e9a39c": {
              "id": "45c210c6-7951-417d-a12d-207a28e9a39c",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "57940a7a-4779-42cb-a785-a0d37a73ef90": {
              "id": "57940a7a-4779-42cb-a785-a0d37a73ef90",
              "parentNodeId": ""
            },
            "645a1281-c0d0-4c79-88cf-19ee3e621c3e": {
              "id": "645a1281-c0d0-4c79-88cf-19ee3e621c3e",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "7174a8e1-0143-4113-a016-99c5d6acff0d": {
              "id": "7174a8e1-0143-4113-a016-99c5d6acff0d",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "721e875d-7460-4369-8bb5-60c70da053c7": {
              "id": "721e875d-7460-4369-8bb5-60c70da053c7",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "8030f309-b134-4a90-aab3-577dc9213cf7": {
              "id": "8030f309-b134-4a90-aab3-577dc9213cf7",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "a562607a-8f03-46c3-81c2-d253eb99070b": {
              "id": "a562607a-8f03-46c3-81c2-d253eb99070b",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "ac163fce-57b1-4973-85de-3190e8c7f5df": {
              "id": "ac163fce-57b1-4973-85de-3190e8c7f5df",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "b594fc33-74ac-49cc-a837-cbdac1a173b1": {
              "id": "b594fc33-74ac-49cc-a837-cbdac1a173b1",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "baae6427-23c7-4684-a4ea-9b17b3db3182": {
              "id": "baae6427-23c7-4684-a4ea-9b17b3db3182",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "bbcebfec-b733-4106-a9d7-995b0c37ba44": {
              "id": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "c0faa121-1c25-4477-8b7c-590b90787321": {
              "id": "c0faa121-1c25-4477-8b7c-590b90787321",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "c179d3b1-bc28-42e0-80e1-c562d0761cef": {
              "id": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "c2760aed-8a29-48f6-b1aa-f8009f8cca25": {
              "id": "c2760aed-8a29-48f6-b1aa-f8009f8cca25",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "c34206e6-bd3c-4b35-b45d-ceb6281f373d": {
              "id": "c34206e6-bd3c-4b35-b45d-ceb6281f373d",
              "parentNodeId": ""
            },
            "d63b1949-abe6-4050-a7e8-577c385672dc": {
              "id": "d63b1949-abe6-4050-a7e8-577c385672dc",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "e32ea6c8-9365-4283-a863-9a354d56dceb": {
              "id": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "parentNodeId": ""
            },
            "e423f975-9e30-4d03-aef0-de6dc5e77d98": {
              "id": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "e970ce0c-5976-4b41-866b-34fa0c65a527": {
              "id": "e970ce0c-5976-4b41-866b-34fa0c65a527",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
              "id": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "parentNodeId": ""
            },
            "f9204b15-d3d0-45d2-820e-713e97a9d81e": {
              "id": "f9204b15-d3d0-45d2-820e-713e97a9d81e",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "fc433fdb-db55-4383-9db6-6e249cc2a995": {
              "id": "fc433fdb-db55-4383-9db6-6e249cc2a995",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            }
          }
        },
        "steps": {
          "0e565ff0-8d8f-45f7-8d22-a64e150ee93e": {
            "nodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
            "name": "Malicious URL Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": true
                  },
                  "op": "==",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "true == true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "13b918db-b65a-42cb-97f4-832498591da1": {
            "nodeId": "13b918db-b65a-42cb-97f4-832498591da1",
            "name": "Analysis Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "2a72a629-1bcc-4910-9adf-efb271f43a15.is_malicious",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "name": "2a72a629-1bcc-4910-9adf-efb271f43a15.is_malicious",
                            "type": "variable"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": true
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "args": [
                            {
                              "name": "19279ef7-3ff3-4228-ae2f-91eb49656fed.is_malicious",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "name": "19279ef7-3ff3-4228-ae2f-91eb49656fed.is_malicious",
                            "type": "variable"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": true
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[2a72a629-1bcc-4910-9adf-efb271f43a15].[is_malicious]}}) && {{[2a72a629-1bcc-4910-9adf-efb271f43a15].[is_malicious]}} == true || is_defined({{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[is_malicious]}}) && {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[is_malicious]}} == true",
                    "value": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item]}}",
                    "valueType": "object"
                  },
                  "name": "malicious_emails",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "d8245176-59e6-49e8-9e41-2995aa20188e",
              "nextEdgeId": "0e78c211-528a-437e-b1fd-9438972a3409",
              "repeatVariable": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "malicious_emails": {
                  "description": "Custom output: \"malicious_emails\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "malicious_emails",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
            "nodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
            "name": "Office 365 New Email Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": true,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "{{$workflow.[Email Address]}}",
                "subject_query": "{{$workflow.[Subject Query]}}"
              }
            },
            "triggerId": "656ccd54-fa9c-42be-98bf-cced145ad037",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": "",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "19279ef7-3ff3-4228-ae2f-91eb49656fed": {
            "nodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
            "name": "Attached File Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "left": {
                              "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                              "type": "variable"
                            },
                            "op": "==",
                            "right": {
                              "type": "literal",
                              "value": "malware"
                            },
                            "type": "binary"
                          },
                          "op": "OR",
                          "right": {
                            "left": {
                              "left": {
                                "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                                "type": "variable"
                              },
                              "op": "==",
                              "right": {
                                "type": "literal",
                                "value": "grayware"
                              },
                              "type": "binary"
                            },
                            "op": "OR",
                            "right": {
                              "left": {
                                "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                                "type": "variable"
                              },
                              "op": "==",
                              "right": {
                                "type": "literal",
                                "value": "phishing"
                              },
                              "type": "binary"
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "args": [
                          {
                            "name": "45c210c6-7951-417d-a12d-207a28e9a39c.content",
                            "type": "variable"
                          }
                        ],
                        "name": "is_defined",
                        "type": "function"
                      },
                      "type": "binary"
                    },
                    "expressionText": "(is_defined({{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}}) && ({{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"malware\" || {{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"grayware\" || {{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"phishing\")) || is_defined({{[45c210c6-7951-417d-a12d-207a28e9a39c].[content]}})"
                  },
                  "name": "is_malicious",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "ae990a5e-f632-4c36-89e0-153b9371a353",
              "nextEdgeId": "ee900a2d-604a-4d95-ae02-a9bee97a4ab6",
              "repeatVariable": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item].[attached_files]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "is_malicious": {
                  "description": "Custom output: \"is_malicious\"",
                  "title": "is_malicious",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "1b82897d-95a2-4799-87d8-881d201d8fa8": {
            "nodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
            "name": "Remediation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Remediation Goes Here\n\n(this artifact can be removed)\n\nAt this point in the workflow, we've established we have a malicious email. \n\nRemediation steps go on this branch of the flow. They can be email notifications, Slack notifications for human follow up. Remediation can also go further and block the sender and delete the email from your organization. \n\nIn this example, I will send a notification via email, and use the Office Admin plugin to both delete the email and block the sender from our organization. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "2418a918-0a59-4429-ab4e-522b48851486": {
            "nodeId": "2418a918-0a59-4429-ab4e-522b48851486",
            "name": "Extract URLs",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.2.1/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item].[body]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "284c098a-b66e-45bb-9bf3-90d7ba29e429": {
            "nodeId": "284c098a-b66e-45bb-9bf3-90d7ba29e429",
            "name": "Manual Malicious File Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "69a45e12-916d-4b88-b3dc-94fe2f62923d",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": true
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "true = true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "2a72a629-1bcc-4910-9adf-efb271f43a15": {
            "nodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
            "name": "URL Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "args": [
                          {
                            "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                            "type": "variable"
                          }
                        ],
                        "name": "is_defined",
                        "type": "function"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "left": {
                            "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                            "type": "variable"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": "malware"
                          },
                          "type": "binary"
                        },
                        "op": "OR",
                        "right": {
                          "left": {
                            "left": {
                              "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                              "type": "variable"
                            },
                            "op": "==",
                            "right": {
                              "type": "literal",
                              "value": "grayware"
                            },
                            "type": "binary"
                          },
                          "op": "OR",
                          "right": {
                            "left": {
                              "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                              "type": "variable"
                            },
                            "op": "==",
                            "right": {
                              "type": "literal",
                              "value": "phishing"
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}}) && ({{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"malware\" || {{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"grayware\" ||  \n{{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"phishing\")"
                  },
                  "name": "is_malicious",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "ed18d5d5-60ce-4070-961f-650467859b7f",
              "nextEdgeId": "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5",
              "repeatVariable": "{{[2418a918-0a59-4429-ab4e-522b48851486].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "is_malicious": {
                  "description": "Custom output: \"is_malicious\"",
                  "title": "is_malicious",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33": {
            "nodeId": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33",
            "name": "Palo Alto Wildfire Get File Verdict",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Wildfire",
              "slugVendor": "rapid7",
              "slugName": "paloalto_wildfire",
              "slugVersion": "1.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/paloalto_wildfire/1.2.0/icon.png"
            },
            "identifier": "get_verdict",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[335c89e3-efe5-4741-a188-268b0aac8993].[submission].[sha256]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "The MD5 or SHA-256 hash value of the sample",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "verdict": {
                  "description": "One of the following verdicts: 'Benign', 'Malware', 'Greyware', 'Pending', 'Error', or 'Not found`",
                  "enum": [
                    "Benign",
                    "Malware",
                    "Greyware",
                    "Pending",
                    "Error",
                    "Not found"
                  ],
                  "order": 1,
                  "title": "Verdict",
                  "type": "string"
                }
              },
              "required": [
                "verdict"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "335c89e3-efe5-4741-a188-268b0aac8993": {
            "nodeId": "335c89e3-efe5-4741-a188-268b0aac8993",
            "name": "Palo Alto Wildfire Submit File",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Wildfire",
              "slugVendor": "rapid7",
              "slugName": "paloalto_wildfire",
              "slugVersion": "1.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/paloalto_wildfire/1.2.0/icon.png"
            },
            "identifier": "submit_file",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "{{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content]}}",
                "filename": "{{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "File to submit. Supported types are Email-link, Flash, APK, PDF, JAR, PE, MS-Office",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "File",
                  "type": "string"
                },
                "filename": {
                  "description": "Optional file name",
                  "order": 2,
                  "title": "Filename",
                  "type": "string"
                }
              },
              "required": [
                "file"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "filedata": {
                  "properties": {
                    "filename": {
                      "order": 3,
                      "title": "Filename",
                      "type": "string"
                    },
                    "filetype": {
                      "order": 2,
                      "title": "File Type",
                      "type": "string"
                    },
                    "md5": {
                      "description": "MD5 hash of file",
                      "order": 5,
                      "title": "MD5",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash of file",
                      "order": 4,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "size": {
                      "description": "File size",
                      "order": 6,
                      "title": "Size",
                      "type": "string"
                    },
                    "supported_file_type": {
                      "description": "Boolean indicating whether the filetype of the sample is supported",
                      "order": 7,
                      "title": "Supported File",
                      "type": "boolean"
                    },
                    "url": {
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Filedata",
                  "type": "object"
                }
              },
              "properties": {
                "submission": {
                  "$ref": "#/definitions/filedata",
                  "description": "Submission",
                  "order": 1,
                  "title": "Submission"
                }
              },
              "required": [
                "submission"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "37a0304d-f836-4d95-b39e-c800344822c7": {
            "nodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
            "name": "Is URL Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
              "stepControlParams": [
                {
                  "edgeId": "47ce318a-ddd4-4320-a996-47c69945b1c0",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                        "type": "variable"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": "malware"
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                          "type": "variable"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": "grayware"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "b594fc33-74ac-49cc-a837-cbdac1a173b1.verdict",
                          "type": "variable"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": "phishing"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"malware\" || {{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"grayware\" ||  \n{{[b594fc33-74ac-49cc-a837-cbdac1a173b1].[verdict]}} == \"phishing\""
                },
                {
                  "edgeId": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "39730100-c4f1-49b7-acf9-7cfa6f53f6c8": {
            "nodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
            "name": "Email Not Malicious",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Email Not Malicious\n\nAfter checking the indicators within the email, and any attached emails and files, the workflow was unable to find any malicious indicators."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "45c210c6-7951-417d-a12d-207a28e9a39c": {
            "nodeId": "45c210c6-7951-417d-a12d-207a28e9a39c",
            "name": "Manual Malicious File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found\n\n_Admin marked this file as malicious manually_\n\nFile Name: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[name]}}\nFile type: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content_type]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "57940a7a-4779-42cb-a785-a0d37a73ef90": {
            "nodeId": "57940a7a-4779-42cb-a785-a0d37a73ef90",
            "name": "Overview Note",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Overview \n\n(This artifact should be removed)\n\nThis workflow assumes a standard phishing process. The user will push the phish button on a suspicious email that will then be sent to the mailbox this flow is monitoring as an attachment. \n\nWe can assume the base email is benign and any suspicious or malicious content will be in the attachment(s).\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "645a1281-c0d0-4c79-88cf-19ee3e621c3e": {
            "nodeId": "645a1281-c0d0-4c79-88cf-19ee3e621c3e",
            "name": "Unsupported File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Unsupported File\n\nFile Name: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[name]}} \nFile Type: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content_type]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7174a8e1-0143-4113-a016-99c5d6acff0d": {
            "nodeId": "7174a8e1-0143-4113-a016-99c5d6acff0d",
            "name": "Sleep for 15 Seconds",
            "type": "action",
            "plugin": {
              "name": "Sleep",
              "slugVendor": "rapid7",
              "slugName": "sleep",
              "slugVersion": "1.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/sleep/1.0.2/icon.png"
            },
            "identifier": "sleep",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "interval": 15
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "interval": {
                  "description": "Interval of time in seconds",
                  "order": 1,
                  "title": "Interval",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "slept": {
                  "description": "Time spent asleep",
                  "order": 1,
                  "title": "Slept",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "721e875d-7460-4369-8bb5-60c70da053c7": {
            "nodeId": "721e875d-7460-4369-8bb5-60c70da053c7",
            "name": "Malicious Email Details",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious Email found\nThe following attached email was found to be malicious. \n\nFrom: {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\n\nSubject: {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8030f309-b134-4a90-aab3-577dc9213cf7": {
            "nodeId": "8030f309-b134-4a90-aab3-577dc9213cf7",
            "name": "Malicious URL Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious URL Found\n\nURL: {{[2a72a629-1bcc-4910-9adf-efb271f43a15].[$item]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "a562607a-8f03-46c3-81c2-d253eb99070b": {
            "nodeId": "a562607a-8f03-46c3-81c2-d253eb99070b",
            "name": "Malicious File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found: \n\nName: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[name]}}\nType: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content_type]}}\n\nVerdict: {{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "ac163fce-57b1-4973-85de-3190e8c7f5df": {
            "nodeId": "ac163fce-57b1-4973-85de-3190e8c7f5df",
            "name": "Alert Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Alert For Manual Intervention\n\nThis artifact should be replaced with an alert step. \n\nThis can be an email or slack step notifying an admin that they need to manually make a decision about an unsupported file type. \n\nYou can include a link to this job like this: \n{{[$job].[URL]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b594fc33-74ac-49cc-a837-cbdac1a173b1": {
            "nodeId": "b594fc33-74ac-49cc-a837-cbdac1a173b1",
            "name": "Get Result from Palo Alto Wildfire",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Wildfire",
              "slugVendor": "rapid7",
              "slugName": "paloalto_wildfire",
              "slugVersion": "1.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/paloalto_wildfire/1.2.0/icon.png"
            },
            "identifier": "get_verdict",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[d63b1949-abe6-4050-a7e8-577c385672dc].[submission].[sha256]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "The MD5 or SHA-256 hash value of the sample",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "verdict": {
                  "description": "One of the following verdicts: 'Benign', 'Malware', 'Greyware', 'Pending', 'Error', or 'Not found`",
                  "enum": [
                    "Benign",
                    "Malware",
                    "Greyware",
                    "Pending",
                    "Error",
                    "Not found"
                  ],
                  "order": 1,
                  "title": "Verdict",
                  "type": "string"
                }
              },
              "required": [
                "verdict"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "baae6427-23c7-4684-a4ea-9b17b3db3182": {
            "nodeId": "baae6427-23c7-4684-a4ea-9b17b3db3182",
            "name": "Malicious Indicator Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious Email Found\n\n(this artifact can be removed)\n\nAt this point, we can be sure that the email we've found is spam. Here you should take remediation steps to remove the email from your organization."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "bbcebfec-b733-4106-a9d7-995b0c37ba44": {
            "nodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
            "name": "Block Sender from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.3.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.3.5/icon.png"
            },
            "identifier": "block_sender_transport_rule",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain_or_email_to_block": "{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}",
                "transport_rule_name": "Block {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain_or_email_to_block": {
                  "description": "Domain or email address to block",
                  "order": 1,
                  "title": "Domain or Email to Block",
                  "type": "string"
                },
                "transport_rule_name": {
                  "default": "InsightConnect Block List",
                  "description": "Name of transport rule",
                  "order": 2,
                  "title": "Transport Rule Name",
                  "type": "string"
                }
              },
              "required": [
                "transport_rule_name",
                "domain_or_email_to_block"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result",
                  "order": 1,
                  "title": "Result",
                  "type": "string"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c0faa121-1c25-4477-8b7c-590b90787321": {
            "nodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
            "name": "Is File Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
              "stepControlParams": [
                {
                  "edgeId": "6a85734f-8b71-4e7f-a5ce-00144e61a93e",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                        "type": "variable"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": "malware"
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                          "type": "variable"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": "grayware"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33.verdict",
                          "type": "variable"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": "phishing"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"malware\" ||{{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"grayware\" ||\n{{[2c4692b5-10bc-4c8a-95ff-6b2f78fb3d33].[verdict]}} == \"phishing\""
                },
                {
                  "edgeId": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c179d3b1-bc28-42e0-80e1-c562d0761cef": {
            "nodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
            "name": "Send Notification Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.1.0/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": [],
                "bcc": [],
                "body": "The following attached email was found to be malicious. \n\nEmail From:\n{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\n\nEmail Subject:\n{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}\n\nJob URL:\n{{[$job].[URL]}}",
                "cc": [],
                "email_from": "{{$workflow.[Malicious Email Notification Sender]}}",
                "email_to": [
                  "change_me"
                ],
                "is_html": false,
                "subject": "Malicious Email Found"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "description": "Accepts one or more attachment represented as a file type which contains the filename and the file content encoded with base64",
                  "items": {
                    "$ref": "#/definitions/file"
                  },
                  "order": 8,
                  "title": "Attachment",
                  "type": "array"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "One or more email addresses of recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Email To",
                  "type": "array"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c2760aed-8a29-48f6-b1aa-f8009f8cca25": {
            "nodeId": "c2760aed-8a29-48f6-b1aa-f8009f8cca25",
            "name": "Was File Supported",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "badda9a9-d2e3-4ddd-bbec-20fc62798b90",
              "stepControlParams": [
                {
                  "edgeId": "badda9a9-d2e3-4ddd-bbec-20fc62798b90",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "d19e949b-361e-4eb2-b051-472afb737061",
                  "expression": {
                    "left": {
                      "name": "335c89e3-efe5-4741-a188-268b0aac8993.submission.supported_file_type",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[335c89e3-efe5-4741-a188-268b0aac8993].[submission].[supported_file_type]}} = false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c34206e6-bd3c-4b35-b45d-ceb6281f373d": {
            "nodeId": "c34206e6-bd3c-4b35-b45d-ceb6281f373d",
            "name": "Attached Email Analysis Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Attached Email Analysis\n\n(This artifact can be removed) \n\nThis loop will analyze any each of the attached emails and look for any malicious indicators - these include any malicious URLs found within these emails, any attached malicious files to these emails. These will be the best indicators of a suspicious email. If any are found this email will be marked as malicious. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "d63b1949-abe6-4050-a7e8-577c385672dc": {
            "nodeId": "d63b1949-abe6-4050-a7e8-577c385672dc",
            "name": "Palo Alto Wildfire Scan URL",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Wildfire",
              "slugVendor": "rapid7",
              "slugName": "paloalto_wildfire",
              "slugVersion": "1.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/paloalto_wildfire/1.2.0/icon.png"
            },
            "identifier": "submit_url",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[2a72a629-1bcc-4910-9adf-efb271f43a15].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL to submit",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "urldata": {
                  "properties": {
                    "md5": {
                      "description": "MD5 hash of file",
                      "order": 3,
                      "title": "MD5",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash of file",
                      "order": 2,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "url": {
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Urldata",
                  "type": "object"
                }
              },
              "properties": {
                "submission": {
                  "$ref": "#/definitions/urldata",
                  "description": "Submission",
                  "order": 1,
                  "title": "Submission"
                }
              },
              "required": [
                "submission"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e32ea6c8-9365-4283-a863-9a354d56dceb": {
            "nodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
            "name": "Remediate Malicious Emails",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "82200da4-4655-4acf-aa29-d5ce4cccf079",
              "nextEdgeId": "8e53d640-6d8f-421c-ab3f-28ef741bc091",
              "repeatVariable": "{{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e423f975-9e30-4d03-aef0-de6dc5e77d98": {
            "nodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
            "name": "Break on Malicious File",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "d5481036-02f9-4c2d-90bc-90896072b477",
                "expression": {
                  "left": {
                    "type": "literal",
                    "value": true
                  },
                  "op": "==",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "true == true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "e970ce0c-5976-4b41-866b-34fa0c65a527": {
            "nodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527",
            "name": "Purge Email from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.3.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.3.5/icon.png"
            },
            "identifier": "mass_search_and_purge",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "compliance_search_name": "Search for {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}",
                "content_match_query": "subject: \"{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}\" from: \"{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\"",
                "delete_items": true,
                "query_timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "compliance_search_name": {
                  "description": "Name of compliance search",
                  "order": 1,
                  "title": "Compliance Search Name",
                  "type": "string"
                },
                "content_match_query": {
                  "description": "This parameter uses a text search string or a query that's formatted by using the Keyword Query Language (KQL). For more information about KQL, see Keyword Query Language syntax reference (https://go.microsoft.com/fwlink/p/?linkid=269603)",
                  "order": 2,
                  "title": "Content Match Query",
                  "type": "string"
                },
                "delete_items": {
                  "default": false,
                  "description": "The script only executes the delete action if this parameter is true",
                  "order": 4,
                  "title": "Delete Items",
                  "type": "boolean"
                },
                "query_timeout": {
                  "default": 60,
                  "description": "Query timeout in minutes",
                  "order": 3,
                  "title": "Query Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "content_match_query",
                "compliance_search_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
            "nodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
            "name": "Was overall mail malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "7885e52a-a487-4510-9364-751a0efcff17",
              "stepControlParams": [
                {
                  "edgeId": "7885e52a-a487-4510-9364-751a0efcff17",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "fceaae38-58dd-4400-96b9-582929fcc93f",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "13b918db-b65a-42cb-97f4-832498591da1.malicious_emails",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "13b918db-b65a-42cb-97f4-832498591da1.malicious_emails",
                        "type": "variable"
                      },
                      "op": "!=",
                      "right": {
                        "elements": [],
                        "type": "array"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "is_defined({{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}}) && {{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}} != []"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f9204b15-d3d0-45d2-820e-713e97a9d81e": {
            "nodeId": "f9204b15-d3d0-45d2-820e-713e97a9d81e",
            "name": "Sleep for 30",
            "type": "action",
            "plugin": {
              "name": "Sleep",
              "slugVendor": "rapid7",
              "slugName": "sleep",
              "slugVersion": "1.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/sleep/1.0.2/icon.png"
            },
            "identifier": "sleep",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "interval": 30
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "interval": {
                  "description": "Interval of time in seconds",
                  "order": 1,
                  "title": "Interval",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "slept": {
                  "description": "Time spent asleep",
                  "order": 1,
                  "title": "Slept",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "fc433fdb-db55-4383-9db6-6e249cc2a995": {
            "nodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995",
            "name": "Is File Safe",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "notifications": {
                "artifactIds": null,
                "userIdsForEmail": []
              },
              "stepControlParams": [
                {
                  "edgeId": "4898fd7a-d20b-487f-b341-7e3ee5843a85",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995"
                },
                {
                  "edgeId": "a0387fc8-d331-4d71-9f40-f9c34d51f743",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "fc433fdb-db55-4383-9db6-6e249cc2a995"
                }
              ],
              "timeout": null,
              "timeoutDisplayUnit": null
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Microsoft",
          "Palo_Alto",
          "Phishing",
          "Threat Intelligence"
        ],
        "humanCostSeconds": 10800,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Email Address": {
                "type": "string",
                "description": "Mailbox email address that you wish to monitor for incoming emails."
              },
              "Subject Query": {
                "type": "string",
                "description": "Regex for the subject query, only emails that match the below regex will create new jobs."
              },
              "Malicious Email Notification Sender": {
                "type": "string",
                "description": "Email address that you would like to send a malicious email notification from."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "656ccd54-fa9c-42be-98bf-cced145ad037",
        "identifier": "email_received",
        "name": "Office 365 New Email Trigger",
        "description": "",
        "input": {
          "flatten_attachments": true,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "{{$workflow.[Email Address]}}",
          "subject_query": "{{$workflow.[Subject Query]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": "",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "file_name": {
                  "order": 1,
                  "title": "File Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "4.0.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
        }
      }
    ]
  }
}