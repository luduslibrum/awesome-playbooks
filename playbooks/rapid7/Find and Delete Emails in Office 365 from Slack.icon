{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:44:27.509826781Z",
    "workflowVersions": [
      {
        "name": "Find and Delete Emails in Office 365 from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nDon‚Äôt let your users fall for the same phish twice. This workflow uses a Slack command to find all emails in the target user's Office 365 inbox that match the provided search criteria. It will look for any emails that match the 'body', 'subject', and 'from'. It will automatically delete these emails by using the `delete` flag.\n\nSample Slack trigger command:\n\n`@Rapid7 InsightConnect find-email user@example.com subject=\"A phishy email\" from=\"example.com\" body=\"Click here for free stuff\"`\n\n`@Rapid7 InsightConnect find-email user@example.com subject=\"A phishy email\" delete=true`\n\n\n# Key Features\n\n* **Eliminate the Threat** - Once a phishing message is verified, the first thing you should do is remove that message from the affected user‚Äôs inbox. \n* **Work with Unparalleled Flexibility** - Take your work mobile and respond to reported threats from your phone, tablet, or PC.\n* **Reduce Portal Fatigue** - You have enough to do without logging into a different solution every 5 minutes. Control your response actions from chat instead.\n\n# Requirements\n\nThe following connections will need to be setup: \n\n* [Microsoft Office365](https://insightconnect.help.rapid7.com/docs/office365)\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere is one parameter you will need to configure in order to complete setup of your workflow:\n\n* Slack Channel: The Slack channel name in your environment where the workflow should be triggered\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameter, activate the workflow in order to trigger it.\n\n### Usage\n\n*This workflow will trigger in any direct messages to your Chatbot **or** any message in a channel directed @ your Chatbot. Note the Chatbot must be in the channel in order to trigger the workflow this way.*\n\nTo run the workflow, send a direct message to your InsightConnect Slack Chatbot or @ your Chatbot in a public channel starting with the command `find-email`.\n\nFor example, in a direct message to your Chatbot:\n* `find-email user@example.com subject=\"A phishy email\"`\n\nOr in a channel including your Chatbot:\n* `@Chatbot find-email user@example.com subject=\"A phishy email\"`\n\nThis will kick off the workflow and prompt you when the search is completed. If any emails are found that match the criteria, you can choose the delete button in Slack to delete them.\n\nSearch criteria can be 'body', 'subject', or 'from' lines in the email. For example:\n\n`@Rapid7 InsightConnect find-email user@example.com subject=\"A phishy email\" from=\"example.com\" body=\"Click here for free stuff\"`\n\nAny combination of 'body', 'subject', and 'from' can be used. At least one search item must be given.\n\nIf you'd like the workflow to delete matching emails without prompting, use `delete=true` For example:\n\n`find-email user@example.com subject=\"A phishy email\" delete=true`\n\nThe workflow will post the results in a thread.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Microsoft Office 365 Email|5.0.1|3|\n|Python 3 Script|2.0.2|2|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.0 - Leverage workflow parameters feature | Update documentation | Update Microsoft Office 365 Email plugin to version 5.0.1\n* 1.0.7 - Fix bug with incorrect email address extraction when using command message directed to Chatbot in the channel | Fix manual deletion of emails | Update Microsoft Office 365 Email to version 5.0.0 | Update Python 3 Script to version 2.0.2\n* 1.0.6 - Updated trigger syntax and documentation\n* 1.0.5 - Updated documentation\n* 1.0.4 - Update to remove join step\n* 1.0.3 - Fix name matching\n* 1.0.2 - Fix filename\n* 1.0.1 - Fix to Slack input command to standardize with leading exclamation point\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Office365](https://www.office.com)\n* [Slack](https://slack.com/)\n",
        "graph": {
          "edges": {
            "06e81ed2-31c6-4eb7-bfa4-819452bead1a": {
              "id": "06e81ed2-31c6-4eb7-bfa4-819452bead1a",
              "name": "No Emails Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "147d178f-d0b0-4a73-b432-22e6713449e4",
              "toNodeId": "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9"
            },
            "0773a9ed-c52f-4bf1-b6d7-6e50818e2b8a": {
              "id": "0773a9ed-c52f-4bf1-b6d7-6e50818e2b8a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "546b32d7-cbbf-45af-84aa-7f8d64ec20dd",
              "toNodeId": "8611a657-e320-4b61-8924-faceafdc49e1"
            },
            "08ce5f83-4332-41ab-9bf5-9a1bd8993ef4": {
              "id": "08ce5f83-4332-41ab-9bf5-9a1bd8993ef4",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2e45f712-a559-4d2b-bc72-051ea2e8a0ef",
              "toNodeId": "c5cce12b-3672-4d99-83be-9df69fd3794c"
            },
            "190da904-30ec-4ea6-8d94-134f56416c6a": {
              "id": "190da904-30ec-4ea6-8d94-134f56416c6a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c5cce12b-3672-4d99-83be-9df69fd3794c",
              "toNodeId": ""
            },
            "23f3e134-061a-4e3b-9049-43e6133a6e8c": {
              "id": "23f3e134-061a-4e3b-9049-43e6133a6e8c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9dfbea14-3d78-4fbb-937b-88d4c9b277d8",
              "toNodeId": "901c9f14-9462-41d5-9959-afe7d477493e"
            },
            "25891de0-4631-484f-8f70-10cfe91ca0e6": {
              "id": "25891de0-4631-484f-8f70-10cfe91ca0e6",
              "name": "Find Email Succeeded",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0052c5f4-4ec5-44d9-aa85-639f9a96a918",
              "toNodeId": "16077c2b-e376-4221-9100-687972fa5956"
            },
            "35e0afed-af88-4d90-9284-8925d86c52ec": {
              "id": "35e0afed-af88-4d90-9284-8925d86c52ec",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ff066138-0d02-4a61-afb4-f7148af31434",
              "toNodeId": "0052c5f4-4ec5-44d9-aa85-639f9a96a918"
            },
            "37d47391-4a54-4ab4-aeb5-c6891490f3bf": {
              "id": "37d47391-4a54-4ab4-aeb5-c6891490f3bf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4b965b0c-fd3d-4f2b-aa30-37f93f214753",
              "toNodeId": ""
            },
            "43e54ec0-7366-4a10-a5e2-8097158d97cb": {
              "id": "43e54ec0-7366-4a10-a5e2-8097158d97cb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cfb0da23-e667-4969-a80e-6ef5775faa87",
              "toNodeId": ""
            },
            "498a0cb5-89cd-42c7-b450-72d68d86c5c2": {
              "id": "498a0cb5-89cd-42c7-b450-72d68d86c5c2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "fa588e39-aba7-4a3a-bcac-bcea4e80ff74",
              "toNodeId": ""
            },
            "5497d824-9e2b-4467-b7f2-bfbe85313f88": {
              "id": "5497d824-9e2b-4467-b7f2-bfbe85313f88",
              "name": "Yes Delete",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4",
              "toNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82"
            },
            "61bef5bf-5fb7-4e4b-aa21-6057ccc70c24": {
              "id": "61bef5bf-5fb7-4e4b-aa21-6057ccc70c24",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "75c4e364-f202-469e-bcb3-4140fe36e205",
              "toNodeId": "9108708f-fe22-4f2a-869b-7ba004878a27"
            },
            "661e8be7-4c1b-422a-80a0-79be7f680abc": {
              "id": "661e8be7-4c1b-422a-80a0-79be7f680abc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cfa4d7bb-cc21-49c5-b9c8-280713447b48",
              "toNodeId": "2e45f712-a559-4d2b-bc72-051ea2e8a0ef"
            },
            "6c54522f-2d39-4705-a424-797087bc83bb": {
              "id": "6c54522f-2d39-4705-a424-797087bc83bb",
              "name": "No Do not Delete",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4",
              "toNodeId": "cfa4d7bb-cc21-49c5-b9c8-280713447b48"
            },
            "746d270d-c6e6-4942-9c7c-1efc823de985": {
              "id": "746d270d-c6e6-4942-9c7c-1efc823de985",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5",
              "toNodeId": "4b965b0c-fd3d-4f2b-aa30-37f93f214753"
            },
            "780eb0c2-5918-4f5d-8bc3-ced48f90b72a": {
              "id": "780eb0c2-5918-4f5d-8bc3-ced48f90b72a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9",
              "toNodeId": ""
            },
            "7a9b6365-a42e-48fa-b529-14ba6b9591a3": {
              "id": "7a9b6365-a42e-48fa-b529-14ba6b9591a3",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2e45f712-a559-4d2b-bc72-051ea2e8a0ef",
              "toNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea"
            },
            "87b4da4f-1729-4a3b-bc76-3f23a0a1d741": {
              "id": "87b4da4f-1729-4a3b-bc76-3f23a0a1d741",
              "name": "Find Email Failed",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0052c5f4-4ec5-44d9-aa85-639f9a96a918",
              "toNodeId": "fa588e39-aba7-4a3a-bcac-bcea4e80ff74"
            },
            "92e28643-a89f-4329-97b9-7f172d0078f5": {
              "id": "92e28643-a89f-4329-97b9-7f172d0078f5",
              "name": "",
              "description": "",
              "parentNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82",
              "fromNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82",
              "toNodeId": "1abfa091-2edb-4e55-b2fc-e3b837df596b"
            },
            "941adb16-50af-4c10-9763-600d35c2d92f": {
              "id": "941adb16-50af-4c10-9763-600d35c2d92f",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9108708f-fe22-4f2a-869b-7ba004878a27",
              "toNodeId": "546b32d7-cbbf-45af-84aa-7f8d64ec20dd"
            },
            "955d8b43-22cb-403d-b6cd-97b24fbe7027": {
              "id": "955d8b43-22cb-403d-b6cd-97b24fbe7027",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82",
              "toNodeId": "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5"
            },
            "9b2b2a40-f2ed-473f-8301-5dd42a32fee6": {
              "id": "9b2b2a40-f2ed-473f-8301-5dd42a32fee6",
              "name": "",
              "description": "",
              "parentNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82",
              "fromNodeId": "1abfa091-2edb-4e55-b2fc-e3b837df596b",
              "toNodeId": ""
            },
            "bf01d119-f000-498a-836c-b160d04f2b83": {
              "id": "bf01d119-f000-498a-836c-b160d04f2b83",
              "name": "Emails Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "147d178f-d0b0-4a73-b432-22e6713449e4",
              "toNodeId": "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4"
            },
            "c35a649f-3cb7-463b-aa43-eac62325d534": {
              "id": "c35a649f-3cb7-463b-aa43-eac62325d534",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9108708f-fe22-4f2a-869b-7ba004878a27",
              "toNodeId": "03b5f488-3825-46ac-afcc-ef6ad57aad0c"
            },
            "d09f40d2-b606-4b25-8961-f2c8fb74168d": {
              "id": "d09f40d2-b606-4b25-8961-f2c8fb74168d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "03b5f488-3825-46ac-afcc-ef6ad57aad0c",
              "toNodeId": ""
            },
            "d30c42c5-c202-4a20-87fd-356e90828cc1": {
              "id": "d30c42c5-c202-4a20-87fd-356e90828cc1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "16077c2b-e376-4221-9100-687972fa5956",
              "toNodeId": "147d178f-d0b0-4a73-b432-22e6713449e4"
            },
            "db5e9cc0-e786-4e9c-abaf-cc39d29d3443": {
              "id": "db5e9cc0-e786-4e9c-abaf-cc39d29d3443",
              "name": "",
              "description": "",
              "parentNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
              "fromNodeId": "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f",
              "toNodeId": ""
            },
            "e97b590e-08b0-4963-a930-d287dc81222a": {
              "id": "e97b590e-08b0-4963-a930-d287dc81222a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8611a657-e320-4b61-8924-faceafdc49e1",
              "toNodeId": "ff066138-0d02-4a61-afb4-f7148af31434"
            },
            "ec54bcef-f96f-4a6f-a1a2-ce7f6604caff": {
              "id": "ec54bcef-f96f-4a6f-a1a2-ce7f6604caff",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
              "toNodeId": "cfb0da23-e667-4969-a80e-6ef5775faa87"
            },
            "f05f0c74-43f1-4c1a-aa6c-b9cc9859d005": {
              "id": "f05f0c74-43f1-4c1a-aa6c-b9cc9859d005",
              "name": "",
              "description": "",
              "parentNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
              "fromNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
              "toNodeId": "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f"
            },
            "fc61a6d1-c28c-495f-8401-89e8145150bf": {
              "id": "fc61a6d1-c28c-495f-8401-89e8145150bf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "901c9f14-9462-41d5-9959-afe7d477493e",
              "toNodeId": "75c4e364-f202-469e-bcb3-4140fe36e205"
            }
          },
          "nodes": {
            "0052c5f4-4ec5-44d9-aa85-639f9a96a918": {
              "id": "0052c5f4-4ec5-44d9-aa85-639f9a96a918",
              "parentNodeId": ""
            },
            "03b5f488-3825-46ac-afcc-ef6ad57aad0c": {
              "id": "03b5f488-3825-46ac-afcc-ef6ad57aad0c",
              "parentNodeId": ""
            },
            "147d178f-d0b0-4a73-b432-22e6713449e4": {
              "id": "147d178f-d0b0-4a73-b432-22e6713449e4",
              "parentNodeId": ""
            },
            "16077c2b-e376-4221-9100-687972fa5956": {
              "id": "16077c2b-e376-4221-9100-687972fa5956",
              "parentNodeId": ""
            },
            "1abfa091-2edb-4e55-b2fc-e3b837df596b": {
              "id": "1abfa091-2edb-4e55-b2fc-e3b837df596b",
              "parentNodeId": "8fc20935-4fe1-465d-b962-52011ff78f82"
            },
            "2e45f712-a559-4d2b-bc72-051ea2e8a0ef": {
              "id": "2e45f712-a559-4d2b-bc72-051ea2e8a0ef",
              "parentNodeId": ""
            },
            "4b965b0c-fd3d-4f2b-aa30-37f93f214753": {
              "id": "4b965b0c-fd3d-4f2b-aa30-37f93f214753",
              "parentNodeId": ""
            },
            "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9": {
              "id": "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9",
              "parentNodeId": ""
            },
            "546b32d7-cbbf-45af-84aa-7f8d64ec20dd": {
              "id": "546b32d7-cbbf-45af-84aa-7f8d64ec20dd",
              "parentNodeId": ""
            },
            "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4": {
              "id": "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4",
              "parentNodeId": ""
            },
            "75c4e364-f202-469e-bcb3-4140fe36e205": {
              "id": "75c4e364-f202-469e-bcb3-4140fe36e205",
              "parentNodeId": ""
            },
            "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f": {
              "id": "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f",
              "parentNodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea"
            },
            "8611a657-e320-4b61-8924-faceafdc49e1": {
              "id": "8611a657-e320-4b61-8924-faceafdc49e1",
              "parentNodeId": ""
            },
            "8fc20935-4fe1-465d-b962-52011ff78f82": {
              "id": "8fc20935-4fe1-465d-b962-52011ff78f82",
              "parentNodeId": ""
            },
            "901c9f14-9462-41d5-9959-afe7d477493e": {
              "id": "901c9f14-9462-41d5-9959-afe7d477493e",
              "parentNodeId": ""
            },
            "9108708f-fe22-4f2a-869b-7ba004878a27": {
              "id": "9108708f-fe22-4f2a-869b-7ba004878a27",
              "parentNodeId": ""
            },
            "9dfbea14-3d78-4fbb-937b-88d4c9b277d8": {
              "id": "9dfbea14-3d78-4fbb-937b-88d4c9b277d8",
              "parentNodeId": ""
            },
            "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5": {
              "id": "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5",
              "parentNodeId": ""
            },
            "c1be2795-8756-4862-ad94-1d7d2fe751ea": {
              "id": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
              "parentNodeId": ""
            },
            "c5cce12b-3672-4d99-83be-9df69fd3794c": {
              "id": "c5cce12b-3672-4d99-83be-9df69fd3794c",
              "parentNodeId": ""
            },
            "cfa4d7bb-cc21-49c5-b9c8-280713447b48": {
              "id": "cfa4d7bb-cc21-49c5-b9c8-280713447b48",
              "parentNodeId": ""
            },
            "cfb0da23-e667-4969-a80e-6ef5775faa87": {
              "id": "cfb0da23-e667-4969-a80e-6ef5775faa87",
              "parentNodeId": ""
            },
            "fa588e39-aba7-4a3a-bcac-bcea4e80ff74": {
              "id": "fa588e39-aba7-4a3a-bcac-bcea4e80ff74",
              "parentNodeId": ""
            },
            "ff066138-0d02-4a61-afb4-f7148af31434": {
              "id": "ff066138-0d02-4a61-afb4-f7148af31434",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0052c5f4-4ec5-44d9-aa85-639f9a96a918": {
            "nodeId": "0052c5f4-4ec5-44d9-aa85-639f9a96a918",
            "name": "Did find succeed",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "87b4da4f-1729-4a3b-bc76-3f23a0a1d741",
              "stepControlParams": [
                {
                  "edgeId": "25891de0-4631-484f-8f70-10cfe91ca0e6",
                  "expression": {
                    "name": "ff066138-0d02-4a61-afb4-f7148af31434.$success",
                    "type": "variable"
                  },
                  "expressionText": "{{[ff066138-0d02-4a61-afb4-f7148af31434].[$success]}}"
                },
                {
                  "edgeId": "87b4da4f-1729-4a3b-bc76-3f23a0a1d741",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "03b5f488-3825-46ac-afcc-ef6ad57aad0c": {
            "nodeId": "03b5f488-3825-46ac-afcc-ef6ad57aad0c",
            "name": "Parse Arguments Failed",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Something went wrong with find-email. \n\nThe message received was: \n{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[text]}}\n\nWorkflow Complete ‚ùó",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "147d178f-d0b0-4a73-b432-22e6713449e4": {
            "nodeId": "147d178f-d0b0-4a73-b432-22e6713449e4",
            "name": "Did we find any emails",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "06e81ed2-31c6-4eb7-bfa4-819452bead1a",
              "stepControlParams": [
                {
                  "edgeId": "bf01d119-f000-498a-836c-b160d04f2b83",
                  "expression": {
                    "left": {
                      "name": "16077c2b-e376-4221-9100-687972fa5956.email_list_count",
                      "type": "variable"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[16077c2b-e376-4221-9100-687972fa5956].[email_list_count]}} > 0"
                },
                {
                  "edgeId": "06e81ed2-31c6-4eb7-bfa4-819452bead1a",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "16077c2b-e376-4221-9100-687972fa5956": {
            "nodeId": "16077c2b-e376-4221-9100-687972fa5956",
            "name": "Count Emails",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    return {\"email_list_count\": len(params.get(\"email_list\"))}",
                "input": {
                  "email_list": "{{[ff066138-0d02-4a61-afb4-f7148af31434].[email_list]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "email_list_count": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1abfa091-2edb-4e55-b2fc-e3b837df596b": {
            "nodeId": "1abfa091-2edb-4e55-b2fc-e3b837df596b",
            "name": "Delete Email 2",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "delete_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[8fc20935-4fe1-465d-b962-52011ff78f82].[$item].[id]}}",
                "mailbox_id": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[indicators].[email_addresses].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "ID of email to delete",
                  "order": 1,
                  "title": "Email ID",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "User mailbox ID to delete from",
                  "order": 2,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "email_id",
                "mailbox_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was delete successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2e45f712-a559-4d2b-bc72-051ea2e8a0ef": {
            "nodeId": "2e45f712-a559-4d2b-bc72-051ea2e8a0ef",
            "name": "Would you like to delete emails",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "{{[cfa4d7bb-cc21-49c5-b9c8-280713447b48].[content]}}",
              "messageType": "button",
              "options": [
                {
                  "answer": "Yes",
                  "buttonStyle": "default",
                  "confirmation": "Attempting to Delete Emails",
                  "edgeId": "7a9b6365-a42e-48fa-b529-14ba6b9591a3",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "No",
                  "buttonStyle": "default",
                  "confirmation": "Skipping Delete Emails",
                  "edgeId": "08ce5f83-4332-41ab-9bf5-9a1bd8993ef4",
                  "isTimeoutOnly": false
                }
              ],
              "question": "Would you like to delete these emails? ",
              "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
              "threadTimestamp": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}",
              "timeout": 3600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "08ce5f83-4332-41ab-9bf5-9a1bd8993ef4"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "4b965b0c-fd3d-4f2b-aa30-37f93f214753": {
            "nodeId": "4b965b0c-fd3d-4f2b-aa30-37f93f214753",
            "name": "Workflow Complete 2",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "üìß  Workflow Completed  üìß\n\n{{[16077c2b-e376-4221-9100-687972fa5956].[email_list_count]}} email(s) were successfully deleted.‚úÖ",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9": {
            "nodeId": "4d198fa1-cc7d-47de-9dd9-f33a50d90fd9",
            "name": "No Emails Found",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "üìß  Workflow completed  üìß\n\nNo emails found with the search criteria provided.‚ùó",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "546b32d7-cbbf-45af-84aa-7f8d64ec20dd": {
            "nodeId": "546b32d7-cbbf-45af-84aa-7f8d64ec20dd",
            "name": "Delete Email Parsed Args",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Target mailbox: \"{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[indicators].[email_addresses].[0]}}\"\n\nFrom: \"{{[75c4e364-f202-469e-bcb3-4140fe36e205].[from]}}\"\nSubject: \"{{[75c4e364-f202-469e-bcb3-4140fe36e205].[subject]}}\"\nBody: \"{{[75c4e364-f202-469e-bcb3-4140fe36e205].[body]}}\"\n\nDelete: \"{{[75c4e364-f202-469e-bcb3-4140fe36e205].[delete]}}\""
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4": {
            "nodeId": "5f2d1d0a-92b7-4479-b35f-c9cd841c10f4",
            "name": "Automatically Delete Emails?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "6c54522f-2d39-4705-a424-797087bc83bb",
              "stepControlParams": [
                {
                  "edgeId": "5497d824-9e2b-4467-b7f2-bfbe85313f88",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "75c4e364-f202-469e-bcb3-4140fe36e205.delete",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "AND",
                    "right": {
                      "name": "75c4e364-f202-469e-bcb3-4140fe36e205.delete",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "is_defined({{[75c4e364-f202-469e-bcb3-4140fe36e205].[delete]}}) AND {{[75c4e364-f202-469e-bcb3-4140fe36e205].[delete]}}"
                },
                {
                  "edgeId": "6c54522f-2d39-4705-a424-797087bc83bb",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "75c4e364-f202-469e-bcb3-4140fe36e205": {
            "nodeId": "75c4e364-f202-469e-bcb3-4140fe36e205",
            "name": "Parse Args",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n\n    # Sometimes Slack will give us email in their linked form:\n    # <mailto:user@example.com>\n    # or\n    # <http://www.exmaple.com|example.com>\n    def parse_email(email):\n\n        if email.startswith(\"<\"):\n            # mailto link\n            if \"mailto:\" in email:\n                split_email = email.split(\":\")[1]\n                if \"|\" in split_email:\n                    return split_email.split(\"|\")[0]\n                return split_email\n\n            # http link\n            if \"http:\" in email:\n                split_email = email.split(\"|\")[1]\n                split_email = split_email.rstrip(\">\")\n                return split_email\n\n        return email\n\n    import shlex\n    input = params.get(\"input\")\n\n    # Sometimes slack gives us unicode spaces\n    input = input.replace(u'\\xa0', u' ')\n\n    # split our args \n    args = shlex.split(input)\n\n    # get the recipient email and clean it up\n    email = parse_email(args[1])    \n    args_for_delete_email = {\n        \"email\": email\n    }\n\n    # parse args\n    for i in range(1, len(args)):\n        split_args = args[i].split('=')\n        if split_args[0].lower() == \"subject\":\n            args_for_delete_email[\"subject\"] = split_args[1]\n        if split_args[0].lower() == \"body\":\n            args_for_delete_email[\"body\"] = split_args[1]\n        if split_args[0].lower() == \"from\":\n            args_for_delete_email[\"from\"] = parse_email(split_args[1])\n        if split_args[0].lower() == \"delete\":\n            args_for_delete_email[\"delete\"] = True if split_args[1][0].lower() == 't' else False\n\n    return(args_for_delete_email)",
                "input": {
                  "input": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[text]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "body": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "delete": {
                  "type": "boolean"
                },
                "email": {
                  "type": "string"
                },
                "from": {
                  "type": "string"
                },
                "subject": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f": {
            "nodeId": "807a9b29-3e8c-4f80-bdf7-00dcb1fe1c8f",
            "name": "Delete Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "delete_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[c1be2795-8756-4862-ad94-1d7d2fe751ea].[$item].[id]}}",
                "mailbox_id": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[indicators].[email_addresses].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "ID of email to delete",
                  "order": 1,
                  "title": "Email ID",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "User mailbox ID to delete from",
                  "order": 2,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "email_id",
                "mailbox_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was delete successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8611a657-e320-4b61-8924-faceafdc49e1": {
            "nodeId": "8611a657-e320-4b61-8924-faceafdc49e1",
            "name": "Start Search Notification",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Starting an email search with the following:\n\n{{[546b32d7-cbbf-45af-84aa-7f8d64ec20dd].[content]}}",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "8fc20935-4fe1-465d-b962-52011ff78f82": {
            "nodeId": "8fc20935-4fe1-465d-b962-52011ff78f82",
            "name": "Delete Emails",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "92e28643-a89f-4329-97b9-7f172d0078f5",
              "nextEdgeId": "955d8b43-22cb-403d-b6cd-97b24fbe7027",
              "repeatVariable": "{{[ff066138-0d02-4a61-afb4-f7148af31434].[email_list]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "901c9f14-9462-41d5-9959-afe7d477493e": {
            "nodeId": "901c9f14-9462-41d5-9959-afe7d477493e",
            "name": "Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Overview\n\n(This artifact can be deleted)\n\nThis workflow uses the Chat Ops Slack connection to listen for key messages from the InsightConnect Rapid7 connection and will search for and delete emails when triggered.\n\nTo trigger this workflow, send a direct message to Rapid7 InsightConnect from Slack like the following.\n\n`find-email user@example.com subject=\"A phishy email\"`\n\nThis will kick off the workflow, and prompt you back when the search is completed. If any emails are found that match the criteria, you can hit the delete button in Slack to delete them.\n\n### Other options:\n\nSearch criteria can be body, subject, or from lines in the email. For example:\n\n`find-email user@example.com subject=\"A phishy email\" from=\"example.com\" body=\"Click here for free stuff\" `\n\nAny combination of body, subject, and from can be used. At least one search item must be given.\n\nIf you'd like the workflow to just delete emails without prompting, you can also use 'delete=true' For example:\n\n`find-email user@example.com subject=\"A phishy email\" delete=true`"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "9108708f-fe22-4f2a-869b-7ba004878a27": {
            "nodeId": "9108708f-fe22-4f2a-869b-7ba004878a27",
            "name": "Was parsing successful",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c35a649f-3cb7-463b-aa43-eac62325d534",
              "stepControlParams": [
                {
                  "edgeId": "941adb16-50af-4c10-9763-600d35c2d92f",
                  "expression": {
                    "name": "75c4e364-f202-469e-bcb3-4140fe36e205.$success",
                    "type": "variable"
                  },
                  "expressionText": "{{[75c4e364-f202-469e-bcb3-4140fe36e205].[$success]}}"
                },
                {
                  "edgeId": "c35a649f-3cb7-463b-aa43-eac62325d534",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9dfbea14-3d78-4fbb-937b-88d4c9b277d8": {
            "nodeId": "9dfbea14-3d78-4fbb-937b-88d4c9b277d8",
            "name": "Delete Email Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "{{$workflow.[Channel]}}",
                "matchText": "find-email",
                "type": "any"
              }
            },
            "triggerId": "a5a63e9f-661b-47da-8c30-e0dd7014e24e",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5": {
            "nodeId": "bc1e909d-4a55-4e24-9dd9-523b19e2c9d5",
            "name": "Workflow Complete",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Workflow Complete\n\n{{[16077c2b-e376-4221-9100-687972fa5956].[email_list_count]}} email(s) were successfully deleted."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c1be2795-8756-4862-ad94-1d7d2fe751ea": {
            "nodeId": "c1be2795-8756-4862-ad94-1d7d2fe751ea",
            "name": "Delete Emails 2",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "f05f0c74-43f1-4c1a-aa6c-b9cc9859d005",
              "nextEdgeId": "ec54bcef-f96f-4a6f-a1a2-ce7f6604caff",
              "repeatVariable": "{{[ff066138-0d02-4a61-afb4-f7148af31434].[email_list]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "c5cce12b-3672-4d99-83be-9df69fd3794c": {
            "nodeId": "c5cce12b-3672-4d99-83be-9df69fd3794c",
            "name": "Workflow Completed without Delete",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "üìß  Workflow Completed  üìß \n\nEmails were not deleted.‚ùó",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "cfa4d7bb-cc21-49c5-b9c8-280713447b48": {
            "nodeId": "cfa4d7bb-cc21-49c5-b9c8-280713447b48",
            "name": "Found Email Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Mailbox Scanned: {{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[indicators].[email_addresses].[0]}}\nNumber of emails found: {{[16077c2b-e376-4221-9100-687972fa5956].[email_list_count]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "cfb0da23-e667-4969-a80e-6ef5775faa87": {
            "nodeId": "cfb0da23-e667-4969-a80e-6ef5775faa87",
            "name": "Workflow Complete Manual Delete",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "üìß  Emails deleted successfully  üìß \n\nWorkflow Complete ‚úÖ",
                "recipient": "@{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "fa588e39-aba7-4a3a-bcac-bcea4e80ff74": {
            "nodeId": "fa588e39-aba7-4a3a-bcac-bcea4e80ff74",
            "name": "No Emails Found Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "üìß  No mails found  üìß \n\nWorkflow Complete ‚ùó",
                "recipient": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[user]}}",
                "thread_ts": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "ff066138-0d02-4a61-afb4-f7148af31434": {
            "nodeId": "ff066138-0d02-4a61-afb4-f7148af31434",
            "name": "Search Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "get_email_from_user",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "body_contains": "{{[75c4e364-f202-469e-bcb3-4140fe36e205].[body]}}",
                "from_contains": "{{[75c4e364-f202-469e-bcb3-4140fe36e205].[from]}}",
                "mailbox_id": "{{[9dfbea14-3d78-4fbb-937b-88d4c9b277d8].[message].[indicators].[email_addresses].[0]}}",
                "max_number_to_return": 250,
                "subject_contains": "{{[75c4e364-f202-469e-bcb3-4140fe36e205].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "body_contains": {
                  "description": "Body contains this word or phrase",
                  "order": 5,
                  "title": "Body",
                  "type": "string"
                },
                "from_contains": {
                  "description": "From address contains this (can be full e-mail address or just a domain) e.g. user@example.com or example.com",
                  "order": 3,
                  "title": "From",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Target user to retrieve email from",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "max_number_to_return": {
                  "default": 250,
                  "description": "Maximum number of emails to return. Max limit is 250 (default)",
                  "order": 2,
                  "title": "Max Number to Return",
                  "type": "integer"
                },
                "subject_contains": {
                  "description": "Subject contains this word or phrase",
                  "order": 4,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "email_list": {
                  "description": "List of emails",
                  "items": {
                    "$ref": "#/definitions/icon_email"
                  },
                  "order": 1,
                  "title": "Email List",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Microsoft",
          "Phishing",
          "Slack"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channel": {
                "type": "string",
                "description": "The Slack channel name in your environment where the workflow should be triggered"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "a5a63e9f-661b-47da-8c30-e0dd7014e24e",
        "name": "Delete Email Trigger",
        "description": "",
        "input": {
          "matchChannel": "{{$workflow.[Channel]}}",
          "matchText": "find-email",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}