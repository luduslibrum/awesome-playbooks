{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:49:35.386488442Z",
    "workflowVersions": [
      {
        "name": "Most Vulnerable Assets in Sites to Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow returns the top 10 most vulnerable assets in each site in InsightVM.\n\nSample Slack Trigger Commands:\n\n`@Slackbot list most vulnerable assets`\n\n# Key Features\n\n* Lists most vulnerable assets from InsightVM in Slack\n\n# Requirements\n\nAPI and account credentials for\n\n* InsightVM Console URL and account credentials\n* InsightConnect License\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n\n# Documentation\n\n## Setup\n\nOnce the workflow has been downloaded, login to InsightConnect and “Import” it into the workflow builder. Once imported, you will initially be prompted to configure the connections for each of the plugins.\n\nTo run the workflow, @ your Slackbot in any channel or in a direct message along with the command \"list most vulnerable assets\". The workflow will post responses in a thread.\n\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|CSV|1.1.5|1|\n|Rapid7 InsightVM|4.0.0|2|\n|Type Converter|1.5.1|2|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.1 - Updated documentation\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [InsightVM] (https://www.rapid7.com/products/insightvm/)\n* [Slack] (https://www.slack.com)\n",
        "graph": {
          "edges": {
            "0790f9d1-36f4-4951-b716-07009f910c82": {
              "id": "0790f9d1-36f4-4951-b716-07009f910c82",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f62a34ec-c00f-4167-8705-f21ee64736b1",
              "toNodeId": "138795ce-68c9-43b0-9f91-ec791b23c4fb"
            },
            "0c9f8613-7d97-4b9d-884f-1499272ee8fc": {
              "id": "0c9f8613-7d97-4b9d-884f-1499272ee8fc",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "toNodeId": "c8b329a1-3960-49be-b11c-b298c89bc98d"
            },
            "18611438-038d-412c-8344-4ec9392a1bd0": {
              "id": "18611438-038d-412c-8344-4ec9392a1bd0",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "6d4cb4ef-d08a-474c-a6ba-3831e9430887",
              "toNodeId": "69b08491-d349-47b6-9fd9-06bb7331caaf"
            },
            "18785e97-bcc5-4c4b-8fa5-b33aae8ab4f1": {
              "id": "18785e97-bcc5-4c4b-8fa5-b33aae8ab4f1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "138795ce-68c9-43b0-9f91-ec791b23c4fb",
              "toNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "5f21a80f-f865-4e21-8509-40d8c9da7964": {
              "id": "5f21a80f-f865-4e21-8509-40d8c9da7964",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "69b08491-d349-47b6-9fd9-06bb7331caaf",
              "toNodeId": "c834c35e-0939-4582-9b19-cae8019ad3d7"
            },
            "6c6dffe8-5a4c-47ae-abe0-ec03ecf9fdde": {
              "id": "6c6dffe8-5a4c-47ae-abe0-ec03ecf9fdde",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d",
              "toNodeId": "7f9ae83d-244d-496c-9278-46d56f35af9d"
            },
            "7ade3a65-95bf-4fbc-bcf3-22b99d46f72f": {
              "id": "7ade3a65-95bf-4fbc-bcf3-22b99d46f72f",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "toNodeId": "7892e300-007e-4b65-aa4d-eee2b4c52f38"
            },
            "7db015cc-45b0-438a-8fe9-c831f50fb04d": {
              "id": "7db015cc-45b0-438a-8fe9-c831f50fb04d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "43b355e2-279c-422a-951b-66e3d46733b3",
              "toNodeId": "f62a34ec-c00f-4167-8705-f21ee64736b1"
            },
            "9461442e-0e02-463a-a287-8bc08d2718d1": {
              "id": "9461442e-0e02-463a-a287-8bc08d2718d1",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "c834c35e-0939-4582-9b19-cae8019ad3d7",
              "toNodeId": "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d"
            },
            "968bffc1-2b11-47c3-92b4-aa1250dd2b19": {
              "id": "968bffc1-2b11-47c3-92b4-aa1250dd2b19",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c8b329a1-3960-49be-b11c-b298c89bc98d",
              "toNodeId": ""
            },
            "9fe44c11-c5ca-43fb-b997-cebdbae0ea7a": {
              "id": "9fe44c11-c5ca-43fb-b997-cebdbae0ea7a",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "7892e300-007e-4b65-aa4d-eee2b4c52f38",
              "toNodeId": "6d4cb4ef-d08a-474c-a6ba-3831e9430887"
            },
            "a0315e79-ddcd-4928-b87c-4c41b09b2d14": {
              "id": "a0315e79-ddcd-4928-b87c-4c41b09b2d14",
              "name": "",
              "description": "",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "fromNodeId": "7f9ae83d-244d-496c-9278-46d56f35af9d",
              "toNodeId": ""
            }
          },
          "nodes": {
            "138795ce-68c9-43b0-9f91-ec791b23c4fb": {
              "id": "138795ce-68c9-43b0-9f91-ec791b23c4fb",
              "parentNodeId": ""
            },
            "28eae105-bc32-4253-b7ca-3647c05c1bdb": {
              "id": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
              "parentNodeId": ""
            },
            "43b355e2-279c-422a-951b-66e3d46733b3": {
              "id": "43b355e2-279c-422a-951b-66e3d46733b3",
              "parentNodeId": ""
            },
            "69b08491-d349-47b6-9fd9-06bb7331caaf": {
              "id": "69b08491-d349-47b6-9fd9-06bb7331caaf",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "6d4cb4ef-d08a-474c-a6ba-3831e9430887": {
              "id": "6d4cb4ef-d08a-474c-a6ba-3831e9430887",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "7892e300-007e-4b65-aa4d-eee2b4c52f38": {
              "id": "7892e300-007e-4b65-aa4d-eee2b4c52f38",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "7f9ae83d-244d-496c-9278-46d56f35af9d": {
              "id": "7f9ae83d-244d-496c-9278-46d56f35af9d",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d": {
              "id": "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "c834c35e-0939-4582-9b19-cae8019ad3d7": {
              "id": "c834c35e-0939-4582-9b19-cae8019ad3d7",
              "parentNodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb"
            },
            "c8b329a1-3960-49be-b11c-b298c89bc98d": {
              "id": "c8b329a1-3960-49be-b11c-b298c89bc98d",
              "parentNodeId": ""
            },
            "f62a34ec-c00f-4167-8705-f21ee64736b1": {
              "id": "f62a34ec-c00f-4167-8705-f21ee64736b1",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "138795ce-68c9-43b0-9f91-ec791b23c4fb": {
            "nodeId": "138795ce-68c9-43b0-9f91-ec791b23c4fb",
            "name": "Get Site List",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "get_sites",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "name": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "name": {
                  "default": "",
                  "description": "Site name regular expression by which to filter",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "site": {
                  "properties": {
                    "assets": {
                      "description": "Site asset count",
                      "order": 1,
                      "title": "Assets",
                      "type": "integer"
                    },
                    "connectionType": {
                      "description": "Site discovery connection type (if applicable)",
                      "order": 2,
                      "title": "Connection Type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Site description",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the site",
                      "order": 4,
                      "title": "ID",
                      "type": "integer"
                    },
                    "importance": {
                      "description": "Site importance, used with the 'weighted' risk scoring strategy",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "lastScanTime": {
                      "description": "Site last scan time",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 6,
                      "title": "Last Scan Time",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 7,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Site name",
                      "order": 8,
                      "title": "Name",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Site risk score",
                      "order": 9,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "scanEngine": {
                      "description": "Site default scan engine ID",
                      "order": 10,
                      "title": "Scan Engine",
                      "type": "integer"
                    },
                    "scanTemplate": {
                      "description": "Site default scan template",
                      "order": 11,
                      "title": "Scan Template",
                      "type": "string"
                    },
                    "type": {
                      "description": "Site type",
                      "order": 12,
                      "title": "Type",
                      "type": "string"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities_count",
                      "description": "Site vulnerability counts",
                      "order": 13,
                      "title": "Vulnerabilities"
                    }
                  },
                  "required": [
                    "scanEngine",
                    "type",
                    "vulnerabilities",
                    "id",
                    "name",
                    "riskScore",
                    "links",
                    "scanTemplate",
                    "assets",
                    "importance"
                  ],
                  "title": "Site",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "sites": {
                  "description": "List of sites",
                  "items": {
                    "$ref": "#/definitions/site"
                  },
                  "order": 1,
                  "title": "Sites",
                  "type": "array"
                }
              },
              "required": [
                "sites"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "28eae105-bc32-4253-b7ca-3647c05c1bdb": {
            "nodeId": "28eae105-bc32-4253-b7ca-3647c05c1bdb",
            "name": "Do Work for Each Site",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "7ade3a65-95bf-4fbc-bcf3-22b99d46f72f",
              "nextEdgeId": "0c9f8613-7d97-4b9d-884f-1499272ee8fc",
              "repeatVariable": "{{[138795ce-68c9-43b0-9f91-ec791b23c4fb].[sites]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "43b355e2-279c-422a-951b-66e3d46733b3": {
            "nodeId": "43b355e2-279c-422a-951b-66e3d46733b3",
            "name": "trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "",
                "matchText": "list most vulnerable assets.*",
                "type": "any"
              }
            },
            "triggerId": "94751b22-c3ed-43c7-bcb4-352d8b303062",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "69b08491-d349-47b6-9fd9-06bb7331caaf": {
            "nodeId": "69b08491-d349-47b6-9fd9-06bb7331caaf",
            "name": "Convert Report to Object",
            "type": "action",
            "plugin": {
              "name": "CSV",
              "slugVendor": "rapid7",
              "slugName": "csv",
              "slugVersion": "1.1.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/csv/1.1.5/icon.png"
            },
            "identifier": "to_json",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "csv": "{{[6d4cb4ef-d08a-474c-a6ba-3831e9430887].[report].[content]}}",
                "validation": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "csv": {
                  "description": "Base64 encoded CSV file",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "CSV",
                  "type": "string"
                },
                "validation": {
                  "default": false,
                  "description": "Validate CSV data, error if not valid",
                  "order": 2,
                  "title": "Validate",
                  "type": "boolean"
                }
              },
              "required": [
                "csv",
                "validation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "json": {
                  "description": "List of objects",
                  "items": {
                    "type": "object"
                  },
                  "order": 1,
                  "title": "JSON",
                  "type": "array"
                }
              },
              "required": [
                "json"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "json": {
                  "properties": {
                    "crit_vulns": {
                      "type": "string"
                    },
                    "exploits": {
                      "type": "string"
                    },
                    "hostname": {
                      "type": "string"
                    },
                    "ip_address": {
                      "type": "string"
                    },
                    "malware_kits": {
                      "type": "string"
                    },
                    "mod_vulns": {
                      "type": "string"
                    },
                    "riskscore": {
                      "type": "string"
                    },
                    "sev_vulns": {
                      "type": "string"
                    },
                    "total_vulns": {
                      "type": "string"
                    },
                    "vuln_instances": {
                      "type": "string"
                    },
                    "vulns_with_exploit": {
                      "type": "string"
                    },
                    "vulns_with_malware": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              },
              "properties": {
                "json": {
                  "description": "List of objects",
                  "items": {
                    "$ref": "#/definitions/json"
                  },
                  "order": 1,
                  "title": "JSON",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "6d4cb4ef-d08a-474c-a6ba-3831e9430887": {
            "nodeId": "6d4cb4ef-d08a-474c-a6ba-3831e9430887",
            "name": "Get Top 10 Assets in Site By Risk",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.0.0/icon.png"
            },
            "identifier": "generate_adhoc_sql_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "filters": "{}",
                "query": "select \n\tvulnerabilities,\n\tcritical_vulnerabilities,\n\tsevere_vulnerabilities,\n\tmoderate_vulnerabilities,\n\tmalware_kits,\n\texploits,\n\tvulnerabilities_with_malware_kit,\n\tvulnerabilities_with_exploit,\n\tvulnerability_instances,\n\tround(riskscore) as riskscore,\n\tip_address,\n\thost_name\nfrom fact_asset\njoin dim_asset using (asset_id)\norder by riskscore desc limit 10",
                "scope": "sites",
                "scope_ids": "{{[7892e300-007e-4b65-aa4d-eee2b4c52f38].[output].[array]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filters": {
                  "default": "{}",
                  "description": "Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options",
                  "order": 4,
                  "title": "Report Filters",
                  "type": "string"
                },
                "query": {
                  "description": "Reporting Data Model SQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "scope": {
                  "default": "none",
                  "description": "Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input",
                  "enum": [
                    "none",
                    "assets",
                    "assetGroups",
                    "sites",
                    "tags",
                    "scan"
                  ],
                  "order": 2,
                  "title": "Scope",
                  "type": "string"
                },
                "scope_ids": {
                  "default": [],
                  "description": "Scope IDs for which tickets should be generated, by default all are included",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "Scope IDs",
                  "type": "array"
                }
              },
              "required": [
                "query",
                "scope"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file",
                  "description": "Base64 encoded file making up the report",
                  "order": 1,
                  "title": "Base64 Encoded Report"
                }
              },
              "required": [
                "report"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7892e300-007e-4b65-aa4d-eee2b4c52f38": {
            "nodeId": "7892e300-007e-4b65-aa4d-eee2b4c52f38",
            "name": "work-around array json bug",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{\"array\": [{{[28eae105-bc32-4253-b7ca-3647c05c1bdb].[$item].[id]}}]}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "output": {
                  "properties": {
                    "array": {
                      "type": "integer"
                    }
                  },
                  "type": "object"
                }
              },
              "properties": {
                "output": {
                  "$ref": "#/definitions/output",
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7f9ae83d-244d-496c-9278-46d56f35af9d": {
            "nodeId": "7f9ae83d-244d-496c-9278-46d56f35af9d",
            "name": "Post Site Result",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": "{{[b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d].[output].[blocks]}}",
                "message": "*Site: {{[28eae105-bc32-4253-b7ca-3647c05c1bdb].[$item].[name]}}*\n_Risk Sore: {{[28eae105-bc32-4253-b7ca-3647c05c1bdb].[$item].[riskScore]}}_",
                "recipient": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[channel_id]}}",
                "thread_ts": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d": {
            "nodeId": "b5ebfed8-4dc5-4b77-8442-bd0fcac9a87d",
            "name": "work-around array json bug2",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.5.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.5.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{\"blocks\":{{[c834c35e-0939-4582-9b19-cae8019ad3d7].[content]}}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "c834c35e-0939-4582-9b19-cae8019ad3d7": {
            "nodeId": "c834c35e-0939-4582-9b19-cae8019ad3d7",
            "name": "Asset Blocks",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "[\n{{#each [69b08491-d349-47b6-9fd9-06bb7331caaf].[json]}}\n\t{{#if @index}},{{/if}}\n\t{\n    \t\"color\": \"#fc8c03\",\n        \"pretext\": \"{{#if host_name}}*{{host_name}}*\\n{{/if}}*{{ip_address}}*\",\n        \"text\": \"_risk: {{riskscore}}_\",\n        \"fields\":[\n        \t{\n        \t\"title\": \"Total Vulns\",\n            \"value\": \"{{vulnerabilities}}\",\n            \"short\": true\n            },\n            {\n        \t\"title\": \"Crit Vulns\",\n            \"value\": \"{{critical_vulnerabilities}}\",\n            \"short\": true\n            },\n            {\n        \t\"title\": \"Sev Vulns\",\n            \"value\": \"{{severe_vulnerabilities}}\",\n            \"short\": true\n            },\n            {\n        \t\"title\": \"Mod Vulns\",\n            \"value\": \"{{moderate_vulnerabilities}}\",\n            \"short\": true\n            },\n            {\n        \t\"title\": \"Malware\",\n            \"value\": \"{{malware_kits}}\",\n            \"short\": true\n            },\n            {\n        \t\"title\": \"Exploits\",\n            \"value\": \"{{exploits}}\",\n            \"short\": true\n            }\n        ]\n    }\n{{/each}}\n]"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c8b329a1-3960-49be-b11c-b298c89bc98d": {
            "nodeId": "c8b329a1-3960-49be-b11c-b298c89bc98d",
            "name": "Done",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Done",
                "recipient": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[channel_id]}}",
                "thread_ts": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "f62a34ec-c00f-4167-8705-f21ee64736b1": {
            "nodeId": "f62a34ec-c00f-4167-8705-f21ee64736b1",
            "name": "Working on it",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "Working on it.....",
                "recipient": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[channel_id]}}",
                "thread_ts": "{{[43b355e2-279c-422a-951b-66e3d46733b3].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          }
        },
        "tags": [
          "Asset Management",
          "Rapid7",
          "Slack",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "94751b22-c3ed-43c7-bcb4-352d8b303062",
        "name": "trigger",
        "description": "",
        "input": {
          "matchChannel": "",
          "matchText": "list most vulnerable assets.*",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}