{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:54:39.167612541Z",
    "workflowVersions": [
      {
        "name": "Enrich Indicators with OSINT from Microsoft Teams {{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[words].[1]}}",
        "type": "runnable",
        "version": "",
        "description": "# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Workflow Control Panel to select or create connections and fill in the Parameters.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are two parameters you will need to configure in order to complete setup of your workflow:\n* `Team Name`: The Microsoft Teams team name in your environment where the workflow should be triggered and respond\n* `Channel Name`: The Microsoft Teams channel name in your environment where the workflow should be triggered and respond\n\nAfter configuring the Parameters, activate the workflow in order to trigger it.\n\n**Note:** This workflow is designed to enrich the indicator provided with a combination of external OSINT as well as internal data sources, in this case, Palo Alto Cortex XDR & Mimecast. If your organization uses different vendors, you can check the Extension Library to confirm whether your vendors are supported as well with pre-built plugins. If so, you can reconfigure the workflow to use those plugins instead.\n\n## Usage\n\n*This workflow will only trigger in the channel specified in the Microsoft Teams Parameters.*\n\nTo run the workflow, send a message to the specified Microsoft Teams channel starting with the command `!enrich-indicator`. \n\nCommands should be in the following format:\n`!enrich-indicator <indicator>`\n\n`!enrich-indicator ip 8.8.8.8`\n`!enrich-indicator url badsite.com`\n`!enrich-indicator hash 009f1e9b72cfb6daa3de82093a755bdb3685e0eb`\n\nThe workflow will post the results in a thread.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|\n|----|----|\n|VirusTotal|9.0.0|\n|Type Converter|1.8.1|\n|urlscan.io|4.0.2|\n|Microsoft Teams|3.2.0|\n|WHOIS|3.0.3|\n|Datetime|3.0.0|\n|Math|1.2.1|\n|Palo Alto Cortex XDR|2.2.1|\n|DNS|2.0.0|\n|Sleep|1.0.2|\n|ExtractIt|2.3.1|\n|Mimecast|4.1.2|\n|PassiveTotal|1.0.1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n",
        "graph": {
          "edges": {
            "022f65e4-073d-4238-9ef8-8fef8290ac81": {
              "id": "022f65e4-073d-4238-9ef8-8fef8290ac81",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
              "toNodeId": "e5618dbc-a698-4252-acdf-c97348754912"
            },
            "08276b36-f75d-496e-bd5c-2f396269f6fe": {
              "id": "08276b36-f75d-496e-bd5c-2f396269f6fe",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "0afd1c6d-a367-4d95-9873-19d3f7f0bd71",
              "toNodeId": "b22ec500-aacc-42fe-a122-f566cb5f2736"
            },
            "0c23d376-effe-43cc-913e-338df58cf6dd": {
              "id": "0c23d376-effe-43cc-913e-338df58cf6dd",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "7b04e3f1-6a08-4724-aa34-22357ff732e1",
              "toNodeId": "c8b4564e-08cb-4538-9d82-afe2b5bc41ba"
            },
            "13738d59-526e-49ca-9b0f-2da93e5da5db": {
              "id": "13738d59-526e-49ca-9b0f-2da93e5da5db",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "de7dd5b1-90e3-4310-8884-1548bf0a5816",
              "toNodeId": ""
            },
            "15ab60e2-5f12-4752-851e-c9bc75dcc964": {
              "id": "15ab60e2-5f12-4752-851e-c9bc75dcc964",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "632fb97e-3487-4617-87b1-986d8e1ff739",
              "toNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f"
            },
            "1b5dc676-c002-4f20-aac7-1a4eed88f774": {
              "id": "1b5dc676-c002-4f20-aac7-1a4eed88f774",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
              "toNodeId": "703c2140-cb3c-4200-9ed0-ba830c563858"
            },
            "21e22b72-ab2d-4a52-85e1-0c281a149d8b": {
              "id": "21e22b72-ab2d-4a52-85e1-0c281a149d8b",
              "name": "",
              "description": "",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "fromNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "toNodeId": "3baf3069-e761-44a7-9efb-efa20e0c930f"
            },
            "255d4a4e-fb1a-42cf-9728-81f3f0cb86d0": {
              "id": "255d4a4e-fb1a-42cf-9728-81f3f0cb86d0",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "fcab256e-1e66-4313-aeea-6355f9c755cb",
              "toNodeId": ""
            },
            "30807b21-11f4-48cc-822f-341afa86163f": {
              "id": "30807b21-11f4-48cc-822f-341afa86163f",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "703c2140-cb3c-4200-9ed0-ba830c563858",
              "toNodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675"
            },
            "32afde22-afc1-4294-a6c9-1a993c5f4381": {
              "id": "32afde22-afc1-4294-a6c9-1a993c5f4381",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "2564fd87-407c-446e-ae86-39433940c452",
              "toNodeId": "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276"
            },
            "362cc1be-b042-4aeb-8b36-f12f54bb44f1": {
              "id": "362cc1be-b042-4aeb-8b36-f12f54bb44f1",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "2bfecf58-e9ec-40d6-ad27-265d86a262ed",
              "toNodeId": "1e170483-6050-4572-b2c6-61221d31d98e"
            },
            "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa": {
              "id": "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "toNodeId": "8555f89c-7355-4854-b8ca-067f214f1b44"
            },
            "3a1774b8-2a2a-47d4-b9f3-d69d9285e20c": {
              "id": "3a1774b8-2a2a-47d4-b9f3-d69d9285e20c",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "1e170483-6050-4572-b2c6-61221d31d98e",
              "toNodeId": "2fd35825-bcdf-4a4a-ac35-bb07c7076aec"
            },
            "43779f4c-4cf0-46cd-93b0-11b7125850a5": {
              "id": "43779f4c-4cf0-46cd-93b0-11b7125850a5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
              "toNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "4fa1ebca-6ab3-4910-aa82-40288f8cf18a": {
              "id": "4fa1ebca-6ab3-4910-aa82-40288f8cf18a",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "2fd35825-bcdf-4a4a-ac35-bb07c7076aec",
              "toNodeId": "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5"
            },
            "52b8a22c-4c27-445d-b138-ca8130c6e45d": {
              "id": "52b8a22c-4c27-445d-b138-ca8130c6e45d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "toNodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53"
            },
            "56a0baeb-953f-4288-916c-6201a79b042a": {
              "id": "56a0baeb-953f-4288-916c-6201a79b042a",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "c8b4564e-08cb-4538-9d82-afe2b5bc41ba",
              "toNodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d"
            },
            "5d6de27a-2312-41ff-94f6-205d22f2bbde": {
              "id": "5d6de27a-2312-41ff-94f6-205d22f2bbde",
              "name": "",
              "description": "",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "fromNodeId": "105f308b-8691-44bb-aacf-cf7e18f781c9",
              "toNodeId": "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0"
            },
            "5e82b957-21e8-40b2-8285-d4505c6c8cbf": {
              "id": "5e82b957-21e8-40b2-8285-d4505c6c8cbf",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "toNodeId": "a7436414-e9b2-408e-9bfd-6ab6dad8be97"
            },
            "60e0e190-d1ae-41f3-8607-f01535c17bcc": {
              "id": "60e0e190-d1ae-41f3-8607-f01535c17bcc",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e",
              "toNodeId": "2564fd87-407c-446e-ae86-39433940c452"
            },
            "62fa39ff-93ec-4d00-9393-65cb7a529574": {
              "id": "62fa39ff-93ec-4d00-9393-65cb7a529574",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "f94f4d3d-f65d-4931-ae21-afa45917e35c",
              "toNodeId": "7b04e3f1-6a08-4724-aa34-22357ff732e1"
            },
            "6ff29e9a-d053-4f24-b4e9-701aa143267d": {
              "id": "6ff29e9a-d053-4f24-b4e9-701aa143267d",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "a06c17bd-28cd-4337-9910-a3ff55a79640",
              "toNodeId": "fcab256e-1e66-4313-aeea-6355f9c755cb"
            },
            "705dcbfe-489f-4470-aa9a-fdcf259ac788": {
              "id": "705dcbfe-489f-4470-aa9a-fdcf259ac788",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
              "toNodeId": ""
            },
            "73e9301c-fe73-45ce-b020-1906d46830ee": {
              "id": "73e9301c-fe73-45ce-b020-1906d46830ee",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "726bf264-041d-499c-847d-078ba2d8a00a",
              "toNodeId": "958ece1c-d001-4abd-98b5-075a9fb55240"
            },
            "7bb0a965-9957-41eb-b214-60a003419771": {
              "id": "7bb0a965-9957-41eb-b214-60a003419771",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5",
              "toNodeId": "0afd1c6d-a367-4d95-9873-19d3f7f0bd71"
            },
            "7d75b2f6-75c4-4cc4-ae6f-ec1789b3ab15": {
              "id": "7d75b2f6-75c4-4cc4-ae6f-ec1789b3ab15",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "fea4b4ad-1e9d-4cc6-a19e-3c0147472902",
              "toNodeId": "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0"
            },
            "7da1e1a7-9fa7-4bf6-b0a0-08b2713593f1": {
              "id": "7da1e1a7-9fa7-4bf6-b0a0-08b2713593f1",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "f5062351-82ae-4b06-bcb7-340a63136281",
              "toNodeId": "7804a348-2bbd-4071-9729-788f7d901043"
            },
            "7e26775e-9c5c-4f3c-8c0e-c5dbc53ed33c": {
              "id": "7e26775e-9c5c-4f3c-8c0e-c5dbc53ed33c",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "958ece1c-d001-4abd-98b5-075a9fb55240",
              "toNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66"
            },
            "7e64d422-535d-4ba4-810b-898925edd82f": {
              "id": "7e64d422-535d-4ba4-810b-898925edd82f",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "b22ec500-aacc-42fe-a122-f566cb5f2736",
              "toNodeId": "16a88661-da72-4cfb-9e18-15a7c2cf5643"
            },
            "86dd3126-49d6-4d03-9cb3-f4079a0a35ea": {
              "id": "86dd3126-49d6-4d03-9cb3-f4079a0a35ea",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
              "toNodeId": ""
            },
            "871925fa-8867-4473-9f8b-12eb1e5d8be1": {
              "id": "871925fa-8867-4473-9f8b-12eb1e5d8be1",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "8555f89c-7355-4854-b8ca-067f214f1b44",
              "toNodeId": "bd09a56b-05ef-4e61-abf7-13a879105864"
            },
            "888fb95f-8e94-44df-a05c-8108f553cb15": {
              "id": "888fb95f-8e94-44df-a05c-8108f553cb15",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "4097b507-b816-41c5-bf16-409fa4f154c8",
              "toNodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc"
            },
            "8b12629a-70de-4bd1-a984-a68e57ee7a02": {
              "id": "8b12629a-70de-4bd1-a984-a68e57ee7a02",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0",
              "toNodeId": "8fdbce4a-7081-4b98-876b-450508c2bab1"
            },
            "8d311edb-8736-498f-b4c9-b7856e8b8b98": {
              "id": "8d311edb-8736-498f-b4c9-b7856e8b8b98",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
              "toNodeId": "632fb97e-3487-4617-87b1-986d8e1ff739"
            },
            "8e27e688-6be5-4697-b507-cc9b147d1618": {
              "id": "8e27e688-6be5-4697-b507-cc9b147d1618",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "toNodeId": "726bf264-041d-499c-847d-078ba2d8a00a"
            },
            "8e78b6ad-4e6b-4d57-beb5-4b35411303b6": {
              "id": "8e78b6ad-4e6b-4d57-beb5-4b35411303b6",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276",
              "toNodeId": "a6b9ba96-8203-477b-878b-7fbbf667a050"
            },
            "8ed4bf12-773c-4654-84ca-46a596c46e53": {
              "id": "8ed4bf12-773c-4654-84ca-46a596c46e53",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
              "toNodeId": "f5062351-82ae-4b06-bcb7-340a63136281"
            },
            "92789a3b-a349-42c2-b98d-36e491abdbf7": {
              "id": "92789a3b-a349-42c2-b98d-36e491abdbf7",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "1c15e572-19c9-4b18-b996-29857dc3761f",
              "toNodeId": "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e"
            },
            "9b92e3b8-1793-4490-8377-09e9749953ce": {
              "id": "9b92e3b8-1793-4490-8377-09e9749953ce",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "2c13cba7-7a69-465b-b927-b80fb06ec621",
              "toNodeId": "e80e7135-c664-4cde-87d5-d7787f0343da"
            },
            "a139e7ac-f2de-40c8-a16d-e0c3e3622ba0": {
              "id": "a139e7ac-f2de-40c8-a16d-e0c3e3622ba0",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "16a88661-da72-4cfb-9e18-15a7c2cf5643",
              "toNodeId": "4097b507-b816-41c5-bf16-409fa4f154c8"
            },
            "a96ed9a8-0478-4ed5-8e5b-8fa66e39c4e0": {
              "id": "a96ed9a8-0478-4ed5-8e5b-8fa66e39c4e0",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "bd09a56b-05ef-4e61-abf7-13a879105864",
              "toNodeId": "2bfecf58-e9ec-40d6-ad27-265d86a262ed"
            },
            "abea42c8-9870-4fdd-b45d-9a87e783dd2d": {
              "id": "abea42c8-9870-4fdd-b45d-9a87e783dd2d",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "8fdbce4a-7081-4b98-876b-450508c2bab1",
              "toNodeId": "f94f4d3d-f65d-4931-ae21-afa45917e35c"
            },
            "aebcd24c-06fc-4927-bc1b-9a92d54d9e4d": {
              "id": "aebcd24c-06fc-4927-bc1b-9a92d54d9e4d",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "a6b9ba96-8203-477b-878b-7fbbf667a050",
              "toNodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453"
            },
            "aff5803a-8f9f-462b-b905-ed4925a38fb6": {
              "id": "aff5803a-8f9f-462b-b905-ed4925a38fb6",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
              "toNodeId": "1638ba1e-339e-48b4-8840-bfa1f9a991ed"
            },
            "b5f96b26-1161-4e5f-bdcd-f81fed879de4": {
              "id": "b5f96b26-1161-4e5f-bdcd-f81fed879de4",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "toNodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced"
            },
            "bd725153-29d5-4b49-acf1-c7c58eee3c2c": {
              "id": "bd725153-29d5-4b49-acf1-c7c58eee3c2c",
              "name": "",
              "description": "",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "fromNodeId": "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0",
              "toNodeId": ""
            },
            "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7": {
              "id": "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "toNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "bdf9140d-1ab2-4d80-9666-45b539f4db6b": {
              "id": "bdf9140d-1ab2-4d80-9666-45b539f4db6b",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "1638ba1e-339e-48b4-8840-bfa1f9a991ed",
              "toNodeId": ""
            },
            "c2aad70a-9f0c-484f-9ddd-42d3c407ec73": {
              "id": "c2aad70a-9f0c-484f-9ddd-42d3c407ec73",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "78788755-a02c-4110-b0d6-fda75080a7fe",
              "toNodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef"
            },
            "c2b72f99-d944-4846-a99a-ddbfb88cd701": {
              "id": "c2b72f99-d944-4846-a99a-ddbfb88cd701",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "toNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "c5e28be1-7cc1-48ed-82b4-48c696cc56b5": {
              "id": "c5e28be1-7cc1-48ed-82b4-48c696cc56b5",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "e80e7135-c664-4cde-87d5-d7787f0343da",
              "toNodeId": "ab17b159-0978-474a-8bd9-d79def02e57b"
            },
            "c704fd81-a1d8-4395-984a-a4f1e346df74": {
              "id": "c704fd81-a1d8-4395-984a-a4f1e346df74",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "ab17b159-0978-474a-8bd9-d79def02e57b",
              "toNodeId": "fea4b4ad-1e9d-4cc6-a19e-3c0147472902"
            },
            "cfb57469-acdc-4212-979c-32f64853b92b": {
              "id": "cfb57469-acdc-4212-979c-32f64853b92b",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "b837ba56-7857-4940-b6b3-be880fcb0808",
              "toNodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8"
            },
            "e24472c9-ecc8-4753-bc03-6d80ced4799b": {
              "id": "e24472c9-ecc8-4753-bc03-6d80ced4799b",
              "name": "",
              "description": "",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "fromNodeId": "3baf3069-e761-44a7-9efb-efa20e0c930f",
              "toNodeId": "105f308b-8691-44bb-aacf-cf7e18f781c9"
            },
            "e2d0f7a3-0e8b-49f6-a2ff-68beb21deb42": {
              "id": "e2d0f7a3-0e8b-49f6-a2ff-68beb21deb42",
              "name": "Yes",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "a7436414-e9b2-408e-9bfd-6ab6dad8be97",
              "toNodeId": "a06c17bd-28cd-4337-9910-a3ff55a79640"
            },
            "e88dd9ed-9dd6-4f81-b21a-3b61b9a9f858": {
              "id": "e88dd9ed-9dd6-4f81-b21a-3b61b9a9f858",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "7804a348-2bbd-4071-9729-788f7d901043",
              "toNodeId": "78788755-a02c-4110-b0d6-fda75080a7fe"
            },
            "ea1ef7b9-aea3-417a-b6aa-e17df86e890b": {
              "id": "ea1ef7b9-aea3-417a-b6aa-e17df86e890b",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "e5618dbc-a698-4252-acdf-c97348754912",
              "toNodeId": "de7dd5b1-90e3-4310-8884-1548bf0a5816"
            },
            "ecfbf3a7-7850-4731-91bb-f19f6b15c125": {
              "id": "ecfbf3a7-7850-4731-91bb-f19f6b15c125",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "toNodeId": "1c15e572-19c9-4b18-b996-29857dc3761f"
            },
            "efc38443-e16a-4dab-9a18-98f1998c4769": {
              "id": "efc38443-e16a-4dab-9a18-98f1998c4769",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
              "toNodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087"
            },
            "f2efb24a-caaf-4221-9418-5f5a5d18cfbb": {
              "id": "f2efb24a-caaf-4221-9418-5f5a5d18cfbb",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
              "toNodeId": "2c13cba7-7a69-465b-b927-b80fb06ec621"
            },
            "f32d2594-3f3f-4c34-b9ab-98c0278f11ed": {
              "id": "f32d2594-3f3f-4c34-b9ab-98c0278f11ed",
              "name": "No",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "a7436414-e9b2-408e-9bfd-6ab6dad8be97",
              "toNodeId": "b837ba56-7857-4940-b6b3-be880fcb0808"
            },
            "f39dd67b-7062-4eb4-a32e-63a115c69f47": {
              "id": "f39dd67b-7062-4eb4-a32e-63a115c69f47",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
              "toNodeId": ""
            },
            "f82389e9-aef8-4758-a1e7-99ebca8e2656": {
              "id": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "toNodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a"
            }
          },
          "nodes": {
            "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276": {
              "id": "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "0a72bb10-b2b8-4976-b464-41f02ed9a67a": {
              "id": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
              "parentNodeId": ""
            },
            "0afd1c6d-a367-4d95-9873-19d3f7f0bd71": {
              "id": "0afd1c6d-a367-4d95-9873-19d3f7f0bd71",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "0e158eb6-6cc2-4eb9-bbac-470d6995b675": {
              "id": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "105f308b-8691-44bb-aacf-cf7e18f781c9": {
              "id": "105f308b-8691-44bb-aacf-cf7e18f781c9",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66"
            },
            "13fbfc5d-a157-4b40-8a84-e930fe648d66": {
              "id": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "1638ba1e-339e-48b4-8840-bfa1f9a991ed": {
              "id": "1638ba1e-339e-48b4-8840-bfa1f9a991ed",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "16a88661-da72-4cfb-9e18-15a7c2cf5643": {
              "id": "16a88661-da72-4cfb-9e18-15a7c2cf5643",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d": {
              "id": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "1c15e572-19c9-4b18-b996-29857dc3761f": {
              "id": "1c15e572-19c9-4b18-b996-29857dc3761f",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "1e170483-6050-4572-b2c6-61221d31d98e": {
              "id": "1e170483-6050-4572-b2c6-61221d31d98e",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "2564fd87-407c-446e-ae86-39433940c452": {
              "id": "2564fd87-407c-446e-ae86-39433940c452",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "26b0afac-ca64-4f1c-99bf-22bd73b3c93f": {
              "id": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
              "parentNodeId": ""
            },
            "2bfecf58-e9ec-40d6-ad27-265d86a262ed": {
              "id": "2bfecf58-e9ec-40d6-ad27-265d86a262ed",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "2c13cba7-7a69-465b-b927-b80fb06ec621": {
              "id": "2c13cba7-7a69-465b-b927-b80fb06ec621",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "2fd35825-bcdf-4a4a-ac35-bb07c7076aec": {
              "id": "2fd35825-bcdf-4a4a-ac35-bb07c7076aec",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "3baf3069-e761-44a7-9efb-efa20e0c930f": {
              "id": "3baf3069-e761-44a7-9efb-efa20e0c930f",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66"
            },
            "4097b507-b816-41c5-bf16-409fa4f154c8": {
              "id": "4097b507-b816-41c5-bf16-409fa4f154c8",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "632fb97e-3487-4617-87b1-986d8e1ff739": {
              "id": "632fb97e-3487-4617-87b1-986d8e1ff739",
              "parentNodeId": ""
            },
            "65e084cc-e4c4-479e-93c8-cccd35ccaecc": {
              "id": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "703c2140-cb3c-4200-9ed0-ba830c563858": {
              "id": "703c2140-cb3c-4200-9ed0-ba830c563858",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "726bf264-041d-499c-847d-078ba2d8a00a": {
              "id": "726bf264-041d-499c-847d-078ba2d8a00a",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "7804a348-2bbd-4071-9729-788f7d901043": {
              "id": "7804a348-2bbd-4071-9729-788f7d901043",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "78788755-a02c-4110-b0d6-fda75080a7fe": {
              "id": "78788755-a02c-4110-b0d6-fda75080a7fe",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "7b04e3f1-6a08-4724-aa34-22357ff732e1": {
              "id": "7b04e3f1-6a08-4724-aa34-22357ff732e1",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "7ec8f1bf-ba7c-442e-8679-b1463aa42453": {
              "id": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "8555f89c-7355-4854-b8ca-067f214f1b44": {
              "id": "8555f89c-7355-4854-b8ca-067f214f1b44",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef": {
              "id": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "8fdbce4a-7081-4b98-876b-450508c2bab1": {
              "id": "8fdbce4a-7081-4b98-876b-450508c2bab1",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "958ece1c-d001-4abd-98b5-075a9fb55240": {
              "id": "958ece1c-d001-4abd-98b5-075a9fb55240",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "9acb3237-d5f5-4a85-b46e-f08226513060": {
              "id": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "parentNodeId": ""
            },
            "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8": {
              "id": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "a06c17bd-28cd-4337-9910-a3ff55a79640": {
              "id": "a06c17bd-28cd-4337-9910-a3ff55a79640",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e": {
              "id": "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "a2f5b26e-51b8-4027-b295-29353fa3ab53": {
              "id": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
              "parentNodeId": ""
            },
            "a55a5c03-1340-467d-9d71-07bfad1d072f": {
              "id": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "parentNodeId": ""
            },
            "a6b9ba96-8203-477b-878b-7fbbf667a050": {
              "id": "a6b9ba96-8203-477b-878b-7fbbf667a050",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "a7436414-e9b2-408e-9bfd-6ab6dad8be97": {
              "id": "a7436414-e9b2-408e-9bfd-6ab6dad8be97",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "ab17b159-0978-474a-8bd9-d79def02e57b": {
              "id": "ab17b159-0978-474a-8bd9-d79def02e57b",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd": {
              "id": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "parentNodeId": ""
            },
            "b22ec500-aacc-42fe-a122-f566cb5f2736": {
              "id": "b22ec500-aacc-42fe-a122-f566cb5f2736",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0": {
              "id": "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0",
              "parentNodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66"
            },
            "b837ba56-7857-4940-b6b3-be880fcb0808": {
              "id": "b837ba56-7857-4940-b6b3-be880fcb0808",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "bd09a56b-05ef-4e61-abf7-13a879105864": {
              "id": "bd09a56b-05ef-4e61-abf7-13a879105864",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0": {
              "id": "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "c8b4564e-08cb-4538-9d82-afe2b5bc41ba": {
              "id": "c8b4564e-08cb-4538-9d82-afe2b5bc41ba",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "cf7d6a3f-91fb-4475-9a5d-c06203055ced": {
              "id": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
              "parentNodeId": ""
            },
            "de7dd5b1-90e3-4310-8884-1548bf0a5816": {
              "id": "de7dd5b1-90e3-4310-8884-1548bf0a5816",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "e1840ac5-38a0-48c8-a465-c406e2772a35": {
              "id": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "parentNodeId": ""
            },
            "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5": {
              "id": "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "e5618dbc-a698-4252-acdf-c97348754912": {
              "id": "e5618dbc-a698-4252-acdf-c97348754912",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "e80e7135-c664-4cde-87d5-d7787f0343da": {
              "id": "e80e7135-c664-4cde-87d5-d7787f0343da",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "e82479d4-8cb9-45f3-9929-79a8d45b2087": {
              "id": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
              "parentNodeId": ""
            },
            "f5062351-82ae-4b06-bcb7-340a63136281": {
              "id": "f5062351-82ae-4b06-bcb7-340a63136281",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "f94f4d3d-f65d-4931-ae21-afa45917e35c": {
              "id": "f94f4d3d-f65d-4931-ae21-afa45917e35c",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "fcab256e-1e66-4313-aeea-6355f9c755cb": {
              "id": "fcab256e-1e66-4313-aeea-6355f9c755cb",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "fea4b4ad-1e9d-4cc6-a19e-3c0147472902": {
              "id": "fea4b4ad-1e9d-4cc6-a19e-3c0147472902",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            }
          }
        },
        "steps": {
          "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276": {
            "nodeId": "0596cf23-1ffb-47f4-bbc6-ba77bd0e7276",
            "name": "VT Hash",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "9.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/9.0.0/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 hash to lookup",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "alert_context": {
                  "properties": {
                    "dest_ip": {
                      "description": "Destination IP",
                      "order": 1,
                      "title": "Destination IP",
                      "type": "string"
                    },
                    "dest_port": {
                      "description": "Destination port",
                      "order": 2,
                      "title": "Destination Port",
                      "type": "integer"
                    },
                    "hostname": {
                      "description": "In case the alert is related to an HTTP event, destination hostname",
                      "order": 3,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Communication protocol",
                      "order": 4,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "src_ip": {
                      "description": "Source IP",
                      "order": 5,
                      "title": "Source IP",
                      "type": "string"
                    },
                    "src_port": {
                      "description": "Source port",
                      "order": 6,
                      "title": "Source Port",
                      "type": "integer"
                    },
                    "url": {
                      "description": "In case the alert is related to an HTTP event, destination URL",
                      "order": 7,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Alert Context",
                  "type": "object"
                },
                "crowdsourced_ids_results": {
                  "properties": {
                    "alert_context": {
                      "description": "Context for every match of that alert",
                      "items": {
                        "$ref": "#/definitions/alert_context"
                      },
                      "order": 1,
                      "title": "Alert Context",
                      "type": "array"
                    },
                    "alert_severity": {
                      "description": "Alert severity",
                      "order": 2,
                      "title": "Alert Severity",
                      "type": "string"
                    },
                    "rule_category": {
                      "description": "Alert category description",
                      "order": 3,
                      "title": "Rule Category",
                      "type": "string"
                    },
                    "rule_id": {
                      "description": "Suricata/Snort rule SID",
                      "order": 4,
                      "title": "Rule ID",
                      "type": "string"
                    },
                    "rule_msg": {
                      "description": "Alert description",
                      "order": 5,
                      "title": "Rule Message",
                      "type": "string"
                    },
                    "rule_source": {
                      "description": "Rule source, determined by SID range",
                      "order": 6,
                      "title": "Rule Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Ids Results",
                  "type": "object"
                },
                "crowdsourced_ids_stats": {
                  "properties": {
                    "high": {
                      "description": "Number of matched rules having a high severity",
                      "order": 1,
                      "title": "High",
                      "type": "integer"
                    },
                    "info": {
                      "description": "Number of matched rules having an info severity",
                      "order": 2,
                      "title": "Info",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched rules having a low severity",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched rules having a medium severity",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Crowdsourced Ids Stats",
                  "type": "object"
                },
                "crowdsourced_yara_results": {
                  "properties": {
                    "author": {
                      "description": "Rule author",
                      "order": 1,
                      "title": "Author",
                      "type": "string"
                    },
                    "description": {
                      "description": "Matched rule description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "match_in_subfile": {
                      "description": "Whether the match was in a subfile or not",
                      "order": 3,
                      "title": "Match in Subfile",
                      "type": "boolean"
                    },
                    "rule_name": {
                      "description": "Matched rule name",
                      "order": 4,
                      "title": "Rule Name",
                      "type": "string"
                    },
                    "ruleset_id": {
                      "description": "VirusTotal's ruleset ID",
                      "order": 5,
                      "title": "Ruleset ID",
                      "type": "string"
                    },
                    "ruleset_name": {
                      "description": "Matched rule's ruleset name",
                      "order": 6,
                      "title": "Ruleset Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Ruleset source",
                      "order": 7,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Yara Results",
                  "type": "object"
                },
                "file_report": {
                  "properties": {
                    "capabilities_tags": {
                      "description": "List of representative tags related to the file's capabilities",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Capabilities Tags",
                      "type": "array"
                    },
                    "creation_date": {
                      "description": "Extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "crowdsourced_ids_results": {
                      "description": "IDS (Snort and Suricata) matches for the file. If the file is not a PCAP, the matches are taken from a PCAP generated after running the file in a sandbox",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_ids_results"
                      },
                      "order": 3,
                      "title": "Crowdsourced IDS Results",
                      "type": "array"
                    },
                    "crowdsourced_ids_stats": {
                      "$ref": "#/definitions/crowdsourced_ids_stats",
                      "description": "IDS results stats",
                      "order": 4,
                      "title": "Crowdsourced IDS Stats"
                    },
                    "crowdsourced_yara_results": {
                      "description": "YARA matches for the file",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_yara_results"
                      },
                      "order": 5,
                      "title": "Crowdsourced YARA Results",
                      "type": "array"
                    },
                    "downloadable": {
                      "description": "True if the file can be downloaded, false otherwise",
                      "order": 6,
                      "title": "Downloadable",
                      "type": "boolean"
                    },
                    "first_submission_date": {
                      "description": "Date when the file was first seen in VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "last_analysis_date": {
                      "description": "Most recent scan date (UTC timestamp)",
                      "order": 8,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Latest scan results. For more information about its format, check the Analysis object results attribute",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 9,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "A summary of the latest scan results",
                      "order": 10,
                      "title": "Last Analysis Stats"
                    },
                    "last_modification_date": {
                      "description": "Date when the object itself was last modified (UTC timestamp)",
                      "order": 11,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "Most recent date the file was posted to VirusTotal (UTC timestamp)",
                      "order": 12,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "main_icon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the main icon",
                      "order": 13,
                      "title": "Main Icon"
                    },
                    "md5": {
                      "description": "File's MD5 hash",
                      "order": 14,
                      "title": "MD5",
                      "type": "string"
                    },
                    "meaningful_name": {
                      "description": "The most interesting name out of all file's names",
                      "order": 15,
                      "title": "Meaningful Name",
                      "type": "string"
                    },
                    "names": {
                      "description": "All file names associated with the file",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Names",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "File's score calculated from all votes posted by the VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "sandbox_verdicts": {
                      "description": "A summary of all sandbox verdicts for a given file",
                      "order": 18,
                      "title": "Sandbox Verdicts",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "File's SHA1 hash",
                      "order": 19,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "File's SHA256 hash",
                      "order": 20,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "sigma_analysis_stats": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules, grouped by its severity",
                      "order": 21,
                      "title": "Sigma Analysis Stats"
                    },
                    "sigma_analysis_summary": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules group by its severity",
                      "order": 22,
                      "title": "Sigma Analysis Summary"
                    },
                    "size": {
                      "description": "File size in bytes",
                      "order": 23,
                      "title": "Size",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "Tags",
                      "type": "array"
                    },
                    "times_submitted": {
                      "description": "Number of times the file has been posted to VirusTotal",
                      "order": 25,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided by harmless and malicious",
                      "order": 26,
                      "title": "Total Votes"
                    },
                    "type_description": {
                      "description": "Describes the file type",
                      "order": 27,
                      "title": "Type Description",
                      "type": "string"
                    },
                    "type_extension": {
                      "description": "Specifies file extension",
                      "order": 28,
                      "title": "Type Extension",
                      "type": "string"
                    },
                    "type_tag": {
                      "description": "Tag representing the file type",
                      "order": 29,
                      "title": "Type Tag",
                      "type": "string"
                    },
                    "unique_sources": {
                      "description": "Indicates from how many different sources the file has been posted from",
                      "order": 30,
                      "title": "Unique Sources",
                      "type": "integer"
                    },
                    "vhash": {
                      "description": "In-house similarity clustering algorithm value, based on a simple structural feature hash allowing you to find similar files",
                      "order": 31,
                      "title": "VHASH",
                      "type": "string"
                    }
                  },
                  "title": "File Report",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "sigma_analysis": {
                  "properties": {
                    "critical": {
                      "description": "Number of matched critical severity rules/rulesets",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "high": {
                      "description": "Number of matched high severity rules/rulesets",
                      "order": 2,
                      "title": "High",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched low severity rules/rulesets",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched medium severity rules/rulesets",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Sigma Analysis",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/file_report",
                  "description": "Hash report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0a72bb10-b2b8-4976-b464-41f02ed9a67a": {
            "nodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
            "name": "Combine IP Addresses",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv4_addresses]}}",
                "array2": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv6_addresses]}}",
                "array3": [],
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "0afd1c6d-a367-4d95-9873-19d3f7f0bd71": {
            "nodeId": "0afd1c6d-a367-4d95-9873-19d3f7f0bd71",
            "name": "URLScan",
            "type": "action",
            "plugin": {
              "name": "urlscan.io",
              "slugVendor": "rapid7",
              "slugName": "urlscan",
              "slugVersion": "4.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/urlscan/4.0.2/icon.png"
            },
            "identifier": "submit_url_for_scan",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "public": false,
                "url": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "public": {
                  "default": false,
                  "description": "Set to false for a private scan",
                  "order": 2,
                  "title": "Public",
                  "type": "boolean"
                },
                "url": {
                  "description": "The URL to scan",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "url",
                "public"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "scan_id": {
                  "description": "UUID of the scan to query later",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "string"
                },
                "was_scan_skipped": {
                  "description": "If true scan was skipped, false if scan was executed",
                  "order": 2,
                  "title": "Was Scan Skipped",
                  "type": "boolean"
                }
              },
              "required": [
                "was_scan_skipped",
                "scan_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0e158eb6-6cc2-4eb9-bbac-470d6995b675": {
            "nodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
            "name": "Hash Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": " Hash Analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}} <br>\n<br>\n<b>VirusTotal</b><br>\n<i>Names: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[names]}}</i><br>\n<i>Malicious Hits: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[malicious]}} </i><br>\n<i>Positives: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[malicious]}} / {{[703c2140-cb3c-4200-9ed0-ba830c563858].[result]}}</i><br>\n<i>Results permalink: <a href=\"https://www.virustotal.com/gui/file/{{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[sha256]}}/detection\">https://www.virustotal.com/gui/file/{{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[sha256]}}/detection</a></i><br>\n<br>\n\n",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "105f308b-8691-44bb-aacf-cf7e18f781c9": {
            "nodeId": "105f308b-8691-44bb-aacf-cf7e18f781c9",
            "name": "markdown time",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Time: {{[3baf3069-e761-44a7-9efb-efa20e0c930f].[date]}}\nHostname- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[agent_hostname]}} <br>\nParent Process- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[causality_actor_process_image_name]}} <br>\nParent Process Directory- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[causality_actor_process_image_path]}} <br>\nProcess Name- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[action_process_image_name]}} <br>\nProcess Directory- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[action_process_image_path]}} <br>"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "13fbfc5d-a157-4b40-8a84-e930fe648d66": {
            "nodeId": "13fbfc5d-a157-4b40-8a84-e930fe648d66",
            "name": "loop over xdr results",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "21e22b72-ab2d-4a52-85e1-0c281a149d8b",
              "nextEdgeId": "ecfbf3a7-7850-4731-91bb-f19f6b15c125",
              "repeatVariable": "{{[958ece1c-d001-4abd-98b5-075a9fb55240].[reply].[results].[data]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "1638ba1e-339e-48b4-8840-bfa1f9a991ed": {
            "nodeId": "1638ba1e-339e-48b4-8840-bfa1f9a991ed",
            "name": "send screenshot of url",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "{{[4097b507-b816-41c5-bf16-409fa4f154c8].[screenshot]}}",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[19b3b326-3d5f-4d7a-8ffe-b7a5155b595d].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "16a88661-da72-4cfb-9e18-15a7c2cf5643": {
            "nodeId": "16a88661-da72-4cfb-9e18-15a7c2cf5643",
            "name": "urlscan get results",
            "type": "action",
            "plugin": {
              "name": "urlscan.io",
              "slugVendor": "rapid7",
              "slugName": "urlscan",
              "slugVersion": "4.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/urlscan/4.0.2/icon.png"
            },
            "identifier": "get_scan_results",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "scan_id": "{{[0afd1c6d-a367-4d95-9873-19d3f7f0bd71].[scan_id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "scan_id": {
                  "description": "UUID of the scan to retrieve",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "string"
                }
              },
              "required": [
                "scan_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "scan_results": {
                  "properties": {
                    "console": {
                      "items": {
                        "type": "object"
                      },
                      "order": 3,
                      "title": "Console",
                      "type": "array"
                    },
                    "cookies": {
                      "items": {
                        "type": "object"
                      },
                      "order": 2,
                      "title": "Cookies",
                      "type": "array"
                    },
                    "globals": {
                      "items": {
                        "type": "object"
                      },
                      "order": 6,
                      "title": "Globals",
                      "type": "array"
                    },
                    "links": {
                      "items": {
                        "type": "object"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "requests": {
                      "items": {
                        "type": "object"
                      },
                      "order": 1,
                      "title": "Requests",
                      "type": "array"
                    },
                    "screenshotURL": {
                      "order": 7,
                      "title": "ScreenshotURL",
                      "type": "string"
                    },
                    "timing": {
                      "order": 5,
                      "title": "Timing",
                      "type": "object"
                    }
                  },
                  "title": "Scan Results",
                  "type": "object"
                }
              },
              "properties": {
                "lists": {
                  "description": "Results of the lists",
                  "order": 4,
                  "title": "Lists",
                  "type": "object"
                },
                "meta": {
                  "description": "Results of the meta",
                  "order": 5,
                  "title": "Meta",
                  "type": "object"
                },
                "page": {
                  "description": "Results of the page",
                  "order": 3,
                  "title": "Page",
                  "type": "object"
                },
                "scan_results": {
                  "$ref": "#/definitions/scan_results",
                  "description": "Results of the scan report",
                  "order": 1,
                  "title": "Scan Results"
                },
                "stats": {
                  "description": "Results of the stats",
                  "order": 6,
                  "title": "Stats",
                  "type": "object"
                },
                "task": {
                  "description": "Results of the task",
                  "order": 2,
                  "title": "Task",
                  "type": "object"
                },
                "verdicts": {
                  "description": "Results of the verdicts",
                  "order": 7,
                  "title": "Verdicts",
                  "type": "object"
                }
              },
              "required": [
                "scan_results",
                "task",
                "page",
                "lists",
                "meta",
                "stats",
                "verdicts"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d": {
            "nodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
            "name": "URL Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "<b> Joe Sandbox Results</b><br>\n\n{{[\"Loop for Joe Sandbox Results\"].[Loop Joe Sandbox Results]}}\n\n",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1c15e572-19c9-4b18-b996-29857dc3761f": {
            "nodeId": "1c15e572-19c9-4b18-b996-29857dc3761f",
            "name": "string to object",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "string_to_object",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{{[958ece1c-d001-4abd-98b5-075a9fb55240].[reply].[results].[data]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "object"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "1e170483-6050-4572-b2c6-61221d31d98e": {
            "nodeId": "1e170483-6050-4572-b2c6-61221d31d98e",
            "name": "Get VT URL Scan Report",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "9.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/9.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2564fd87-407c-446e-ae86-39433940c452": {
            "nodeId": "2564fd87-407c-446e-ae86-39433940c452",
            "name": "epoch time xdr",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "content": "{{[a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e].[date]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "26b0afac-ca64-4f1c-99bf-22bd73b3c93f": {
            "nodeId": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
            "name": "Microsoft Teams Message",
            "description": "Trigger on MS Teams message\nE.X. !enrich-indicator <Command> <data>",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "!enrich-indicator",
                "team_name": "{{$workflow.[Team Name]}}"
              }
            },
            "triggerId": "f890dd01-e7ec-44e1-b186-7c1b80ef39fb",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "2bfecf58-e9ec-40d6-ad27-265d86a262ed": {
            "nodeId": "2bfecf58-e9ec-40d6-ad27-265d86a262ed",
            "name": "WHOIS Domain Extract",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "2c13cba7-7a69-465b-b927-b80fb06ec621": {
            "nodeId": "2c13cba7-7a69-465b-b927-b80fb06ec621",
            "name": "Teams Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": " URL Analysis for {{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}} <br>\n \n<b>WhoIs</b><br>\nOrg Details<br>\nDomain Name: {{[2bfecf58-e9ec-40d6-ad27-265d86a262ed].[name]}}<br>\nDomain Registrar: {{[2bfecf58-e9ec-40d6-ad27-265d86a262ed].[registrar]}}<br>\nDomain Creation Date: {{[2bfecf58-e9ec-40d6-ad27-265d86a262ed].[creation_date]}}<br>\nDomain Last Updated: {{[2bfecf58-e9ec-40d6-ad27-265d86a262ed].[last_updated]}}<br>\nRegistrar Abuse Contact: {{[2bfecf58-e9ec-40d6-ad27-265d86a262ed].[registrar_abuse_contact_email]}}<br>\n\n<b>Virus Total</b><br>\n<br>\n<b>URL Report</b><br>\nLast Analysis Results: {{[1e170483-6050-4572-b2c6-61221d31d98e].[report].[last_analysis_results]}}<br>\nTotal Votes: {{[1e170483-6050-4572-b2c6-61221d31d98e].[report].[total_votes]}}<br>\nTags: {{[1e170483-6050-4572-b2c6-61221d31d98e].[report].[tags]}}<br>\n<br>\n<b>Domain Report</b><br>\nCategories {{[2fd35825-bcdf-4a4a-ac35-bb07c7076aec].[report].[categories]}}<br>\nTotal Votes {{[2fd35825-bcdf-4a4a-ac35-bb07c7076aec].[report].[total_votes]}}<br>\n<br>\n\n\n<b>URLScan</b>\nHas Verdicts? {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[verdicts].[overall].[hasVerdicts]}}<br>\nCategory {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[verdicts].[overall].[categories]}}<br>\nMalicious? {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[verdicts].[overall].[malicious]}}<br>\nScore {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[verdicts].[overall].[score]}}<br>\nTags {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[verdicts].[overall].[tags]}}<br>\nScreenshot URL: {{[16a88661-da72-4cfb-9e18-15a7c2cf5643].[scan_results].[screenshotURL]}}<br>\n<br>\nPlease wait for Joe Sandbox Results",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2fd35825-bcdf-4a4a-ac35-bb07c7076aec": {
            "nodeId": "2fd35825-bcdf-4a4a-ac35-bb07c7076aec",
            "name": "VT domain",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "9.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/9.0.0/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "categories": {
                      "description": "Mapping that relates categorization services with the assigned domain category. These services are, among others: Alexa, BitDefender, TrendMicro, Websense ThreatSeeker, etc.",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Creation date extracted from the Domain's WHOIS (UTC timestamp)",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the domain's favicon",
                      "order": 3,
                      "title": "Favicon"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 4,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 5,
                      "title": "Last Analysis Statistics"
                    },
                    "last_dns_records": {
                      "description": "Domain's DNS records on its last scan",
                      "items": {
                        "$ref": "#/definitions/last_dns_records"
                      },
                      "order": 6,
                      "title": "Last DNS Records",
                      "type": "array"
                    },
                    "last_dns_records_date": {
                      "description": "Date when the DNS records list was retrieved by VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "Last DNS Records Date",
                      "type": "integer"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL certificate object retrieved last time the domain was analyzed",
                      "order": 8,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 9,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the domain's information was last updated",
                      "order": 10,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_update_date": {
                      "description": "Updated date extracted from WHOIS (UTC timestamp)",
                      "order": 11,
                      "title": "Last Update Date",
                      "type": "integer"
                    },
                    "popularity_ranks": {
                      "$ref": "#/definitions/popularity_ranks",
                      "description": "Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo, etc.",
                      "order": 12,
                      "title": "Popularity Ranks"
                    },
                    "registrar": {
                      "description": "Company that registered the domain",
                      "order": 13,
                      "title": "Registrar",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "Domain's score calculated from the votes of the VirusTotal's community",
                      "order": 14,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 16,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 17,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 18,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "last_dns_records": {
                  "properties": {
                    "expire": {
                      "description": "Expire",
                      "order": 1,
                      "title": "Expire",
                      "type": "integer"
                    },
                    "flag": {
                      "description": "Flag",
                      "order": 2,
                      "title": "Flag",
                      "type": "integer"
                    },
                    "minimum": {
                      "description": "Minimum",
                      "order": 3,
                      "title": "Minimum",
                      "type": "integer"
                    },
                    "priority": {
                      "description": "Priority",
                      "order": 4,
                      "title": "Priority",
                      "type": "integer"
                    },
                    "refresh": {
                      "description": "Refresh",
                      "order": 5,
                      "title": "Refresh",
                      "type": "integer"
                    },
                    "retry": {
                      "description": "Retry",
                      "order": 7,
                      "title": "Retry",
                      "type": "integer"
                    },
                    "rname": {
                      "description": "RNAME",
                      "order": 6,
                      "title": "RNAME",
                      "type": "string"
                    },
                    "serial": {
                      "description": "Serial",
                      "order": 8,
                      "title": "Serial",
                      "type": "integer"
                    },
                    "tag": {
                      "description": "Tag",
                      "order": 9,
                      "title": "Tag",
                      "type": "string"
                    },
                    "ttl": {
                      "description": "Time to live",
                      "order": 10,
                      "title": "TTL",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type",
                      "order": 11,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 12,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Last Dns Records",
                  "type": "object"
                },
                "popularity_ranks": {
                  "properties": {
                    "rank": {
                      "description": "Rank position",
                      "order": 1,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "UTC timestamp when the rank was ingested",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Popularity Ranks",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "3baf3069-e761-44a7-9efb-efa20e0c930f": {
            "nodeId": "3baf3069-e761-44a7-9efb-efa20e0c930f",
            "name": "epoch to date",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "date_from_epoch",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "epoch": "{{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[_time]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "epoch": {
                  "description": "Epoch as integer or float",
                  "order": 1,
                  "title": "Epoch",
                  "type": "string"
                }
              },
              "required": [
                "epoch"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "date": {
                  "description": "Datetime after epoch conversion",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Date",
                  "type": "string"
                }
              },
              "required": [
                "date"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4097b507-b816-41c5-bf16-409fa4f154c8": {
            "nodeId": "4097b507-b816-41c5-bf16-409fa4f154c8",
            "name": "screenshot url",
            "type": "action",
            "plugin": {
              "name": "Screenshot a URL",
              "slugVendor": "rapid7",
              "slugName": "url_screenshot",
              "slugVersion": "1.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/url_screenshot/1.0.1/icon.png"
            },
            "identifier": "screenshot",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "delay": 0,
                "full_page": false,
                "url": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[urls].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delay": {
                  "description": "Delay (in seconds) after page has loaded before screenshot",
                  "order": 2,
                  "title": "Delay",
                  "type": "integer"
                },
                "full_page": {
                  "default": false,
                  "description": "Export screenshot of \"body\" element instead of the default viewport.  This \"body\" element may have some formatting issues but should contain all elements of the page",
                  "order": 3,
                  "title": "Full Page Capture",
                  "type": "boolean"
                },
                "url": {
                  "description": "URL to screenshot",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "full_page",
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "screenshot": {
                  "description": "The resulting PNG screenshot of the URL",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Screenshot",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "632fb97e-3487-4617-87b1-986d8e1ff739": {
            "nodeId": "632fb97e-3487-4617-87b1-986d8e1ff739",
            "name": "Post Command Received",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": " Starting workflow ",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "65e084cc-e4c4-479e-93c8-cccd35ccaecc": {
            "nodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
            "name": "Lookup URL Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": true,
            "parameters": {
              "input": {
                "content": "analysis for: {{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}\n\n*WhoIs Results*\nDomain Name: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[name]}}\nDomain Registrar: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar]}}\nDomain Creation Date: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[creation_date]}}\nDomain Last Updated: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[last_updated]}}\nRegistrar Abuse Contact: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar_abuse_contact_email]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "703c2140-cb3c-4200-9ed0-ba830c563858": {
            "nodeId": "703c2140-cb3c-4200-9ed0-ba830c563858",
            "name": "Calculate Total Reports",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[harmless]}} + {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[malicious]}} + {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[suspicious]}} + {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_analysis_stats].[undetected]}}\n"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "726bf264-041d-499c-847d-078ba2d8a00a": {
            "nodeId": "726bf264-041d-499c-847d-078ba2d8a00a",
            "name": "Cymru Lookup Hash",
            "type": "action",
            "plugin": {
              "name": "Team Cymru MHR",
              "slugVendor": "rapid7",
              "slugName": "cymru_malware_hash",
              "slugVersion": "1.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/cymru_malware_hash/1.1.1/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5 or SHA1 hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "result": {
                  "properties": {
                    "detected": {
                      "description": "Anti-Virus Detection Percentage",
                      "order": 3,
                      "title": "Detected",
                      "type": "string"
                    },
                    "found": {
                      "description": "Malware found",
                      "order": 4,
                      "title": "Found",
                      "type": "boolean"
                    },
                    "last_seen_utc": {
                      "description": "Last seen timestamp",
                      "order": 1,
                      "title": "Last Seen Utc",
                      "type": "string"
                    },
                    "response_code": {
                      "description": "Response code",
                      "order": 2,
                      "title": "Response Code",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "last_seen_utc",
                    "response_code",
                    "detected",
                    "found"
                  ],
                  "title": "Result",
                  "type": "object"
                }
              },
              "properties": {
                "result": {
                  "$ref": "#/definitions/result",
                  "description": "Result",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7804a348-2bbd-4071-9729-788f7d901043": {
            "nodeId": "7804a348-2bbd-4071-9729-788f7d901043",
            "name": "passive total look up ip",
            "type": "action",
            "plugin": {
              "name": "PassiveTotal",
              "slugVendor": "rapid7",
              "slugName": "passivetotal",
              "slugVersion": "1.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/passivetotal/1.0.1/icon.png"
            },
            "identifier": "lookup_address",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP Address, e.g. 4.2.2.2",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address_record": {
                  "properties": {
                    "autonomous_system_name": {
                      "description": "Autonomous System Name",
                      "order": 2,
                      "title": "Autonomous System Name",
                      "type": "string"
                    },
                    "autonomous_system_number": {
                      "order": 8,
                      "title": "Autonomous System Number",
                      "type": "string"
                    },
                    "country": {
                      "description": "Country Code",
                      "order": 3,
                      "title": "Country",
                      "type": "string"
                    },
                    "ever_compromised": {
                      "description": "True if ever compromised",
                      "order": 4,
                      "title": "Ever Compromised",
                      "type": "boolean"
                    },
                    "latitude": {
                      "order": 6,
                      "title": "Latitude",
                      "type": "number"
                    },
                    "longitude": {
                      "order": 7,
                      "title": "Longitude",
                      "type": "number"
                    },
                    "network": {
                      "description": "Network subnet",
                      "order": 1,
                      "title": "Network",
                      "type": "string"
                    },
                    "sinkhole": {
                      "description": "True if sinkholed",
                      "order": 5,
                      "title": "Sinkhole",
                      "type": "boolean"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 9,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "title": "Address Record",
                  "type": "object"
                }
              },
              "properties": {
                "address_record": {
                  "$ref": "#/definitions/address_record",
                  "description": "IP Address Record",
                  "order": 1,
                  "title": "Address Record"
                },
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "78788755-a02c-4110-b0d6-fda75080a7fe": {
            "nodeId": "78788755-a02c-4110-b0d6-fda75080a7fe",
            "name": "Lookup IP Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Analysis for: {{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}\n\n*WhoIs Results*\n\nOrg Details\nReg Date: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[regdate]}}\nOrg Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[orgname]}}\nNet Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netname]}}\nNet Type: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[nettype]}}\nNetRange: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netrange]}}\nLocation Details\nAddress: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[address]}}\nCity: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[city]}}\nCountry: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[country]}}\n\n*Dig Results*\n\nQuestion Asked: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[question]}}\nAnswer Received: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[answer]}}\nQuery Status: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[status]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7b04e3f1-6a08-4724-aa34-22357ff732e1": {
            "nodeId": "7b04e3f1-6a08-4724-aa34-22357ff732e1",
            "name": "Joe Sandbox URL analysis",
            "type": "action",
            "plugin": {
              "name": "Joe Sandbox",
              "slugVendor": "rapid7",
              "slugName": "joe_sandbox",
              "slugVersion": "1.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/joe_sandbox/1.0.4/icon.png"
            },
            "identifier": "submit_url",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "additional_parameters": {},
                "parameters": {},
                "url": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "additional_parameters": {
                  "description": "Additional parameters for Joe Sandbox Cloud, described in more detail in the API documentation. All boolean parameters should be set to 1 or 0. Parameter `accept-tac` will always be set to 1",
                  "order": 3,
                  "title": "Additional Parameters",
                  "type": "object"
                },
                "parameters": {
                  "description": "Custom sandbox parameters, described in more detail in the API documentation. All boolean parameters should be set to 1 or 0",
                  "order": 2,
                  "title": "Parameters",
                  "type": "object"
                },
                "url": {
                  "description": "The URL of a website to submit",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "webids": {
                  "description": "Web IDs associated with the sample",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Web IDs",
                  "type": "array"
                }
              },
              "required": [
                "webids"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7ec8f1bf-ba7c-442e-8679-b1463aa42453": {
            "nodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
            "name": "Hash Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Virus Total malware hash analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}\n\nMalicious: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[malicious]}}\nHash last submitted: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[last_submission_date]}}\nHash Names: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[names]}}\nNumber of malicious votes: {{[0596cf23-1ffb-47f4-bbc6-ba77bd0e7276].[report].[total_votes].[malicious]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8555f89c-7355-4854-b8ca-067f214f1b44": {
            "nodeId": "8555f89c-7355-4854-b8ca-067f214f1b44",
            "name": "Whois Lookup Domain",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef": {
            "nodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
            "name": "Dig IP Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "test",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8fdbce4a-7081-4b98-876b-450508c2bab1": {
            "nodeId": "8fdbce4a-7081-4b98-876b-450508c2bab1",
            "name": "get mimecast url results",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<b>Mimecast URL Logs</b><br>\n{{#each [c16b9c8d-1e70-4746-9ce8-5158de0ef9f0].[click_logs]}}\nCategory- {{this.[action]}}<br>\nDate- {{this.[date]}}<br>\nFrom User Email Address- {{this.[fromUserEmailAddress]}}<br>\nMessage ID- {{this.[messageID]}}<br>\nRoute- {{this.[route]}}<br>\nScan Result- {{this.[scanResult]}}<br>\nSending IP- {{this.[sendingIp]}}<br>\nSubject- {{this.[subject]}}<br>\nURL- {{this.[url]}}<br>\nUser Email Address- {{this.[userEmailAddress]}}<br>\n{{/each}}\n",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "958ece1c-d001-4abd-98b5-075a9fb55240": {
            "nodeId": "958ece1c-d001-4abd-98b5-075a9fb55240",
            "name": "xdr hash search",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Cortex XDR",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_cortex_xdr",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_cortex_xdr/2.2.1/icon.png"
            },
            "identifier": "get_xql_query_results",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "end_time": 0,
                "limit": 20,
                "query": "dataset = xdr_data | filter causality_actor_process_image_sha256 = \"{{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}\" \n| fields _time, agent_hostname, causality_actor_process_image_sha256, causality_actor_process_image_name, causality_actor_process_image_path, action_process_image_name, action_process_image_path \n",
                "start_time": 0,
                "tenants": [
                  "997134488"
                ]
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "end_time": {
                  "description": "Integer in timestamp epoch milliseconds for end of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 3,
                  "title": "End Time",
                  "type": "integer"
                },
                "limit": {
                  "default": 20,
                  "description": "Integer representing the maximum number of results to return, defaults to 20, max value 1000",
                  "order": 5,
                  "title": "Limit",
                  "type": "integer"
                },
                "query": {
                  "description": "String of the XQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "start_time": {
                  "description": "Integer in timestamp epoch milliseconds for start of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 4,
                  "title": "Start Time",
                  "type": "integer"
                },
                "tenants": {
                  "description": "String that represents additional information regarding the action",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Tenants",
                  "type": "array"
                }
              },
              "required": [
                "tenants",
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "reply": {
                  "properties": {
                    "number_of_results": {
                      "description": "Integer representing the number of results returned",
                      "order": 2,
                      "title": "Number of Results",
                      "type": "integer"
                    },
                    "query_cost": {
                      "description": "Float representing the number of query units collected for this API",
                      "order": 3,
                      "title": "Query Cost",
                      "type": "object"
                    },
                    "remaining_quota": {
                      "description": "Float representing the number of query units available for you to use",
                      "order": 4,
                      "title": "Remaining Quota",
                      "type": "number"
                    },
                    "results": {
                      "description": "Displays the API response in either of the following fields according to the number of results: data: API results according to defined format field stream: id String representing a unique ID of more than 1000 number of results",
                      "order": 5,
                      "title": "Results",
                      "type": "object"
                    },
                    "status": {
                      "description": "API call status: 'SUCCESS', 'FAIL', 'PENDING', 'PARTIAL_SUCCESS'",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Reply",
                  "type": "object"
                }
              },
              "properties": {
                "reply": {
                  "$ref": "#/definitions/reply",
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Reply"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {
                "reply": {
                  "properties": {
                    "number_of_results": {
                      "description": "Integer representing the number of results returned",
                      "order": 2,
                      "title": "Number of Results",
                      "type": "integer"
                    },
                    "query_cost": {
                      "description": "Float representing the number of query units collected for this API",
                      "order": 3,
                      "title": "Query Cost",
                      "type": "object"
                    },
                    "remaining_quota": {
                      "description": "Float representing the number of query units available for you to use",
                      "order": 4,
                      "title": "Remaining Quota",
                      "type": "number"
                    },
                    "results": {
                      "$ref": "#/definitions/results",
                      "description": "Displays the API response in either of the following fields according to the number of results: data: API results according to defined format field stream: id String representing a unique ID of more than 1000 number of results",
                      "order": 5,
                      "title": "Results"
                    },
                    "status": {
                      "description": "API call status: 'SUCCESS', 'FAIL', 'PENDING', 'PARTIAL_SUCCESS'",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Reply",
                  "type": "object"
                },
                "results": {
                  "properties": {
                    "data": {
                      "items": {
                        "type": "string"
                      },
                      "type": "array"
                    }
                  },
                  "title": "Results",
                  "type": "object"
                }
              },
              "properties": {
                "reply": {
                  "$ref": "#/definitions/reply",
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Reply"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "9acb3237-d5f5-4a85-b46e-f08226513060": {
            "nodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
            "name": "Hash Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "8e27e688-6be5-4697-b507-cc9b147d1618",
              "nextEdgeId": "52b8a22c-4c27-445d-b138-ca8130c6e45d",
              "repeatVariable": "{{[e82479d4-8cb9-45f3-9929-79a8d45b2087].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8": {
            "nodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
            "name": "Dig Lookup Reverse DNS",
            "type": "action",
            "plugin": {
              "name": "DNS",
              "slugVendor": "rapid7",
              "slugName": "dig",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/dig/2.0.0/icon.png"
            },
            "identifier": "reverse",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}",
                "resolver": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Internet address to resolve",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "resolver": {
                  "description": "Resolver. Leave blank to use default resolver for the system",
                  "order": 1,
                  "title": "Resolver",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "answer": {
                  "description": "Answer received",
                  "order": 4,
                  "title": "Answer",
                  "type": "string"
                },
                "fulloutput": {
                  "description": "Full DNS output",
                  "order": 1,
                  "title": "Full Output",
                  "type": "string"
                },
                "nameserver": {
                  "description": "Nameserver that fulfilled request",
                  "order": 3,
                  "title": "Nameserver",
                  "type": "string"
                },
                "question": {
                  "description": "Question asked",
                  "order": 5,
                  "title": "Question",
                  "type": "string"
                },
                "status": {
                  "description": "Query status [ NOERROR | FORMERR | NXDOMAIN | SERVFAIL | REFUSED ...]",
                  "order": 2,
                  "title": "Query Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a06c17bd-28cd-4337-9910-a3ff55a79640": {
            "nodeId": "a06c17bd-28cd-4337-9910-a3ff55a79640",
            "name": "Get XDR details",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Cortex XDR",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_cortex_xdr",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_cortex_xdr/2.2.1/icon.png"
            },
            "identifier": "get_endpoint_details",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "endpoint": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "endpoint": {
                  "description": "The endpoint to get information about. This can be an IPv4 address, hostname, or endpoint ID",
                  "order": 1,
                  "title": "Endpoint",
                  "type": "string"
                }
              },
              "required": [
                "endpoint"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "endpoint": {
                  "properties": {
                    "alias": {
                      "description": "Alias",
                      "order": 1,
                      "title": "Alias",
                      "type": "string"
                    },
                    "content_version": {
                      "description": "Content version",
                      "order": 2,
                      "title": "Content Version",
                      "type": "string"
                    },
                    "domain": {
                      "description": "Domain",
                      "order": 3,
                      "title": "Domain",
                      "type": "string"
                    },
                    "endpoint_id": {
                      "description": "Endpoint ID",
                      "order": 4,
                      "title": "Endpoint ID",
                      "type": "string"
                    },
                    "endpoint_name": {
                      "description": "Endpoint name",
                      "order": 5,
                      "title": "Endpoint Name",
                      "type": "string"
                    },
                    "endpoint_status": {
                      "description": "Endpoint status",
                      "order": 6,
                      "title": "Endpoint Status",
                      "type": "string"
                    },
                    "endpoint_type": {
                      "description": "Endpoint type",
                      "order": 7,
                      "title": "Endpoint Type",
                      "type": "string"
                    },
                    "endpoint_version": {
                      "description": "Endpoint version",
                      "order": 8,
                      "title": "Endpoint Version",
                      "type": "string"
                    },
                    "first_seen": {
                      "description": "First seen",
                      "order": 9,
                      "title": "First Seen",
                      "type": "integer"
                    },
                    "install_date": {
                      "description": "Install date",
                      "order": 10,
                      "title": "Install Date",
                      "type": "integer"
                    },
                    "installation_package": {
                      "description": "Installation package",
                      "order": 11,
                      "title": "Installation Package",
                      "type": "string"
                    },
                    "ip": {
                      "description": "IP",
                      "items": {
                        "type": "string"
                      },
                      "order": 12,
                      "title": "IP",
                      "type": "array"
                    },
                    "is_isolated": {
                      "description": "Is isolated",
                      "order": 13,
                      "title": "Is Isolated",
                      "type": "string"
                    },
                    "last_seen": {
                      "description": "Last seen",
                      "order": 14,
                      "title": "Last Seen",
                      "type": "integer"
                    },
                    "operational_status": {
                      "description": "Operational status",
                      "order": 15,
                      "title": "Operational Status",
                      "type": "string"
                    },
                    "operational_status_description": {
                      "description": "Operational status description",
                      "order": 16,
                      "title": "Operational Status Description",
                      "type": "string"
                    },
                    "os_type": {
                      "description": "OS type",
                      "order": 17,
                      "title": "OS Type",
                      "type": "string"
                    },
                    "scan_status": {
                      "description": "Scan status",
                      "order": 18,
                      "title": "Scan Status",
                      "type": "string"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "type": "string"
                      },
                      "order": 19,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Endpoint",
                  "type": "object"
                }
              },
              "properties": {
                "endpoints": {
                  "description": "Any endpoints that match the given endpoint information",
                  "items": {
                    "$ref": "#/definitions/endpoint"
                  },
                  "order": 2,
                  "title": "Endpoints",
                  "type": "array"
                },
                "total_count": {
                  "description": "Number of results found (max 100)",
                  "order": 1,
                  "title": "Total Count",
                  "type": "integer"
                }
              },
              "required": [
                "total_count",
                "endpoints"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e": {
            "nodeId": "a2d3f7a1-f934-4da9-84b3-2c84d4b76d0e",
            "name": "get time from epoch",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "date_from_epoch",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "epoch": "{{[958ece1c-d001-4abd-98b5-075a9fb55240].[reply].[results].[data].[_time]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "epoch": {
                  "description": "Epoch as integer or float",
                  "order": 1,
                  "title": "Epoch",
                  "type": "string"
                }
              },
              "required": [
                "epoch"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "date": {
                  "description": "Datetime after epoch conversion",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Date",
                  "type": "string"
                }
              },
              "required": [
                "date"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a2f5b26e-51b8-4027-b295-29353fa3ab53": {
            "nodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
            "name": "Workflow Complete",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "  *Workflow Complete*   ",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a55a5c03-1340-467d-9d71-07bfad1d072f": {
            "nodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
            "name": "Valid Indicator",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
              "stepControlParams": [
                {
                  "edgeId": "b5f96b26-1161-4e5f-bdcd-f81fed879de4",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.ip_addresses.ipv4_addresses",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.ip_addresses.ipv6_addresses",
                              "type": "variable"
                            }
                          ],
                          "name": "length",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": 0
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "left": {
                            "args": [
                              {
                                "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.md5_hashes",
                                "type": "variable"
                              }
                            ],
                            "name": "length",
                            "type": "function"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": 0
                          },
                          "type": "binary"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "left": {
                              "args": [
                                {
                                  "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.sha1_hashes",
                                  "type": "variable"
                                }
                              ],
                              "name": "length",
                              "type": "function"
                            },
                            "op": "=",
                            "right": {
                              "type": "literal",
                              "value": 0
                            },
                            "type": "binary"
                          },
                          "op": "AND",
                          "right": {
                            "left": {
                              "left": {
                                "args": [
                                  {
                                    "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.sha256_hashes",
                                    "type": "variable"
                                  }
                                ],
                                "name": "length",
                                "type": "function"
                              },
                              "op": "=",
                              "right": {
                                "type": "literal",
                                "value": 0
                              },
                              "type": "binary"
                            },
                            "op": "AND",
                            "right": {
                              "left": {
                                "args": [
                                  {
                                    "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.domains",
                                    "type": "variable"
                                  }
                                ],
                                "name": "length",
                                "type": "function"
                              },
                              "op": "=",
                              "right": {
                                "type": "literal",
                                "value": 0
                              },
                              "type": "binary"
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv4_addresses]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv6_addresses]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[md5_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha1_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha256_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[domains]}}) = 0"
                },
                {
                  "edgeId": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a6b9ba96-8203-477b-878b-7fbbf667a050": {
            "nodeId": "a6b9ba96-8203-477b-878b-7fbbf667a050",
            "name": "Joe sandbox hash",
            "type": "action",
            "plugin": {
              "name": "Joe Sandbox",
              "slugVendor": "rapid7",
              "slugName": "joe_sandbox",
              "slugVersion": "1.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/joe_sandbox/1.0.4/icon.png"
            },
            "identifier": "search_analysis",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "query": "{{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "query": {
                  "description": "String to search for",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                }
              },
              "required": [
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "webid": {
                  "properties": {
                    "webid": {
                      "description": "Web ID",
                      "order": 1,
                      "title": "WebID",
                      "type": "string"
                    }
                  },
                  "title": "Webid",
                  "type": "object"
                }
              },
              "properties": {
                "analyses": {
                  "description": "A list of matching analyses IDs",
                  "items": {
                    "$ref": "#/definitions/webid"
                  },
                  "order": 1,
                  "title": "Analyses",
                  "type": "array"
                }
              },
              "required": [
                "analyses"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a7436414-e9b2-408e-9bfd-6ab6dad8be97": {
            "nodeId": "a7436414-e9b2-408e-9bfd-6ab6dad8be97",
            "name": "Is IP address internal?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f32d2594-3f3f-4c34-b9ab-98c0278f11ed",
              "stepControlParams": [
                {
                  "edgeId": "f32d2594-3f3f-4c34-b9ab-98c0278f11ed",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "e2d0f7a3-0e8b-49f6-a2ff-68beb21deb42",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                        "type": "variable"
                      },
                      "op": "starts_with",
                      "right": {
                        "type": "literal",
                        "value": "10."
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                          "type": "variable"
                        },
                        "op": "starts_with",
                        "right": {
                          "type": "literal",
                          "value": "172.16"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "left": {
                            "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                            "type": "variable"
                          },
                          "op": "starts_with",
                          "right": {
                            "type": "literal",
                            "value": "172.17"
                          },
                          "type": "binary"
                        },
                        "op": "OR",
                        "right": {
                          "left": {
                            "left": {
                              "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                              "type": "variable"
                            },
                            "op": "starts_with",
                            "right": {
                              "type": "literal",
                              "value": "172.18"
                            },
                            "type": "binary"
                          },
                          "op": "OR",
                          "right": {
                            "left": {
                              "left": {
                                "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                "type": "variable"
                              },
                              "op": "starts_with",
                              "right": {
                                "type": "literal",
                                "value": "172.19"
                              },
                              "type": "binary"
                            },
                            "op": "OR",
                            "right": {
                              "left": {
                                "left": {
                                  "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                  "type": "variable"
                                },
                                "op": "starts_with",
                                "right": {
                                  "type": "literal",
                                  "value": "172.20"
                                },
                                "type": "binary"
                              },
                              "op": "OR",
                              "right": {
                                "left": {
                                  "left": {
                                    "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                    "type": "variable"
                                  },
                                  "op": "starts_with",
                                  "right": {
                                    "type": "literal",
                                    "value": "172.21"
                                  },
                                  "type": "binary"
                                },
                                "op": "OR",
                                "right": {
                                  "left": {
                                    "left": {
                                      "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                      "type": "variable"
                                    },
                                    "op": "starts_with",
                                    "right": {
                                      "type": "literal",
                                      "value": "172.22"
                                    },
                                    "type": "binary"
                                  },
                                  "op": "OR",
                                  "right": {
                                    "left": {
                                      "left": {
                                        "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                        "type": "variable"
                                      },
                                      "op": "starts_with",
                                      "right": {
                                        "type": "literal",
                                        "value": "172.23"
                                      },
                                      "type": "binary"
                                    },
                                    "op": "OR",
                                    "right": {
                                      "left": {
                                        "left": {
                                          "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                          "type": "variable"
                                        },
                                        "op": "starts_with",
                                        "right": {
                                          "type": "literal",
                                          "value": "172.24"
                                        },
                                        "type": "binary"
                                      },
                                      "op": "OR",
                                      "right": {
                                        "left": {
                                          "left": {
                                            "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                            "type": "variable"
                                          },
                                          "op": "starts_with",
                                          "right": {
                                            "type": "literal",
                                            "value": "172.25"
                                          },
                                          "type": "binary"
                                        },
                                        "op": "OR",
                                        "right": {
                                          "left": {
                                            "left": {
                                              "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                              "type": "variable"
                                            },
                                            "op": "starts_with",
                                            "right": {
                                              "type": "literal",
                                              "value": "172.26"
                                            },
                                            "type": "binary"
                                          },
                                          "op": "OR",
                                          "right": {
                                            "left": {
                                              "left": {
                                                "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                "type": "variable"
                                              },
                                              "op": "starts_with",
                                              "right": {
                                                "type": "literal",
                                                "value": "172.27"
                                              },
                                              "type": "binary"
                                            },
                                            "op": "OR",
                                            "right": {
                                              "left": {
                                                "left": {
                                                  "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                  "type": "variable"
                                                },
                                                "op": "starts_with",
                                                "right": {
                                                  "type": "literal",
                                                  "value": "172.28"
                                                },
                                                "type": "binary"
                                              },
                                              "op": "OR",
                                              "right": {
                                                "left": {
                                                  "left": {
                                                    "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                    "type": "variable"
                                                  },
                                                  "op": "starts_with",
                                                  "right": {
                                                    "type": "literal",
                                                    "value": "172.29"
                                                  },
                                                  "type": "binary"
                                                },
                                                "op": "OR",
                                                "right": {
                                                  "left": {
                                                    "left": {
                                                      "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                      "type": "variable"
                                                    },
                                                    "op": "starts_with",
                                                    "right": {
                                                      "type": "literal",
                                                      "value": "172.30"
                                                    },
                                                    "type": "binary"
                                                  },
                                                  "op": "OR",
                                                  "right": {
                                                    "left": {
                                                      "left": {
                                                        "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                        "type": "variable"
                                                      },
                                                      "op": "starts_with",
                                                      "right": {
                                                        "type": "literal",
                                                        "value": "172.31"
                                                      },
                                                      "type": "binary"
                                                    },
                                                    "op": "OR",
                                                    "right": {
                                                      "left": {
                                                        "name": "e1840ac5-38a0-48c8-a465-c406e2772a35.$item",
                                                        "type": "variable"
                                                      },
                                                      "op": "starts_with",
                                                      "right": {
                                                        "type": "literal",
                                                        "value": "192.168"
                                                      },
                                                      "type": "binary"
                                                    },
                                                    "type": "binary"
                                                  },
                                                  "type": "binary"
                                                },
                                                "type": "binary"
                                              },
                                              "type": "binary"
                                            },
                                            "type": "binary"
                                          },
                                          "type": "binary"
                                        },
                                        "type": "binary"
                                      },
                                      "type": "binary"
                                    },
                                    "type": "binary"
                                  },
                                  "type": "binary"
                                },
                                "type": "binary"
                              },
                              "type": "binary"
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"10.\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.16\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.17\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.18\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.19\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.20\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.21\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.22\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.23\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.24\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.25\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.26\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.27\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.28\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.29\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.30\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"172.31\") OR \n{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} starts_with (\"192.168\")\n"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "ab17b159-0978-474a-8bd9-d79def02e57b": {
            "nodeId": "ab17b159-0978-474a-8bd9-d79def02e57b",
            "name": "get palo domain logs",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Firewall",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_pan_os",
              "slugVersion": "6.1.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_pan_os/6.1.4/icon.png"
            },
            "identifier": "retrieve_logs",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "count": 20,
                "direction": "backward",
                "filter": "( url contains '{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}' )",
                "interval": 0.5,
                "log_type": "url",
                "max_tries": 50,
                "skip": 0
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "count": {
                  "default": 20,
                  "description": "Number of logs to retrieve (Max: 500, Default: 20)",
                  "order": 2,
                  "title": "Count",
                  "type": "integer"
                },
                "direction": {
                  "description": "Order in which to return the logs",
                  "enum": [
                    "backward",
                    "forward"
                  ],
                  "order": 7,
                  "title": "Direction",
                  "type": "string"
                },
                "filter": {
                  "description": "Search query. Format as a log filter expression",
                  "order": 4,
                  "title": "Filter",
                  "type": "string"
                },
                "interval": {
                  "default": 0.5,
                  "description": "Time interval in seconds to wait between queries for commit job completion (Default: 0.5)",
                  "order": 5,
                  "title": "Interval",
                  "type": "number"
                },
                "log_type": {
                  "description": "Type of log to retrieve",
                  "enum": [
                    "config",
                    "hipmatch",
                    "system",
                    "threat",
                    "traffic",
                    "url",
                    "wildfire"
                  ],
                  "order": 1,
                  "title": "Log Type",
                  "type": "string"
                },
                "max_tries": {
                  "default": 25,
                  "description": "Maximum number of times to poll for job completion before timing out (Default: 25)",
                  "order": 6,
                  "title": "Max Tries",
                  "type": "integer"
                },
                "skip": {
                  "default": 0,
                  "description": "Log retrieval offset, number of entries to skip, (Default: 0)",
                  "order": 3,
                  "title": "Skip",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "log": {
                  "properties": {
                    "data": {
                      "order": 1,
                      "title": "Data",
                      "type": "object"
                    }
                  },
                  "title": "Log",
                  "type": "object"
                }
              },
              "properties": {
                "response": {
                  "$ref": "#/definitions/log",
                  "description": "Response from the firewall",
                  "order": 1,
                  "title": "Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd": {
            "nodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
            "name": "URL Loop ",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa",
              "nextEdgeId": "c2b72f99-d944-4846-a99a-ddbfb88cd701",
              "repeatVariable": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "b22ec500-aacc-42fe-a122-f566cb5f2736": {
            "nodeId": "b22ec500-aacc-42fe-a122-f566cb5f2736",
            "name": "sleep 10 seconds",
            "type": "action",
            "plugin": {
              "name": "Sleep",
              "slugVendor": "rapid7",
              "slugName": "sleep",
              "slugVersion": "1.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/sleep/1.0.2/icon.png"
            },
            "identifier": "sleep",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "interval": 10
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "interval": {
                  "description": "Interval of time in seconds",
                  "order": 1,
                  "title": "Interval",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "slept": {
                  "description": "Time spent asleep",
                  "order": 1,
                  "title": "Slept",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0": {
            "nodeId": "b616214b-92ae-4fa8-a30f-c2cf8db2e9a0",
            "name": "Teams hash xdr results",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "XDR Search Results<br>\nTime: {{[3baf3069-e761-44a7-9efb-efa20e0c930f].[date]}}\nHostname- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[agent_hostname]}} <br>\nParent Process- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[causality_actor_process_image_name]}} <br>\nParent Process Directory- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[causality_actor_process_image_path]}} <br>\nProcess Name- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[action_process_image_name]}} <br>\nProcess Directory- {{[13fbfc5d-a157-4b40-8a84-e930fe648d66].[$item].[action_process_image_path]}} <br>",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b837ba56-7857-4940-b6b3-be880fcb0808": {
            "nodeId": "b837ba56-7857-4940-b6b3-be880fcb0808",
            "name": "Whois Lookup IP",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}",
                "registrar": "Autodetect"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "registrar": {
                  "default": "Autodetect",
                  "description": "Domain Registrar",
                  "enum": [
                    "Autodetect",
                    "RIPE",
                    "ARIN",
                    "LACNIC",
                    "APNIC"
                  ],
                  "order": 2,
                  "title": "Registrar",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "bd09a56b-05ef-4e61-abf7-13a879105864": {
            "nodeId": "bd09a56b-05ef-4e61-abf7-13a879105864",
            "name": "Domain extractor",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.3.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.3.1/icon.png"
            },
            "identifier": "domain_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}",
                "subdomain": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes, supports text and binary file types such as PDF, DOCX, XLSX, PPTX, ODT, ODP, ODS",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                },
                "subdomain": {
                  "description": "Include subdomain in result",
                  "order": 3,
                  "title": "Subdomain",
                  "type": "boolean"
                }
              },
              "required": [
                "subdomain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "domains": {
                  "description": "List of extracted Domain names",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domain Names",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0": {
            "nodeId": "c16b9c8d-1e70-4746-9ce8-5158de0ef9f0",
            "name": "get mimecast url logs",
            "type": "action",
            "plugin": {
              "name": "Mimecast",
              "slugVendor": "rapid7",
              "slugName": "mimecast",
              "slugVersion": "4.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/mimecast/4.1.2/icon.png"
            },
            "identifier": "get_ttp_url_logs",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "from": "",
                "max_pages": 100,
                "page_size": 10,
                "route": "all",
                "scan_result": "all",
                "to": "",
                "url_to_filter": "{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "from": {
                  "description": "Start date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is the start of the current day",
                  "order": 1,
                  "title": "From",
                  "type": "string"
                },
                "max_pages": {
                  "default": 100,
                  "description": "Max pages returned, default 100",
                  "order": 6,
                  "title": "Max Pages",
                  "type": "integer"
                },
                "page_size": {
                  "default": 10,
                  "description": "The number of logs returned per page, default value is 10",
                  "order": 7,
                  "title": "Page Size",
                  "type": "integer"
                },
                "route": {
                  "default": "all",
                  "description": "Filters logs by route, must be one of inbound, outbound, internal, or all",
                  "enum": [
                    "all",
                    "inbound",
                    "outbound",
                    "internal"
                  ],
                  "order": 3,
                  "title": "Route",
                  "type": "string"
                },
                "scan_result": {
                  "default": "all",
                  "description": "Filters logs by scan result, must be one of clean, malicious, or all",
                  "enum": [
                    "clean",
                    "malicious",
                    "all"
                  ],
                  "order": 4,
                  "title": "Scan Result",
                  "type": "string"
                },
                "to": {
                  "description": "End date of logs to return in the following format 2015-11-16T14:49:18+0000. Default is time of request",
                  "order": 2,
                  "title": "To",
                  "type": "string"
                },
                "url_to_filter": {
                  "description": "Regular expression to filter on. e.g. `examp` will return only URLs with the letters examp in them",
                  "order": 5,
                  "title": "URL Regular Expression Filter",
                  "type": "string"
                }
              },
              "required": [
                "route",
                "scan_result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "click_logs": {
                  "properties": {
                    "action": {
                      "description": "The action that was taken for the click",
                      "order": 9,
                      "title": "Action",
                      "type": "string"
                    },
                    "adminOverride": {
                      "description": "The action defined by the administrator for the URL",
                      "order": 6,
                      "title": "Admin Override",
                      "type": "string"
                    },
                    "category": {
                      "description": "The category of the URL clicked",
                      "order": 1,
                      "title": "Category",
                      "type": "string"
                    },
                    "date": {
                      "description": "The date that the URL was clicked",
                      "order": 7,
                      "title": "Date",
                      "type": "string"
                    },
                    "route": {
                      "description": "The route of the email that contained the link",
                      "order": 5,
                      "title": "Route",
                      "type": "string"
                    },
                    "scanResult": {
                      "description": "The result of the URL scan",
                      "order": 8,
                      "title": "Scan Result",
                      "type": "string"
                    },
                    "ttpDefinition": {
                      "description": "The description of the definition that triggered the URL to be rewritten by Mimecast",
                      "order": 10,
                      "title": "TTP Definition",
                      "type": "string"
                    },
                    "url": {
                      "description": "The URL clicked",
                      "order": 3,
                      "title": "URL",
                      "type": "string"
                    },
                    "userAwarenessAction": {
                      "description": "The action taken by the user if user awareness was applied",
                      "order": 4,
                      "title": "User Awareness Action",
                      "type": "string"
                    },
                    "userEmailAddress": {
                      "description": "The email address of the user who clicked the link",
                      "order": 2,
                      "title": "User Email Address",
                      "type": "string"
                    },
                    "userOverride": {
                      "description": "The action requested by the user",
                      "order": 11,
                      "title": "User Override",
                      "type": "string"
                    }
                  },
                  "title": "Click Logs",
                  "type": "object"
                }
              },
              "properties": {
                "click_logs": {
                  "description": "Click Logs",
                  "items": {
                    "$ref": "#/definitions/click_logs"
                  },
                  "order": 1,
                  "title": "Click Logs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c8b4564e-08cb-4538-9d82-afe2b5bc41ba": {
            "nodeId": "c8b4564e-08cb-4538-9d82-afe2b5bc41ba",
            "name": "Joe Sandbox Get Report",
            "type": "action",
            "plugin": {
              "name": "Joe Sandbox",
              "slugVendor": "rapid7",
              "slugName": "joe_sandbox",
              "slugVersion": "1.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/joe_sandbox/1.0.4/icon.png"
            },
            "identifier": "get_analysis_info",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "webid": "{{[7b04e3f1-6a08-4724-aa34-22357ff732e1].[webids].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "webid": {
                  "description": "The web ID of the analysis",
                  "order": 1,
                  "title": "WebID",
                  "type": "string"
                }
              },
              "required": [
                "webid"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "analysis": {
                  "properties": {
                    "analysisid": {
                      "description": "Analysis ID. Will not be returned if the analysis is not finished",
                      "order": 2,
                      "title": "AnalysisID",
                      "type": "string"
                    },
                    "comments": {
                      "description": "Comments",
                      "order": 4,
                      "title": "Comments",
                      "type": "string"
                    },
                    "duration": {
                      "description": "Duration of the analysis in seconds (only for finished analyses)",
                      "order": 8,
                      "title": "Duration",
                      "type": "integer"
                    },
                    "filename": {
                      "description": "File name",
                      "order": 5,
                      "title": "Filename",
                      "type": "string"
                    },
                    "md5": {
                      "description": "MD5",
                      "order": 9,
                      "title": "MD5",
                      "type": "string"
                    },
                    "runs": {
                      "description": "Runs",
                      "items": {
                        "$ref": "#/definitions/run"
                      },
                      "order": 13,
                      "title": "Runs",
                      "type": "array"
                    },
                    "scriptname": {
                      "description": "Script name",
                      "order": 6,
                      "title": "Scriptname",
                      "type": "string"
                    },
                    "sha1": {
                      "description": "SHA1",
                      "order": 10,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 11,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status of the analysis, one of: submitted, running, finished",
                      "order": 3,
                      "title": "Status",
                      "type": "string"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 12,
                      "title": "Tags",
                      "type": "array"
                    },
                    "time": {
                      "description": "Time",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 7,
                      "title": "Time",
                      "type": "string"
                    },
                    "webid": {
                      "description": "Web ID",
                      "order": 1,
                      "title": "WebID",
                      "type": "string"
                    }
                  },
                  "title": "Analysis",
                  "type": "object"
                },
                "run": {
                  "properties": {
                    "detection": {
                      "description": "Detection, one of: unknown, clean, suspicious, malicious",
                      "order": 1,
                      "title": "Detection",
                      "type": "string"
                    },
                    "error": {
                      "description": "Error description, will not be present if no error was detected",
                      "order": 2,
                      "title": "Error",
                      "type": "string"
                    },
                    "system": {
                      "description": "System",
                      "order": 3,
                      "title": "System",
                      "type": "string"
                    },
                    "yara": {
                      "description": "Yara",
                      "order": 4,
                      "title": "Yara",
                      "type": "boolean"
                    }
                  },
                  "title": "Run",
                  "type": "object"
                }
              },
              "properties": {
                "analysis": {
                  "$ref": "#/definitions/analysis",
                  "description": "Analysis details",
                  "order": 1,
                  "title": "Analysis"
                }
              },
              "required": [
                "analysis"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "cf7d6a3f-91fb-4475-9a5d-c06203055ced": {
            "nodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
            "name": "Invalid Input Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "Your message was not correctly formatted.<br>\nMessage format should be:<br>\n!enrich-indicator ValidIndicator<br>",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "de7dd5b1-90e3-4310-8884-1548bf0a5816": {
            "nodeId": "de7dd5b1-90e3-4310-8884-1548bf0a5816",
            "name": "XDR IP search results",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": " IP Analysis for: {{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} <br>\n<br>\n<b>WhoIs</b><br>\nOrg Details<br>\nReg Date: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[regdate]}}<br>\nOrg Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[orgname]}}<br>\nNet Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netname]}}<br>\nNet Type: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[nettype]}}<br>\nNet Range: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netrange]}}<br>\nLocation Details<br>\nAddress: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[address]}}<br>\nCity: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[city]}}<br>\nCountry: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[country]}}<br>\n<br>\n<b>Dig</b><br>\nQuestion Asked: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[question]}}<br>\nAnswer Received: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[answer]}}<br>\nQuery Status: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[status]}}<br>\nNameserver that Fulfilled Request: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[nameserver]}}<br>\n<br>\nVirus Total Results<br>\nCertificate {{[f5062351-82ae-4b06-bcb7-340a63136281].[report].[last_https_certificate].[subject]}}<br>\nSubject alternative name {{[f5062351-82ae-4b06-bcb7-340a63136281].[report].[last_https_certificate].[extensions].[subject_alternative_name]}}<br>\nLast Analysis Stats {{[f5062351-82ae-4b06-bcb7-340a63136281].[report].[last_analysis_stats]}}<br>\nTotal Votes{{[f5062351-82ae-4b06-bcb7-340a63136281].[report].[total_votes]}}<br>\n<br>\n\n\n<b>XDR Results</b><br>\n{{#each [e5618dbc-a698-4252-acdf-c97348754912].[reply].[results].[data]}}\nTime- {{this.[_time]}} <br>\nHostname- {{this.[agent_hostname]}} <br>\nSource IP address- {{this.[agent_ip_addresses]}} <br>\nSource Process- {{this.[actor_process_image_name]}} <br>\nDestination IP- {{this.[action_remote_ip]}} <br>\nDestination Port- {{this.[action_remote_port]}} <br>\n<br>\n{{/each}}\n",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e1840ac5-38a0-48c8-a465-c406e2772a35": {
            "nodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
            "name": "IP Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "5e82b957-21e8-40b2-8285-d4505c6c8cbf",
              "nextEdgeId": "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7",
              "repeatVariable": "{{[0a72bb10-b2b8-4976-b464-41f02ed9a67a].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5": {
            "nodeId": "e4af9d3e-9b04-43b2-b1fd-ea79b51d40c5",
            "name": "Passive Total Domain",
            "type": "action",
            "plugin": {
              "name": "PassiveTotal",
              "slugVendor": "rapid7",
              "slugName": "passivetotal",
              "slugVersion": "1.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/passivetotal/1.0.1/icon.png"
            },
            "identifier": "lookup_domain",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain, e.g. 4.2.2.2",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "domain_record": {
                  "properties": {
                    "dynamic_dns": {
                      "description": "True if Dynamic DNS",
                      "order": 5,
                      "title": "Dynamic Dns",
                      "type": "boolean"
                    },
                    "ever_compromised": {
                      "description": "True if ever compromised",
                      "order": 1,
                      "title": "Ever Compromised",
                      "type": "boolean"
                    },
                    "primary_domain": {
                      "description": "True if primary Domain",
                      "order": 2,
                      "title": "Primary Domain",
                      "type": "string"
                    },
                    "subdomains": {
                      "description": "Subdomains",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Subdomains",
                      "type": "array"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Tags",
                      "type": "array"
                    },
                    "tld": {
                      "description": "TLD",
                      "order": 6,
                      "title": "Tld",
                      "type": "string"
                    }
                  },
                  "title": "Domain Record",
                  "type": "object"
                }
              },
              "properties": {
                "domain_record": {
                  "$ref": "#/definitions/domain_record",
                  "description": "Domain Record",
                  "order": 1,
                  "title": "Domain Record"
                },
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e5618dbc-a698-4252-acdf-c97348754912": {
            "nodeId": "e5618dbc-a698-4252-acdf-c97348754912",
            "name": "get XDR outbound logs",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Cortex XDR",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_cortex_xdr",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_cortex_xdr/2.2.1/icon.png"
            },
            "identifier": "get_xql_query_results",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "end_time": 0,
                "limit": 20,
                "query": "dataset in(xdr_data)\n| filter event_type = ENUM.NETWORK  and action_remote_ip = \"{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}\"\n| fields agent_hostname, agent_ip_addresses, actor_process_image_name, action_remote_ip, action_remote_port ",
                "start_time": 0,
                "tenants": [
                  "997134488"
                ]
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "end_time": {
                  "description": "Integer in timestamp epoch milliseconds for end of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 3,
                  "title": "End Time",
                  "type": "integer"
                },
                "limit": {
                  "default": 20,
                  "description": "Integer representing the maximum number of results to return, defaults to 20, max value 1000",
                  "order": 5,
                  "title": "Limit",
                  "type": "integer"
                },
                "query": {
                  "description": "String of the XQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "start_time": {
                  "description": "Integer in timestamp epoch milliseconds for start of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 4,
                  "title": "Start Time",
                  "type": "integer"
                },
                "tenants": {
                  "description": "String that represents additional information regarding the action",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Tenants",
                  "type": "array"
                }
              },
              "required": [
                "tenants",
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "reply": {
                  "properties": {
                    "number_of_results": {
                      "description": "Integer representing the number of results returned",
                      "order": 2,
                      "title": "Number of Results",
                      "type": "integer"
                    },
                    "query_cost": {
                      "description": "Float representing the number of query units collected for this API",
                      "order": 3,
                      "title": "Query Cost",
                      "type": "object"
                    },
                    "remaining_quota": {
                      "description": "Float representing the number of query units available for you to use",
                      "order": 4,
                      "title": "Remaining Quota",
                      "type": "number"
                    },
                    "results": {
                      "description": "Displays the API response in either of the following fields according to the number of results: data: API results according to defined format field stream: id String representing a unique ID of more than 1000 number of results",
                      "order": 5,
                      "title": "Results",
                      "type": "object"
                    },
                    "status": {
                      "description": "API call status: 'SUCCESS', 'FAIL', 'PENDING', 'PARTIAL_SUCCESS'",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Reply",
                  "type": "object"
                }
              },
              "properties": {
                "reply": {
                  "$ref": "#/definitions/reply",
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Reply"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e80e7135-c664-4cde-87d5-d7787f0343da": {
            "nodeId": "e80e7135-c664-4cde-87d5-d7787f0343da",
            "name": "Get umbrella visits",
            "type": "action",
            "plugin": {
              "name": "Cisco Umbrella Reporting",
              "slugVendor": "rapid7",
              "slugName": "cisco_umbrella_reporting",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/cisco_umbrella_reporting/1.0.0/icon.png"
            },
            "identifier": "get_domain_visits",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Domain, IP address, or URL to search for computer visits. If a URL is provided it will be stripped down to a domain or IP address. If this field is empty, it will return activities for all domains in the organization",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "record": {
                  "properties": {
                    "actionTaken": {
                      "description": "Either Blocked or Allowed",
                      "order": 7,
                      "title": "Action Taken",
                      "type": "string"
                    },
                    "categories": {
                      "description": "Which categories, if any, the destination for which this request was made falls into",
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "datetime": {
                      "description": "Datetime at which the event occurred, in UTC",
                      "order": 8,
                      "title": "Datetime",
                      "type": "string"
                    },
                    "destination": {
                      "description": "Destination to which this request was made",
                      "order": 9,
                      "title": "Destination",
                      "type": "string"
                    },
                    "externalIp": {
                      "description": "External IP address of the identity making the request",
                      "order": 3,
                      "title": "External IP",
                      "type": "string"
                    },
                    "internalIp": {
                      "description": "Internal IP address of the identity making the request",
                      "order": 2,
                      "title": "Internal IP",
                      "type": "string"
                    },
                    "originLabel": {
                      "description": "Human-readable name for the identity, matching the one seen in the dashboard",
                      "order": 4,
                      "title": "Origin Label",
                      "type": "string"
                    },
                    "originType": {
                      "description": "Identity type (such as network, roaming computer, AD User, etc)",
                      "order": 6,
                      "title": "Origin Type",
                      "type": "string"
                    },
                    "originid": {
                      "description": "Numerical identifier for the identity making the request",
                      "order": 1,
                      "title": "Origin ID",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Which tags, if any, the destination for which this request was made falls into",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "title": "Record",
                  "type": "object"
                }
              },
              "properties": {
                "domain_visits": {
                  "description": "List of computers that visited a domain",
                  "items": {
                    "$ref": "#/definitions/record"
                  },
                  "order": 1,
                  "title": "Domain Visits",
                  "type": "array"
                }
              },
              "required": [
                "domain_visits"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e82479d4-8cb9-45f3-9929-79a8d45b2087": {
            "nodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
            "name": "Combine Hashes",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[md5_hashes]}}",
                "array2": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha1_hashes]}}",
                "array3": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha256_hashes]}}",
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "f5062351-82ae-4b06-bcb7-340a63136281": {
            "nodeId": "f5062351-82ae-4b06-bcb7-340a63136281",
            "name": "Virus Total IP",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "9.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/9.0.0/icon.png"
            },
            "identifier": "ip_address_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "ip_report": {
                  "properties": {
                    "as_owner": {
                      "description": "Owner of the Autonomous System to which the IP belongs",
                      "order": 1,
                      "title": "As Owner",
                      "type": "string"
                    },
                    "asn": {
                      "description": "Autonomous System Number to which the IP belongs",
                      "order": 2,
                      "title": "ASN",
                      "type": "integer"
                    },
                    "continent": {
                      "description": "Continent where the IP is placed (ISO-3166 continent code)",
                      "order": 3,
                      "title": "Continent",
                      "type": "string"
                    },
                    "country": {
                      "description": "Country where the IP is placed (ISO-3166 country code)",
                      "order": 4,
                      "title": "Country",
                      "type": "string"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 5,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scans",
                      "order": 6,
                      "title": "Last Analysis Statistics"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL Certificate object retrieved last time the domain was analyzed",
                      "order": 7,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 8,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the IP's information was last updated (UTC timestamp)",
                      "order": 9,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "network": {
                      "description": "IPv4 network range to which the IP belongs",
                      "order": 10,
                      "title": "Network",
                      "type": "string"
                    },
                    "regional_internet_registry": {
                      "description": "RIR (one of the current RIRs: AFRINIC, ARIN, APNIC, LACNIC or RIPE NCC)",
                      "order": 11,
                      "title": "Regional Internet Registry",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "IP's score calculated from the votes of the VirusTotal's community",
                      "order": 12,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Identificative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 14,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 15,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 16,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Ip Report",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/ip_report",
                  "description": "IP address report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f94f4d3d-f65d-4931-ae21-afa45917e35c": {
            "nodeId": "f94f4d3d-f65d-4931-ae21-afa45917e35c",
            "name": "Cortex XDR Search Results",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<b>Results for {{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}</b<br>\n\n<b>XDR Domain Search Results</b><br>\n\n{{#each [fea4b4ad-1e9d-4cc6-a19e-3c0147472902].[reply].[results].[data]}}\nTime- {{this.[_time]}} <br>\nHostname- {{this.[agent_hostname]}} <br>\nDNS Query- {{this.[dns_query_name]}} <br>\n<br>\n{{/each}}\n",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "fcab256e-1e66-4313-aeea-6355f9c755cb": {
            "nodeId": "fcab256e-1e66-4313-aeea-6355f9c755cb",
            "name": "send internal ip enrichment in teams",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "<b>IP Addresses:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[ip]}}<br>\n<b>Endpoint Name:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[endpoint_name]}}<br>\n<b>Endpoint Status:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[endpoint_status]}}<br>\n<b>Endpoint Type:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[endpoint_type]}}<br>\n<b>OS Type:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[os_type]}}<br>\n<b>Users:</b> {{[a06c17bd-28cd-4337-9910-a3ff55a79640].[endpoints].[0].[users].[0]}}",
                "team_name": "{{$workflow.[Team Name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "fea4b4ad-1e9d-4cc6-a19e-3c0147472902": {
            "nodeId": "fea4b4ad-1e9d-4cc6-a19e-3c0147472902",
            "name": "xdr domain search",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Cortex XDR",
              "slugVendor": "rapid7",
              "slugName": "palo_alto_cortex_xdr",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/palo_alto_cortex_xdr/2.2.1/icon.png"
            },
            "identifier": "get_xql_query_results",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "end_time": 0,
                "limit": 20,
                "query": "dataset = xdr_data \n| filter event_type = ENUM.STORY and dns_query_name contains \"{{[bd09a56b-05ef-4e61-abf7-13a879105864].[domains].[0]}}\"\n| fields _time, agent_hostname, dns_query_name ",
                "start_time": 0,
                "tenants": [
                  "997134488"
                ]
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "end_time": {
                  "description": "Integer in timestamp epoch milliseconds for end of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 3,
                  "title": "End Time",
                  "type": "integer"
                },
                "limit": {
                  "default": 20,
                  "description": "Integer representing the maximum number of results to return, defaults to 20, max value 1000",
                  "order": 5,
                  "title": "Limit",
                  "type": "integer"
                },
                "query": {
                  "description": "String of the XQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "start_time": {
                  "description": "Integer in timestamp epoch milliseconds for start of the time range, Cortex XDR calls by default the last 24 hours if both 'Start Time' and 'End Time' values are not present",
                  "order": 4,
                  "title": "Start Time",
                  "type": "integer"
                },
                "tenants": {
                  "description": "String that represents additional information regarding the action",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Tenants",
                  "type": "array"
                }
              },
              "required": [
                "tenants",
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "reply": {
                  "properties": {
                    "number_of_results": {
                      "description": "Integer representing the number of results returned",
                      "order": 2,
                      "title": "Number of Results",
                      "type": "integer"
                    },
                    "query_cost": {
                      "description": "Float representing the number of query units collected for this API",
                      "order": 3,
                      "title": "Query Cost",
                      "type": "object"
                    },
                    "remaining_quota": {
                      "description": "Float representing the number of query units available for you to use",
                      "order": 4,
                      "title": "Remaining Quota",
                      "type": "number"
                    },
                    "results": {
                      "description": "Displays the API response in either of the following fields according to the number of results: data: API results according to defined format field stream: id String representing a unique ID of more than 1000 number of results",
                      "order": 5,
                      "title": "Results",
                      "type": "object"
                    },
                    "status": {
                      "description": "API call status: 'SUCCESS', 'FAIL', 'PENDING', 'PARTIAL_SUCCESS'",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Reply",
                  "type": "object"
                }
              },
              "properties": {
                "reply": {
                  "$ref": "#/definitions/reply",
                  "description": "Was the operation successful",
                  "order": 1,
                  "title": "Reply"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Threat Intelligence"
        ],
        "humanCostSeconds": 900,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Team Name": {
                "type": "string",
                "description": "The Microsoft Teams team name where the workflow will be triggered and respond"
              },
              "Channel Name": {
                "type": "string",
                "description": "The Microsoft Teams channel name where the workflow will be triggered and respond"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "f890dd01-e7ec-44e1-b186-7c1b80ef39fb",
        "identifier": "new_message_received",
        "name": "Microsoft Teams Message",
        "description": "Trigger on MS Teams message\nE.X. !enrich-indicator <Command> <data>",
        "input": {
          "channel_name": "{{$workflow.[Channel Name]}}",
          "message_content": "!enrich-indicator",
          "team_name": "{{$workflow.[Team Name]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "first_word",
                "words"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.2.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.2.0/icon.png"
        }
      }
    ]
  }
}