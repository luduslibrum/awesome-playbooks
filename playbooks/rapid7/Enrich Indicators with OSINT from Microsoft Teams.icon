{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:46:54.193134687Z",
    "workflowVersions": [
      {
        "name": "Enrich Indicators with OSINT from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThreat Intelligence doesnâ€™t have to come with a cost. This workflow uses open-source intelligence (OSINT) to perform domain lookups, header analysis, hash analysis, and more directly from Microsoft Teams. Just connect Microsoft Teams and activate this instant indicator enrichment workflow.\n\nSample Trigger Commands:\n\n`!enrich-indicator 8.8.8.8`\n\n`!enrich-indicator rapid7.com`\n\n`!enrich-indicator 009f1e9b72cfb6daa3de82093a755bdb3685e0eb`\n\n# Key Features\n\n* **Automation in Minutes** - Get your first automation workflow up and running in minutes with this connectionless enrichment workflow.\n* **Investigate Indicators at Scale** - Manually investigating every reported phishing attempt is extremely difficult to scale. Automatic analysis of common phishing IOCs reduces the overhead associated with every reported incident.\n* **Shorten the Investigation Timeline** - Manage timely responses to real attacks by eliminating the investigation of false positives and spam. If the URLs are found to be malicious, pivot seamlessly to incident response.\n\n# Requirements\n\n* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are two parameters you will need to configure in order to complete setup of your workflow:\n* `team name`: The Microsoft Teams team name in your environment where the workflow should be triggered and respond\n* `channel name`: The Microsoft Teams channel name in your environment where the workflow should be triggered and respond\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameters, activate the workflow in order to trigger it.\n\n### Usage\n\n*This workflow will only trigger in the channel specified in the Microsoft Teams workflow steps.*\n\nTo run the workflow, send a message to the specified Microsoft Teams channel starting with the command `!enrich-indicator`. \n\nCommands should be in the following format:\n`!enrich-indicator <indicator>`\n\n`!enrich-indicator ip 8.8.8.8`\n`!enrich-indicator url badsite.com`\n`!enrich-indicator hash 009f1e9b72cfb6daa3de82093a755bdb3685e0eb`\n\n\nAlternatively, use `!enrich-indicator help` for more information and examples. \n\nThe workflow will post the results in a thread.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|DNS|2.0.0|1|\n|Team Cymru MHR|1.1.1|1|\n|Microsoft Teams|3.1.0|8|\n|WHOIS|3.0.1|2|\n|Type Converter|1.7.0|2|\n\n## Troubleshooting\n\nIn some instances using copy & paste for `!enrich-indicator` commands may introduce unicode characters. These characters may be misinterpreted by the workflow, resulting in the help response triggering for what appear to be valid commands. It is recommended to avoid copying & pasting commands.\n\n# Version History\n\n* 3.0.1 - Update keywords\n* 3.0.0 - Update the major version\n* 2.0.2 - Update to use Workflow Parameters | Update DNS plugin to 2.0.0 | Update WHOIS plugin to 3.0.1 | Update documentation\n* 2.0.1 - Update Microsoft Teams to version 3.1.0 | Update documentation\n* 2.0.0 - Update workflow to use loop outputs\n* 1.0.2 - Update to make Microsoft Teams plugin the latest version\n* 1.0.1 - Updated trigger syntax and documentation\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Teams](https://teams.microsoft.com)\n",
        "graph": {
          "edges": {
            "022f65e4-073d-4238-9ef8-8fef8290ac81": {
              "id": "022f65e4-073d-4238-9ef8-8fef8290ac81",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
              "toNodeId": ""
            },
            "15ab60e2-5f12-4752-851e-c9bc75dcc964": {
              "id": "15ab60e2-5f12-4752-851e-c9bc75dcc964",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "632fb97e-3487-4617-87b1-986d8e1ff739",
              "toNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f"
            },
            "1b5dc676-c002-4f20-aac7-1a4eed88f774": {
              "id": "1b5dc676-c002-4f20-aac7-1a4eed88f774",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
              "toNodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675"
            },
            "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa": {
              "id": "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "toNodeId": "8555f89c-7355-4854-b8ca-067f214f1b44"
            },
            "43779f4c-4cf0-46cd-93b0-11b7125850a5": {
              "id": "43779f4c-4cf0-46cd-93b0-11b7125850a5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
              "toNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "52b8a22c-4c27-445d-b138-ca8130c6e45d": {
              "id": "52b8a22c-4c27-445d-b138-ca8130c6e45d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "toNodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53"
            },
            "5a79de9c-5662-44dc-a9ba-f3d05db9becc": {
              "id": "5a79de9c-5662-44dc-a9ba-f3d05db9becc",
              "name": "Found",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "2095c328-836e-4672-8fbb-4ae6b48425c5",
              "toNodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453"
            },
            "5e82b957-21e8-40b2-8285-d4505c6c8cbf": {
              "id": "5e82b957-21e8-40b2-8285-d4505c6c8cbf",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "toNodeId": "b837ba56-7857-4940-b6b3-be880fcb0808"
            },
            "66f4281b-5d97-488d-9a4e-65c04d5ed98f": {
              "id": "66f4281b-5d97-488d-9a4e-65c04d5ed98f",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "4c6598c9-cc1c-4f80-845a-9af6e3c903ae",
              "toNodeId": ""
            },
            "705dcbfe-489f-4470-aa9a-fdcf259ac788": {
              "id": "705dcbfe-489f-4470-aa9a-fdcf259ac788",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
              "toNodeId": ""
            },
            "73e9301c-fe73-45ce-b020-1906d46830ee": {
              "id": "73e9301c-fe73-45ce-b020-1906d46830ee",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "726bf264-041d-499c-847d-078ba2d8a00a",
              "toNodeId": "2095c328-836e-4672-8fbb-4ae6b48425c5"
            },
            "86dd3126-49d6-4d03-9cb3-f4079a0a35ea": {
              "id": "86dd3126-49d6-4d03-9cb3-f4079a0a35ea",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
              "toNodeId": ""
            },
            "871925fa-8867-4473-9f8b-12eb1e5d8be1": {
              "id": "871925fa-8867-4473-9f8b-12eb1e5d8be1",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "8555f89c-7355-4854-b8ca-067f214f1b44",
              "toNodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc"
            },
            "8d311edb-8736-498f-b4c9-b7856e8b8b98": {
              "id": "8d311edb-8736-498f-b4c9-b7856e8b8b98",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
              "toNodeId": "632fb97e-3487-4617-87b1-986d8e1ff739"
            },
            "8e27e688-6be5-4697-b507-cc9b147d1618": {
              "id": "8e27e688-6be5-4697-b507-cc9b147d1618",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "toNodeId": "726bf264-041d-499c-847d-078ba2d8a00a"
            },
            "8ed4bf12-773c-4654-84ca-46a596c46e53": {
              "id": "8ed4bf12-773c-4654-84ca-46a596c46e53",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
              "toNodeId": "78788755-a02c-4110-b0d6-fda75080a7fe"
            },
            "ad9d901d-c221-44a1-8570-d635b8211cfb": {
              "id": "ad9d901d-c221-44a1-8570-d635b8211cfb",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "2095c328-836e-4672-8fbb-4ae6b48425c5",
              "toNodeId": "bb488a00-a927-455e-bfd2-b4a520ac7ca2"
            },
            "aff5803a-8f9f-462b-b905-ed4925a38fb6": {
              "id": "aff5803a-8f9f-462b-b905-ed4925a38fb6",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
              "toNodeId": ""
            },
            "b5f96b26-1161-4e5f-bdcd-f81fed879de4": {
              "id": "b5f96b26-1161-4e5f-bdcd-f81fed879de4",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "toNodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced"
            },
            "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7": {
              "id": "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "toNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "c2aad70a-9f0c-484f-9ddd-42d3c407ec73": {
              "id": "c2aad70a-9f0c-484f-9ddd-42d3c407ec73",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "78788755-a02c-4110-b0d6-fda75080a7fe",
              "toNodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef"
            },
            "c2b72f99-d944-4846-a99a-ddbfb88cd701": {
              "id": "c2b72f99-d944-4846-a99a-ddbfb88cd701",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "toNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "cfb57469-acdc-4212-979c-32f64853b92b": {
              "id": "cfb57469-acdc-4212-979c-32f64853b92b",
              "name": "",
              "description": "",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "fromNodeId": "b837ba56-7857-4940-b6b3-be880fcb0808",
              "toNodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8"
            },
            "efc38443-e16a-4dab-9a18-98f1998c4769": {
              "id": "efc38443-e16a-4dab-9a18-98f1998c4769",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
              "toNodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087"
            },
            "f2efb24a-caaf-4221-9418-5f5a5d18cfbb": {
              "id": "f2efb24a-caaf-4221-9418-5f5a5d18cfbb",
              "name": "",
              "description": "",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "fromNodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
              "toNodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d"
            },
            "f39dd67b-7062-4eb4-a32e-63a115c69f47": {
              "id": "f39dd67b-7062-4eb4-a32e-63a115c69f47",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
              "toNodeId": ""
            },
            "f82389e9-aef8-4758-a1e7-99ebca8e2656": {
              "id": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "toNodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a"
            },
            "fed0fdb2-0682-43e5-a208-da2ae0f9a26f": {
              "id": "fed0fdb2-0682-43e5-a208-da2ae0f9a26f",
              "name": "",
              "description": "",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "fromNodeId": "bb488a00-a927-455e-bfd2-b4a520ac7ca2",
              "toNodeId": "4c6598c9-cc1c-4f80-845a-9af6e3c903ae"
            }
          },
          "nodes": {
            "0a72bb10-b2b8-4976-b464-41f02ed9a67a": {
              "id": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
              "parentNodeId": ""
            },
            "0e158eb6-6cc2-4eb9-bbac-470d6995b675": {
              "id": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d": {
              "id": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "2095c328-836e-4672-8fbb-4ae6b48425c5": {
              "id": "2095c328-836e-4672-8fbb-4ae6b48425c5",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "26b0afac-ca64-4f1c-99bf-22bd73b3c93f": {
              "id": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
              "parentNodeId": ""
            },
            "4c6598c9-cc1c-4f80-845a-9af6e3c903ae": {
              "id": "4c6598c9-cc1c-4f80-845a-9af6e3c903ae",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "632fb97e-3487-4617-87b1-986d8e1ff739": {
              "id": "632fb97e-3487-4617-87b1-986d8e1ff739",
              "parentNodeId": ""
            },
            "65e084cc-e4c4-479e-93c8-cccd35ccaecc": {
              "id": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "726bf264-041d-499c-847d-078ba2d8a00a": {
              "id": "726bf264-041d-499c-847d-078ba2d8a00a",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "78788755-a02c-4110-b0d6-fda75080a7fe": {
              "id": "78788755-a02c-4110-b0d6-fda75080a7fe",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "7ec8f1bf-ba7c-442e-8679-b1463aa42453": {
              "id": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "8555f89c-7355-4854-b8ca-067f214f1b44": {
              "id": "8555f89c-7355-4854-b8ca-067f214f1b44",
              "parentNodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd"
            },
            "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef": {
              "id": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "9acb3237-d5f5-4a85-b46e-f08226513060": {
              "id": "9acb3237-d5f5-4a85-b46e-f08226513060",
              "parentNodeId": ""
            },
            "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8": {
              "id": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "a2f5b26e-51b8-4027-b295-29353fa3ab53": {
              "id": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
              "parentNodeId": ""
            },
            "a55a5c03-1340-467d-9d71-07bfad1d072f": {
              "id": "a55a5c03-1340-467d-9d71-07bfad1d072f",
              "parentNodeId": ""
            },
            "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd": {
              "id": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
              "parentNodeId": ""
            },
            "b837ba56-7857-4940-b6b3-be880fcb0808": {
              "id": "b837ba56-7857-4940-b6b3-be880fcb0808",
              "parentNodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35"
            },
            "bb488a00-a927-455e-bfd2-b4a520ac7ca2": {
              "id": "bb488a00-a927-455e-bfd2-b4a520ac7ca2",
              "parentNodeId": "9acb3237-d5f5-4a85-b46e-f08226513060"
            },
            "cf7d6a3f-91fb-4475-9a5d-c06203055ced": {
              "id": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
              "parentNodeId": ""
            },
            "e1840ac5-38a0-48c8-a465-c406e2772a35": {
              "id": "e1840ac5-38a0-48c8-a465-c406e2772a35",
              "parentNodeId": ""
            },
            "e82479d4-8cb9-45f3-9929-79a8d45b2087": {
              "id": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0a72bb10-b2b8-4976-b464-41f02ed9a67a": {
            "nodeId": "0a72bb10-b2b8-4976-b464-41f02ed9a67a",
            "name": "Combine IP Addresses",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.7.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.7.0/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv4_addresses]}}",
                "array2": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv6_addresses]}}",
                "array3": [],
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "0e158eb6-6cc2-4eb9-bbac-470d6995b675": {
            "nodeId": "0e158eb6-6cc2-4eb9-bbac-470d6995b675",
            "name": "Hash Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸ“” Hash Analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}} ðŸ“”<br>\n<br>\n<b>Cymru malware hash</b><br>\nMalicious: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[detected]}}<br>\nHash last seen: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[last_seen_utc]}}<br>\nResponse Code: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[response_code]}}<br>",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d": {
            "nodeId": "19b3b326-3d5f-4d7a-8ffe-b7a5155b595d",
            "name": "URL Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸ“” URL Analysis for {{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}} ðŸ“”<br>\n<br>\n<b>WhoIs</b><br>\nOrg Details<br>\nDomain Name: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[name]}}<br>\nDomain Registrar: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar]}}<br>\nDomain Creation Date: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[creation_date]}}<br>\nDomain Last Updated: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[last_updated]}}<br>\nRegistrar Abuse Contact: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar_abuse_contact_email]}}",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2095c328-836e-4672-8fbb-4ae6b48425c5": {
            "nodeId": "2095c328-836e-4672-8fbb-4ae6b48425c5",
            "name": "Hash Data Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "5a79de9c-5662-44dc-a9ba-f3d05db9becc",
              "stepControlParams": [
                {
                  "edgeId": "ad9d901d-c221-44a1-8570-d635b8211cfb",
                  "expression": {
                    "left": {
                      "name": "726bf264-041d-499c-847d-078ba2d8a00a.result.detected",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": "NO_DATA"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[detected]}} = \"NO_DATA\""
                },
                {
                  "edgeId": "5a79de9c-5662-44dc-a9ba-f3d05db9becc",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "26b0afac-ca64-4f1c-99bf-22bd73b3c93f": {
            "nodeId": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f",
            "name": "Microsoft Teams Message",
            "description": "Trigger on MS Teams message\nE.X. !enrich-indicator <Command> <data>",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "!enrich-indicator",
                "team_name": "{{$workflow.[Team Name]}}"
              }
            },
            "triggerId": "430af65a-c26a-4488-8fa4-bafd6a56da1d",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "4c6598c9-cc1c-4f80-845a-9af6e3c903ae": {
            "nodeId": "4c6598c9-cc1c-4f80-845a-9af6e3c903ae",
            "name": "Hash Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸ“” Hash Analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}} ðŸ“”<br>\n<br>\nNo data on the hash was found.",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "632fb97e-3487-4617-87b1-986d8e1ff739": {
            "nodeId": "632fb97e-3487-4617-87b1-986d8e1ff739",
            "name": "Post Command Received",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸš€ Starting workflow ðŸš€",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "65e084cc-e4c4-479e-93c8-cccd35ccaecc": {
            "nodeId": "65e084cc-e4c4-479e-93c8-cccd35ccaecc",
            "name": "Lookup URL Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "analysis for: {{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}\n\n*WhoIs Results*\nDomain Name: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[name]}}\nDomain Registrar: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar]}}\nDomain Creation Date: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[creation_date]}}\nDomain Last Updated: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[last_updated]}}\nRegistrar Abuse Contact: {{[8555f89c-7355-4854-b8ca-067f214f1b44].[registrar_abuse_contact_email]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "726bf264-041d-499c-847d-078ba2d8a00a": {
            "nodeId": "726bf264-041d-499c-847d-078ba2d8a00a",
            "name": "Cymru Lookup Hash",
            "type": "action",
            "plugin": {
              "name": "Team Cymru MHR",
              "slugVendor": "rapid7",
              "slugName": "cymru_malware_hash",
              "slugVersion": "1.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/cymru_malware_hash/1.1.1/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5 or SHA1 hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "result": {
                  "properties": {
                    "detected": {
                      "description": "Anti-Virus Detection Percentage",
                      "order": 3,
                      "title": "Detected",
                      "type": "string"
                    },
                    "found": {
                      "description": "Malware found",
                      "order": 4,
                      "title": "Found",
                      "type": "boolean"
                    },
                    "last_seen_utc": {
                      "description": "Last seen timestamp",
                      "order": 1,
                      "title": "Last Seen Utc",
                      "type": "string"
                    },
                    "response_code": {
                      "description": "Response code",
                      "order": 2,
                      "title": "Response Code",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "last_seen_utc",
                    "response_code",
                    "detected",
                    "found"
                  ],
                  "title": "Result",
                  "type": "object"
                }
              },
              "properties": {
                "result": {
                  "$ref": "#/definitions/result",
                  "description": "Result",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "78788755-a02c-4110-b0d6-fda75080a7fe": {
            "nodeId": "78788755-a02c-4110-b0d6-fda75080a7fe",
            "name": "Lookup IP Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Analysis for: {{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}\n\n*WhoIs Results*\n\nOrg Details\nReg Date: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[regdate]}}\nOrg Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[orgname]}}\nNet Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netname]}}\nNet Type: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[nettype]}}\nNetRange: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netrange]}}\nLocation Details\nAddress: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[address]}}\nCity: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[city]}}\nCountry: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[country]}}\n\n*Dig Results*\n\nQuestion Asked: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[question]}}\nAnswer Received: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[answer]}}\nQuery Status: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[status]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7ec8f1bf-ba7c-442e-8679-b1463aa42453": {
            "nodeId": "7ec8f1bf-ba7c-442e-8679-b1463aa42453",
            "name": "Hash Output",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Cymru malware hash analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}\n\nMalicious: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[detected]}}\nHash last seen: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[last_seen_utc]}}\nResponse Code: {{[726bf264-041d-499c-847d-078ba2d8a00a].[result].[response_code]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8555f89c-7355-4854-b8ca-067f214f1b44": {
            "nodeId": "8555f89c-7355-4854-b8ca-067f214f1b44",
            "name": "Whois Lookup Domain",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.1/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[b1292b2b-f1c9-4c02-b7d3-ce80e09047fd].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef": {
            "nodeId": "8fc906d9-b1dc-4e79-b63c-c8d4e93ed4ef",
            "name": "Dig IP Output Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸ“” IP Analysis for: {{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}} ðŸ“”<br>\n<br>\n<b>WhoIs</b><br>\nOrg Details<br>\nReg Date: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[regdate]}}<br>\nOrg Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[orgname]}}<br>\nNet Name: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netname]}}<br>\nNet Type: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[nettype]}}<br>\nNet Range: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[netrange]}}<br>\nLocation Details<br>\nAddress: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[address]}}<br>\nCity: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[city]}}<br>\nCountry: {{[b837ba56-7857-4940-b6b3-be880fcb0808].[country]}}<br>\n<br>\n<b>Dig</b><br>\nQuestion Asked: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[question]}}<br>\nAnswer Received: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[answer]}}<br>\nQuery Status: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[status]}}<br>\nNameserver that Fulfilled Request: {{[9fc934ba-ecdc-42aa-98d0-20c73b2b9da8].[nameserver]}}",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "9acb3237-d5f5-4a85-b46e-f08226513060": {
            "nodeId": "9acb3237-d5f5-4a85-b46e-f08226513060",
            "name": "Hash Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "8e27e688-6be5-4697-b507-cc9b147d1618",
              "nextEdgeId": "52b8a22c-4c27-445d-b138-ca8130c6e45d",
              "repeatVariable": "{{[e82479d4-8cb9-45f3-9929-79a8d45b2087].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8": {
            "nodeId": "9fc934ba-ecdc-42aa-98d0-20c73b2b9da8",
            "name": "Dig Lookup Reverse DNS",
            "type": "action",
            "plugin": {
              "name": "DNS",
              "slugVendor": "rapid7",
              "slugName": "dig",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/dig/2.0.0/icon.png"
            },
            "identifier": "reverse",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}",
                "resolver": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Internet address to resolve",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "resolver": {
                  "description": "Resolver. Leave blank to use default resolver for the system",
                  "order": 1,
                  "title": "Resolver",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "answer": {
                  "description": "Answer received",
                  "order": 4,
                  "title": "Answer",
                  "type": "string"
                },
                "fulloutput": {
                  "description": "Full DNS output",
                  "order": 1,
                  "title": "Full Output",
                  "type": "string"
                },
                "nameserver": {
                  "description": "Nameserver that fulfilled request",
                  "order": 3,
                  "title": "Nameserver",
                  "type": "string"
                },
                "question": {
                  "description": "Question asked",
                  "order": 5,
                  "title": "Question",
                  "type": "string"
                },
                "status": {
                  "description": "Query status [ NOERROR | FORMERR | NXDOMAIN | SERVFAIL | REFUSED ...]",
                  "order": 2,
                  "title": "Query Status",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a2f5b26e-51b8-4027-b295-29353fa3ab53": {
            "nodeId": "a2f5b26e-51b8-4027-b295-29353fa3ab53",
            "name": "Workflow Complete",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "ðŸš€  *Workflow Complete*  ðŸš€ ",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a55a5c03-1340-467d-9d71-07bfad1d072f": {
            "nodeId": "a55a5c03-1340-467d-9d71-07bfad1d072f",
            "name": "Valid Indicator",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
              "stepControlParams": [
                {
                  "edgeId": "b5f96b26-1161-4e5f-bdcd-f81fed879de4",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.ip_addresses.ipv4_addresses",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.ip_addresses.ipv6_addresses",
                              "type": "variable"
                            }
                          ],
                          "name": "length",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": 0
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "left": {
                            "args": [
                              {
                                "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.md5_hashes",
                                "type": "variable"
                              }
                            ],
                            "name": "length",
                            "type": "function"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": 0
                          },
                          "type": "binary"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "left": {
                              "args": [
                                {
                                  "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.sha1_hashes",
                                  "type": "variable"
                                }
                              ],
                              "name": "length",
                              "type": "function"
                            },
                            "op": "=",
                            "right": {
                              "type": "literal",
                              "value": 0
                            },
                            "type": "binary"
                          },
                          "op": "AND",
                          "right": {
                            "left": {
                              "left": {
                                "args": [
                                  {
                                    "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.hashes.sha256_hashes",
                                    "type": "variable"
                                  }
                                ],
                                "name": "length",
                                "type": "function"
                              },
                              "op": "=",
                              "right": {
                                "type": "literal",
                                "value": 0
                              },
                              "type": "binary"
                            },
                            "op": "AND",
                            "right": {
                              "left": {
                                "args": [
                                  {
                                    "name": "26b0afac-ca64-4f1c-99bf-22bd73b3c93f.indicators.domains",
                                    "type": "variable"
                                  }
                                ],
                                "name": "length",
                                "type": "function"
                              },
                              "op": "=",
                              "right": {
                                "type": "literal",
                                "value": 0
                              },
                              "type": "binary"
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv4_addresses]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[ip_addresses].[ipv6_addresses]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[md5_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha1_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha256_hashes]}}) = 0 && length({{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[domains]}}) = 0"
                },
                {
                  "edgeId": "f82389e9-aef8-4758-a1e7-99ebca8e2656",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd": {
            "nodeId": "b1292b2b-f1c9-4c02-b7d3-ce80e09047fd",
            "name": "URL Loop ",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "36b8c3d7-49d7-49fb-b91f-826a0e04d2aa",
              "nextEdgeId": "c2b72f99-d944-4846-a99a-ddbfb88cd701",
              "repeatVariable": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "b837ba56-7857-4940-b6b3-be880fcb0808": {
            "nodeId": "b837ba56-7857-4940-b6b3-be880fcb0808",
            "name": "Whois Lookup IP",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.1/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[e1840ac5-38a0-48c8-a465-c406e2772a35].[$item]}}",
                "registrar": "Autodetect"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "registrar": {
                  "default": "Autodetect",
                  "description": "Domain Registrar",
                  "enum": [
                    "Autodetect",
                    "RIPE",
                    "ARIN",
                    "LACNIC",
                    "APNIC"
                  ],
                  "order": 2,
                  "title": "Registrar",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "bb488a00-a927-455e-bfd2-b4a520ac7ca2": {
            "nodeId": "bb488a00-a927-455e-bfd2-b4a520ac7ca2",
            "name": "Hash Not Found Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Cymru malware hash analysis for: {{[9acb3237-d5f5-4a85-b46e-f08226513060].[$item]}}\n\nNo data on the hash was found."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "cf7d6a3f-91fb-4475-9a5d-c06203055ced": {
            "nodeId": "cf7d6a3f-91fb-4475-9a5d-c06203055ced",
            "name": "Invalid Input Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[channel_name]}}",
                "message_content": "Your message was not correctly formatted.<br>\nMessage format should be:<br>\n!enrich-indicator ValidIndicator<br>",
                "team_name": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[team_name]}}",
                "thread_id": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e1840ac5-38a0-48c8-a465-c406e2772a35": {
            "nodeId": "e1840ac5-38a0-48c8-a465-c406e2772a35",
            "name": "IP Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "5e82b957-21e8-40b2-8285-d4505c6c8cbf",
              "nextEdgeId": "bdaa18e1-466c-4dc3-829f-ed4cacf6b9c7",
              "repeatVariable": "{{[0a72bb10-b2b8-4976-b464-41f02ed9a67a].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e82479d4-8cb9-45f3-9929-79a8d45b2087": {
            "nodeId": "e82479d4-8cb9-45f3-9929-79a8d45b2087",
            "name": "Combine Hashes",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.7.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.7.0/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[md5_hashes]}}",
                "array2": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha1_hashes]}}",
                "array3": "{{[26b0afac-ca64-4f1c-99bf-22bd73b3c93f].[indicators].[hashes].[sha256_hashes]}}",
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": [
          "Microsoft",
          "Team_cymru",
          "Threat Intelligence",
          "Whois"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Team Name": {
                "type": "string",
                "description": "The Microsoft Teams team name where the workflow will be triggered and respond"
              },
              "Channel Name": {
                "type": "string",
                "description": "The Microsoft Teams channel name where the workflow will be triggered and respond"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "430af65a-c26a-4488-8fa4-bafd6a56da1d",
        "identifier": "new_message_received",
        "name": "Microsoft Teams Message",
        "description": "Trigger on MS Teams message\nE.X. !enrich-indicator <Command> <data>",
        "input": {
          "channel_name": "{{$workflow.[Channel Name]}}",
          "message_content": "!enrich-indicator",
          "team_name": "{{$workflow.[Team Name]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "words",
                "first_word"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.1.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
        }
      }
    ]
  }
}