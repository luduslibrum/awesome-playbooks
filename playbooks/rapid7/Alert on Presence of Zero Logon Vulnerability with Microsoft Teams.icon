{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T10:11:16.80294924Z",
    "workflowVersions": [
      {
        "name": "Alert on Presence of Zero Logon Vulnerability with Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow listens for InsightVM Webhook Events for newly discovered vulnerabilities, checks if a Zero Logon (CVE-2020-1472 or derivative) vulnerability is present, and if found, posts a notification to a Microsoft Teams channel.\n\nThis workflow helps Security and IT teams have awareness of this critical high-risk vulnerability. The Slack message posted includes a link to more information about the specific version of the vulnerability, along with host information regarding the vulnerable asset and the solution details for remediation.\n\n# Key Features\n\n* Heightened awareness of this critical vulnerability in your environment\n* VM Events trigger utilizes InsightVM's new webhook feature\n* Flexible workflow design allows for easy customization and updating for current vulnerabilities\n\n# Requirements\n\n* Insight Platform User API Key\n* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* InsightVM\n* InsightConnect\n\n# Documentation\n\n## Setup\n\n**In order to use this workflow, you will need to subscribe to the InsightVM Vulnerabilities Found webhook event. You will also need to adjust the Microsoft Teams team and channel names to match your environment.**\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nOnce the workflow has been imported, open the workflow and view the InsightVM Events trigger step. Save the trigger configuration step and proceed through the Instructions on subscribing to the InsightVM Vulnerabilities Found Webhook Event. This will require an [Insight Platform User API Key](https://docs.rapid7.com/insight/managing-platform-api-keys#generating-a-user-key). Insert your User API Key, copy the API request, run it from a command prompt, and look for a JSON response including an ID. If you receive a JSON response, then your webhook event subscription is active! Close your command prompt and return to the workflow in InsightConnect.\n\nAfter subscribing to the vulnerabilities found webhook event, return to the workflow editor and click the \"Loop over Found Vulnerabilities\" loop. Within the loop, click on the \"Post Message to Teams\" step, and change the Team and Channel fields from `change_me` to the desired team and channel for the Teams environment where you would like vulnerability notifications delivered. We recommend a private channel with representatives from security and remediation teams for the best visibility.\n\nAfter configuring Teams, activate the workflow. Any newly discovered vulnerability will generate a webhook event, which will trigger your workflow. If the vulnerability is a Zero Logon vulnerability or related, then the workflow will trigger a message with details to the specified Teams channel!\n\n### Adapting the Workflow to New Vulnerabilities\n\nBy default, the workflow detects specific vulnerabilities matching or containing the Zero Logon CVE: CVE-2020-1472. It can be easily updated for other pressing vulnerabilities by changing the ID within the \"Is Zero Logon?\" decision step within the \"Loop Over found Vulnerabilities\" loop. See InsightConnect's Help Documentation for more information on [using decision steps](https://docs.rapid7.com/insightconnect/lesson-4-use-decision-steps/#lesson-4-use-decision-steps) and on the [decision query language](https://docs.rapid7.com/insightconnect/format-query-language/#operators).\n \n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 Vulnerability & Exploit Database|2.0.3|1|\n|Microsoft Teams|3.1.0|1|\n\n## Troubleshooting\n\nExperiencing delays? InsightVM Events are delivered to InsightConnect from InsightVM as soon as the Insight platform is notified of a change by the on-premises InsightVM Security Console. This can take anywhere from 5 minutes to several hours. Please be patient!\n\n# Version History\n\n* 1.0.1 - Update Microsoft Teams to version 3.1.0\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 Vulnerability & Exploit Database](https://rapid7.com/db)\n* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-365/microsoft-teams/group-chat-software)\n* [InsightVM Events Trigger](https://docs.rapid7.com/insightconnect/set-up-an-insightvm-events-trigger)\n",
        "graph": {
          "edges": {
            "40d4f886-1a7d-483a-943c-243202b6e851": {
              "id": "40d4f886-1a7d-483a-943c-243202b6e851",
              "name": "Yes",
              "description": "The vulnerability is or is related to CVE-2020-1472",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "fromNodeId": "2237f3df-cc3d-49b3-8931-46bf256008f0",
              "toNodeId": "e9e722f0-be7c-44dd-ac16-0262f632fef5"
            },
            "5db52e06-8f01-45a6-9cd2-a7a330831c7f": {
              "id": "5db52e06-8f01-45a6-9cd2-a7a330831c7f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "79fddb0f-359c-4b94-98b1-cdd09e801247",
              "toNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2"
            },
            "69970e9f-6601-4d1c-b9ec-cc82a339d410": {
              "id": "69970e9f-6601-4d1c-b9ec-cc82a339d410",
              "name": "No",
              "description": "The vulnerability is not Zero Logon",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "fromNodeId": "2237f3df-cc3d-49b3-8931-46bf256008f0",
              "toNodeId": ""
            },
            "6cac6b9f-5c25-4746-8665-3ce28585b087": {
              "id": "6cac6b9f-5c25-4746-8665-3ce28585b087",
              "name": "",
              "description": "",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "fromNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "toNodeId": "2237f3df-cc3d-49b3-8931-46bf256008f0"
            },
            "7c523346-4c73-48db-9edf-8c7da839393d": {
              "id": "7c523346-4c73-48db-9edf-8c7da839393d",
              "name": "",
              "description": "",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "fromNodeId": "e9e722f0-be7c-44dd-ac16-0262f632fef5",
              "toNodeId": "c2a206de-5d98-4ff1-9cbd-fe227428ff60"
            },
            "8727cf8e-1b44-442f-bbff-c8119f30d6b5": {
              "id": "8727cf8e-1b44-442f-bbff-c8119f30d6b5",
              "name": "",
              "description": "",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "fromNodeId": "c2a206de-5d98-4ff1-9cbd-fe227428ff60",
              "toNodeId": ""
            },
            "eee7e2d5-3969-43a8-a80a-cffd54951981": {
              "id": "eee7e2d5-3969-43a8-a80a-cffd54951981",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "toNodeId": ""
            }
          },
          "nodes": {
            "06bd742c-d3a6-4f68-856c-75fafd2a89a2": {
              "id": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
              "parentNodeId": ""
            },
            "2237f3df-cc3d-49b3-8931-46bf256008f0": {
              "id": "2237f3df-cc3d-49b3-8931-46bf256008f0",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2"
            },
            "79fddb0f-359c-4b94-98b1-cdd09e801247": {
              "id": "79fddb0f-359c-4b94-98b1-cdd09e801247",
              "parentNodeId": ""
            },
            "c2a206de-5d98-4ff1-9cbd-fe227428ff60": {
              "id": "c2a206de-5d98-4ff1-9cbd-fe227428ff60",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2"
            },
            "e9e722f0-be7c-44dd-ac16-0262f632fef5": {
              "id": "e9e722f0-be7c-44dd-ac16-0262f632fef5",
              "parentNodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2"
            }
          }
        },
        "steps": {
          "06bd742c-d3a6-4f68-856c-75fafd2a89a2": {
            "nodeId": "06bd742c-d3a6-4f68-856c-75fafd2a89a2",
            "name": "Loop over Found Vulnerabilities",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "6cac6b9f-5c25-4746-8665-3ce28585b087",
              "nextEdgeId": "eee7e2d5-3969-43a8-a80a-cffd54951981",
              "repeatVariable": "{{[79fddb0f-359c-4b94-98b1-cdd09e801247].[changes].[asset_vulnerabilities_found]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "2237f3df-cc3d-49b3-8931-46bf256008f0": {
            "nodeId": "2237f3df-cc3d-49b3-8931-46bf256008f0",
            "name": "Is Zero Logon?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "69970e9f-6601-4d1c-b9ec-cc82a339d410",
              "stepControlParams": [
                {
                  "edgeId": "40d4f886-1a7d-483a-943c-243202b6e851",
                  "expression": {
                    "left": {
                      "name": "06bd742c-d3a6-4f68-856c-75fafd2a89a2.$item",
                      "type": "variable"
                    },
                    "op": "contains",
                    "right": {
                      "type": "literal",
                      "value": "cve-2020-1472"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[06bd742c-d3a6-4f68-856c-75fafd2a89a2].[$item]}} contains \"cve-2020-1472\""
                },
                {
                  "edgeId": "69970e9f-6601-4d1c-b9ec-cc82a339d410",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "79fddb0f-359c-4b94-98b1-cdd09e801247": {
            "nodeId": "79fddb0f-359c-4b94-98b1-cdd09e801247",
            "name": "Found Vulnerability",
            "description": "A vulnerability was found on an asset.",
            "type": "trigger",
            "identifier": "vulnerabilities_found",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "329eb204-45ca-4e3f-b522-63715f8c26aa",
            "defaultInputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-vm.svg",
            "connectionType": "NONE"
          },
          "c2a206de-5d98-4ff1-9cbd-fe227428ff60": {
            "nodeId": "c2a206de-5d98-4ff1-9cbd-fe227428ff60",
            "name": "Post Message to Teams",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "<b>🚨 ZERO LOGON VULNERABILITY DETECTED! 🚨</b><br>\n<h2>☢️ Vulnerability Details: ☢️</h2> \n<blockquote>\n<ul>\n    <li><b>Title: </b>{{[e9e722f0-be7c-44dd-ac16-0262f632fef5].[content_result].[title]}}</li>\n    <li><b>CVSS Score:</b> {{[e9e722f0-be7c-44dd-ac16-0262f632fef5].[content_result].[severity]}}</li>\n    <li><b>More Details:</b> <a href=\"https://www.rapid7.com/db/vulnerabilities/{{[06bd742c-d3a6-4f68-856c-75fafd2a89a2].[$item]}}\">{{[06bd742c-d3a6-4f68-856c-75fafd2a89a2].[$item]}}</a></li>\n</ul>\n</blockquote>\n\n<h2>🖥 Asset Details: 🖥</h2>\n<blockquote>\n<ul>\n    <li><b>Hostname:</b> {{[79fddb0f-359c-4b94-98b1-cdd09e801247].[summary].[host_name]}}</li>\n    <li><b>IP Address:</b> {{[79fddb0f-359c-4b94-98b1-cdd09e801247].[summary].[ip]}}</li>\n    <li><b>Operating System:</b> {{[79fddb0f-359c-4b94-98b1-cdd09e801247].[summary].[operating_system]}}</li>\n    <li><b>Last Scanned:</b> {{[79fddb0f-359c-4b94-98b1-cdd09e801247].[summary].[last_scanned]}}</li>\n</ul>\n</blockquote>",
                "team_name": "change_me",
                "thread_id": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e9e722f0-be7c-44dd-ac16-0262f632fef5": {
            "nodeId": "e9e722f0-be7c-44dd-ac16-0262f632fef5",
            "name": "Find More Vuln Information",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.0.3/icon.png"
            },
            "identifier": "get_content",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "identifier": "{{[06bd742c-d3a6-4f68-856c-75fafd2a89a2].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "identifier": {
                  "description": "Rapid7 vulnerability/module identifier",
                  "order": 1,
                  "title": "Identifier",
                  "type": "string"
                }
              },
              "required": [
                "identifier"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "content": {
                  "properties": {
                    "alternate_ids": {
                      "description": "List of alternative identifiers for the vulnerability",
                      "order": 12,
                      "title": "Alternative Identifiers",
                      "type": "string"
                    },
                    "architectures": {
                      "description": "List of applicable architectures for the module",
                      "order": 4,
                      "title": "architectures",
                      "type": "string"
                    },
                    "authors": {
                      "description": "List of module authors",
                      "order": 7,
                      "title": "Authors",
                      "type": "string"
                    },
                    "content_type": {
                      "description": "Type of returned content for module or vulnerability",
                      "order": 3,
                      "title": "Content type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Brief summary of the returned content",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 5,
                      "title": "Published_at",
                      "type": "string"
                    },
                    "rank": {
                      "description": "Rank of module",
                      "order": 8,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "references": {
                      "description": "List of references",
                      "order": 6,
                      "title": "References",
                      "type": "string"
                    },
                    "reliability": {
                      "description": "Reliability of module",
                      "order": 9,
                      "title": "Reliability",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity of vulnerability",
                      "order": 10,
                      "title": "Severity",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 11,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of Vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                }
              },
              "properties": {
                "content_result": {
                  "$ref": "#/definitions/content",
                  "description": "Content record for the vulnerability or module",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "content_result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": [
          "Alerting & Notifications",
          "Microsoft",
          "Rapid7",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 600,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "329eb204-45ca-4e3f-b522-63715f8c26aa",
        "identifier": "vulnerabilities_found",
        "name": "Found Vulnerability",
        "description": "A vulnerability was found on an asset.",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_vm_webhook"
      }
    ]
  }
}