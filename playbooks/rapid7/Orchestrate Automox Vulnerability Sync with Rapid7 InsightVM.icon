{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:54:41.236910843Z",
    "workflowVersions": [
      {
        "name": "Orchestrate Automox Vulnerability Sync with Rapid7 InsightVM",
        "type": "runnable",
        "version": "",
        "description": "# Description\nOrchestrate the remediation of high risk vulnerabilities by generating and uploading scan reports from InsightVM to\nAutomox Vulnerability Sync in order to stage or immediately remediate vulnerabilities and reduce risk. \n\nThis workflow connects vulnerability and patch management programs by reducing the need to manually send vulnerability \nreports between Security and IT Operations teams. By automating a frequently tedious and high-friction process, teams \nare able to reduce mean-time-to-remediation, decrease environment risk, and improve their endpoint and patch management\nprocesses.\n\n# Key Features\n\n* Connect vulnerability and patch management programs with a single workflow\n* Immediately create remediation tasks within Automox based on InsightVM scan results\n* Automatically apply patches to remediate faster and reduce environment risks\n\n# Requirements\n\n* Automox API key\n* InsightVM Console URL and account credentials\n* InsightConnect license\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. \nImport plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThere are three workflow parameters you will need to configure in order to complete setup of your workflow:\n* `Automox Organization ID`: The identifier of the Automox organization.\n* `CVEs in Scope`: Comma separated list of CVEs in scope for immediate remediation between InsightVM and Automox.\n* `Auto-Approve Tasks`: Whether to auto-approve and apply patches for identified vulnerabilities immediately.\n\n## Usage\n\n*This workflow will only trigger on the successful completion of an InsightVM scan.*\n\nOnce configured, the workflow does not need manual intervention for it to run. On successful completion of an InsightVM\nscan, a scoped report based on both the scan ID and CVE IDs will be generated and uploaded to Automox. If the \nauto-approval of tasks workflow parameter is enabled, patches will be immediately applied to the matched hosts.\n\nThe workflow will complete with a `Final Report` artifact detailing the outcome of the job, as well as links to the\nresulting Automox Vulnerability Sync batch and tasks.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Automox|1.1.0|6|\n|Rapid7 InsightVM Console|4.9.1|2|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Automox](https://www.automox.com/)\n* [Rapid7 InsightVM](https://www.rapid7.com/products/insightvm)\n",
        "graph": {
          "edges": {
            "1b91bbbf-6746-4d95-9682-3e19838a165b": {
              "id": "1b91bbbf-6746-4d95-9682-3e19838a165b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "toNodeId": "971630a0-76f7-4185-9a7b-3949861f0e4f"
            },
            "21db8063-71de-4b9d-b869-79c244c16ebe": {
              "id": "21db8063-71de-4b9d-b869-79c244c16ebe",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f0679411-f3b9-4313-9861-e4a85d81a39c",
              "toNodeId": ""
            },
            "25c493d3-b394-4bf7-bd05-9a879d4496eb": {
              "id": "25c493d3-b394-4bf7-bd05-9a879d4496eb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8a4fd5f4-9dfa-499c-9aea-71e3236bd354",
              "toNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3"
            },
            "2f549550-456f-4aaf-80d2-6d2aa2251355": {
              "id": "2f549550-456f-4aaf-80d2-6d2aa2251355",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a57e6a0d-3627-43d2-9970-19d70b22913e",
              "toNodeId": "f0679411-f3b9-4313-9861-e4a85d81a39c"
            },
            "483a8ceb-84e2-4045-975a-0341674b6302": {
              "id": "483a8ceb-84e2-4045-975a-0341674b6302",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "819629f9-4928-4a65-b56d-8199a44f492c",
              "toNodeId": "646ad287-543b-4893-901f-e9dc8bb1b13f"
            },
            "5e7f1cc8-8867-43dd-b667-587e7f1ac2c2": {
              "id": "5e7f1cc8-8867-43dd-b667-587e7f1ac2c2",
              "name": "No",
              "description": "The batch did not move to status awaiting_approval in the defined amount of time.",
              "parentNodeId": "",
              "fromNodeId": "971630a0-76f7-4185-9a7b-3949861f0e4f",
              "toNodeId": "81fa8c7a-fa16-4340-beea-34e10cec9d44"
            },
            "66a9f15c-b7ea-492b-9ace-e18bb9c989bd": {
              "id": "66a9f15c-b7ea-492b-9ace-e18bb9c989bd",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "646ad287-543b-4893-901f-e9dc8bb1b13f",
              "toNodeId": "194fd578-7bc4-4c65-b4d3-27f5efacd20e"
            },
            "77a22dca-42e4-4bce-807c-30940e2d67b9": {
              "id": "77a22dca-42e4-4bce-807c-30940e2d67b9",
              "name": "",
              "description": "",
              "parentNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
              "fromNodeId": "0752dc97-0058-4448-afce-7cd022b45a19",
              "toNodeId": ""
            },
            "8e7834b3-e7db-4191-8b47-92e14a806b25": {
              "id": "8e7834b3-e7db-4191-8b47-92e14a806b25",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "45965192-f584-4270-ade0-72eab2733033",
              "toNodeId": "134b99d2-c08a-4b95-a9ef-39ce923a22ef"
            },
            "9a87055f-ea37-4e4d-9f68-9721c901bd52": {
              "id": "9a87055f-ea37-4e4d-9f68-9721c901bd52",
              "name": "Yes",
              "description": "The batch is awaiting_approval and the workflow can continue.",
              "parentNodeId": "",
              "fromNodeId": "971630a0-76f7-4185-9a7b-3949861f0e4f",
              "toNodeId": "819629f9-4928-4a65-b56d-8199a44f492c"
            },
            "a348ca3e-aeda-40fa-b3d6-69f2aaea6a4f": {
              "id": "a348ca3e-aeda-40fa-b3d6-69f2aaea6a4f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ada4fa79-adeb-492c-ac27-cf676cc1d6c7",
              "toNodeId": "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7"
            },
            "a589986f-bb91-4f76-9a71-95e5cfd04398": {
              "id": "a589986f-bb91-4f76-9a71-95e5cfd04398",
              "name": "",
              "description": "",
              "parentNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "fromNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "toNodeId": "edc5a035-022d-4fa0-a946-368f0fad88bd"
            },
            "b585388a-d816-42ac-913c-7385be5ccac3": {
              "id": "b585388a-d816-42ac-913c-7385be5ccac3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "81fa8c7a-fa16-4340-beea-34e10cec9d44",
              "toNodeId": ""
            },
            "ba19a4c0-4554-44c1-a5c3-3394f76f0e1c": {
              "id": "ba19a4c0-4554-44c1-a5c3-3394f76f0e1c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "194fd578-7bc4-4c65-b4d3-27f5efacd20e",
              "toNodeId": "45965192-f584-4270-ade0-72eab2733033"
            },
            "be42e05f-caea-4439-b87b-b75101e8d71a": {
              "id": "be42e05f-caea-4439-b87b-b75101e8d71a",
              "name": "",
              "description": "",
              "parentNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
              "fromNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
              "toNodeId": "0752dc97-0058-4448-afce-7cd022b45a19"
            },
            "d0ea7522-64e3-4445-97d2-e8693658b1af": {
              "id": "d0ea7522-64e3-4445-97d2-e8693658b1af",
              "name": "",
              "description": "",
              "parentNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "fromNodeId": "edc5a035-022d-4fa0-a946-368f0fad88bd",
              "toNodeId": "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d"
            },
            "daf69a50-f91c-4391-937d-dd5539f9db84": {
              "id": "daf69a50-f91c-4391-937d-dd5539f9db84",
              "name": "",
              "description": "",
              "parentNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "fromNodeId": "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d",
              "toNodeId": ""
            },
            "dfdb43b3-ad56-4eb0-a9ed-e30c777e902d": {
              "id": "dfdb43b3-ad56-4eb0-a9ed-e30c777e902d",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "134b99d2-c08a-4b95-a9ef-39ce923a22ef",
              "toNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4"
            },
            "e8de53f1-b103-486e-a348-690cf0c98156": {
              "id": "e8de53f1-b103-486e-a348-690cf0c98156",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "134b99d2-c08a-4b95-a9ef-39ce923a22ef",
              "toNodeId": "a57e6a0d-3627-43d2-9970-19d70b22913e"
            },
            "f67a8ebc-2b87-4b6f-bd3a-3c7d714697f5": {
              "id": "f67a8ebc-2b87-4b6f-bd3a-3c7d714697f5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
              "toNodeId": "a57e6a0d-3627-43d2-9970-19d70b22913e"
            },
            "f752736e-d12e-402e-8596-48485aca3db1": {
              "id": "f752736e-d12e-402e-8596-48485aca3db1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7",
              "toNodeId": "8a4fd5f4-9dfa-499c-9aea-71e3236bd354"
            }
          },
          "nodes": {
            "0752dc97-0058-4448-afce-7cd022b45a19": {
              "id": "0752dc97-0058-4448-afce-7cd022b45a19",
              "parentNodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4"
            },
            "134b99d2-c08a-4b95-a9ef-39ce923a22ef": {
              "id": "134b99d2-c08a-4b95-a9ef-39ce923a22ef",
              "parentNodeId": ""
            },
            "194fd578-7bc4-4c65-b4d3-27f5efacd20e": {
              "id": "194fd578-7bc4-4c65-b4d3-27f5efacd20e",
              "parentNodeId": ""
            },
            "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4": {
              "id": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
              "parentNodeId": ""
            },
            "45965192-f584-4270-ade0-72eab2733033": {
              "id": "45965192-f584-4270-ade0-72eab2733033",
              "parentNodeId": ""
            },
            "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7": {
              "id": "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7",
              "parentNodeId": ""
            },
            "646ad287-543b-4893-901f-e9dc8bb1b13f": {
              "id": "646ad287-543b-4893-901f-e9dc8bb1b13f",
              "parentNodeId": ""
            },
            "819629f9-4928-4a65-b56d-8199a44f492c": {
              "id": "819629f9-4928-4a65-b56d-8199a44f492c",
              "parentNodeId": ""
            },
            "81fa8c7a-fa16-4340-beea-34e10cec9d44": {
              "id": "81fa8c7a-fa16-4340-beea-34e10cec9d44",
              "parentNodeId": ""
            },
            "8a4fd5f4-9dfa-499c-9aea-71e3236bd354": {
              "id": "8a4fd5f4-9dfa-499c-9aea-71e3236bd354",
              "parentNodeId": ""
            },
            "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d": {
              "id": "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d",
              "parentNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3"
            },
            "971630a0-76f7-4185-9a7b-3949861f0e4f": {
              "id": "971630a0-76f7-4185-9a7b-3949861f0e4f",
              "parentNodeId": ""
            },
            "a57e6a0d-3627-43d2-9970-19d70b22913e": {
              "id": "a57e6a0d-3627-43d2-9970-19d70b22913e",
              "parentNodeId": ""
            },
            "ada4fa79-adeb-492c-ac27-cf676cc1d6c7": {
              "id": "ada4fa79-adeb-492c-ac27-cf676cc1d6c7",
              "parentNodeId": ""
            },
            "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3": {
              "id": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
              "parentNodeId": ""
            },
            "edc5a035-022d-4fa0-a946-368f0fad88bd": {
              "id": "edc5a035-022d-4fa0-a946-368f0fad88bd",
              "parentNodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3"
            },
            "f0679411-f3b9-4313-9861-e4a85d81a39c": {
              "id": "f0679411-f3b9-4313-9861-e4a85d81a39c",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0752dc97-0058-4448-afce-7cd022b45a19": {
            "nodeId": "0752dc97-0058-4448-afce-7cd022b45a19",
            "name": "Execute Vulnerability Sync Task",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "action_on_vulnerability_sync_task",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "execute",
                "org_id": "{{$workflow.[Automox Organization ID]}}",
                "task_id": "{{[2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4].[$item].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "description": "Action to take on vulnerability sync task",
                  "enum": [
                    "execute",
                    "cancel"
                  ],
                  "order": 3,
                  "title": "Action",
                  "type": "string"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                },
                "task_id": {
                  "description": "Identifier of task",
                  "order": 2,
                  "title": "Task ID",
                  "type": "integer"
                }
              },
              "required": [
                "org_id",
                "task_id",
                "action"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "134b99d2-c08a-4b95-a9ef-39ce923a22ef": {
            "nodeId": "134b99d2-c08a-4b95-a9ef-39ce923a22ef",
            "name": "Auto Approve Tasks",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e8de53f1-b103-486e-a348-690cf0c98156",
              "stepControlParams": [
                {
                  "edgeId": "dfdb43b3-ad56-4eb0-a9ed-e30c777e902d",
                  "expression": {
                    "name": "$workflow.Auto-Approve Tasks",
                    "type": "variable"
                  },
                  "expressionText": "{{$workflow.[Auto-Approve Tasks]}}"
                },
                {
                  "edgeId": "e8de53f1-b103-486e-a348-690cf0c98156",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "194fd578-7bc4-4c65-b4d3-27f5efacd20e": {
            "nodeId": "194fd578-7bc4-4c65-b4d3-27f5efacd20e",
            "name": "Approve Vulnerability Sync Batch",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "action_on_vulnerability_sync_batch",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "accept",
                "batch_id": "{{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[id]}}",
                "org_id": "{{$workflow.[Automox Organization ID]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "description": "Action to take on batch",
                  "enum": [
                    "accept",
                    "reject"
                  ],
                  "order": 3,
                  "title": "Action",
                  "type": "string"
                },
                "batch_id": {
                  "description": "Identifier of batch",
                  "order": 2,
                  "title": "Batch ID",
                  "type": "integer"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                }
              },
              "required": [
                "batch_id",
                "action",
                "org_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4": {
            "nodeId": "2269fe6b-6d2a-4567-a09f-b0ae6d8f0ec4",
            "name": "Iterate Tasks",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "be42e05f-caea-4439-b87b-b75101e8d71a",
              "nextEdgeId": "f67a8ebc-2b87-4b6f-bd3a-3c7d714697f5",
              "repeatVariable": "{{[45965192-f584-4270-ade0-72eab2733033].[tasks]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "45965192-f584-4270-ade0-72eab2733033": {
            "nodeId": "45965192-f584-4270-ade0-72eab2733033",
            "name": "Retrieve Vulnerability Sync Tasks for Batch",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "list_vulnerability_sync_tasks",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "batch_id": "{{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[id]}}",
                "org_id": "{{$workflow.[Automox Organization ID]}}",
                "status": "pending"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "batch_id": {
                  "description": "Filter by batch identifier",
                  "order": 3,
                  "title": "Batch ID",
                  "type": "integer"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                },
                "status": {
                  "description": "Filter by status of tasks",
                  "order": 2,
                  "title": "Status",
                  "type": "string"
                }
              },
              "required": [
                "org_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "batch_user": {
                  "properties": {
                    "email": {
                      "description": "The email of the user",
                      "order": 4,
                      "title": "Email",
                      "type": "string"
                    },
                    "firstname": {
                      "description": "The first name of the user",
                      "order": 2,
                      "title": "First Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "The user identifier",
                      "order": 1,
                      "title": "User ID",
                      "type": "integer"
                    },
                    "lastname": {
                      "description": "The last name of the user",
                      "order": 3,
                      "title": "Last Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Batch User",
                  "type": "object"
                },
                "task": {
                  "properties": {
                    "completed_at": {
                      "description": "The datetime the task was completed",
                      "order": 12,
                      "title": "Completed At",
                      "type": "string"
                    },
                    "created_at": {
                      "description": "The datetime the task was created",
                      "order": 10,
                      "title": "Created At",
                      "type": "string"
                    },
                    "created_by_user": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Task creation details",
                      "order": 8,
                      "title": "Created by User"
                    },
                    "cves": {
                      "description": "List of CVEs associated with task",
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of task",
                      "order": 1,
                      "title": "Task ID",
                      "type": "integer"
                    },
                    "last_updated_by_user": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Task update details",
                      "order": 9,
                      "title": "Updated by User"
                    },
                    "notes": {
                      "description": "Notes associated with task",
                      "order": 6,
                      "title": "Task Notes",
                      "type": "string"
                    },
                    "organization_id": {
                      "description": "Identifier of organization",
                      "order": 2,
                      "title": "Organization ID",
                      "type": "integer"
                    },
                    "payload": {
                      "$ref": "#/definitions/task_payload",
                      "description": "Payload associated with task",
                      "order": 4,
                      "title": "Payload"
                    },
                    "report_source": {
                      "description": "The source of the vulnerability report",
                      "order": 14,
                      "title": "Report Source",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source of task",
                      "order": 5,
                      "title": "Task Source",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status of task",
                      "order": 7,
                      "title": "Task Status",
                      "type": "string"
                    },
                    "task_type": {
                      "description": "Type of task",
                      "order": 3,
                      "title": "Task Type",
                      "type": "string"
                    },
                    "updated_at": {
                      "description": "The datetime the task was updated",
                      "order": 11,
                      "title": "Updated At",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Task",
                  "type": "object"
                },
                "task_payload": {
                  "properties": {
                    "package_versions": {
                      "description": "The version of the packages within scope of the task",
                      "items": {
                        "$ref": "#/definitions/task_payload_package_versions"
                      },
                      "order": 3,
                      "title": "Package Versions",
                      "type": "array"
                    },
                    "patch_id": {
                      "description": "The patch identifier associated with the task",
                      "order": 1,
                      "title": "Patch ID",
                      "type": "string"
                    },
                    "severity": {
                      "description": "The severity of the patch associated with the task",
                      "order": 2,
                      "title": "Severity",
                      "type": "string"
                    }
                  },
                  "title": "Task Payload",
                  "type": "object"
                },
                "task_payload_package_versions": {
                  "properties": {
                    "display_name": {
                      "description": "The display name of the package associated with the task",
                      "order": 4,
                      "title": "Display Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "The package identifier associated with the task",
                      "order": 1,
                      "title": "Package ID",
                      "type": "string"
                    },
                    "name": {
                      "description": "The name of the package associated with the task",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "requires_reboot": {
                      "description": "Whether the package installed by the task will require reboot",
                      "order": 5,
                      "title": "Requires Reboot",
                      "type": "boolean"
                    },
                    "version": {
                      "description": "The version of the package associated with the task",
                      "order": 3,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Task Payload Package Versions",
                  "type": "object"
                }
              },
              "properties": {
                "tasks": {
                  "description": "List of vulnerability sync tasks",
                  "items": {
                    "$ref": "#/definitions/task"
                  },
                  "order": 1,
                  "title": "Vulnerability Sync Tasks",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7": {
            "nodeId": "4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7",
            "name": "Generate CVE Report",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "generate_adhoc_sql_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "filters": "{}",
                "query": "select favf.asset_id, favf.vulnerability_id, SUBSTRING(da.host_name,1,POSITION('.' IN da.host_name)-1) as hostname, dvf.reference as \"cve id\"\nFROM fact_asset_vulnerability_finding favf\nJOIN dim_vulnerability_reference dvf ON dvf.vulnerability_id = favf.vulnerability_id\nJOIN dim_asset da ON da.asset_id = favf.asset_id\nWHERE dvf.source = 'CVE' AND\ndvf.reference IN ({{$workflow.[CVEs in Scope]}})",
                "scope": "none",
                "scope_ids": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filters": {
                  "default": "{}",
                  "description": "Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options",
                  "order": 4,
                  "title": "Report Filters",
                  "type": "string"
                },
                "query": {
                  "description": "Reporting Data Model SQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "scope": {
                  "default": "none",
                  "description": "Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input",
                  "enum": [
                    "none",
                    "assets",
                    "assetGroups",
                    "sites",
                    "tags",
                    "scan"
                  ],
                  "order": 2,
                  "title": "Scope",
                  "type": "string"
                },
                "scope_ids": {
                  "default": [],
                  "description": "Scope IDs for which tickets should be generated, by default all are included",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "Scope IDs",
                  "type": "array"
                }
              },
              "required": [
                "query",
                "scope"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file",
                  "description": "Base64 encoded file making up the report",
                  "order": 1,
                  "title": "Base64 Encoded Report"
                }
              },
              "required": [
                "report"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "646ad287-543b-4893-901f-e9dc8bb1b13f": {
            "nodeId": "646ad287-543b-4893-901f-e9dc8bb1b13f",
            "name": "Batch Details",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The Automox batch generated from report `insightconnect-uploaded-report-scan-{{[ada4fa79-adeb-492c-ac27-cf676cc1d6c7].[scan].[id]}}.csv` resulted in the following details.\n\n**CVE Count:** {{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[cve_count]}}\n**Task Count:** {{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[task_count]}}\n**Issue Count:** {{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[issue_count]}}\n\nThe Automox Vulnerability Sync batch ID `{{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[id]}}` will be automatically approved to generate remediation tasks."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "819629f9-4928-4a65-b56d-8199a44f492c": {
            "nodeId": "819629f9-4928-4a65-b56d-8199a44f492c",
            "name": "Retrieve Vulnerability Sync Batch",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "get_vulnerability_sync_batch",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "batch_id": "{{[8a4fd5f4-9dfa-499c-9aea-71e3236bd354].[batch_id]}}",
                "org_id": "{{$workflow.[Automox Organization ID]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "batch_id": {
                  "description": "Identifier of batch",
                  "order": 2,
                  "title": "Batch ID",
                  "type": "integer"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                }
              },
              "required": [
                "org_id",
                "batch_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "batch": {
                  "properties": {
                    "created_by": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Batch creation details",
                      "order": 5,
                      "title": "Created By"
                    },
                    "cve_count": {
                      "description": "Number of CVEs that are impacted by batch",
                      "order": 12,
                      "title": "CVE Count",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Identifier of batch",
                      "order": 1,
                      "title": "Batch ID",
                      "type": "integer"
                    },
                    "impacted_device_count": {
                      "description": "Number of devices that are impacted by batch",
                      "order": 10,
                      "title": "Impacted Device Count",
                      "type": "integer"
                    },
                    "issue_count": {
                      "description": "Number of issues identified with batch",
                      "order": 11,
                      "title": "Issue Count",
                      "type": "integer"
                    },
                    "organization_id": {
                      "description": "Identifier of organization",
                      "order": 2,
                      "title": "Organization ID",
                      "type": "integer"
                    },
                    "source": {
                      "description": "Source of batch",
                      "order": 4,
                      "title": "Batch Source",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status of batch",
                      "order": 3,
                      "title": "Batch Status",
                      "type": "string"
                    },
                    "task_count": {
                      "description": "Number of tasks related to batch",
                      "order": 8,
                      "title": "Task Count",
                      "type": "integer"
                    },
                    "unknown_host_count": {
                      "description": "Number of hosts that are unknown within batch",
                      "order": 9,
                      "title": "Unknown Host Count",
                      "type": "integer"
                    },
                    "updated_by": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Batch update details",
                      "order": 6,
                      "title": "Updated By"
                    },
                    "uploaded_at": {
                      "description": "Datetime the batch was uploaded",
                      "order": 7,
                      "title": "Uploaded At",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Batch",
                  "type": "object"
                },
                "batch_user": {
                  "properties": {
                    "email": {
                      "description": "The email of the user",
                      "order": 4,
                      "title": "Email",
                      "type": "string"
                    },
                    "firstname": {
                      "description": "The first name of the user",
                      "order": 2,
                      "title": "First Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "The user identifier",
                      "order": 1,
                      "title": "User ID",
                      "type": "integer"
                    },
                    "lastname": {
                      "description": "The last name of the user",
                      "order": 3,
                      "title": "Last Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Batch User",
                  "type": "object"
                }
              },
              "properties": {
                "batch": {
                  "$ref": "#/definitions/batch",
                  "description": "Details of a specified vulnerability sync batch",
                  "order": 1,
                  "title": "Vulnerability Sync Batch"
                }
              },
              "required": [
                "batch"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "81fa8c7a-fa16-4340-beea-34e10cec9d44": {
            "nodeId": "81fa8c7a-fa16-4340-beea-34e10cec9d44",
            "name": "Failure Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The workflow failed to generate and upload the InsightVM report to Automox for remediation.\nInsightVM scan ID: `{{[ada4fa79-adeb-492c-ac27-cf676cc1d6c7].[scan].[id]}}`\nCVEs: {{$workflow.[CVEs in Scope]}}\nAutomox Organization ID `{{$workflow.[Automox Organization ID]}}`.\n\nPlease review any errors resulting from the report generation or upload to Automox prior to continuing."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8a4fd5f4-9dfa-499c-9aea-71e3236bd354": {
            "nodeId": "8a4fd5f4-9dfa-499c-9aea-71e3236bd354",
            "name": "Upload CSV Report to Automox",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "upload_vulnerability_sync_file",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "csv_file": "{{[4c1bdfab-c762-4aa6-8e3d-2692f09aa4a7].[report].[content]}}",
                "csv_file_name": "insightconnect-uploaded-report-scan-{{[ada4fa79-adeb-492c-ac27-cf676cc1d6c7].[scan].[id]}}.csv",
                "org_id": "{{$workflow.[Automox Organization ID]}}",
                "report_source": "Rapid7"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "csv_file": {
                  "description": "Base64 encoded CSV data from which to create the vulnerability sync batch",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "CSV File",
                  "type": "string"
                },
                "csv_file_name": {
                  "default": "insightconnect-uploaded-report.csv",
                  "description": "Name for CSV file uploaded and shown within Automox",
                  "order": 3,
                  "title": "CSV File Name",
                  "type": "string"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                },
                "report_source": {
                  "default": "Generic Report",
                  "description": "The third-party source of the vulnerability report",
                  "enum": [
                    "Generic Report",
                    "CrowdStrike",
                    "Rapid7",
                    "TenableIO",
                    "Qualys"
                  ],
                  "order": 4,
                  "title": "Report Source",
                  "type": "string"
                }
              },
              "required": [
                "org_id",
                "csv_file"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "batch_id": {
                  "description": "Identifier of vulnerability sync batch",
                  "order": 1,
                  "title": "Vulnerability Sync Batch ID",
                  "type": "integer"
                }
              },
              "required": [
                "batch_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d": {
            "nodeId": "8f4d0f1b-fcbf-4cf2-a1d4-bdf44294f51d",
            "name": "Batch Awaiting Approval",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "daf69a50-f91c-4391-937d-dd5539f9db84",
                "expression": {
                  "left": {
                    "name": "edc5a035-022d-4fa0-a946-368f0fad88bd.batch.status",
                    "type": "variable"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "awaiting_approval"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[edc5a035-022d-4fa0-a946-368f0fad88bd].[batch].[status]}} = \"awaiting_approval\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "971630a0-76f7-4185-9a7b-3949861f0e4f": {
            "nodeId": "971630a0-76f7-4185-9a7b-3949861f0e4f",
            "name": "Batch Ready for Processing",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "5e7f1cc8-8867-43dd-b667-587e7f1ac2c2",
              "stepControlParams": [
                {
                  "edgeId": "5e7f1cc8-8867-43dd-b667-587e7f1ac2c2",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9a87055f-ea37-4e4d-9f68-9721c901bd52",
                  "expression": {
                    "name": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3.Batch Awaiting Approval?",
                    "type": "variable"
                  },
                  "expressionText": "{{[bdc5b3e1-312b-43d8-96f5-d05bf87b06b3].[Batch Awaiting Approval?]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a57e6a0d-3627-43d2-9970-19d70b22913e": {
            "nodeId": "a57e6a0d-3627-43d2-9970-19d70b22913e",
            "name": "Join for Final Report",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "e8de53f1-b103-486e-a348-690cf0c98156",
                "f67a8ebc-2b87-4b6f-bd3a-3c7d714697f5"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "ada4fa79-adeb-492c-ac27-cf676cc1d6c7": {
            "nodeId": "ada4fa79-adeb-492c-ac27-cf676cc1d6c7",
            "name": "Trigger on Successful InsightVM Scans",
            "description": "Trigger workflow on any new InsightVM scans that have completed and are successful.",
            "type": "trigger",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "new_scans",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "frequency": 5,
                "most_recent_scan": true,
                "site_name_filter": ".*",
                "status_filter": [
                  "Successful"
                ]
              }
            },
            "triggerId": "88ba3da3-7d50-444c-a5b1-db2d431027ab",
            "defaultInputJSONSchema": {
              "properties": {
                "frequency": {
                  "default": 5,
                  "description": "How often the trigger should check for new scans in minutes",
                  "order": 1,
                  "title": "Frequency",
                  "type": "integer"
                },
                "most_recent_scan": {
                  "default": true,
                  "description": "Only process the most recent scan for a site since the last time the trigger was run",
                  "order": 3,
                  "title": "Most Recent Scan Only",
                  "type": "boolean"
                },
                "site_name_filter": {
                  "default": ".*",
                  "description": "Regular expression to match sites where new scans should be triggered",
                  "order": 2,
                  "title": "Site Name Filter",
                  "type": "string"
                },
                "status_filter": {
                  "default": [
                    "Successful"
                  ],
                  "description": "List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Status Filter",
                  "type": "array"
                }
              },
              "required": [
                "most_recent_scan",
                "frequency",
                "site_name_filter"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "scan": {
                  "properties": {
                    "assets": {
                      "description": "Count of assets identified during the scan",
                      "order": 3,
                      "title": "Assets",
                      "type": "integer"
                    },
                    "duration": {
                      "description": "Duration of the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 11,
                      "title": "Duration",
                      "type": "string"
                    },
                    "endTime": {
                      "description": "End time of the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 14,
                      "title": "End Time",
                      "type": "string"
                    },
                    "engineId": {
                      "description": "ID for the scan engine/scan engine pool used for the scan",
                      "order": 8,
                      "title": "Engine ID",
                      "type": "integer"
                    },
                    "engineName": {
                      "description": "Name of the scan engine/scan engine pool used for the scan",
                      "order": 12,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID of the scan",
                      "order": 15,
                      "title": "ID",
                      "type": "integer"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "message": {
                      "description": "Scan status message",
                      "order": 13,
                      "title": "Message",
                      "type": "string"
                    },
                    "scanName": {
                      "description": "Name of the scan",
                      "order": 16,
                      "title": "Scan Name",
                      "type": "string"
                    },
                    "scanType": {
                      "description": "Type of scan (automated, manual, scheduled)",
                      "order": 2,
                      "title": "Scan Type",
                      "type": "string"
                    },
                    "siteId": {
                      "description": "ID of the site scanned",
                      "order": 9,
                      "title": "Site ID",
                      "type": "integer"
                    },
                    "siteName": {
                      "description": "Name of the site scanned",
                      "order": 5,
                      "title": "Site Name",
                      "type": "string"
                    },
                    "startTime": {
                      "description": "Start time for the scan",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 10,
                      "title": "Start Time",
                      "type": "string"
                    },
                    "startedBy": {
                      "description": "User that started the scan",
                      "order": 7,
                      "title": "Started By",
                      "type": "string"
                    },
                    "status": {
                      "description": "Scan status (aborted, unknown, running, finished, stopped, error, paused, dispatched, integrating)",
                      "order": 1,
                      "title": "Status",
                      "type": "string"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities_count",
                      "description": "Counts of vulnerabilities identified during the scan",
                      "order": 6,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Scan",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "scan": {
                  "$ref": "#/definitions/scan",
                  "description": "InsightVM Scan",
                  "order": 1,
                  "title": "Scan"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3": {
            "nodeId": "bdc5b3e1-312b-43d8-96f5-d05bf87b06b3",
            "name": "Wait For Report Processing",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "name": "edc5a035-022d-4fa0-a946-368f0fad88bd.batch.status",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "awaiting_approval"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[edc5a035-022d-4fa0-a946-368f0fad88bd].[batch].[status]}} = \"awaiting_approval\""
                  },
                  "name": "Batch Awaiting Approval?",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "a589986f-bb91-4f76-9a71-95e5cfd04398",
              "nextEdgeId": "1b91bbbf-6746-4d95-9682-3e19838a165b",
              "repeatCount": 4,
              "repeatDelay": 30
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Batch Awaiting Approval?": {
                  "description": "Custom output: \"Batch Awaiting Approval?\"",
                  "title": "Batch Awaiting Approval?",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "edc5a035-022d-4fa0-a946-368f0fad88bd": {
            "nodeId": "edc5a035-022d-4fa0-a946-368f0fad88bd",
            "name": "Get Vulnerability Sync Batch",
            "type": "action",
            "plugin": {
              "name": "Automox",
              "slugVendor": "automox",
              "slugName": "automox",
              "slugVersion": "1.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/automox/automox/1.1.0/icon.png"
            },
            "identifier": "get_vulnerability_sync_batch",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "batch_id": "{{[8a4fd5f4-9dfa-499c-9aea-71e3236bd354].[batch_id]}}",
                "org_id": "{{$workflow.[Automox Organization ID]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "batch_id": {
                  "description": "Identifier of batch",
                  "order": 2,
                  "title": "Batch ID",
                  "type": "integer"
                },
                "org_id": {
                  "description": "Identifier of organization",
                  "order": 1,
                  "title": "Organization ID",
                  "type": "integer"
                }
              },
              "required": [
                "org_id",
                "batch_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "batch": {
                  "properties": {
                    "created_by": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Batch creation details",
                      "order": 5,
                      "title": "Created By"
                    },
                    "cve_count": {
                      "description": "Number of CVEs that are impacted by batch",
                      "order": 12,
                      "title": "CVE Count",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Identifier of batch",
                      "order": 1,
                      "title": "Batch ID",
                      "type": "integer"
                    },
                    "impacted_device_count": {
                      "description": "Number of devices that are impacted by batch",
                      "order": 10,
                      "title": "Impacted Device Count",
                      "type": "integer"
                    },
                    "issue_count": {
                      "description": "Number of issues identified with batch",
                      "order": 11,
                      "title": "Issue Count",
                      "type": "integer"
                    },
                    "organization_id": {
                      "description": "Identifier of organization",
                      "order": 2,
                      "title": "Organization ID",
                      "type": "integer"
                    },
                    "source": {
                      "description": "Source of batch",
                      "order": 4,
                      "title": "Batch Source",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status of batch",
                      "order": 3,
                      "title": "Batch Status",
                      "type": "string"
                    },
                    "task_count": {
                      "description": "Number of tasks related to batch",
                      "order": 8,
                      "title": "Task Count",
                      "type": "integer"
                    },
                    "unknown_host_count": {
                      "description": "Number of hosts that are unknown within batch",
                      "order": 9,
                      "title": "Unknown Host Count",
                      "type": "integer"
                    },
                    "updated_by": {
                      "$ref": "#/definitions/batch_user",
                      "description": "Batch update details",
                      "order": 6,
                      "title": "Updated By"
                    },
                    "uploaded_at": {
                      "description": "Datetime the batch was uploaded",
                      "order": 7,
                      "title": "Uploaded At",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Batch",
                  "type": "object"
                },
                "batch_user": {
                  "properties": {
                    "email": {
                      "description": "The email of the user",
                      "order": 4,
                      "title": "Email",
                      "type": "string"
                    },
                    "firstname": {
                      "description": "The first name of the user",
                      "order": 2,
                      "title": "First Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "The user identifier",
                      "order": 1,
                      "title": "User ID",
                      "type": "integer"
                    },
                    "lastname": {
                      "description": "The last name of the user",
                      "order": 3,
                      "title": "Last Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "id"
                  ],
                  "title": "Batch User",
                  "type": "object"
                }
              },
              "properties": {
                "batch": {
                  "$ref": "#/definitions/batch",
                  "description": "Details of a specified vulnerability sync batch",
                  "order": 1,
                  "title": "Vulnerability Sync Batch"
                }
              },
              "required": [
                "batch"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f0679411-f3b9-4313-9861-e4a85d81a39c": {
            "nodeId": "f0679411-f3b9-4313-9861-e4a85d81a39c",
            "name": "Final Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Trigger\n`Orchestrate Automox Vulnerability Sync with Rapid7 InsightVM` was initiated by a newly completed InsightVM scan with a scan ID of `{{[ada4fa79-adeb-492c-ac27-cf676cc1d6c7].[scan].[id]}}`.\n\n# Outcome\nThe workflow generated and uploaded an InsightVM report to Automox Vulnerability Sync including {{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[impacted_device_count]}} targeted hosts for remediation. The report resulted in the creation of `{{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[task_count]}}` remediation task(s) in Automox. \n\n**Tasks Auto-Approved for Remediation:** {{$workflow.[Auto-Approve Tasks]}}\n\n## Vulnerability Sync Batch\nAdditional details of the generated Vulnerability Sync batch can be reviewed at `https://console.automox.com/manage/tasks/batches/{{[819629f9-4928-4a65-b56d-8199a44f492c].[batch].[id]}}?o={{$workflow.[Automox Organization ID]}}`.\n\n## Task Details Report\n{{#each [45965192-f584-4270-ade0-72eab2733033].[tasks]}}\n**{{this.payload.patch_id}}**\n* Console URL: `https://console.automox.com/manage/tasks/{{this.id}}?o={{$workflow.[Automox Organization ID]}}`\n* Severity: {{this.payload.severity}}\n\n{{/each}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "automox",
          "endpoint",
          "insightvm",
          "patch",
          "remediation",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 7200,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "CVEs in Scope": {
                "type": "string",
                "description": "Comma separated list of CVEs in scope for immediate remediation between InsightVM and Automox. Example format: 'CVE-2018-1234','CVE-2018-5678'."
              },
              "Auto-Approve Tasks": {
                "type": "boolean",
                "description": "Whether to auto-approve and apply patches for identified vulnerabilities immediately. By setting this to true, patches will be applied immediately as the workflow is run. Caution is advised depending on environment needs."
              },
              "Automox Organization ID": {
                "type": "integer",
                "description": "The identifier of the Automox organization."
              }
            },
            "definitions": {}
          }
        },
        "summary": "Orchestrate the remediation of highly impacted vulnerabilities by generating scan reports from InsightVM and uploading the scoped CVE report to Automox Vulnerability Sync in order to stage or immediately remediate vulnerabilities."
      }
    ],
    "triggers": [
      {
        "id": "88ba3da3-7d50-444c-a5b1-db2d431027ab",
        "identifier": "new_scans",
        "name": "Trigger on Successful InsightVM Scans",
        "description": "Trigger workflow on any new InsightVM scans that have completed and are successful.",
        "input": {
          "frequency": 5,
          "most_recent_scan": true,
          "site_name_filter": ".*",
          "status_filter": [
            "Successful"
          ]
        },
        "inputJsonSchema": {
          "properties": {
            "frequency": {
              "default": 5,
              "description": "How often the trigger should check for new scans in minutes",
              "order": 1,
              "title": "Frequency",
              "type": "integer"
            },
            "most_recent_scan": {
              "default": true,
              "description": "Only process the most recent scan for a site since the last time the trigger was run",
              "order": 3,
              "title": "Most Recent Scan Only",
              "type": "boolean"
            },
            "site_name_filter": {
              "default": ".*",
              "description": "Regular expression to match sites where new scans should be triggered",
              "order": 2,
              "title": "Site Name Filter",
              "type": "string"
            },
            "status_filter": {
              "default": [
                "Successful"
              ],
              "description": "List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown",
              "items": {
                "type": "string"
              },
              "order": 4,
              "title": "Status Filter",
              "type": "array"
            }
          },
          "required": [
            "most_recent_scan",
            "frequency",
            "site_name_filter"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "link": {
              "properties": {
                "href": {
                  "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                },
                "rel": {
                  "description": "Link relation type following RFC 5988",
                  "order": 2,
                  "title": "Rel",
                  "type": "string"
                }
              },
              "title": "Link",
              "type": "object"
            },
            "scan": {
              "properties": {
                "assets": {
                  "description": "Count of assets identified during the scan",
                  "order": 3,
                  "title": "Assets",
                  "type": "integer"
                },
                "duration": {
                  "description": "Duration of the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 11,
                  "title": "Duration",
                  "type": "string"
                },
                "endTime": {
                  "description": "End time of the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 14,
                  "title": "End Time",
                  "type": "string"
                },
                "engineId": {
                  "description": "ID for the scan engine/scan engine pool used for the scan",
                  "order": 8,
                  "title": "Engine ID",
                  "type": "integer"
                },
                "engineName": {
                  "description": "Name of the scan engine/scan engine pool used for the scan",
                  "order": 12,
                  "title": "Engine Name",
                  "type": "string"
                },
                "id": {
                  "description": "ID of the scan",
                  "order": 15,
                  "title": "ID",
                  "type": "integer"
                },
                "links": {
                  "description": "List of hypermedia links to corresponding resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 4,
                  "title": "Links",
                  "type": "array"
                },
                "message": {
                  "description": "Scan status message",
                  "order": 13,
                  "title": "Message",
                  "type": "string"
                },
                "scanName": {
                  "description": "Name of the scan",
                  "order": 16,
                  "title": "Scan Name",
                  "type": "string"
                },
                "scanType": {
                  "description": "Type of scan (automated, manual, scheduled)",
                  "order": 2,
                  "title": "Scan Type",
                  "type": "string"
                },
                "siteId": {
                  "description": "ID of the site scanned",
                  "order": 9,
                  "title": "Site ID",
                  "type": "integer"
                },
                "siteName": {
                  "description": "Name of the site scanned",
                  "order": 5,
                  "title": "Site Name",
                  "type": "string"
                },
                "startTime": {
                  "description": "Start time for the scan",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 10,
                  "title": "Start Time",
                  "type": "string"
                },
                "startedBy": {
                  "description": "User that started the scan",
                  "order": 7,
                  "title": "Started By",
                  "type": "string"
                },
                "status": {
                  "description": "Scan status (aborted, unknown, running, finished, stopped, error, paused, dispatched, integrating)",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                },
                "vulnerabilities": {
                  "$ref": "#/definitions/vulnerabilities_count",
                  "description": "Counts of vulnerabilities identified during the scan",
                  "order": 6,
                  "title": "Vulnerabilities"
                }
              },
              "title": "Scan",
              "type": "object"
            },
            "vulnerabilities_count": {
              "properties": {
                "critical": {
                  "description": "Number of critical vulnerabilities",
                  "order": 1,
                  "title": "Critical",
                  "type": "integer"
                },
                "moderate": {
                  "description": "Number of moderate vulnerabilities",
                  "order": 2,
                  "title": "Moderate",
                  "type": "integer"
                },
                "severe": {
                  "description": "Number of severe vulnerabilities",
                  "order": 3,
                  "title": "Severe",
                  "type": "integer"
                },
                "total": {
                  "description": "Total",
                  "order": 4,
                  "title": "Total number of vulnerabilities",
                  "type": "integer"
                }
              },
              "title": "Vulnerabilities Count",
              "type": "object"
            }
          },
          "properties": {
            "scan": {
              "$ref": "#/definitions/scan",
              "description": "InsightVM Scan",
              "order": 1,
              "title": "Scan"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Rapid7 InsightVM Console",
          "slugVendor": "rapid7",
          "slugName": "rapid7_insightvm",
          "slugVersion": "4.9.1",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
        }
      }
    ]
  }
}