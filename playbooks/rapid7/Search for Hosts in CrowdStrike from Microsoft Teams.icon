{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:35:53.888052853Z",
    "workflowVersions": [
      {
        "name": "Search for Hosts in CrowdStrike from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow looks for one or more hostnames in CrowdStrike Falcon and reports back with any host and detection data. The workflow is triggered from a Microsoft Teams `!crowdstrike_actions` command, followed by a comma separated list of one or more hostnames.\n\nExample trigger command:\n\n* `!crowdstrike_actions hostname1,hostname2,hostname3`\n\n# Key Features\n\n* Determine whether or not any host is being monitored by a CrowdStrike agent\n* Collect host info from CrowdStrike in Microsoft Teams\n* Check for detections on a given host\n\n# Requirements\n\n* [Microsoft Teams](https://docs.rapid7.com/insightconnect/microsoft-teams/)\n* CrowdStrike Falcon (API Client ID & Secret)\n\n# Documentation\n\n## Setup\n\nImport the workflow and configure connections for [Microsoft Teams](https://docs.rapid7.com/insightconnect/microsoft-teams/) and CrowdStrike (API Client ID & Secret).\n\nSet the `Microsoft Teams Team Name` and `Microsoft Teams Channel Name` parameters for the team and channel where you will run this workflow from. \n\n## Usage\n\nTrigger the workflow by entering a Microsoft Teams message in the specified channel. The message must start with the text `!crowdstrike_actions`, followed by a comma separated list of one or more hostnames. The workflow will capture each host in the comma separated list and look each up individually in CrowdStrike. Progress will be reported in a thread off the original Teams message.\n\nExample trigger command:\n\n* `!crowdstrike_actions hostname1,hostname2,hostname3`\n\n*Note: To input a list of hostnames, make sure there are no spaces between hosts! Values must be comma separated.*\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Microsoft Teams|3.1.1|6|\n|CrowdStrike Falcon|2.3.0|4|\n|HTML|1.2.2|1|\n|Type Converter|1.8.0|1|\n|Advanced Regex|1.0.3|1|\n|Markdown|3.1.0|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)\n* [CrowdStrike](https://www.crowdstrike.com/)\n",
        "graph": {
          "edges": {
            "0873c28f-65f4-43de-ba55-b2931732179e": {
              "id": "0873c28f-65f4-43de-ba55-b2931732179e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "toNodeId": ""
            },
            "103c7994-e2c3-4c76-a088-ce4a7f66e359": {
              "id": "103c7994-e2c3-4c76-a088-ce4a7f66e359",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "b092c4ed-9f61-47bb-b25c-d9133e8c2190",
              "toNodeId": "69879db8-ec15-402b-bdb8-b5b9d4e18dbd"
            },
            "14e05e7e-e445-4c5a-bc2a-222014b84341": {
              "id": "14e05e7e-e445-4c5a-bc2a-222014b84341",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "ca673847-a734-4311-930c-dfdc929ba369",
              "toNodeId": "b092c4ed-9f61-47bb-b25c-d9133e8c2190"
            },
            "16091243-6e5d-4678-a514-776a6eea32c6": {
              "id": "16091243-6e5d-4678-a514-776a6eea32c6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0a45f8eb-bf71-4219-a31f-e7b5f84d9056",
              "toNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "200fb641-556f-4426-88f6-8304359045d7": {
              "id": "200fb641-556f-4426-88f6-8304359045d7",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "4d179979-5006-463f-962b-6e70f49c3a00",
              "toNodeId": "afb70849-c163-40e5-9f25-7c8b34726f1e"
            },
            "279d0198-0ec9-4507-901d-bc88bb9da516": {
              "id": "279d0198-0ec9-4507-901d-bc88bb9da516",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "24e200f9-4733-47e6-a460-bde6ae320563",
              "toNodeId": "d8fd5231-5f55-4180-bda0-55bf854c0879"
            },
            "36c8a50f-38da-48d6-b996-37f35eca24cb": {
              "id": "36c8a50f-38da-48d6-b996-37f35eca24cb",
              "name": "",
              "description": "",
              "parentNodeId": "ca673847-a734-4311-930c-dfdc929ba369",
              "fromNodeId": "ca673847-a734-4311-930c-dfdc929ba369",
              "toNodeId": "677fd975-16bb-4aa3-99ff-3d8624113f83"
            },
            "40a76199-5751-40bb-833a-081a45dd09c1": {
              "id": "40a76199-5751-40bb-833a-081a45dd09c1",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "toNodeId": "4d179979-5006-463f-962b-6e70f49c3a00"
            },
            "5f9aa980-95b4-4ae9-8222-2271510a0b85": {
              "id": "5f9aa980-95b4-4ae9-8222-2271510a0b85",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "15638de6-1390-4e8e-8adb-6b174d169bd7",
              "toNodeId": "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f"
            },
            "63f68af1-0eaa-4da9-a6db-3ec428cd30f9": {
              "id": "63f68af1-0eaa-4da9-a6db-3ec428cd30f9",
              "name": "No ❌",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "afb70849-c163-40e5-9f25-7c8b34726f1e",
              "toNodeId": "36362e2e-f4fa-41d2-b1ff-86ca7c46764c"
            },
            "6e05b0d7-2c04-442d-a6ee-82a7cb24061d": {
              "id": "6e05b0d7-2c04-442d-a6ee-82a7cb24061d",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "d8fd5231-5f55-4180-bda0-55bf854c0879",
              "toNodeId": "983baf8b-87c4-431e-a9f7-f2753e17c56c"
            },
            "7350f663-c3f5-4a39-9d98-c9eac86fe468": {
              "id": "7350f663-c3f5-4a39-9d98-c9eac86fe468",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "672da7fe-297f-4aaf-9fbb-8bb98f8c1587",
              "toNodeId": "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e"
            },
            "7a6b71b7-1f42-478d-a5bc-4d7c3ea535c8": {
              "id": "7a6b71b7-1f42-478d-a5bc-4d7c3ea535c8",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "db96936b-35e7-4a19-93c2-b8e749a43308",
              "toNodeId": ""
            },
            "81b02185-7ef1-4254-9a36-c665bc1dafef": {
              "id": "81b02185-7ef1-4254-9a36-c665bc1dafef",
              "name": "Yes ✔️",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "afb70849-c163-40e5-9f25-7c8b34726f1e",
              "toNodeId": "81c29a75-d457-47de-adea-134c076e10c5"
            },
            "8cd5cb3b-54c6-43db-b97a-7b60f7f31af6": {
              "id": "8cd5cb3b-54c6-43db-b97a-7b60f7f31af6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "93b0261c-9717-42f3-8ded-9b57cbb1c18c",
              "toNodeId": "6c1499b5-ef30-4a39-a542-829b2311805e"
            },
            "935a7e20-5383-4f6a-9e72-8b1550f713ef": {
              "id": "935a7e20-5383-4f6a-9e72-8b1550f713ef",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6c1499b5-ef30-4a39-a542-829b2311805e",
              "toNodeId": "0a45f8eb-bf71-4219-a31f-e7b5f84d9056"
            },
            "9eb7eb0f-30b3-4e49-8cfe-9e1515314bf1": {
              "id": "9eb7eb0f-30b3-4e49-8cfe-9e1515314bf1",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "983baf8b-87c4-431e-a9f7-f2753e17c56c",
              "toNodeId": "ca673847-a734-4311-930c-dfdc929ba369"
            },
            "9fc47f44-1ec1-43a8-aa49-7c9099fee713": {
              "id": "9fc47f44-1ec1-43a8-aa49-7c9099fee713",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f",
              "toNodeId": "93b0261c-9717-42f3-8ded-9b57cbb1c18c"
            },
            "a88e9577-5f5a-402a-94dc-f6228f827ed9": {
              "id": "a88e9577-5f5a-402a-94dc-f6228f827ed9",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "36362e2e-f4fa-41d2-b1ff-86ca7c46764c",
              "toNodeId": "95895045-6f38-411d-8ae5-a273c7eb412a"
            },
            "b605fc15-da78-44fc-809c-5cf7e91eaf04": {
              "id": "b605fc15-da78-44fc-809c-5cf7e91eaf04",
              "name": "",
              "description": "",
              "parentNodeId": "ca673847-a734-4311-930c-dfdc929ba369",
              "fromNodeId": "677fd975-16bb-4aa3-99ff-3d8624113f83",
              "toNodeId": ""
            },
            "c54129a7-79e8-4c39-8171-d15256c8b75a": {
              "id": "c54129a7-79e8-4c39-8171-d15256c8b75a",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "81c29a75-d457-47de-adea-134c076e10c5",
              "toNodeId": "24e200f9-4733-47e6-a460-bde6ae320563"
            },
            "d1561aba-f6d4-4e06-bcbc-2f8fddc2ecae": {
              "id": "d1561aba-f6d4-4e06-bcbc-2f8fddc2ecae",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e",
              "toNodeId": "15638de6-1390-4e8e-8adb-6b174d169bd7"
            },
            "d4170863-cf6b-4d4b-98a0-1eb8c8cc172b": {
              "id": "d4170863-cf6b-4d4b-98a0-1eb8c8cc172b",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "95895045-6f38-411d-8ae5-a273c7eb412a",
              "toNodeId": ""
            },
            "f8b1bdaf-215b-4ad0-949b-2523b0261f27": {
              "id": "f8b1bdaf-215b-4ad0-949b-2523b0261f27",
              "name": "",
              "description": "",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "fromNodeId": "69879db8-ec15-402b-bdb8-b5b9d4e18dbd",
              "toNodeId": "db96936b-35e7-4a19-93c2-b8e749a43308"
            }
          },
          "nodes": {
            "0948a74e-0cc4-4fc3-b4c7-0faafddf2162": {
              "id": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
              "parentNodeId": ""
            },
            "0a45f8eb-bf71-4219-a31f-e7b5f84d9056": {
              "id": "0a45f8eb-bf71-4219-a31f-e7b5f84d9056",
              "parentNodeId": ""
            },
            "15638de6-1390-4e8e-8adb-6b174d169bd7": {
              "id": "15638de6-1390-4e8e-8adb-6b174d169bd7",
              "parentNodeId": ""
            },
            "24e200f9-4733-47e6-a460-bde6ae320563": {
              "id": "24e200f9-4733-47e6-a460-bde6ae320563",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "36362e2e-f4fa-41d2-b1ff-86ca7c46764c": {
              "id": "36362e2e-f4fa-41d2-b1ff-86ca7c46764c",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "4d179979-5006-463f-962b-6e70f49c3a00": {
              "id": "4d179979-5006-463f-962b-6e70f49c3a00",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f": {
              "id": "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f",
              "parentNodeId": ""
            },
            "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e": {
              "id": "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e",
              "parentNodeId": ""
            },
            "672da7fe-297f-4aaf-9fbb-8bb98f8c1587": {
              "id": "672da7fe-297f-4aaf-9fbb-8bb98f8c1587",
              "parentNodeId": ""
            },
            "677fd975-16bb-4aa3-99ff-3d8624113f83": {
              "id": "677fd975-16bb-4aa3-99ff-3d8624113f83",
              "parentNodeId": "ca673847-a734-4311-930c-dfdc929ba369"
            },
            "69879db8-ec15-402b-bdb8-b5b9d4e18dbd": {
              "id": "69879db8-ec15-402b-bdb8-b5b9d4e18dbd",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "6c1499b5-ef30-4a39-a542-829b2311805e": {
              "id": "6c1499b5-ef30-4a39-a542-829b2311805e",
              "parentNodeId": ""
            },
            "81c29a75-d457-47de-adea-134c076e10c5": {
              "id": "81c29a75-d457-47de-adea-134c076e10c5",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "93b0261c-9717-42f3-8ded-9b57cbb1c18c": {
              "id": "93b0261c-9717-42f3-8ded-9b57cbb1c18c",
              "parentNodeId": ""
            },
            "95895045-6f38-411d-8ae5-a273c7eb412a": {
              "id": "95895045-6f38-411d-8ae5-a273c7eb412a",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "983baf8b-87c4-431e-a9f7-f2753e17c56c": {
              "id": "983baf8b-87c4-431e-a9f7-f2753e17c56c",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "afb70849-c163-40e5-9f25-7c8b34726f1e": {
              "id": "afb70849-c163-40e5-9f25-7c8b34726f1e",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "b092c4ed-9f61-47bb-b25c-d9133e8c2190": {
              "id": "b092c4ed-9f61-47bb-b25c-d9133e8c2190",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "ca673847-a734-4311-930c-dfdc929ba369": {
              "id": "ca673847-a734-4311-930c-dfdc929ba369",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "d8fd5231-5f55-4180-bda0-55bf854c0879": {
              "id": "d8fd5231-5f55-4180-bda0-55bf854c0879",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            },
            "db96936b-35e7-4a19-93c2-b8e749a43308": {
              "id": "db96936b-35e7-4a19-93c2-b8e749a43308",
              "parentNodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162"
            }
          }
        },
        "steps": {
          "0948a74e-0cc4-4fc3-b4c7-0faafddf2162": {
            "nodeId": "0948a74e-0cc4-4fc3-b4c7-0faafddf2162",
            "name": "Loop Through Hostnames",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "40a76199-5751-40bb-833a-081a45dd09c1",
              "nextEdgeId": "0873c28f-65f4-43de-ba55-b2931732179e",
              "repeatVariable": "{{[0a45f8eb-bf71-4219-a31f-e7b5f84d9056].[output]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "0a45f8eb-bf71-4219-a31f-e7b5f84d9056": {
            "nodeId": "0a45f8eb-bf71-4219-a31f-e7b5f84d9056",
            "name": "Convert Hosts String To List",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.0/icon.png"
            },
            "identifier": "string_to_list",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delimiter": ",",
                "input": "{{[6c1499b5-ef30-4a39-a542-829b2311805e].[hosts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delimiter": {
                  "description": "Character used to split the string into slices for the list. Default is a newline, if not provided by user",
                  "order": 2,
                  "title": "Delimiter",
                  "type": "string"
                },
                "input": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted output",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Output",
                  "type": "array"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "15638de6-1390-4e8e-8adb-6b174d169bd7": {
            "nodeId": "15638de6-1390-4e8e-8adb-6b174d169bd7",
            "name": "Notify User Workflow is Starting in Teams",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[channel_name]}}",
                "message_content": "<strong style=\"color: darkorange;\">@{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[from].[user].[displayName]}}</strong> Triggered the SOAR User Management Workflow (<a href=\"{{[$job].[URL]}}\">{{[52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e].[id]}}</a>)",
                "team_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[team_name]}}",
                "thread_id": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "24e200f9-4733-47e6-a460-bde6ae320563": {
            "nodeId": "24e200f9-4733-47e6-a460-bde6ae320563",
            "name": "CrowdStrike Host",
            "type": "action",
            "plugin": {
              "name": "CrowdStrike Falcon",
              "slugVendor": "rapid7",
              "slugName": "crowdstrike_falcon",
              "slugVersion": "2.3.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/crowdstrike_falcon/2.3.0/icon.png"
            },
            "identifier": "get_device_info",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "agent_id": "{{[4d179979-5006-463f-962b-6e70f49c3a00].[resources].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "agent_id": {
                  "description": "Agent ID",
                  "order": 1,
                  "title": "Agent ID",
                  "type": "string"
                }
              },
              "required": [
                "agent_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "behaviors_type": {
                  "properties": {
                    "alleged_filetype": {
                      "description": "Alleged filetype",
                      "order": 25,
                      "title": "Alleged Filetype",
                      "type": "string"
                    },
                    "behavior_id": {
                      "description": "Behavior ID",
                      "order": 14,
                      "title": "Behavior ID",
                      "type": "string"
                    },
                    "cmdline": {
                      "description": "Cmdline",
                      "order": 1,
                      "title": "Cmdline",
                      "type": "string"
                    },
                    "confidence": {
                      "description": "Confidence",
                      "order": 3,
                      "title": "Confidence",
                      "type": "integer"
                    },
                    "control_graph_id": {
                      "description": "Control graph ID",
                      "order": 20,
                      "title": "Control Graph ID",
                      "type": "string"
                    },
                    "device_id": {
                      "description": "Device ID",
                      "order": 24,
                      "title": "Device ID",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Filename",
                      "order": 8,
                      "title": "Filename",
                      "type": "string"
                    },
                    "ioc_description": {
                      "description": "Ioc description",
                      "order": 6,
                      "title": "Ioc Description",
                      "type": "string"
                    },
                    "ioc_source": {
                      "description": "Ioc source",
                      "order": 22,
                      "title": "Ioc Source",
                      "type": "string"
                    },
                    "ioc_type": {
                      "description": "Ioc type",
                      "order": 2,
                      "title": "Ioc Type",
                      "type": "string"
                    },
                    "ioc_value": {
                      "description": "Ioc value",
                      "order": 23,
                      "title": "Ioc Value",
                      "type": "string"
                    },
                    "md5": {
                      "description": "MD5",
                      "order": 17,
                      "title": "MD5",
                      "type": "string"
                    },
                    "objective": {
                      "description": "Objective",
                      "order": 11,
                      "title": "Objective",
                      "type": "string"
                    },
                    "parent_details": {
                      "$ref": "#/definitions/parent_details",
                      "description": "Parent details",
                      "order": 19,
                      "title": "Parent Details"
                    },
                    "pattern_disposition": {
                      "description": "Pattern disposition",
                      "order": 9,
                      "title": "Pattern Disposition",
                      "type": "integer"
                    },
                    "pattern_disposition_details": {
                      "$ref": "#/definitions/pattern_disposition_details",
                      "description": "Pattern disposition details",
                      "order": 16,
                      "title": "Pattern Disposition Details"
                    },
                    "scenario": {
                      "description": "Scenario",
                      "order": 18,
                      "title": "Scenario",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity",
                      "order": 5,
                      "title": "Severity",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 12,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "tactic": {
                      "description": "Tactic",
                      "order": 10,
                      "title": "Tactic",
                      "type": "string"
                    },
                    "technique": {
                      "description": "Technique",
                      "order": 7,
                      "title": "Technique",
                      "type": "string"
                    },
                    "timestamp": {
                      "description": "Timestamp",
                      "order": 15,
                      "title": "Timestamp",
                      "type": "string"
                    },
                    "triggering_process_graph_id": {
                      "description": "Triggering process graph ID",
                      "order": 21,
                      "title": "Triggering Process Graph ID",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "User ID",
                      "order": 4,
                      "title": "User ID",
                      "type": "string"
                    },
                    "user_name": {
                      "description": "User name",
                      "order": 13,
                      "title": "User Name",
                      "type": "string"
                    }
                  },
                  "title": "Behaviors Type",
                  "type": "object"
                },
                "device": {
                  "properties": {
                    "agent_load_flags": {
                      "description": "Agent load flags",
                      "order": 14,
                      "title": "Agent Load Flags",
                      "type": "string"
                    },
                    "agent_local_time": {
                      "description": "Agent local time",
                      "order": 19,
                      "title": "Agent Local Time",
                      "type": "string"
                    },
                    "agent_version": {
                      "description": "Agent version",
                      "order": 29,
                      "title": "Agent Version",
                      "type": "string"
                    },
                    "bios_manufacturer": {
                      "description": "Bios manufacturer",
                      "order": 16,
                      "title": "Bios Manufacturer",
                      "type": "string"
                    },
                    "bios_version": {
                      "description": "Bios version",
                      "order": 13,
                      "title": "Bios Version",
                      "type": "string"
                    },
                    "cid": {
                      "description": "Crowdstrike Customer Identification",
                      "order": 23,
                      "title": "CID",
                      "type": "string"
                    },
                    "config_id_base": {
                      "description": "Config ID base",
                      "order": 27,
                      "title": "Config ID Base",
                      "type": "string"
                    },
                    "config_id_build": {
                      "description": "Config ID build",
                      "order": 9,
                      "title": "Config ID Build",
                      "type": "string"
                    },
                    "config_id_platform": {
                      "description": "Config ID platform",
                      "order": 3,
                      "title": "Config ID Platform",
                      "type": "string"
                    },
                    "device_id": {
                      "description": "Device ID",
                      "order": 20,
                      "title": "Device ID",
                      "type": "string"
                    },
                    "external_ip": {
                      "description": "External IP",
                      "order": 24,
                      "title": "External IP",
                      "type": "string"
                    },
                    "first_seen": {
                      "description": "First seen",
                      "order": 5,
                      "title": "First Seen",
                      "type": "string"
                    },
                    "hostname": {
                      "description": "Hostname",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "last_seen": {
                      "description": "Last seen",
                      "order": 30,
                      "title": "Last Seen",
                      "type": "string"
                    },
                    "local_ip": {
                      "description": "Local ip",
                      "order": 7,
                      "title": "Local Ip",
                      "type": "string"
                    },
                    "mac_address": {
                      "description": "Mac address",
                      "order": 12,
                      "title": "Mac Address",
                      "type": "string"
                    },
                    "machine_domain": {
                      "description": "Machine domain",
                      "order": 18,
                      "title": "Machine Domain",
                      "type": "string"
                    },
                    "major_version": {
                      "description": "Major version",
                      "order": 25,
                      "title": "Major Version",
                      "type": "string"
                    },
                    "minor_version": {
                      "description": "Minor version",
                      "order": 10,
                      "title": "Minor Version",
                      "type": "string"
                    },
                    "modified_timestamp": {
                      "description": "Modified timestamp",
                      "order": 1,
                      "title": "Modified Timestamp",
                      "type": "string"
                    },
                    "os_version": {
                      "description": "Os version",
                      "order": 11,
                      "title": "Os Version",
                      "type": "string"
                    },
                    "ou": {
                      "description": "OU",
                      "items": {
                        "type": "string"
                      },
                      "order": 28,
                      "title": "OU",
                      "type": "array"
                    },
                    "platform_id": {
                      "description": "Platform ID",
                      "order": 26,
                      "title": "Platform ID",
                      "type": "string"
                    },
                    "platform_name": {
                      "description": "Platform name",
                      "order": 6,
                      "title": "Platform Name",
                      "type": "string"
                    },
                    "product_type": {
                      "description": "Product type",
                      "order": 22,
                      "title": "Product Type",
                      "type": "string"
                    },
                    "product_type_desc": {
                      "description": "Product type description",
                      "order": 17,
                      "title": "Product Type Description",
                      "type": "string"
                    },
                    "site_name": {
                      "description": "Site name",
                      "order": 2,
                      "title": "Site Name",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status",
                      "order": 15,
                      "title": "Status",
                      "type": "string"
                    },
                    "system_manufacturer": {
                      "description": "System manufacturer",
                      "order": 4,
                      "title": "System Manufacturer",
                      "type": "string"
                    },
                    "system_product_name": {
                      "description": "System product name",
                      "order": 21,
                      "title": "System Product Name",
                      "type": "string"
                    }
                  },
                  "title": "Device",
                  "type": "object"
                },
                "hostinfo": {
                  "properties": {
                    "active_directory_dn_display": {
                      "description": "Active directory DN display",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Active Directory DN Display",
                      "type": "array"
                    },
                    "domain": {
                      "description": "Domain",
                      "order": 1,
                      "title": "Domain",
                      "type": "string"
                    }
                  },
                  "title": "Hostinfo",
                  "type": "object"
                },
                "meta": {
                  "properties": {
                    "pagination": {
                      "$ref": "#/definitions/pagination",
                      "description": "Pagination",
                      "order": 1,
                      "title": "Pagination"
                    },
                    "powered_by": {
                      "description": "Powered by",
                      "order": 3,
                      "title": "Powered By",
                      "type": "string"
                    },
                    "query_time": {
                      "description": "Query time",
                      "order": 2,
                      "title": "Query Time",
                      "type": "number"
                    },
                    "trace_id": {
                      "description": "Trace ID",
                      "order": 4,
                      "title": "Trace ID",
                      "type": "string"
                    }
                  },
                  "title": "Meta",
                  "type": "object"
                },
                "pagination": {
                  "properties": {
                    "limit": {
                      "description": "Limit",
                      "order": 2,
                      "title": "Limit",
                      "type": "integer"
                    },
                    "offset": {
                      "description": "Offset",
                      "order": 3,
                      "title": "Offset",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 1,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Pagination",
                  "type": "object"
                },
                "parent_details": {
                  "properties": {
                    "parent_cmdline": {
                      "description": "Parent cmdline",
                      "order": 2,
                      "title": "Parent Cmdline",
                      "type": "string"
                    },
                    "parent_md5": {
                      "description": "Parent MD5",
                      "order": 1,
                      "title": "Parent MD5",
                      "type": "string"
                    },
                    "parent_process_graph_id": {
                      "description": "Parent process graph ID",
                      "order": 3,
                      "title": "Parent Process Graph ID",
                      "type": "string"
                    },
                    "parent_sha256": {
                      "description": "Parent SHA256",
                      "order": 4,
                      "title": "Parent SHA256",
                      "type": "string"
                    }
                  },
                  "title": "Parent Details",
                  "type": "object"
                },
                "pattern_disposition_details": {
                  "properties": {
                    "detect": {
                      "description": "Detect",
                      "order": 2,
                      "title": "Detect",
                      "type": "boolean"
                    },
                    "inddet_mask": {
                      "description": "Inddet mask",
                      "order": 4,
                      "title": "Inddet Mask",
                      "type": "boolean"
                    },
                    "indicator": {
                      "description": "Indicator",
                      "order": 1,
                      "title": "Indicator",
                      "type": "boolean"
                    },
                    "kill_parent": {
                      "description": "Kill parent",
                      "order": 7,
                      "title": "Kill Parent",
                      "type": "boolean"
                    },
                    "kill_process": {
                      "description": "Kill process",
                      "order": 12,
                      "title": "Kill Process",
                      "type": "boolean"
                    },
                    "kill_subprocess": {
                      "description": "Kill subprocess",
                      "order": 11,
                      "title": "Kill Subprocess",
                      "type": "boolean"
                    },
                    "operation_blocked": {
                      "description": "Operation blocked",
                      "order": 9,
                      "title": "Operation Blocked",
                      "type": "boolean"
                    },
                    "policy_disabled": {
                      "description": "Policy disabled",
                      "order": 13,
                      "title": "Policy Disabled",
                      "type": "boolean"
                    },
                    "process_blocked": {
                      "description": "Process blocked",
                      "order": 6,
                      "title": "Process Blocked",
                      "type": "boolean"
                    },
                    "quarantine_file": {
                      "description": "Quarantine file",
                      "order": 3,
                      "title": "Quarantine File",
                      "type": "boolean"
                    },
                    "quarantine_machine": {
                      "description": "Quarantine machine",
                      "order": 8,
                      "title": "Quarantine Machine",
                      "type": "boolean"
                    },
                    "rooting": {
                      "description": "Rooting",
                      "order": 5,
                      "title": "Rooting",
                      "type": "boolean"
                    },
                    "sensor_only": {
                      "description": "Sensor only",
                      "order": 10,
                      "title": "Sensor Only",
                      "type": "boolean"
                    }
                  },
                  "title": "Pattern Disposition Details",
                  "type": "object"
                },
                "quarantined_file_type": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "paths": {
                      "description": "Paths",
                      "order": 2,
                      "title": "Paths",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 3,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "state": {
                      "description": "State",
                      "order": 4,
                      "title": "State",
                      "type": "string"
                    }
                  },
                  "title": "Quarantined File Type",
                  "type": "object"
                },
                "resources": {
                  "properties": {
                    "assigned_to_name": {
                      "description": "Assigned to name",
                      "order": 7,
                      "title": "Assigned To Name",
                      "type": "string"
                    },
                    "assigned_to_uid": {
                      "description": "Assigned to UID",
                      "order": 11,
                      "title": "Assigned To UID",
                      "type": "string"
                    },
                    "behaviors": {
                      "description": "Behaviors",
                      "items": {
                        "$ref": "#/definitions/behaviors_type"
                      },
                      "order": 1,
                      "title": "Behaviors",
                      "type": "array"
                    },
                    "cid": {
                      "description": "Crowdstrike Customer Identification",
                      "order": 4,
                      "title": "CID",
                      "type": "string"
                    },
                    "created_timestamp": {
                      "description": "Created timestamp",
                      "order": 14,
                      "title": "Created Timestamp",
                      "type": "string"
                    },
                    "detection_id": {
                      "description": "Detection ID",
                      "order": 13,
                      "title": "Detection ID",
                      "type": "string"
                    },
                    "device": {
                      "$ref": "#/definitions/device",
                      "description": "Device",
                      "order": 9,
                      "title": "Device"
                    },
                    "email_sent": {
                      "description": "Email sent",
                      "order": 8,
                      "title": "Email Sent",
                      "type": "boolean"
                    },
                    "first_behavior": {
                      "description": "First behavior",
                      "order": 15,
                      "title": "First Behavior",
                      "type": "string"
                    },
                    "hostinfo": {
                      "$ref": "#/definitions/hostinfo",
                      "description": "Host Information",
                      "order": 3,
                      "title": "Hostinfo"
                    },
                    "id": {
                      "description": "ID",
                      "order": 19,
                      "title": "ID",
                      "type": "string"
                    },
                    "last_behavior": {
                      "description": "Last behavior",
                      "order": 12,
                      "title": "Last Behavior",
                      "type": "string"
                    },
                    "max_confidence": {
                      "description": "Max confidence",
                      "order": 10,
                      "title": "Max Confidence",
                      "type": "integer"
                    },
                    "max_severity": {
                      "description": "Max severity",
                      "order": 2,
                      "title": "Max Severity",
                      "type": "integer"
                    },
                    "max_severity_displayname": {
                      "description": "Max severity displayname",
                      "order": 17,
                      "title": "Max Severity Displayname",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path",
                      "order": 20,
                      "title": "Path",
                      "type": "string"
                    },
                    "quarantined_files": {
                      "description": "Qarantined files",
                      "items": {
                        "$ref": "#/definitions/quarantined_file_type"
                      },
                      "order": 21,
                      "title": "Quarantined Files",
                      "type": "array"
                    },
                    "seconds_to_resolved": {
                      "description": "Seconds to resolved",
                      "order": 18,
                      "title": "Seconds To Resolved",
                      "type": "integer"
                    },
                    "seconds_to_triaged": {
                      "description": "Seconds to triaged",
                      "order": 5,
                      "title": "Seconds To Triaged",
                      "type": "integer"
                    },
                    "show_in_ui": {
                      "description": "Show in UI",
                      "order": 16,
                      "title": "Show In UI",
                      "type": "boolean"
                    },
                    "status": {
                      "description": "Status",
                      "order": 6,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Resources",
                  "type": "object"
                }
              },
              "properties": {
                "errors": {
                  "description": "Errors",
                  "items": {
                    "type": "object"
                  },
                  "order": 2,
                  "title": "Errors",
                  "type": "array"
                },
                "meta": {
                  "$ref": "#/definitions/meta",
                  "description": "Meta",
                  "order": 1,
                  "title": "Meta"
                },
                "resources": {
                  "description": "Resources",
                  "items": {
                    "$ref": "#/definitions/resources"
                  },
                  "order": 3,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "36362e2e-f4fa-41d2-b1ff-86ca7c46764c": {
            "nodeId": "36362e2e-f4fa-41d2-b1ff-86ca7c46764c",
            "name": "CrowdStrike Aid Not Found",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "No CrowdStrike Aid for hostname `{{[0948a74e-0cc4-4fc3-b4c7-0faafddf2162].[$item]}}`"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "4d179979-5006-463f-962b-6e70f49c3a00": {
            "nodeId": "4d179979-5006-463f-962b-6e70f49c3a00",
            "name": "CrowdStrike Aid",
            "type": "action",
            "plugin": {
              "name": "CrowdStrike Falcon",
              "slugVendor": "rapid7",
              "slugName": "crowdstrike_falcon",
              "slugVersion": "2.3.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/crowdstrike_falcon/2.3.0/icon.png"
            },
            "identifier": "search_for_devices",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "filter": "hostname:'{{[0948a74e-0cc4-4fc3-b4c7-0faafddf2162].[$item]}}'",
                "limit": 1000,
                "offset": 0,
                "sort": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filter": {
                  "description": "Falcon Query Language (FQL) filter string used to limit results",
                  "order": 4,
                  "title": "Filter",
                  "type": "string"
                },
                "limit": {
                  "default": 1000,
                  "description": "Maximum number of devices returned",
                  "order": 2,
                  "title": "Limit",
                  "type": "integer"
                },
                "offset": {
                  "default": 0,
                  "description": "Offset",
                  "order": 1,
                  "title": "Offset",
                  "type": "integer"
                },
                "sort": {
                  "description": "Property to sort by (e.g. status.desc or hostname.asc)",
                  "order": 3,
                  "title": "Sort By",
                  "type": "string"
                }
              },
              "required": [
                "offset",
                "limit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "meta": {
                  "properties": {
                    "pagination": {
                      "$ref": "#/definitions/pagination",
                      "description": "Pagination",
                      "order": 1,
                      "title": "Pagination"
                    },
                    "powered_by": {
                      "description": "Powered by",
                      "order": 3,
                      "title": "Powered By",
                      "type": "string"
                    },
                    "query_time": {
                      "description": "Query time",
                      "order": 2,
                      "title": "Query Time",
                      "type": "number"
                    },
                    "trace_id": {
                      "description": "Trace ID",
                      "order": 4,
                      "title": "Trace ID",
                      "type": "string"
                    }
                  },
                  "title": "Meta",
                  "type": "object"
                },
                "pagination": {
                  "properties": {
                    "limit": {
                      "description": "Limit",
                      "order": 2,
                      "title": "Limit",
                      "type": "integer"
                    },
                    "offset": {
                      "description": "Offset",
                      "order": 3,
                      "title": "Offset",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 1,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Pagination",
                  "type": "object"
                }
              },
              "properties": {
                "errors": {
                  "description": "Errors",
                  "items": {
                    "type": "object"
                  },
                  "order": 2,
                  "title": "Errors",
                  "type": "array"
                },
                "meta": {
                  "$ref": "#/definitions/meta",
                  "description": "Meta",
                  "order": 1,
                  "title": "Meta"
                },
                "resources": {
                  "description": "Resources returned are the Device IDs that have the Falcon sensor installed",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f": {
            "nodeId": "4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f",
            "name": "Convert HTML to String",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[body].[content]}}",
                "remove_scripts": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e": {
            "nodeId": "52c3ddeb-59b4-4a59-bc00-f0eb04a5c82e",
            "name": "Job ID",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{id:/[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}$/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "id",
                    "regex": "[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}$"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[$job].[URL]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "672da7fe-297f-4aaf-9fbb-8bb98f8c1587": {
            "nodeId": "672da7fe-297f-4aaf-9fbb-8bb98f8c1587",
            "name": "Teams Message",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "test123",
                "message_content": "!crowdstrike_actions",
                "team_name": "Dream Team"
              }
            },
            "triggerId": "28c64f02-fe85-4e93-8dee-253ab9cbc82a",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "677fd975-16bb-4aa3-99ff-3d8624113f83": {
            "nodeId": "677fd975-16bb-4aa3-99ff-3d8624113f83",
            "name": "CrowdStrike Detection",
            "type": "action",
            "plugin": {
              "name": "CrowdStrike Falcon",
              "slugVendor": "rapid7",
              "slugName": "crowdstrike_falcon",
              "slugVersion": "2.3.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/crowdstrike_falcon/2.3.0/icon.png"
            },
            "identifier": "get_detection_info",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "detection_id": "{{[ca673847-a734-4311-930c-dfdc929ba369].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "detection_id": {
                  "description": "Detection ID",
                  "order": 1,
                  "title": "Detection ID",
                  "type": "string"
                }
              },
              "required": [
                "detection_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "behaviors": {
                  "properties": {
                    "alleged_filetype": {
                      "description": "Alleged filetype",
                      "order": 1,
                      "title": "Alleged Filetype",
                      "type": "string"
                    },
                    "behavior_id": {
                      "description": "Behavior ID",
                      "order": 2,
                      "title": "Behavior ID",
                      "type": "string"
                    },
                    "cmdline": {
                      "description": "Cmdline",
                      "order": 3,
                      "title": "Cmdline",
                      "type": "string"
                    },
                    "confidence": {
                      "description": "Confidence",
                      "order": 4,
                      "title": "Confidence",
                      "type": "integer"
                    },
                    "control_graph_id": {
                      "description": "Control graph ID",
                      "order": 5,
                      "title": "Control Graph ID",
                      "type": "string"
                    },
                    "device_id": {
                      "description": "Device ID",
                      "order": 6,
                      "title": "Device ID",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Filename",
                      "order": 7,
                      "title": "Filename",
                      "type": "string"
                    },
                    "ioc_description": {
                      "description": "IOC description",
                      "order": 8,
                      "title": "IOC Description",
                      "type": "string"
                    },
                    "ioc_source": {
                      "description": "IOC source",
                      "order": 9,
                      "title": "IOC Source",
                      "type": "string"
                    },
                    "ioc_type": {
                      "description": "IOC type",
                      "order": 10,
                      "title": "IOC Type",
                      "type": "string"
                    },
                    "ioc_value": {
                      "description": "IOC value",
                      "order": 11,
                      "title": "IOC Value",
                      "type": "string"
                    },
                    "md5": {
                      "description": "MD5",
                      "order": 12,
                      "title": "MD5",
                      "type": "string"
                    },
                    "objective": {
                      "description": "Objective",
                      "order": 13,
                      "title": "Objective",
                      "type": "string"
                    },
                    "parent_details": {
                      "$ref": "#/definitions/parent_details",
                      "description": "Parent details",
                      "order": 14,
                      "title": "Parent Details"
                    },
                    "pattern_disposition": {
                      "description": "Pattern disposition",
                      "order": 15,
                      "title": "Pattern Disposition",
                      "type": "integer"
                    },
                    "pattern_disposition_details": {
                      "$ref": "#/definitions/detection_pattern_disposition_details",
                      "description": "Pattern disposition details",
                      "order": 16,
                      "title": "Pattern Disposition Details"
                    },
                    "rule_instance_id": {
                      "description": "Rule instance ID",
                      "order": 17,
                      "title": "Rule Instance ID",
                      "type": "string"
                    },
                    "rule_instance_version": {
                      "description": "Rule instance version",
                      "order": 18,
                      "title": "Rule Instance Version",
                      "type": "integer"
                    },
                    "scenario": {
                      "description": "Scenario",
                      "order": 19,
                      "title": "Scenario",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity",
                      "order": 20,
                      "title": "Severity",
                      "type": "integer"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 21,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "tactic": {
                      "description": "Tactic",
                      "order": 22,
                      "title": "Tactic",
                      "type": "string"
                    },
                    "technique": {
                      "description": "Technique",
                      "order": 23,
                      "title": "Technique",
                      "type": "string"
                    },
                    "template_instance_id": {
                      "description": "Template instance ID",
                      "order": 24,
                      "title": "Template Instance ID",
                      "type": "string"
                    },
                    "timestamp": {
                      "description": "Timestamp",
                      "order": 25,
                      "title": "Timestamp",
                      "type": "string"
                    },
                    "triggering_process_graph_id": {
                      "description": "Triggering process graph ID",
                      "order": 26,
                      "title": "Triggering Process Graph ID",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "User ID",
                      "order": 27,
                      "title": "User ID",
                      "type": "string"
                    },
                    "user_name": {
                      "description": "User name",
                      "order": 28,
                      "title": "User Name",
                      "type": "string"
                    }
                  },
                  "title": "Behaviors",
                  "type": "object"
                },
                "detection_device": {
                  "properties": {
                    "agent_load_flags": {
                      "description": "Agent load flags",
                      "order": 1,
                      "title": "Agent Load Flags",
                      "type": "string"
                    },
                    "agent_local_time": {
                      "description": "Agent local time",
                      "order": 2,
                      "title": "Agent Local Time",
                      "type": "string"
                    },
                    "agent_version": {
                      "description": "Agent version",
                      "order": 3,
                      "title": "Agent Version",
                      "type": "string"
                    },
                    "bios_manufacturer": {
                      "description": "BIOS manufacturer",
                      "order": 4,
                      "title": "BIOS Manufacturer",
                      "type": "string"
                    },
                    "bios_version": {
                      "description": "BIOS version",
                      "order": 5,
                      "title": "BIOS Version",
                      "type": "string"
                    },
                    "cid": {
                      "description": "CID",
                      "order": 6,
                      "title": "CID",
                      "type": "string"
                    },
                    "config_id_base": {
                      "description": "Config ID base",
                      "order": 7,
                      "title": "Config ID Base",
                      "type": "string"
                    },
                    "config_id_build": {
                      "description": "Config ID build",
                      "order": 8,
                      "title": "Config ID Build",
                      "type": "string"
                    },
                    "config_id_platform": {
                      "description": "Config ID platform",
                      "order": 9,
                      "title": "Config ID Platform",
                      "type": "string"
                    },
                    "device_id": {
                      "description": "Device ID",
                      "order": 10,
                      "title": "Device ID",
                      "type": "string"
                    },
                    "external_ip": {
                      "description": "External IP",
                      "order": 11,
                      "title": "External IP",
                      "type": "string"
                    },
                    "first_login_timestamp": {
                      "description": "First login timestamp",
                      "order": 12,
                      "title": "First Login Timestamp",
                      "type": "string"
                    },
                    "first_login_user": {
                      "description": "First login user",
                      "order": 13,
                      "title": "First Login User",
                      "type": "string"
                    },
                    "first_seen": {
                      "description": "First seen",
                      "order": 14,
                      "title": "First Seen",
                      "type": "string"
                    },
                    "hostname": {
                      "description": "Hostname",
                      "order": 15,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "last_login_timestamp": {
                      "description": "Last login timestamp",
                      "order": 16,
                      "title": "Last Login Timestamp",
                      "type": "string"
                    },
                    "last_login_user": {
                      "description": "Last login user",
                      "order": 17,
                      "title": "Last Login User",
                      "type": "string"
                    },
                    "last_seen": {
                      "description": "Last seen",
                      "order": 18,
                      "title": "Last Seen",
                      "type": "string"
                    },
                    "local_ip": {
                      "description": "Local IP address",
                      "order": 19,
                      "title": "Local IP Address",
                      "type": "string"
                    },
                    "mac_address": {
                      "description": "MAC address",
                      "order": 20,
                      "title": "MAC Address",
                      "type": "string"
                    },
                    "machine_domain": {
                      "description": "Machine domain",
                      "order": 21,
                      "title": "Machine Domain",
                      "type": "string"
                    },
                    "major_version": {
                      "description": "Major version",
                      "order": 22,
                      "title": "Major Version",
                      "type": "string"
                    },
                    "minor_version": {
                      "description": "Minor version",
                      "order": 23,
                      "title": "Minor Version",
                      "type": "string"
                    },
                    "modified_timestamp": {
                      "description": "Modified timestamp",
                      "order": 24,
                      "title": "Modified Timestamp",
                      "type": "string"
                    },
                    "notes": {
                      "description": "Notes",
                      "items": {
                        "type": "string"
                      },
                      "order": 25,
                      "title": "Notes",
                      "type": "array"
                    },
                    "os_version": {
                      "description": "OS version",
                      "order": 26,
                      "title": "OS Version",
                      "type": "string"
                    },
                    "ou": {
                      "description": "OU",
                      "items": {
                        "type": "string"
                      },
                      "order": 27,
                      "title": "OU",
                      "type": "array"
                    },
                    "platform_id": {
                      "description": "Platform ID",
                      "order": 28,
                      "title": "Platform ID",
                      "type": "string"
                    },
                    "platform_name": {
                      "description": "Platform name",
                      "order": 29,
                      "title": "Platform Name",
                      "type": "string"
                    },
                    "product_type": {
                      "description": "Product type",
                      "order": 30,
                      "title": "Product Type",
                      "type": "string"
                    },
                    "product_type_desc": {
                      "description": "Product type description",
                      "order": 31,
                      "title": "Product Type Description",
                      "type": "string"
                    },
                    "release_group": {
                      "description": "Release group",
                      "order": 32,
                      "title": "Release Group",
                      "type": "string"
                    },
                    "site_name": {
                      "description": "Site name",
                      "order": 33,
                      "title": "Site Name",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status",
                      "order": 34,
                      "title": "Status",
                      "type": "string"
                    },
                    "system_manufacturer": {
                      "description": "System manufacturer",
                      "order": 35,
                      "title": "System Manufacturer",
                      "type": "string"
                    },
                    "system_product_name": {
                      "description": "System product name",
                      "order": 36,
                      "title": "System Product Name",
                      "type": "string"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 37,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "title": "Detection Device",
                  "type": "object"
                },
                "detection_pattern_disposition_details": {
                  "properties": {
                    "bootup_safeguard_enabled": {
                      "description": "Bootup safeguard enabled",
                      "order": 1,
                      "title": "Bootup Safeguard Enabled",
                      "type": "boolean"
                    },
                    "critical_process_disabled": {
                      "description": "Critical process disabled",
                      "order": 2,
                      "title": "Critical Process Disabled",
                      "type": "boolean"
                    },
                    "detect": {
                      "description": "Detect",
                      "order": 3,
                      "title": "Detect",
                      "type": "boolean"
                    },
                    "fs_operation_blocked": {
                      "description": "FS operation blocked",
                      "order": 4,
                      "title": "FS Operation Blocked",
                      "type": "boolean"
                    },
                    "inddet_mask": {
                      "description": "Inddet mask",
                      "order": 5,
                      "title": "Inddet Mask",
                      "type": "boolean"
                    },
                    "indicator": {
                      "description": "Indicator",
                      "order": 6,
                      "title": "Indicator",
                      "type": "boolean"
                    },
                    "kill_parent": {
                      "description": "Kill parent",
                      "order": 7,
                      "title": "Kill Parent",
                      "type": "boolean"
                    },
                    "kill_process": {
                      "description": "Kill process",
                      "order": 8,
                      "title": "Kill Process",
                      "type": "boolean"
                    },
                    "kill_subprocess": {
                      "description": "Kill subprocess",
                      "order": 9,
                      "title": "Kill Subprocess",
                      "type": "boolean"
                    },
                    "operation_blocked": {
                      "description": "Operation blocked",
                      "order": 10,
                      "title": "Operation Blocked",
                      "type": "boolean"
                    },
                    "policy_disabled": {
                      "description": "Policy disabled",
                      "order": 11,
                      "title": "Policy Disabled",
                      "type": "boolean"
                    },
                    "process_blocked": {
                      "description": "Process blocked",
                      "order": 12,
                      "title": "Process Blocked",
                      "type": "boolean"
                    },
                    "quarantine_file": {
                      "description": "Quarantine file",
                      "order": 13,
                      "title": "Quarantine File",
                      "type": "boolean"
                    },
                    "quarantine_machine": {
                      "description": "Quarantine machine",
                      "order": 14,
                      "title": "Quarantine Machine",
                      "type": "boolean"
                    },
                    "registry_operation_blocked": {
                      "description": "Registry operation blocked",
                      "order": 15,
                      "title": "Registry Operation Blocked",
                      "type": "boolean"
                    },
                    "rooting": {
                      "description": "Rooting",
                      "order": 16,
                      "title": "Rooting",
                      "type": "boolean"
                    },
                    "sensor_only": {
                      "description": "Sensor only",
                      "order": 17,
                      "title": "Sensor Only",
                      "type": "boolean"
                    }
                  },
                  "title": "Detection Pattern Disposition Details",
                  "type": "object"
                },
                "error": {
                  "properties": {
                    "code": {
                      "description": "Error code",
                      "order": 1,
                      "title": "Code",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Error ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "message": {
                      "description": "Error message",
                      "order": 3,
                      "title": "Message",
                      "type": "string"
                    }
                  },
                  "title": "Error",
                  "type": "object"
                },
                "get_detection_resource": {
                  "properties": {
                    "adversary_ids": {
                      "description": "Adversary IDs",
                      "items": {
                        "type": "integer"
                      },
                      "order": 1,
                      "title": "Adversary IDs",
                      "type": "array"
                    },
                    "assigned_to_name": {
                      "description": "Assigned to name",
                      "order": 2,
                      "title": "Assigned To Name",
                      "type": "string"
                    },
                    "assigned_to_uid": {
                      "description": "Assigned to UID",
                      "order": 3,
                      "title": "Assigned To UID",
                      "type": "string"
                    },
                    "behaviors": {
                      "description": "Behaviors",
                      "items": {
                        "$ref": "#/definitions/behaviors"
                      },
                      "order": 4,
                      "title": "Behaviors",
                      "type": "array"
                    },
                    "cid": {
                      "description": "CID",
                      "order": 5,
                      "title": "CID",
                      "type": "string"
                    },
                    "created_timestamp": {
                      "description": "Created timestamp",
                      "order": 6,
                      "title": "Created Timestamp",
                      "type": "string"
                    },
                    "detection_id": {
                      "description": "Detection ID",
                      "order": 7,
                      "title": "Detection ID",
                      "type": "string"
                    },
                    "device": {
                      "$ref": "#/definitions/detection_device",
                      "description": "Device",
                      "order": 8,
                      "title": "Device"
                    },
                    "email_sent": {
                      "description": "Email sent",
                      "order": 9,
                      "title": "Email Sent",
                      "type": "boolean"
                    },
                    "first_behavior": {
                      "description": "First behavior",
                      "order": 10,
                      "title": "First Behavior",
                      "type": "string"
                    },
                    "hostinfo": {
                      "$ref": "#/definitions/hostinfo",
                      "description": "Hostinfo",
                      "order": 11,
                      "title": "Hostinfo"
                    },
                    "last_behavior": {
                      "description": "Last behavior",
                      "order": 12,
                      "title": "Last Behavior",
                      "type": "string"
                    },
                    "max_confidence": {
                      "description": "Max confidence",
                      "order": 13,
                      "title": "Max Confidence",
                      "type": "integer"
                    },
                    "max_severity": {
                      "description": "Max severity",
                      "order": 14,
                      "title": "Max Severity",
                      "type": "integer"
                    },
                    "max_severity_displayname": {
                      "description": "Max severity displayname",
                      "order": 15,
                      "title": "Max Severity Displayname",
                      "type": "string"
                    },
                    "overwatch_notes": {
                      "description": "Overwatch notes",
                      "order": 16,
                      "title": "Overwatch Notes",
                      "type": "string"
                    },
                    "quarantined_files": {
                      "description": "Quarantined files",
                      "items": {
                        "$ref": "#/definitions/quarantined_files"
                      },
                      "order": 17,
                      "title": "Quarantined Files",
                      "type": "array"
                    },
                    "seconds_to_resolved": {
                      "description": "Seconds to resolved",
                      "order": 18,
                      "title": "Seconds To Resolved",
                      "type": "integer"
                    },
                    "seconds_to_triaged": {
                      "description": "Seconds to triaged",
                      "order": 19,
                      "title": "Seconds To Triaged",
                      "type": "integer"
                    },
                    "show_in_ui": {
                      "description": "Show in UI",
                      "order": 20,
                      "title": "Show In UI",
                      "type": "boolean"
                    },
                    "status": {
                      "description": "Status",
                      "order": 21,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Get Detection Resource",
                  "type": "object"
                },
                "hostinfo": {
                  "properties": {
                    "active_directory_dn_display": {
                      "description": "Active directory DN display",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Active Directory DN Display",
                      "type": "array"
                    },
                    "domain": {
                      "description": "Domain",
                      "order": 1,
                      "title": "Domain",
                      "type": "string"
                    }
                  },
                  "title": "Hostinfo",
                  "type": "object"
                },
                "meta": {
                  "properties": {
                    "pagination": {
                      "$ref": "#/definitions/pagination",
                      "description": "Pagination",
                      "order": 1,
                      "title": "Pagination"
                    },
                    "powered_by": {
                      "description": "Powered by",
                      "order": 3,
                      "title": "Powered By",
                      "type": "string"
                    },
                    "query_time": {
                      "description": "Query time",
                      "order": 2,
                      "title": "Query Time",
                      "type": "number"
                    },
                    "trace_id": {
                      "description": "Trace ID",
                      "order": 4,
                      "title": "Trace ID",
                      "type": "string"
                    }
                  },
                  "title": "Meta",
                  "type": "object"
                },
                "pagination": {
                  "properties": {
                    "limit": {
                      "description": "Limit",
                      "order": 2,
                      "title": "Limit",
                      "type": "integer"
                    },
                    "offset": {
                      "description": "Offset",
                      "order": 3,
                      "title": "Offset",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 1,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Pagination",
                  "type": "object"
                },
                "parent_details": {
                  "properties": {
                    "parent_cmdline": {
                      "description": "Parent cmdline",
                      "order": 2,
                      "title": "Parent Cmdline",
                      "type": "string"
                    },
                    "parent_md5": {
                      "description": "Parent MD5",
                      "order": 1,
                      "title": "Parent MD5",
                      "type": "string"
                    },
                    "parent_process_graph_id": {
                      "description": "Parent process graph ID",
                      "order": 3,
                      "title": "Parent Process Graph ID",
                      "type": "string"
                    },
                    "parent_sha256": {
                      "description": "Parent SHA256",
                      "order": 4,
                      "title": "Parent SHA256",
                      "type": "string"
                    }
                  },
                  "title": "Parent Details",
                  "type": "object"
                },
                "quarantined_files": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "paths": {
                      "description": "Paths",
                      "order": 2,
                      "title": "Paths",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 3,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "state": {
                      "description": "State",
                      "order": 4,
                      "title": "State",
                      "type": "string"
                    }
                  },
                  "title": "Quarantined Files",
                  "type": "object"
                }
              },
              "properties": {
                "errors": {
                  "description": "Errors",
                  "items": {
                    "$ref": "#/definitions/error"
                  },
                  "order": 2,
                  "title": "Errors",
                  "type": "array"
                },
                "meta": {
                  "$ref": "#/definitions/meta",
                  "description": "Meta",
                  "order": 1,
                  "title": "Meta"
                },
                "resources": {
                  "description": "Resources",
                  "items": {
                    "$ref": "#/definitions/get_detection_resource"
                  },
                  "order": 3,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "69879db8-ec15-402b-bdb8-b5b9d4e18dbd": {
            "nodeId": "69879db8-ec15-402b-bdb8-b5b9d4e18dbd",
            "name": "Convert CrowdStrike Host Results Markdown to HTML",
            "type": "action",
            "plugin": {
              "name": "Markdown",
              "slugVendor": "rapid7",
              "slugName": "markdown",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/markdown/3.1.0/icon.png"
            },
            "identifier": "markdown_to_html",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "markdown": "",
                "markdown_string": "{{[b092c4ed-9f61-47bb-b25c-d9133e8c2190].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "markdown": {
                  "description": "Markdown content represented in base64",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Markdown Bytes",
                  "type": "string"
                },
                "markdown_string": {
                  "description": "Markdown content as a string",
                  "order": 2,
                  "title": "Markdown String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "html": {
                  "description": "HTML data as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "HTML",
                  "type": "string"
                },
                "html_string": {
                  "description": "HTML data",
                  "order": 2,
                  "title": "HTML",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "6c1499b5-ef30-4a39-a542-829b2311805e": {
            "nodeId": "6c1499b5-ef30-4a39-a542-829b2311805e",
            "name": "Parse Out Hosts",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{hosts:/[a-z0-9,-.]+$/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "hosts",
                    "regex": "[a-z0-9,-.]+$"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[93b0261c-9717-42f3-8ded-9b57cbb1c18c].[result]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "81c29a75-d457-47de-adea-134c076e10c5": {
            "nodeId": "81c29a75-d457-47de-adea-134c076e10c5",
            "name": "Send Host Found Message to Teams (HTML)",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[channel_name]}}",
                "message_content": "Host Found, getting info...",
                "team_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[team_name]}}",
                "thread_id": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "93b0261c-9717-42f3-8ded-9b57cbb1c18c": {
            "nodeId": "93b0261c-9717-42f3-8ded-9b57cbb1c18c",
            "name": "Parse off New Lines from HTML",
            "type": "action",
            "plugin": {
              "name": "Advanced Regex",
              "slugVendor": "rapid7",
              "slugName": "advanced_regex",
              "slugVersion": "1.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/advanced_regex/1.0.3/icon.png"
            },
            "identifier": "replace",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ascii": false,
                "dotall": false,
                "ignorecase": false,
                "in_regex": "[\\n|\\r]",
                "in_string": "{{[4de33b6d-dbdf-471f-bfe4-3e29cd9f0d6f].[text]}}",
                "max_replace": 0,
                "multiline": false,
                "replace_string": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ascii": {
                  "default": false,
                  "description": "Make \\w \\W \\b \\B follow ASCII rules",
                  "order": 8,
                  "title": "ASCII",
                  "type": "boolean"
                },
                "dotall": {
                  "default": false,
                  "description": "Make . match newline",
                  "order": 7,
                  "title": "Dot All",
                  "type": "boolean"
                },
                "ignorecase": {
                  "default": false,
                  "description": "Make regex non-case sensitive",
                  "order": 5,
                  "title": "Ignore Case",
                  "type": "boolean"
                },
                "in_regex": {
                  "description": "Regex to match",
                  "order": 3,
                  "title": "Regex",
                  "type": "string"
                },
                "in_string": {
                  "description": "Input string",
                  "order": 1,
                  "title": "Input String",
                  "type": "string"
                },
                "max_replace": {
                  "default": 0,
                  "description": "Max occurrences to replace - if zero all will be replaced",
                  "order": 4,
                  "title": "Max Replace",
                  "type": "integer"
                },
                "multiline": {
                  "default": false,
                  "description": "Make begin/end consider each line",
                  "order": 6,
                  "title": "Multiline",
                  "type": "boolean"
                },
                "replace_string": {
                  "description": "The string to replace matches with",
                  "order": 2,
                  "title": "New String",
                  "type": "string"
                }
              },
              "required": [
                "in_string",
                "in_regex"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "The result of the replace operation",
                  "order": 1,
                  "title": "Result String",
                  "type": "string"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "95895045-6f38-411d-8ae5-a273c7eb412a": {
            "nodeId": "95895045-6f38-411d-8ae5-a273c7eb412a",
            "name": "Send No CrowdStrike Agent Message to Teams (HTML)",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[channel_name]}}",
                "message_content": "<strong style=\"color: red;\">No CrowdStrike Aid for hostname</strong> <code>{{[0948a74e-0cc4-4fc3-b4c7-0faafddf2162].[$item]}}</code>",
                "team_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[team_name]}}",
                "thread_id": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "983baf8b-87c4-431e-a9f7-f2753e17c56c": {
            "nodeId": "983baf8b-87c4-431e-a9f7-f2753e17c56c",
            "name": "CrowdStrike Detections",
            "type": "action",
            "plugin": {
              "name": "CrowdStrike Falcon",
              "slugVendor": "rapid7",
              "slugName": "crowdstrike_falcon",
              "slugVersion": "2.3.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/crowdstrike_falcon/2.3.0/icon.png"
            },
            "identifier": "search_detections",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "filter": "device.device_id:'{{[4d179979-5006-463f-962b-6e70f49c3a00].[resources].[0]}}'",
                "limit": 1000,
                "offset": 0,
                "q": "",
                "sort": "first_behavior"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filter": {
                  "description": "Falcon Query Language (FQL) filter to apply to the results",
                  "order": 4,
                  "title": "FQL Filter",
                  "type": "string"
                },
                "limit": {
                  "default": 1000,
                  "description": "The maximum number of detections to return in this response. Use with the offset parameter to manage pagination of results",
                  "order": 2,
                  "title": "Limit",
                  "type": "integer"
                },
                "offset": {
                  "default": 0,
                  "description": "The first detection to return, where 0 is the latest detection. Use with the limit parameter to manage pagination of results",
                  "order": 1,
                  "title": "Detection ID Offset",
                  "type": "integer"
                },
                "q": {
                  "description": "Search all detection metadata for the provided string",
                  "order": 5,
                  "title": "Keyword Search",
                  "type": "string"
                },
                "sort": {
                  "default": "first_behavior",
                  "description": "Sort results according to certain criteria",
                  "enum": [
                    "first_behavior",
                    "last_behavior",
                    "max_severity",
                    "max_confidence",
                    "adversary_id",
                    "devices.hostname"
                  ],
                  "order": 3,
                  "title": "Sort Using",
                  "type": "string"
                }
              },
              "required": [
                "offset",
                "limit",
                "sort"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "meta": {
                  "properties": {
                    "pagination": {
                      "$ref": "#/definitions/pagination",
                      "description": "Pagination",
                      "order": 1,
                      "title": "Pagination"
                    },
                    "powered_by": {
                      "description": "Powered by",
                      "order": 3,
                      "title": "Powered By",
                      "type": "string"
                    },
                    "query_time": {
                      "description": "Query time",
                      "order": 2,
                      "title": "Query Time",
                      "type": "number"
                    },
                    "trace_id": {
                      "description": "Trace ID",
                      "order": 4,
                      "title": "Trace ID",
                      "type": "string"
                    }
                  },
                  "title": "Meta",
                  "type": "object"
                },
                "pagination": {
                  "properties": {
                    "limit": {
                      "description": "Limit",
                      "order": 2,
                      "title": "Limit",
                      "type": "integer"
                    },
                    "offset": {
                      "description": "Offset",
                      "order": 3,
                      "title": "Offset",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 1,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Pagination",
                  "type": "object"
                }
              },
              "properties": {
                "errors": {
                  "description": "Errors",
                  "items": {
                    "type": "object"
                  },
                  "order": 2,
                  "title": "Errors",
                  "type": "array"
                },
                "meta": {
                  "$ref": "#/definitions/meta",
                  "description": "Meta",
                  "order": 1,
                  "title": "Meta"
                },
                "resources": {
                  "description": "Resources",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Resources",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "afb70849-c163-40e5-9f25-7c8b34726f1e": {
            "nodeId": "afb70849-c163-40e5-9f25-7c8b34726f1e",
            "name": "Was Aid Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "63f68af1-0eaa-4da9-a6db-3ec428cd30f9",
              "stepControlParams": [
                {
                  "edgeId": "81b02185-7ef1-4254-9a36-c665bc1dafef",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "4d179979-5006-463f-962b-6e70f49c3a00.resources",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[4d179979-5006-463f-962b-6e70f49c3a00].[resources]}}) = 1"
                },
                {
                  "edgeId": "63f68af1-0eaa-4da9-a6db-3ec428cd30f9",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b092c4ed-9f61-47bb-b25c-d9133e8c2190": {
            "nodeId": "b092c4ed-9f61-47bb-b25c-d9133e8c2190",
            "name": "CrowdStrike Host Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# CrowdStrike Host: {{[0948a74e-0cc4-4fc3-b4c7-0faafddf2162].[$item]}}  \n* Last Seen: {{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[last_seen]}}  \n* Local IP: {{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[local_ip]}}  \n* Platform Name {{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[platform_name]}}  \n* OS Version: {{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[os_version]}} \n* OU: {{#each [24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[ou]}}{{this}}/{{else}}No OU{{/each}}{{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[machine_domain]}}   \n* Agent Version: {{[24e200f9-4733-47e6-a460-bde6ae320563].[resources].[0].[agent_version]}}  \n\n{{#if [ca673847-a734-4311-930c-dfdc929ba369].[Count]}}\n❗❗❗ **{{[ca673847-a734-4311-930c-dfdc929ba369].[Count]}} Detections found for host** ❗❗❗\n{{else}}\n*No Detections found*\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "ca673847-a734-4311-930c-dfdc929ba369": {
            "nodeId": "ca673847-a734-4311-930c-dfdc929ba369",
            "name": "Loop Through Detections",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "name": "677fd975-16bb-4aa3-99ff-3d8624113f83.$success",
                      "type": "variable"
                    },
                    "expressionText": "{{[677fd975-16bb-4aa3-99ff-3d8624113f83].[$success]}}"
                  },
                  "name": "Count",
                  "outputType": "count"
                }
              ],
              "innerEdgeId": "36c8a50f-38da-48d6-b996-37f35eca24cb",
              "nextEdgeId": "14e05e7e-e445-4c5a-bc2a-222014b84341",
              "repeatVariable": "{{[983baf8b-87c4-431e-a9f7-f2753e17c56c].[resources]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Count": {
                  "description": "Custom output: \"Count\"",
                  "title": "Count",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "d8fd5231-5f55-4180-bda0-55bf854c0879": {
            "nodeId": "d8fd5231-5f55-4180-bda0-55bf854c0879",
            "name": "Send Checking For Detections Message to Teams (HTML)",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[channel_name]}}",
                "message_content": "Checking for detections...",
                "team_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[team_name]}}",
                "thread_id": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "db96936b-35e7-4a19-93c2-b8e749a43308": {
            "nodeId": "db96936b-35e7-4a19-93c2-b8e749a43308",
            "name": "Send CrowdStrike Host Results Message to Teams (HTML)",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[channel_name]}}",
                "message_content": "{{[69879db8-ec15-402b-bdb8-b5b9d4e18dbd].[html_string]}}",
                "team_name": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[team_name]}}",
                "thread_id": "{{[672da7fe-297f-4aaf-9fbb-8bb98f8c1587].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "first_word",
                    "words"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Alerting & Notifications",
          "Asset Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Microsoft Teams Team Name": {
                "type": "string",
                "description": "The Team Name of your Microsoft Teams...team."
              },
              "Microsoft Teams Channel Name": {
                "type": "string",
                "description": "The name of the Channel in Microsoft Teams where this workflow may be triggered from."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "28c64f02-fe85-4e93-8dee-253ab9cbc82a",
        "identifier": "new_message_received",
        "name": "Teams Message",
        "description": "",
        "input": {
          "channel_name": "test123",
          "message_content": "!crowdstrike_actions",
          "team_name": "Dream Team"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "first_word",
                "words"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.1.1",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.1/icon.png"
        }
      }
    ]
  }
}