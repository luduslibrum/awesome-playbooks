{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T10:10:29.401264803Z",
    "workflowVersions": [
      {
        "name": "Alert on New High-Risk Vulnerability in InsightVM with Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow listens for InsightVM Webhook Events for newly discovered vulnerabilities, checks the CVSS score of each new vulnerability, and posts notifications for high-risk vulnerabilities to a Slack channel.\n\nThis workflow helps Security and IT teams raise awareness of newly discovered, high-risk vulnerabilities. The workflow includes a link to the relevant vulnerability page in InsightVM, along with host information regarding the vulnerable asset and the solution details for remediation.\n\n# Key Features\n\n* Heightened awareness of newly discovered, high-risk vulnerabilities\n* VM Events trigger utilizes InsightVM's new webhook feature\n* Flexible workflow design allows for easy customization\n\n# Requirements\n\n* Insight Platform User API Key\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* InsightVM\n* InsightConnect\n\n# Documentation\n\n## Setup\n\n**In order to use this workflow, you will need to subscribe to the InsightVM Vulnerabilities Found webhook event. You will also need to adjust the Slack channel names to match your environment.**\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nOnce the workflow has been imported, open the workflow and view the InsightVM Events trigger step. Save the trigger configuration step and proceed through the Instructions on subscribing to the InsightVM Vulnerabilities Found Webhook Event. This will require an [Insight Platform User API Key](https://docs.rapid7.com/insight/managing-platform-api-keys#generating-a-user-key). Insert your User API Key, copy the API request, run it from a command prompt, and look for a JSON response including an ID. If you receive a JSON response, then your webhook event subscription is active! Close your command prompt and return to the workflow in InsightConnect.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are two parameters you will need to configure in order to complete setup of your workflow:\n\n* Channel Name: The name of the Slack channel where high-risk vulnerability notifications should be delivered\n* Risk Threshold: The CVSS risk threshold value. Vulnerabilities above this risk threshold will be alerted on in the specified Slack channel. Recommended value: 7\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameters, activate the workflow. Any newly discovered vulnerability will generate a webhook event, which will trigger your workflow, which will look up the vulnerability CVSS score, see if it is greater than or equal to `Risk Threshold`, and then post information about high-risk vulnerabilities to the specified Slack channel!\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 Vulnerability & Exploit Database|2.1.1|1|\n|Rapid7 InsightVM Console|4.10.0|1|\n|Type Converter|1.8.1|1|\n|HTML|1.2.2|1|\n\n\n## Troubleshooting\n\nExperiencing delays? InsightVM Events are delivered to InsightConnect from InsightVM as soon as the Insight platform is notified of a change by the on-premises InsightVM Security Console. This can take anywhere from 5 minutes to several hours. Please be patient!\n\n# Version History\n\n* 2.0.0 - Add parameters feature | Update Rapid7 Vulnerability & Exploit Database plugin to version 2.1.1 | Update Type Converter plugin to version 1.8.1 | Update Rapid7 InsightVM Console plugin to version 4.10.0 | Update documentation | Remove `Settings` and `Global Artifact` steps\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 Vulnerability & Exploit Database](https://rapid7.com/db)\n* [Slack](https://slack.com)\n",
        "graph": {
          "edges": {
            "200e8873-ae2a-475f-80cd-6cddfaa29a17": {
              "id": "200e8873-ae2a-475f-80cd-6cddfaa29a17",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a35e011b-c470-4be5-a8f1-bfd85a8ff9a9",
              "toNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "671d88b5-3b92-488b-803e-5f48568e0cc1": {
              "id": "671d88b5-3b92-488b-803e-5f48568e0cc1",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "4a3f44db-41c8-4f88-a69f-08d304e2be47",
              "toNodeId": "8b04da4a-a124-40e2-ade9-659c02cad009"
            },
            "7ce61389-fa51-40ec-b214-3470d6f0bfcb": {
              "id": "7ce61389-fa51-40ec-b214-3470d6f0bfcb",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "toNodeId": "4a3f44db-41c8-4f88-a69f-08d304e2be47"
            },
            "7d66404e-b0c3-4138-adea-9959fbd93c5d": {
              "id": "7d66404e-b0c3-4138-adea-9959fbd93c5d",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "ab8750ba-a5aa-462a-a9e3-4570b0d5e291",
              "toNodeId": "bb4e78da-cc05-43d4-bed4-546e445cfe06"
            },
            "8865ad25-b3d1-4ac8-b77a-c16de104e32b": {
              "id": "8865ad25-b3d1-4ac8-b77a-c16de104e32b",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "95ae01d9-f082-47e1-8e7c-dd4845df3443",
              "toNodeId": "b876af61-bcaf-43c8-bc8b-9eb9d5d18606"
            },
            "a2de63ca-36fd-44ae-830f-523448dfc20c": {
              "id": "a2de63ca-36fd-44ae-830f-523448dfc20c",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "bb4e78da-cc05-43d4-bed4-546e445cfe06",
              "toNodeId": ""
            },
            "b41a009d-b473-498b-81e0-ebd66b8b32c1": {
              "id": "b41a009d-b473-498b-81e0-ebd66b8b32c1",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "8b04da4a-a124-40e2-ade9-659c02cad009",
              "toNodeId": "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce"
            },
            "b794724f-e89b-4db5-90d0-19fee7953aad": {
              "id": "b794724f-e89b-4db5-90d0-19fee7953aad",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "a070ef79-7030-44f3-b003-2e59cf023831",
              "toNodeId": "95ae01d9-f082-47e1-8e7c-dd4845df3443"
            },
            "c12b9313-0735-4b6a-a816-616758621b42": {
              "id": "c12b9313-0735-4b6a-a816-616758621b42",
              "name": "Ignored",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce",
              "toNodeId": ""
            },
            "cb9d09fb-4dd5-45ee-9d30-21e6463a7379": {
              "id": "cb9d09fb-4dd5-45ee-9d30-21e6463a7379",
              "name": "",
              "description": "",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "b876af61-bcaf-43c8-bc8b-9eb9d5d18606",
              "toNodeId": "ab8750ba-a5aa-462a-a9e3-4570b0d5e291"
            },
            "f68f7364-1253-44bc-93dc-36152e32b9b4": {
              "id": "f68f7364-1253-44bc-93dc-36152e32b9b4",
              "name": "High-Risk",
              "description": "CVSS score is greater than or equal to the risk threshold",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "fromNodeId": "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce",
              "toNodeId": "a070ef79-7030-44f3-b003-2e59cf023831"
            },
            "fff42645-b602-493b-8dd6-f43950c6a2e1": {
              "id": "fff42645-b602-493b-8dd6-f43950c6a2e1",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "toNodeId": ""
            }
          },
          "nodes": {
            "4a3f44db-41c8-4f88-a69f-08d304e2be47": {
              "id": "4a3f44db-41c8-4f88-a69f-08d304e2be47",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce": {
              "id": "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "8b04da4a-a124-40e2-ade9-659c02cad009": {
              "id": "8b04da4a-a124-40e2-ade9-659c02cad009",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "95ae01d9-f082-47e1-8e7c-dd4845df3443": {
              "id": "95ae01d9-f082-47e1-8e7c-dd4845df3443",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "a070ef79-7030-44f3-b003-2e59cf023831": {
              "id": "a070ef79-7030-44f3-b003-2e59cf023831",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "a35e011b-c470-4be5-a8f1-bfd85a8ff9a9": {
              "id": "a35e011b-c470-4be5-a8f1-bfd85a8ff9a9",
              "parentNodeId": ""
            },
            "ab8750ba-a5aa-462a-a9e3-4570b0d5e291": {
              "id": "ab8750ba-a5aa-462a-a9e3-4570b0d5e291",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "b876af61-bcaf-43c8-bc8b-9eb9d5d18606": {
              "id": "b876af61-bcaf-43c8-bc8b-9eb9d5d18606",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "bb4e78da-cc05-43d4-bed4-546e445cfe06": {
              "id": "bb4e78da-cc05-43d4-bed4-546e445cfe06",
              "parentNodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0"
            },
            "c2f9de14-52b7-4124-b306-5bdae4e6f3e0": {
              "id": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "4a3f44db-41c8-4f88-a69f-08d304e2be47": {
            "nodeId": "4a3f44db-41c8-4f88-a69f-08d304e2be47",
            "name": "Get Vulnerability Content",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.1.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.1.1/icon.png"
            },
            "identifier": "get_content",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "identifier": "{{[c2f9de14-52b7-4124-b306-5bdae4e6f3e0].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "identifier": {
                  "description": "Rapid7 vulnerability/module identifier",
                  "order": 1,
                  "title": "Identifier",
                  "type": "string"
                }
              },
              "required": [
                "identifier"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "content": {
                  "properties": {
                    "alternate_ids": {
                      "description": "List of alternative identifiers for the vulnerability",
                      "order": 12,
                      "title": "Alternative Identifiers",
                      "type": "string"
                    },
                    "architectures": {
                      "description": "List of applicable architectures for the module",
                      "order": 4,
                      "title": "architectures",
                      "type": "string"
                    },
                    "authors": {
                      "description": "List of module authors",
                      "order": 7,
                      "title": "Authors",
                      "type": "string"
                    },
                    "content_type": {
                      "description": "Type of returned content for module or vulnerability",
                      "order": 3,
                      "title": "Content type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Brief summary of the returned content",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 5,
                      "title": "Published_at",
                      "type": "string"
                    },
                    "rank": {
                      "description": "Rank of module",
                      "order": 8,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "references": {
                      "description": "List of references",
                      "order": 6,
                      "title": "References",
                      "type": "string"
                    },
                    "reliability": {
                      "description": "Reliability of module",
                      "order": 9,
                      "title": "Reliability",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity of vulnerability",
                      "order": 10,
                      "title": "Severity",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 11,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of Vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                }
              },
              "properties": {
                "content_result": {
                  "$ref": "#/definitions/content",
                  "description": "Content record for the vulnerability or module",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "content_result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce": {
            "nodeId": "4c9505fc-2c5b-43e9-ba2e-4498d7b7a7ce",
            "name": "Risk Greater than Risk Threshold?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c12b9313-0735-4b6a-a816-616758621b42",
              "stepControlParams": [
                {
                  "edgeId": "c12b9313-0735-4b6a-a816-616758621b42",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "f68f7364-1253-44bc-93dc-36152e32b9b4",
                  "expression": {
                    "left": {
                      "name": "8b04da4a-a124-40e2-ade9-659c02cad009.output",
                      "type": "variable"
                    },
                    "op": ">=",
                    "right": {
                      "name": "$workflow.Risk Threshold",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[8b04da4a-a124-40e2-ade9-659c02cad009].[output]}} >= {{$workflow.[Risk Threshold]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "8b04da4a-a124-40e2-ade9-659c02cad009": {
            "nodeId": "8b04da4a-a124-40e2-ade9-659c02cad009",
            "name": "Convert Severity to Float",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "string_to_float",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[severity]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted output",
                  "order": 1,
                  "title": "Output",
                  "type": "number"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "95ae01d9-f082-47e1-8e7c-dd4845df3443": {
            "nodeId": "95ae01d9-f082-47e1-8e7c-dd4845df3443",
            "name": "Post Vulnerability Alert to Slack",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":rotating_light: *NEW HIGH-RISK VULNERABILITY DETECTED!* :rotating_light: \n\n:radioactive_sign: *Vulnerability Details:* :radioactive_sign:\n* *Title:* {{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[title]}}\n* *CVSS Score:* {{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[severity]}}\n* *Publish Date:* {{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[published_at]}}\n* *Description:* \n```{{[a070ef79-7030-44f3-b003-2e59cf023831].[text]}}```\n\n\n:computer: *Asset Details:* :computer:\n* *Hostname:* {{[a35e011b-c470-4be5-a8f1-bfd85a8ff9a9].[summary].[host_name]}}\n* *IP Address:* {{[a35e011b-c470-4be5-a8f1-bfd85a8ff9a9].[summary].[ip]}}\n* *Operating System:* {{[a35e011b-c470-4be5-a8f1-bfd85a8ff9a9].[summary].[operating_system]}}\n* *Last Scanned:* {{[a35e011b-c470-4be5-a8f1-bfd85a8ff9a9].[summary].[last_scanned]}}",
                "recipient": "{{$workflow.[Channel Name]}}",
                "thread_ts": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "a070ef79-7030-44f3-b003-2e59cf023831": {
            "nodeId": "a070ef79-7030-44f3-b003-2e59cf023831",
            "name": "Strip Vulnerability Description HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[description]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a35e011b-c470-4be5-a8f1-bfd85a8ff9a9": {
            "nodeId": "a35e011b-c470-4be5-a8f1-bfd85a8ff9a9",
            "name": "Vulnerabilities Found Trigger",
            "description": "Triggered from InsightVM Vulnerabilities Found Webhook Event.",
            "type": "trigger",
            "identifier": "vulnerabilities_found",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "06e4c710-4da6-4048-aaef-bc538ab09870",
            "defaultInputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-vm.svg",
            "connectionType": "NONE"
          },
          "ab8750ba-a5aa-462a-a9e3-4570b0d5e291": {
            "nodeId": "ab8750ba-a5aa-462a-a9e3-4570b0d5e291",
            "name": "Lookup Vulnerability",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.10.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.10.0/icon.png"
            },
            "identifier": "get_vulnerability",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[c2f9de14-52b7-4124-b306-5bdae4e6f3e0].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "The identifier of the vulnerability to retrieve from InsightVM",
                  "order": 1,
                  "title": "Vulnerability ID",
                  "type": "string"
                }
              },
              "required": [
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "cvss": {
                  "properties": {
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 1,
                      "title": "Links",
                      "type": "array"
                    },
                    "v2": {
                      "$ref": "#/definitions/cvss_v2",
                      "description": "CVSSv2 details",
                      "order": 2,
                      "title": "V2"
                    },
                    "v3": {
                      "$ref": "#/definitions/cvss_v3",
                      "description": "CVSSv3 details",
                      "order": 3,
                      "title": "V3"
                    }
                  },
                  "title": "Cvss",
                  "type": "object"
                },
                "cvss_v2": {
                  "properties": {
                    "accessComplexity": {
                      "description": "CVSSv2 access complexity metric",
                      "order": 1,
                      "title": "Access Complexity",
                      "type": "string"
                    },
                    "accessVector": {
                      "description": "CVSSv2 access vector metric",
                      "order": 2,
                      "title": "Access Vector",
                      "type": "string"
                    },
                    "authentication": {
                      "description": "CVSSv2 authentication metric",
                      "order": 3,
                      "title": "Authentication",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv2 availability impact metric",
                      "order": 4,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv2 confidentiality impact metric",
                      "order": 5,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv2 combined exploit metric score (Access Complexity/Access Vector/Authentication)",
                      "order": 6,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 7,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv2 integrity impact metric",
                      "order": 8,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv2 score",
                      "order": 9,
                      "title": "Score",
                      "type": "number"
                    },
                    "vector": {
                      "description": "CVSSv2 combined vector string",
                      "order": 10,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V2",
                  "type": "object"
                },
                "cvss_v3": {
                  "properties": {
                    "attackComplexity": {
                      "description": "CVSSv3 attack complexity metric",
                      "order": 1,
                      "title": "Attack Complexity",
                      "type": "string"
                    },
                    "attackVector": {
                      "description": "CVSSv3 attack vector metric",
                      "order": 2,
                      "title": "Attack Vector",
                      "type": "string"
                    },
                    "availabilityImpact": {
                      "description": "CVSSv3 availability impact metric",
                      "order": 3,
                      "title": "Availability Impact",
                      "type": "string"
                    },
                    "confidentialityImpact": {
                      "description": "CVSSv3 confidentiality impact metric",
                      "order": 4,
                      "title": "Confidentiality Impact",
                      "type": "string"
                    },
                    "exploitScore": {
                      "description": "CVSSv3 combined exploit metric score (Attack Complexity/Attack Vector/Privilege Required/Scope/User Interaction)",
                      "order": 5,
                      "title": "Exploit Score",
                      "type": "number"
                    },
                    "impactScore": {
                      "description": "CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)",
                      "order": 6,
                      "title": "Impact Score",
                      "type": "number"
                    },
                    "integrityImpact": {
                      "description": "CVSSv3 integrity impact metric",
                      "order": 7,
                      "title": "Integrity Impact",
                      "type": "string"
                    },
                    "privilegeRequired": {
                      "description": "CVSSv3 privilege required metric",
                      "order": 8,
                      "title": "Privilege Required",
                      "type": "string"
                    },
                    "scope": {
                      "description": "CVSSv3 scope metric",
                      "order": 9,
                      "title": "Scope",
                      "type": "string"
                    },
                    "score": {
                      "description": "CVSSv3 score",
                      "order": 10,
                      "title": "Score",
                      "type": "number"
                    },
                    "userInteraction": {
                      "description": "CVSSv3 user interaction metric",
                      "order": 11,
                      "title": "User Interaction",
                      "type": "string"
                    },
                    "vector": {
                      "description": "CVSSv3 combined vector string",
                      "order": 12,
                      "title": "Vector",
                      "type": "string"
                    }
                  },
                  "title": "Cvss V3",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "pci": {
                  "properties": {
                    "adjustedCVSSScore": {
                      "description": "PCI adjusted CVSS score",
                      "order": 1,
                      "title": "Adjusted CVSS score",
                      "type": "integer"
                    },
                    "adjustedSeverityScore": {
                      "description": "PCI adjusted severity score",
                      "order": 2,
                      "title": "Adjusted severity score",
                      "type": "integer"
                    },
                    "fail": {
                      "description": "Whether this vulnerability results in a PCI assessment failure",
                      "order": 3,
                      "title": "Fail",
                      "type": "boolean"
                    },
                    "specialNotes": {
                      "description": "PCI special notes",
                      "order": 4,
                      "title": "Special Notes",
                      "type": "string"
                    },
                    "status": {
                      "description": "PCI status",
                      "order": 5,
                      "title": "Status",
                      "type": "string"
                    }
                  },
                  "title": "Pci",
                  "type": "object"
                },
                "vulnerability": {
                  "properties": {
                    "added": {
                      "description": "Date that the vulnerability was added to InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 1,
                      "title": "Added",
                      "type": "string"
                    },
                    "categories": {
                      "description": "List of vulnerabilities categories with which this vulnerability is affiliated",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Categories",
                      "type": "array"
                    },
                    "cves": {
                      "description": "List of CVE identifiers associated with this vulnerability",
                      "items": {
                        "type": "string"
                      },
                      "order": 17,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "cvss": {
                      "$ref": "#/definitions/cvss",
                      "description": "Vulnerability CVSS details",
                      "order": 15,
                      "title": "CVSS"
                    },
                    "denialOfService": {
                      "description": "Whether the vulnerability is a denial of service vulnerability",
                      "order": 7,
                      "title": "Denial of Service",
                      "type": "boolean"
                    },
                    "description": {
                      "$ref": "#/definitions/vulnerability_description",
                      "description": "Vulnerability description",
                      "order": 3,
                      "title": "Description"
                    },
                    "exploits": {
                      "description": "Exploit count",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "id": {
                      "description": "Vulnerability ID",
                      "order": 9,
                      "title": "ID",
                      "type": "string"
                    },
                    "links": {
                      "description": "List of hypermedia links to corresponding resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "malwareKits": {
                      "description": "Malware kit count",
                      "order": 6,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "modified": {
                      "description": "Date the vulnerability was last modified in InsightVM",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 8,
                      "title": "Modified",
                      "type": "string"
                    },
                    "pci": {
                      "$ref": "#/definitions/pci",
                      "description": "Vulnerability PCI details",
                      "order": 11,
                      "title": "PCI"
                    },
                    "published": {
                      "description": "Date the vulnerability was published",
                      "displayType": "date",
                      "format": "date-time",
                      "order": 12,
                      "title": "Published",
                      "type": "string"
                    },
                    "riskScore": {
                      "description": "Vulnerability risk score using the configured risk scoring strategy (RealRisk by default)",
                      "order": 14,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "severity": {
                      "description": "Vulnerability severity string (Moderate/Severe/Critical)",
                      "order": 13,
                      "title": "Severity",
                      "type": "string"
                    },
                    "severityScore": {
                      "description": "Vulnerability severity score",
                      "order": 10,
                      "title": "Severity Score",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Vulnerability title",
                      "order": 5,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability",
                  "type": "object"
                },
                "vulnerability_description": {
                  "properties": {
                    "html": {
                      "description": "Vulnerability description HTML",
                      "order": 1,
                      "title": "HTML",
                      "type": "string"
                    },
                    "text": {
                      "description": "Vulnerability description raw text",
                      "order": 2,
                      "title": "Text",
                      "type": "string"
                    }
                  },
                  "title": "Vulnerability Description",
                  "type": "object"
                }
              },
              "properties": {
                "vulnerability": {
                  "$ref": "#/definitions/vulnerability",
                  "description": "The details of the vulnerability requested",
                  "order": 1,
                  "title": "Vulnerability Details"
                }
              },
              "required": [
                "vulnerability"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b876af61-bcaf-43c8-bc8b-9eb9d5d18606": {
            "nodeId": "b876af61-bcaf-43c8-bc8b-9eb9d5d18606",
            "name": "Fetching More Data Notification",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_Fetching more vulnerability data from your InsightVM instance. Please hold :musical_score:_",
                "recipient": "{{$workflow.[Channel Name]}}",
                "thread_ts": "{{[95ae01d9-f082-47e1-8e7c-dd4845df3443].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "bb4e78da-cc05-43d4-bed4-546e445cfe06": {
            "nodeId": "bb4e78da-cc05-43d4-bed4-546e445cfe06",
            "name": "Thread Vulnerability Details",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*More Vulnerability Details*\n* CVE(s): {{[ab8750ba-a5aa-462a-a9e3-4570b0d5e291].[vulnerability].[cves]}}\n* Exploits: {{[ab8750ba-a5aa-462a-a9e3-4570b0d5e291].[vulnerability].[exploits]}}\n* Malware Kits: {{[ab8750ba-a5aa-462a-a9e3-4570b0d5e291].[vulnerability].[malwareKits]}}\n* InsightVM RealRisk Score: {{[ab8750ba-a5aa-462a-a9e3-4570b0d5e291].[vulnerability].[riskScore]}}\n* Description:\n```{{[ab8750ba-a5aa-462a-a9e3-4570b0d5e291].[vulnerability].[description].[text]}}```\n* Solution(s):\n```{{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result].[solutions]}}```",
                "recipient": "{{$workflow.[Channel Name]}}",
                "thread_ts": "{{[95ae01d9-f082-47e1-8e7c-dd4845df3443].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "c2f9de14-52b7-4124-b306-5bdae4e6f3e0": {
            "nodeId": "c2f9de14-52b7-4124-b306-5bdae4e6f3e0",
            "name": "Process Vulnerabilities",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": null,
                    "value": "{{[4a3f44db-41c8-4f88-a69f-08d304e2be47].[content_result]}}",
                    "valueType": "object"
                  },
                  "name": "Vulnerability Details",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "7ce61389-fa51-40ec-b214-3470d6f0bfcb",
              "nextEdgeId": "fff42645-b602-493b-8dd6-f43950c6a2e1",
              "repeatVariable": "{{[a35e011b-c470-4be5-a8f1-bfd85a8ff9a9].[changes].[asset_vulnerabilities_found]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Vulnerability Details": {
                  "description": "Custom output: \"Vulnerability Details\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "Vulnerability Details",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Alerting & Notifications",
          "Rapid7",
          "Slack",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channel Name": {
                "type": "string",
                "description": "The name of the Slack channel where high-risk vulnerability notifications should be delivered"
              },
              "Risk Threshold": {
                "type": "integer",
                "description": "The CVSS risk threshold value. Vulnerabilities above this risk threshold will be alerted on in the specified Slack channel. Recommended value: 7"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "06e4c710-4da6-4048-aaef-bc538ab09870",
        "identifier": "vulnerabilities_found",
        "name": "Vulnerabilities Found Trigger",
        "description": "Triggered from InsightVM Vulnerabilities Found Webhook Event.",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_vm_webhook"
      }
    ]
  }
}