{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:35:45.616498312Z",
    "workflowVersions": [
      {
        "name": "Correlate Mimecast and Netskope Events with InsightIDR UBA Alerts and Contain with the Insight Agent",
        "type": "runnable",
        "version": "",
        "description": "# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Workflow Control Panel in InsightConnect. Create or select Connections and rename the Workflow as necessary.\n\n## Usage\n\nThis workflow can be paired to any InsightIDR UBA Alerts. It can be set to run automatically upon UBA Alert generation, and/or manually from the Take Action dropdown of an Investigation in InsightIDR. Once you've imported the workflow into InsightConnect, refer to the Manual and Automatic trigger instructions on the Workflow Details tab of your Workflow Control panel.\n\nWhen this workflow runs, it will parse out the user associated with the alert and run two automated queries against Mimecast and Netskope logs. The workflow will query for any virus-related detections in Mimecast over the last hour, and it will also query for any DLP events in Netskope over the last hour for the same user. The intention of these queries is to help ascertain whether the incident is potentially more critical, as any Mimecast and Netskope query results would indicate that there is a greater volume of suspicious activity originating from the same user.\n\nThe query results will be presented as Artifacts in the InsightConnect Job details, also viewable from the related InsightIDR Investigation. Then, you will be presented with a choice in the form of a Human Decision step - whether you would like to quarantine the associated asset using the Rapid7 Insight Agent, or do nothing. If you do not make a choice within 10 minutes, the workflow will automatically do nothing; this setting can be changed within the Workflow Builder when viewing the \"Quarantine Decision\" step.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|\n|----|----|\n|Rapid7 InsightIDR|3.2.0|\n|Rapid7 Insight Agent|1.0.4|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n",
        "graph": {
          "edges": {
            "02c45453-0f35-42a9-9371-3ae6a5b54762": {
              "id": "02c45453-0f35-42a9-9371-3ae6a5b54762",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "99cdbb1d-6e39-431e-a87e-6618c68ce2e8",
              "toNodeId": "d4333c78-b321-454a-b990-1f6b02f91005"
            },
            "0491a87c-572b-4771-af57-f4e06fb7426b": {
              "id": "0491a87c-572b-4771-af57-f4e06fb7426b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2609b393-8365-4ec6-ae1c-31147eca4914",
              "toNodeId": "52e19f21-2111-4dd0-8044-765106359ccd"
            },
            "1312c99e-5691-436e-b79a-abf0c476996e": {
              "id": "1312c99e-5691-436e-b79a-abf0c476996e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504",
              "toNodeId": "2609b393-8365-4ec6-ae1c-31147eca4914"
            },
            "1a41631a-df28-401e-b5a7-5e472690e9d9": {
              "id": "1a41631a-df28-401e-b5a7-5e472690e9d9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e9e23ae1-e097-41a2-87a2-059e7faf6868",
              "toNodeId": "b855e7fe-495f-40a7-85ce-1214ca0a8db7"
            },
            "24dd4257-b13f-48ae-9a8b-c8cdd03136b6": {
              "id": "24dd4257-b13f-48ae-9a8b-c8cdd03136b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "42355aea-40fc-4b27-a5d9-1b9e13aea796",
              "toNodeId": ""
            },
            "262db396-77ae-4b05-966f-9905e0424aba": {
              "id": "262db396-77ae-4b05-966f-9905e0424aba",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a",
              "toNodeId": "99cdbb1d-6e39-431e-a87e-6618c68ce2e8"
            },
            "2c0f2932-2142-4e2b-9600-4854869e643d": {
              "id": "2c0f2932-2142-4e2b-9600-4854869e643d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "188e04b2-b89d-403d-b6ac-56ff4ce4e06c",
              "toNodeId": ""
            },
            "2d56f364-5d1b-4626-a92d-a6c62cdc2a43": {
              "id": "2d56f364-5d1b-4626-a92d-a6c62cdc2a43",
              "name": "Full",
              "description": "Both the Mimecast & Netskope queries returned results.",
              "parentNodeId": "",
              "fromNodeId": "d4333c78-b321-454a-b990-1f6b02f91005",
              "toNodeId": "097ab770-1751-4ed3-98f1-06abb380aa92"
            },
            "45859b06-9148-4cfb-8b99-183e15342ef4": {
              "id": "45859b06-9148-4cfb-8b99-183e15342ef4",
              "name": "Contain the Asset(s)",
              "description": "If chosen, InsightConnect will attempt to quarantine the associated asset(s) using the Rapid7 Insight Agent.",
              "parentNodeId": "",
              "fromNodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1",
              "toNodeId": "c018e3a3-c224-4849-a00e-730f7237016a"
            },
            "515b1251-eb63-4ce4-9204-f3ee265b1e5b": {
              "id": "515b1251-eb63-4ce4-9204-f3ee265b1e5b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0152788f-9170-4bc3-a0d1-34a7d845949f",
              "toNodeId": "e090b21e-29da-4eda-bb6d-8f68caf4382f"
            },
            "54b99d3a-5930-408a-8b85-2db2b34f1507": {
              "id": "54b99d3a-5930-408a-8b85-2db2b34f1507",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "52e19f21-2111-4dd0-8044-765106359ccd",
              "toNodeId": "614b424e-2164-4a77-ab2f-a3e59336739f"
            },
            "6204eb09-3fc1-48c2-a093-45310d931263": {
              "id": "6204eb09-3fc1-48c2-a093-45310d931263",
              "name": "No Results",
              "description": "Neither queries returned results.",
              "parentNodeId": "",
              "fromNodeId": "d4333c78-b321-454a-b990-1f6b02f91005",
              "toNodeId": "0152788f-9170-4bc3-a0d1-34a7d845949f"
            },
            "7b9e1c04-1d50-4194-bd1f-698f60a1a1df": {
              "id": "7b9e1c04-1d50-4194-bd1f-698f60a1a1df",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "097ab770-1751-4ed3-98f1-06abb380aa92",
              "toNodeId": "e090b21e-29da-4eda-bb6d-8f68caf4382f"
            },
            "7c59160e-fe02-481a-953c-fc9096b2e98b": {
              "id": "7c59160e-fe02-481a-953c-fc9096b2e98b",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "52e19f21-2111-4dd0-8044-765106359ccd",
              "toNodeId": "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a"
            },
            "8c7aa42b-6bb9-44d6-a492-ca10935ed26a": {
              "id": "8c7aa42b-6bb9-44d6-a492-ca10935ed26a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975",
              "toNodeId": "29653370-5af2-4fea-9e84-fe77ba9c85bd"
            },
            "917fbd2b-cbf0-4dd6-8ac5-f109ef4858ac": {
              "id": "917fbd2b-cbf0-4dd6-8ac5-f109ef4858ac",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "614b424e-2164-4a77-ab2f-a3e59336739f",
              "toNodeId": "99cdbb1d-6e39-431e-a87e-6618c68ce2e8"
            },
            "91b52175-f8bc-417c-a845-4084fd5b94d0": {
              "id": "91b52175-f8bc-417c-a845-4084fd5b94d0",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "29653370-5af2-4fea-9e84-fe77ba9c85bd",
              "toNodeId": "e25610c2-bfd6-4700-b8c9-560a39882a67"
            },
            "92013c7c-0fcd-4f76-b8fa-cae7877ec108": {
              "id": "92013c7c-0fcd-4f76-b8fa-cae7877ec108",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c018e3a3-c224-4849-a00e-730f7237016a",
              "toNodeId": "b98a66e0-5fc4-41e5-95a1-43889421c152"
            },
            "a8f06f60-0e1c-476c-8aac-79e040424f0e": {
              "id": "a8f06f60-0e1c-476c-8aac-79e040424f0e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e090b21e-29da-4eda-bb6d-8f68caf4382f",
              "toNodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1"
            },
            "ad750f0e-d6e4-4972-8685-cc3145c16571": {
              "id": "ad750f0e-d6e4-4972-8685-cc3145c16571",
              "name": "Asset Quarantined",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b98a66e0-5fc4-41e5-95a1-43889421c152",
              "toNodeId": "42355aea-40fc-4b27-a5d9-1b9e13aea796"
            },
            "af6b5ed8-0354-4d97-bc49-8c6e728eb012": {
              "id": "af6b5ed8-0354-4d97-bc49-8c6e728eb012",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "29653370-5af2-4fea-9e84-fe77ba9c85bd",
              "toNodeId": "64659457-7cb4-4562-8106-cee6dc7eb819"
            },
            "b9d0c3d2-b2f0-4e0a-a2af-77df5099871e": {
              "id": "b9d0c3d2-b2f0-4e0a-a2af-77df5099871e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b855e7fe-495f-40a7-85ce-1214ca0a8db7",
              "toNodeId": "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975"
            },
            "be7ac625-141a-4bc3-b256-25737284c0d0": {
              "id": "be7ac625-141a-4bc3-b256-25737284c0d0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "64659457-7cb4-4562-8106-cee6dc7eb819",
              "toNodeId": "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504"
            },
            "cf888dff-7712-4bc5-bbf2-b10472d7c0dd": {
              "id": "cf888dff-7712-4bc5-bbf2-b10472d7c0dd",
              "name": "Quarantine Failed",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b98a66e0-5fc4-41e5-95a1-43889421c152",
              "toNodeId": "eeecfe06-418c-41ad-9458-3063c92f92d1"
            },
            "de7b8eb3-dbdc-4abe-b791-1983538f5b86": {
              "id": "de7b8eb3-dbdc-4abe-b791-1983538f5b86",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "19872c39-99d5-450f-bee6-711a809fed3c",
              "toNodeId": "e090b21e-29da-4eda-bb6d-8f68caf4382f"
            },
            "e29db235-7fe4-4200-9ccd-5a247c1b7df0": {
              "id": "e29db235-7fe4-4200-9ccd-5a247c1b7df0",
              "name": "Do Nothing",
              "description": "If chosen, InsightConnect will do nothing.",
              "parentNodeId": "",
              "fromNodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1",
              "toNodeId": "188e04b2-b89d-403d-b6ac-56ff4ce4e06c"
            },
            "ed46358e-d2fa-4eca-8609-3fcb6fb87f3b": {
              "id": "ed46358e-d2fa-4eca-8609-3fcb6fb87f3b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "eeecfe06-418c-41ad-9458-3063c92f92d1",
              "toNodeId": ""
            },
            "eeca9289-c6dd-457a-a5ed-e989b5bec3bb": {
              "id": "eeca9289-c6dd-457a-a5ed-e989b5bec3bb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e25610c2-bfd6-4700-b8c9-560a39882a67",
              "toNodeId": "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504"
            },
            "f587efba-20c7-42ef-a12a-f258f79ef95b": {
              "id": "f587efba-20c7-42ef-a12a-f258f79ef95b",
              "name": "Partial",
              "description": "Either the Mimecast or Netskope queries returned results, but not both.",
              "parentNodeId": "",
              "fromNodeId": "d4333c78-b321-454a-b990-1f6b02f91005",
              "toNodeId": "19872c39-99d5-450f-bee6-711a809fed3c"
            }
          },
          "nodes": {
            "0152788f-9170-4bc3-a0d1-34a7d845949f": {
              "id": "0152788f-9170-4bc3-a0d1-34a7d845949f",
              "parentNodeId": ""
            },
            "097ab770-1751-4ed3-98f1-06abb380aa92": {
              "id": "097ab770-1751-4ed3-98f1-06abb380aa92",
              "parentNodeId": ""
            },
            "188e04b2-b89d-403d-b6ac-56ff4ce4e06c": {
              "id": "188e04b2-b89d-403d-b6ac-56ff4ce4e06c",
              "parentNodeId": ""
            },
            "19872c39-99d5-450f-bee6-711a809fed3c": {
              "id": "19872c39-99d5-450f-bee6-711a809fed3c",
              "parentNodeId": ""
            },
            "2609b393-8365-4ec6-ae1c-31147eca4914": {
              "id": "2609b393-8365-4ec6-ae1c-31147eca4914",
              "parentNodeId": ""
            },
            "29653370-5af2-4fea-9e84-fe77ba9c85bd": {
              "id": "29653370-5af2-4fea-9e84-fe77ba9c85bd",
              "parentNodeId": ""
            },
            "42355aea-40fc-4b27-a5d9-1b9e13aea796": {
              "id": "42355aea-40fc-4b27-a5d9-1b9e13aea796",
              "parentNodeId": ""
            },
            "52e19f21-2111-4dd0-8044-765106359ccd": {
              "id": "52e19f21-2111-4dd0-8044-765106359ccd",
              "parentNodeId": ""
            },
            "614b424e-2164-4a77-ab2f-a3e59336739f": {
              "id": "614b424e-2164-4a77-ab2f-a3e59336739f",
              "parentNodeId": ""
            },
            "64659457-7cb4-4562-8106-cee6dc7eb819": {
              "id": "64659457-7cb4-4562-8106-cee6dc7eb819",
              "parentNodeId": ""
            },
            "99cdbb1d-6e39-431e-a87e-6618c68ce2e8": {
              "id": "99cdbb1d-6e39-431e-a87e-6618c68ce2e8",
              "parentNodeId": ""
            },
            "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975": {
              "id": "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975",
              "parentNodeId": ""
            },
            "b855e7fe-495f-40a7-85ce-1214ca0a8db7": {
              "id": "b855e7fe-495f-40a7-85ce-1214ca0a8db7",
              "parentNodeId": ""
            },
            "b98a66e0-5fc4-41e5-95a1-43889421c152": {
              "id": "b98a66e0-5fc4-41e5-95a1-43889421c152",
              "parentNodeId": ""
            },
            "c018e3a3-c224-4849-a00e-730f7237016a": {
              "id": "c018e3a3-c224-4849-a00e-730f7237016a",
              "parentNodeId": ""
            },
            "ca97d519-a6c8-4b56-8400-dbb591aaded1": {
              "id": "ca97d519-a6c8-4b56-8400-dbb591aaded1",
              "parentNodeId": ""
            },
            "d4333c78-b321-454a-b990-1f6b02f91005": {
              "id": "d4333c78-b321-454a-b990-1f6b02f91005",
              "parentNodeId": ""
            },
            "e090b21e-29da-4eda-bb6d-8f68caf4382f": {
              "id": "e090b21e-29da-4eda-bb6d-8f68caf4382f",
              "parentNodeId": ""
            },
            "e25610c2-bfd6-4700-b8c9-560a39882a67": {
              "id": "e25610c2-bfd6-4700-b8c9-560a39882a67",
              "parentNodeId": ""
            },
            "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504": {
              "id": "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504",
              "parentNodeId": ""
            },
            "e9e23ae1-e097-41a2-87a2-059e7faf6868": {
              "id": "e9e23ae1-e097-41a2-87a2-059e7faf6868",
              "parentNodeId": ""
            },
            "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a": {
              "id": "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a",
              "parentNodeId": ""
            },
            "eeecfe06-418c-41ad-9458-3063c92f92d1": {
              "id": "eeecfe06-418c-41ad-9458-3063c92f92d1",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0152788f-9170-4bc3-a0d1-34a7d845949f": {
            "nodeId": "0152788f-9170-4bc3-a0d1-34a7d845949f",
            "name": "User has no Other Alerts",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The user `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users].[0].[name]}}` associated with the \"{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[name]}}\" alert from InsightIDR was not associated with suspicious alerts from Mimecast & Netskope within the last hour. \n\nCheck the other Artifacts for more details about the Mimecast & Netskope queries."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "097ab770-1751-4ed3-98f1-06abb380aa92": {
            "nodeId": "097ab770-1751-4ed3-98f1-06abb380aa92",
            "name": "User has Mimecast and Netskope Alerts",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The user `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users].[0].[name]}}` associated with the \"{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[name]}}\" alert from InsightIDR was also associated with alerts from Mimecast & Netskope in the last hour. This could indicate a more serious incident.\n\nCheck the other Artifacts for more details about the Mimecast & Netskope activity."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "188e04b2-b89d-403d-b6ac-56ff4ce4e06c": {
            "nodeId": "188e04b2-b89d-403d-b6ac-56ff4ce4e06c",
            "name": "Decided Not to Quarantine",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "A user decided that the asset `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[shortname]}}` should not be quarantined using the Rapid7 Insight Agent."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "19872c39-99d5-450f-bee6-711a809fed3c": {
            "nodeId": "19872c39-99d5-450f-bee6-711a809fed3c",
            "name": "User has Mimecast or Netskope Alerts",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "The user `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users].[0].[name]}}` associated with the \"{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[name]}}\" alert from InsightIDR was associated with suspicious alerts from either Mimecast or Netskope within the last hour. \n\nCheck the other Artifacts for more details about the Mimecast & Netskope results."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "2609b393-8365-4ec6-ae1c-31147eca4914": {
            "nodeId": "2609b393-8365-4ec6-ae1c-31147eca4914",
            "name": "Query Netskope Logs",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightIDR",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightidr",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightidr/3.2.0/icon.png"
            },
            "identifier": "advanced_query_on_log_set",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "log_set": "Unparsed Data",
                "query": "where(header.device_event_class_id=DLP AND user={{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users].[0].[emails].[0]}})",
                "relative_time": "Last 1 Hour",
                "time_from": "",
                "time_to": "",
                "timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "log_set": {
                  "description": "Log Set to search",
                  "enum": [
                    "Advanced Malware Alert",
                    "Active Directory Admin Activity",
                    "Asset Authentication",
                    "Cloud Service Admin Activity",
                    "Cloud Service Activity",
                    "DNS Query",
                    "Endpoint Activity",
                    "EndPoint Agent",
                    "Exploit Mitigation Alert",
                    "File Access Activity",
                    "File Modification Activity",
                    "Firewall Activity",
                    "Network Flow",
                    "Host To IP Observations",
                    "IDS Alert",
                    "Ingress Authentication",
                    "Raw Log",
                    "SSO Authentication",
                    "Unparsed Data",
                    "Third Party Alert",
                    "Virus Alert",
                    "Web Proxy Activity"
                  ],
                  "order": 6,
                  "title": "Log Set",
                  "type": "string"
                },
                "query": {
                  "description": "LQL Query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "relative_time": {
                  "default": "Last 5 Minutes",
                  "description": "A relative time in the past to look for alerts",
                  "enum": [
                    "Last 5 Minutes",
                    "Last 10 Minutes",
                    "Last 20 Minutes",
                    "Last 30 Minutes",
                    "Last 45 Minutes",
                    "Last 1 Hour",
                    "Last 2 Hours",
                    "Last 3 Hours",
                    "Last 6 Hours",
                    "Last 12 Hours",
                    "Use Time From Value"
                  ],
                  "order": 2,
                  "title": "Relative Time",
                  "type": "string"
                },
                "time_from": {
                  "description": "Beginning date and time for the query. This will be ignored unless Relative Time input is set to 'Use Time From Value'. The format is flexible and will work with simple dates (e.g. 01-01-2020) to full ISO time (e.g. 01-01-2020T00:00:00)",
                  "order": 3,
                  "title": "Time From",
                  "type": "string"
                },
                "time_to": {
                  "description": "Date and time for the end of the query. If left blank, the current time will be used. The format is flexible and will work with simple dates (e.g. 01-01-2020) to full ISO time (e.g. 01-01-2020T00:00:00)",
                  "order": 4,
                  "title": "Time To",
                  "type": "string"
                },
                "timeout": {
                  "default": 60,
                  "description": "Time in seconds to wait for the query to return. If exceeded the plugin will throw an error",
                  "order": 5,
                  "title": "Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "query",
                "relative_time",
                "timeout",
                "log_set"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "eventData": {
                  "properties": {
                    "asSignatureCreationTime": {
                      "description": "As signature creation time",
                      "order": 6,
                      "title": "As Signature Creation Time",
                      "type": "string"
                    },
                    "assignatureVersion": {
                      "description": "As signature version",
                      "order": 4,
                      "title": "As Signature Version",
                      "type": "string"
                    },
                    "avSignatureCreationTime": {
                      "description": "AV signature creation time",
                      "order": 20,
                      "title": "AV Signature Creation Time",
                      "type": "string"
                    },
                    "avsignatureVersion": {
                      "description": "AV signature version",
                      "order": 21,
                      "title": "AV Signature Version",
                      "type": "string"
                    },
                    "bmState": {
                      "description": "BMS state",
                      "order": 11,
                      "title": "BMS State",
                      "type": "string"
                    },
                    "data": {
                      "description": "Data",
                      "items": {
                        "type": "object"
                      },
                      "order": 18,
                      "title": "Data",
                      "type": "array"
                    },
                    "engineVersion": {
                      "description": "Engine version",
                      "order": 10,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "ioavState": {
                      "description": "IOAV state",
                      "order": 5,
                      "title": "IOAV State",
                      "type": "string"
                    },
                    "lastAsSignatureAge": {
                      "description": "Last as signature age",
                      "order": 2,
                      "title": "Last As Signature Age",
                      "type": "string"
                    },
                    "lastAvSignatureAge": {
                      "description": "Last AV signature age",
                      "order": 22,
                      "title": "Last AV Signature Age",
                      "type": "string"
                    },
                    "lastFullScanAge": {
                      "description": "Last full scan age",
                      "order": 25,
                      "title": "Last Full Scan Age",
                      "type": "string"
                    },
                    "lastFullScanEndTime": {
                      "description": "Last full scan end time",
                      "order": 13,
                      "title": "Last Full Scan End Time",
                      "type": "string"
                    },
                    "lastFullScanSource": {
                      "description": "Last full scan source",
                      "order": 7,
                      "title": "Last Full Scan Source",
                      "type": "string"
                    },
                    "lastFullScanStartTime": {
                      "description": "Last full scan start time",
                      "order": 9,
                      "title": "Last Full Scan Start Time",
                      "type": "string"
                    },
                    "lastQuickScanAge": {
                      "description": "Last quick scan age",
                      "order": 17,
                      "title": "Last Quick Scan Age",
                      "type": "string"
                    },
                    "lastQuickScanEndTime": {
                      "description": "Last quick scan end time",
                      "order": 19,
                      "title": "Last Quick Scan End Time",
                      "type": "string"
                    },
                    "lastQuickScanSource": {
                      "description": "Last quick scan source",
                      "order": 12,
                      "title": "Last Quick Scan Source",
                      "type": "string"
                    },
                    "lastQuickScanStartTime": {
                      "description": "Last quick scan start time",
                      "order": 24,
                      "title": "Last Quick Scan Start Time",
                      "type": "string"
                    },
                    "nriEngineVersion": {
                      "description": "NRI engine version",
                      "order": 23,
                      "title": "NRI Engine Version",
                      "type": "string"
                    },
                    "nriSignatureVersion": {
                      "description": "NRI signature version",
                      "order": 8,
                      "title": "NRI Signature Version",
                      "type": "string"
                    },
                    "oaState": {
                      "description": "OA state",
                      "order": 1,
                      "title": "OA State",
                      "type": "string"
                    },
                    "platformVersion": {
                      "description": "Platform version",
                      "order": 16,
                      "title": "Platform Version",
                      "type": "string"
                    },
                    "productName": {
                      "description": "Product name",
                      "order": 14,
                      "title": "Product Name",
                      "type": "string"
                    },
                    "productStatus": {
                      "description": "Product status",
                      "order": 3,
                      "title": "Product Status",
                      "type": "string"
                    },
                    "rtpState": {
                      "description": "RTP state",
                      "order": 15,
                      "title": "RTP State",
                      "type": "string"
                    }
                  },
                  "title": "EventData",
                  "type": "object"
                },
                "events": {
                  "properties": {
                    "labels": {
                      "description": "List of labels",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Labels",
                      "type": "array"
                    },
                    "links": {
                      "description": "Links",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 6,
                      "title": "Links",
                      "type": "array"
                    },
                    "log_id": {
                      "description": "Log ID",
                      "order": 4,
                      "title": "Log ID",
                      "type": "string"
                    },
                    "message": {
                      "$ref": "#/definitions/message",
                      "description": "Message",
                      "order": 5,
                      "title": "Message"
                    },
                    "sequence_number": {
                      "description": "Sequence number",
                      "order": 3,
                      "title": "Sequence Number",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "Timestamp",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Events",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "HREF",
                      "order": 2,
                      "title": "HREF",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Relation",
                      "order": 1,
                      "title": "Relation",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "computerName": {
                      "order": 3,
                      "title": "Computer Name",
                      "type": "string"
                    },
                    "eventCode": {
                      "order": 2,
                      "title": "Event Code",
                      "type": "integer"
                    },
                    "eventData": {
                      "$ref": "#/definitions/eventData",
                      "order": 6,
                      "title": "Event Data"
                    },
                    "isDomainController": {
                      "order": 5,
                      "title": "Is Domain Controller",
                      "type": "boolean"
                    },
                    "sid": {
                      "order": 4,
                      "title": "SID",
                      "type": "string"
                    },
                    "sourceName": {
                      "order": 1,
                      "title": "Source Name",
                      "type": "string"
                    },
                    "timeWritten": {
                      "order": 7,
                      "title": "Time Written",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "count": {
                  "description": "Number of log entries found",
                  "order": 2,
                  "title": "Count",
                  "type": "integer"
                },
                "results": {
                  "description": "Query Results",
                  "items": {
                    "$ref": "#/definitions/events"
                  },
                  "order": 1,
                  "title": "Query Results",
                  "type": "array"
                }
              },
              "required": [
                "results",
                "count"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "29653370-5af2-4fea-9e84-fe77ba9c85bd": {
            "nodeId": "29653370-5af2-4fea-9e84-fe77ba9c85bd",
            "name": "Check for Mimecast Results",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "91b52175-f8bc-417c-a845-4084fd5b94d0",
              "stepControlParams": [
                {
                  "edgeId": "af6b5ed8-0354-4d97-bc49-8c6e728eb012",
                  "expression": {
                    "left": {
                      "name": "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975.count",
                      "type": "variable"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975].[count]}} > 0"
                },
                {
                  "edgeId": "91b52175-f8bc-417c-a845-4084fd5b94d0",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "42355aea-40fc-4b27-a5d9-1b9e13aea796": {
            "nodeId": "42355aea-40fc-4b27-a5d9-1b9e13aea796",
            "name": "Quarantine Asset Successful",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect was able to successfully quarantine the following asset using the Rapid7 Insight Agent:\n\n- Asset shortname: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[shortname]}}`\n- Asset FQDN: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[fqdn]}}`\n- Insight Agent ID: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[assetId]}}`\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "52e19f21-2111-4dd0-8044-765106359ccd": {
            "nodeId": "52e19f21-2111-4dd0-8044-765106359ccd",
            "name": "Check for Netskope Results",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "54b99d3a-5930-408a-8b85-2db2b34f1507",
              "stepControlParams": [
                {
                  "edgeId": "7c59160e-fe02-481a-953c-fc9096b2e98b",
                  "expression": {
                    "left": {
                      "name": "2609b393-8365-4ec6-ae1c-31147eca4914.count",
                      "type": "variable"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[2609b393-8365-4ec6-ae1c-31147eca4914].[count]}} > 0"
                },
                {
                  "edgeId": "54b99d3a-5930-408a-8b85-2db2b34f1507",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "614b424e-2164-4a77-ab2f-a3e59336739f": {
            "nodeId": "614b424e-2164-4a77-ab2f-a3e59336739f",
            "name": "No Netskope Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Netskope logs were queried for any DLP events in the last hour, but none were found. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "64659457-7cb4-4562-8106-cee6dc7eb819": {
            "nodeId": "64659457-7cb4-4562-8106-cee6dc7eb819",
            "name": "Mimecast Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Mimecast logs were queried for any emails rejected in the last hour due to a virus signature detection, and `{{[9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975].[count]}}` result(s) were found. \n\nHere are the details:\n\n{{[9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975].[results]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "99cdbb1d-6e39-431e-a87e-6618c68ce2e8": {
            "nodeId": "99cdbb1d-6e39-431e-a87e-6618c68ce2e8",
            "name": "Join 2",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "262db396-77ae-4b05-966f-9905e0424aba",
                "917fbd2b-cbf0-4dd6-8ac5-f109ef4858ac"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975": {
            "nodeId": "9d6759cb-0c6c-4bb7-8a8c-13fe4cc1a975",
            "name": "Query Mimecast Logs",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightIDR",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightidr",
              "slugVersion": "3.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightidr/3.2.0/icon.png"
            },
            "identifier": "advanced_query_on_log_set",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "log_set": "Virus Alert",
                "query": "where(action=Rej AND source_json.RejType=\"Virus Signature Detection\" AND user={{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users].[0].[emails].[0]}})",
                "relative_time": "Last 1 Hour",
                "time_from": "",
                "time_to": "",
                "timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "log_set": {
                  "description": "Log Set to search",
                  "enum": [
                    "Advanced Malware Alert",
                    "Active Directory Admin Activity",
                    "Asset Authentication",
                    "Cloud Service Admin Activity",
                    "Cloud Service Activity",
                    "DNS Query",
                    "Endpoint Activity",
                    "EndPoint Agent",
                    "Exploit Mitigation Alert",
                    "File Access Activity",
                    "File Modification Activity",
                    "Firewall Activity",
                    "Network Flow",
                    "Host To IP Observations",
                    "IDS Alert",
                    "Ingress Authentication",
                    "Raw Log",
                    "SSO Authentication",
                    "Unparsed Data",
                    "Third Party Alert",
                    "Virus Alert",
                    "Web Proxy Activity"
                  ],
                  "order": 6,
                  "title": "Log Set",
                  "type": "string"
                },
                "query": {
                  "description": "LQL Query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "relative_time": {
                  "default": "Last 5 Minutes",
                  "description": "A relative time in the past to look for alerts",
                  "enum": [
                    "Last 5 Minutes",
                    "Last 10 Minutes",
                    "Last 20 Minutes",
                    "Last 30 Minutes",
                    "Last 45 Minutes",
                    "Last 1 Hour",
                    "Last 2 Hours",
                    "Last 3 Hours",
                    "Last 6 Hours",
                    "Last 12 Hours",
                    "Use Time From Value"
                  ],
                  "order": 2,
                  "title": "Relative Time",
                  "type": "string"
                },
                "time_from": {
                  "description": "Beginning date and time for the query. This will be ignored unless Relative Time input is set to 'Use Time From Value'. The format is flexible and will work with simple dates (e.g. 01-01-2020) to full ISO time (e.g. 01-01-2020T00:00:00)",
                  "order": 3,
                  "title": "Time From",
                  "type": "string"
                },
                "time_to": {
                  "description": "Date and time for the end of the query. If left blank, the current time will be used. The format is flexible and will work with simple dates (e.g. 01-01-2020) to full ISO time (e.g. 01-01-2020T00:00:00)",
                  "order": 4,
                  "title": "Time To",
                  "type": "string"
                },
                "timeout": {
                  "default": 60,
                  "description": "Time in seconds to wait for the query to return. If exceeded the plugin will throw an error",
                  "order": 5,
                  "title": "Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "query",
                "relative_time",
                "timeout",
                "log_set"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "eventData": {
                  "properties": {
                    "asSignatureCreationTime": {
                      "description": "As signature creation time",
                      "order": 6,
                      "title": "As Signature Creation Time",
                      "type": "string"
                    },
                    "assignatureVersion": {
                      "description": "As signature version",
                      "order": 4,
                      "title": "As Signature Version",
                      "type": "string"
                    },
                    "avSignatureCreationTime": {
                      "description": "AV signature creation time",
                      "order": 20,
                      "title": "AV Signature Creation Time",
                      "type": "string"
                    },
                    "avsignatureVersion": {
                      "description": "AV signature version",
                      "order": 21,
                      "title": "AV Signature Version",
                      "type": "string"
                    },
                    "bmState": {
                      "description": "BMS state",
                      "order": 11,
                      "title": "BMS State",
                      "type": "string"
                    },
                    "data": {
                      "description": "Data",
                      "items": {
                        "type": "object"
                      },
                      "order": 18,
                      "title": "Data",
                      "type": "array"
                    },
                    "engineVersion": {
                      "description": "Engine version",
                      "order": 10,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "ioavState": {
                      "description": "IOAV state",
                      "order": 5,
                      "title": "IOAV State",
                      "type": "string"
                    },
                    "lastAsSignatureAge": {
                      "description": "Last as signature age",
                      "order": 2,
                      "title": "Last As Signature Age",
                      "type": "string"
                    },
                    "lastAvSignatureAge": {
                      "description": "Last AV signature age",
                      "order": 22,
                      "title": "Last AV Signature Age",
                      "type": "string"
                    },
                    "lastFullScanAge": {
                      "description": "Last full scan age",
                      "order": 25,
                      "title": "Last Full Scan Age",
                      "type": "string"
                    },
                    "lastFullScanEndTime": {
                      "description": "Last full scan end time",
                      "order": 13,
                      "title": "Last Full Scan End Time",
                      "type": "string"
                    },
                    "lastFullScanSource": {
                      "description": "Last full scan source",
                      "order": 7,
                      "title": "Last Full Scan Source",
                      "type": "string"
                    },
                    "lastFullScanStartTime": {
                      "description": "Last full scan start time",
                      "order": 9,
                      "title": "Last Full Scan Start Time",
                      "type": "string"
                    },
                    "lastQuickScanAge": {
                      "description": "Last quick scan age",
                      "order": 17,
                      "title": "Last Quick Scan Age",
                      "type": "string"
                    },
                    "lastQuickScanEndTime": {
                      "description": "Last quick scan end time",
                      "order": 19,
                      "title": "Last Quick Scan End Time",
                      "type": "string"
                    },
                    "lastQuickScanSource": {
                      "description": "Last quick scan source",
                      "order": 12,
                      "title": "Last Quick Scan Source",
                      "type": "string"
                    },
                    "lastQuickScanStartTime": {
                      "description": "Last quick scan start time",
                      "order": 24,
                      "title": "Last Quick Scan Start Time",
                      "type": "string"
                    },
                    "nriEngineVersion": {
                      "description": "NRI engine version",
                      "order": 23,
                      "title": "NRI Engine Version",
                      "type": "string"
                    },
                    "nriSignatureVersion": {
                      "description": "NRI signature version",
                      "order": 8,
                      "title": "NRI Signature Version",
                      "type": "string"
                    },
                    "oaState": {
                      "description": "OA state",
                      "order": 1,
                      "title": "OA State",
                      "type": "string"
                    },
                    "platformVersion": {
                      "description": "Platform version",
                      "order": 16,
                      "title": "Platform Version",
                      "type": "string"
                    },
                    "productName": {
                      "description": "Product name",
                      "order": 14,
                      "title": "Product Name",
                      "type": "string"
                    },
                    "productStatus": {
                      "description": "Product status",
                      "order": 3,
                      "title": "Product Status",
                      "type": "string"
                    },
                    "rtpState": {
                      "description": "RTP state",
                      "order": 15,
                      "title": "RTP State",
                      "type": "string"
                    }
                  },
                  "title": "EventData",
                  "type": "object"
                },
                "events": {
                  "properties": {
                    "labels": {
                      "description": "List of labels",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Labels",
                      "type": "array"
                    },
                    "links": {
                      "description": "Links",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 6,
                      "title": "Links",
                      "type": "array"
                    },
                    "log_id": {
                      "description": "Log ID",
                      "order": 4,
                      "title": "Log ID",
                      "type": "string"
                    },
                    "message": {
                      "$ref": "#/definitions/message",
                      "description": "Message",
                      "order": 5,
                      "title": "Message"
                    },
                    "sequence_number": {
                      "description": "Sequence number",
                      "order": 3,
                      "title": "Sequence Number",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "Timestamp",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Events",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "HREF",
                      "order": 2,
                      "title": "HREF",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Relation",
                      "order": 1,
                      "title": "Relation",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "computerName": {
                      "order": 3,
                      "title": "Computer Name",
                      "type": "string"
                    },
                    "eventCode": {
                      "order": 2,
                      "title": "Event Code",
                      "type": "integer"
                    },
                    "eventData": {
                      "$ref": "#/definitions/eventData",
                      "order": 6,
                      "title": "Event Data"
                    },
                    "isDomainController": {
                      "order": 5,
                      "title": "Is Domain Controller",
                      "type": "boolean"
                    },
                    "sid": {
                      "order": 4,
                      "title": "SID",
                      "type": "string"
                    },
                    "sourceName": {
                      "order": 1,
                      "title": "Source Name",
                      "type": "string"
                    },
                    "timeWritten": {
                      "order": 7,
                      "title": "Time Written",
                      "type": "string"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "count": {
                  "description": "Number of log entries found",
                  "order": 2,
                  "title": "Count",
                  "type": "integer"
                },
                "results": {
                  "description": "Query Results",
                  "items": {
                    "$ref": "#/definitions/events"
                  },
                  "order": 1,
                  "title": "Query Results",
                  "type": "array"
                }
              },
              "required": [
                "results",
                "count"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b855e7fe-495f-40a7-85ce-1214ca0a8db7": {
            "nodeId": "b855e7fe-495f-40a7-85ce-1214ca0a8db7",
            "name": "Alert Overview",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Investigation Overview: {{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[name]}}\n\nInvestigation created at: {{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[timestamp]}}\n\nInvestigation link: {{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[link]}}\n\nInvestigation ID: {{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[investigationId]}}\n\n{{#each [e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[users]}}\nUser involved: {{name}}\n{{/each}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b98a66e0-5fc4-41e5-95a1-43889421c152": {
            "nodeId": "b98a66e0-5fc4-41e5-95a1-43889421c152",
            "name": "Confirm Success",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "cf888dff-7712-4bc5-bbf2-b10472d7c0dd",
              "stepControlParams": [
                {
                  "edgeId": "ad750f0e-d6e4-4972-8685-cc3145c16571",
                  "expression": {
                    "left": {
                      "name": "c018e3a3-c224-4849-a00e-730f7237016a.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[c018e3a3-c224-4849-a00e-730f7237016a].[success]}} = true"
                },
                {
                  "edgeId": "cf888dff-7712-4bc5-bbf2-b10472d7c0dd",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c018e3a3-c224-4849-a00e-730f7237016a": {
            "nodeId": "c018e3a3-c224-4849-a00e-730f7237016a",
            "name": "Quarantine Asset",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Insight Agent",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insight_agent",
              "slugVersion": "1.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insight_agent/1.0.4/icon.png"
            },
            "identifier": "quarantine",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "agent_id": "{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[assetId]}}",
                "interval": 604800,
                "quarantine_state": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "agent_id": {
                  "description": "The ID of the agent on the device to quarantine",
                  "order": 1,
                  "title": "Agent ID",
                  "type": "string"
                },
                "interval": {
                  "default": 604800,
                  "description": "Length of time in seconds to try to take action on a device. This is also called Advertisement Period",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "quarantine_state": {
                  "default": true,
                  "description": "Set to true to quarantine a host, set to false to unquarantine",
                  "order": 2,
                  "title": "Quarantine State",
                  "type": "boolean"
                }
              },
              "required": [
                "agent_id",
                "quarantine_state",
                "interval"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was operation successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ca97d519-a6c8-4b56-8400-dbb591aaded1": {
            "nodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1",
            "name": "Quarantine Decision",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "notifications": {
                "artifactIds": null,
                "userIdsForEmail": []
              },
              "stepControlParams": [
                {
                  "edgeId": "45859b06-9148-4cfb-8b99-183e15342ef4",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1"
                },
                {
                  "edgeId": "e29db235-7fe4-4200-9ccd-5a247c1b7df0",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "ca97d519-a6c8-4b56-8400-dbb591aaded1"
                }
              ],
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "e29db235-7fe4-4200-9ccd-5a247c1b7df0"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "d4333c78-b321-454a-b990-1f6b02f91005": {
            "nodeId": "d4333c78-b321-454a-b990-1f6b02f91005",
            "name": "Results",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "f587efba-20c7-42ef-a12a-f258f79ef95b",
              "stepControlParams": [
                {
                  "edgeId": "2d56f364-5d1b-4626-a92d-a6c62cdc2a43",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "29653370-5af2-4fea-9e84-fe77ba9c85bd.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Yes"
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "52e19f21-2111-4dd0-8044-765106359ccd.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Yes"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[29653370-5af2-4fea-9e84-fe77ba9c85bd].[path]}} = \"Yes\" AND {{[52e19f21-2111-4dd0-8044-765106359ccd].[path]}} = \"Yes\""
                },
                {
                  "edgeId": "f587efba-20c7-42ef-a12a-f258f79ef95b",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "6204eb09-3fc1-48c2-a093-45310d931263",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "29653370-5af2-4fea-9e84-fe77ba9c85bd.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "No"
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "52e19f21-2111-4dd0-8044-765106359ccd.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "No"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[29653370-5af2-4fea-9e84-fe77ba9c85bd].[path]}} = \"No\" AND {{[52e19f21-2111-4dd0-8044-765106359ccd].[path]}} = \"No\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "e090b21e-29da-4eda-bb6d-8f68caf4382f": {
            "nodeId": "e090b21e-29da-4eda-bb6d-8f68caf4382f",
            "name": "Join 3",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "de7b8eb3-dbdc-4abe-b791-1983538f5b86",
                "515b1251-eb63-4ce4-9204-f3ee265b1e5b",
                "7b9e1c04-1d50-4194-bd1f-698f60a1a1df"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "e25610c2-bfd6-4700-b8c9-560a39882a67": {
            "nodeId": "e25610c2-bfd6-4700-b8c9-560a39882a67",
            "name": "No Mimecast Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Mimecast logs were queried for any emails rejected in the last hour due to a virus signature detection, but none were found. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504": {
            "nodeId": "e3ca6c0f-0106-4d49-bdaa-d7c39c7cc504",
            "name": "Join",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "eeca9289-c6dd-457a-a5ed-e989b5bec3bb",
                "be7ac625-141a-4bc3-b256-25737284c0d0"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "e9e23ae1-e097-41a2-87a2-059e7faf6868": {
            "nodeId": "e9e23ae1-e097-41a2-87a2-059e7faf6868",
            "name": "InsightIDR UBA Alert Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "f60d267a-f83a-479b-bcfb-866156edfc9e",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a": {
            "nodeId": "ea776dcf-99d6-4b57-887a-0aaadc9b0d1a",
            "name": "Netskope Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Netskope logs were queried for any DLP events in the last hour, and `{{[2609b393-8365-4ec6-ae1c-31147eca4914].[count]}}` result(s) were found. \n\nHere are the details:\n\n{{[2609b393-8365-4ec6-ae1c-31147eca4914].[results]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "eeecfe06-418c-41ad-9458-3063c92f92d1": {
            "nodeId": "eeecfe06-418c-41ad-9458-3063c92f92d1",
            "name": "Quarantine Asset Failed",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "InsightConnect attempted to quarantine the following asset using the Rapid7 Insight Agent, but was unsuccessful:\n\n- Asset shortname: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[shortname]}}`\n- Asset FQDN: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[fqdn]}}`\n- Insight Agent ID: `{{[e9e23ae1-e097-41a2-87a2-059e7faf6868].[actors].[assets].[0].[assetId]}}`\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Endpoint Detection & Response"
        ],
        "humanCostSeconds": 1200,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "f60d267a-f83a-479b-bcfb-866156edfc9e",
        "name": "InsightIDR UBA Alert Trigger",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}