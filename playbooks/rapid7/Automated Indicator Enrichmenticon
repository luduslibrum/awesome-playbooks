{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T10:12:14.580524211Z",
    "workflowVersions": [
      {
        "name": "Automated Indicator Enrichment",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow automatically looks up IP addresses and URLs using open source threat intelligence via Slack command and reports information back to Slack.\n\nVirusTotal, Whois, AbuseIPDB, and IPStack are all used to obtain information about the given indicator. \n\nMultiple indicators can be specified within a single command.\n\nSample Slack Trigger Commands:\n\n`@Rapid7 InsightConnect investigate aadroid.net`\n\n`@Rapid7 InsightConnect investigate 192.168.1.1`\n\n`@Rapid7 InsightConnect investigate 192.168.0.0 118.25.6.39 aadroid.net`\n\n\n# Key Features\n\n* IP and URL enrichment from Slack\n\n# Requirements\n\n* API and account credentials for the following:\n    * [AbuseIPDB](https://docs.abuseipdb.com/#introduction)\n    * [VirusTotal](https://developers.virustotal.com/v3.0/reference)\n    * [IPStack](https://ipstack.com/documentation) \n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow. \n\nThere is one parameter you will need to configure in order to complete setup of your workflow:\n\n* `Slack Channel`: The Slack channel name in your environment where the workflow should be triggered and respond\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the steps, activate the workflow in order to trigger it. \n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Type Converter|1.7.0|1|\n|AbuseIPDB|5.0.6|1|\n|IPStack|2.0.0|1|\n|WHOIS|3.0.1|1|\n|VirusTotal|7.0.0|1|\n|Math|1.2.1|1|\n|HashIt|2.0.4|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.1.0 - Updated VirusTotal plugin | Added Math plugin to support the same artifact outputs\n* 2.0.0 - Leverage Parameters Feature | Update AbuseIPDB, VirusTotal, Whois, and Type Converter plugins\n* 1.1.0 - Replace pattern match with Automatic indicator extraction | Update plugins\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Slack](https://slack.com/)\n* [InsightConnect with Slack](https://docs.rapid7.com/insightconnect/trigger-workflows-with-slack-chatops/)\n* [VirusTotal](https://www.virustotal.com/gui/)\n* [Whois](https://www.whois.net/)\n* [AbuseIPDB](https://www.abuseipdb.com/)\n* [IPStack](https://ipstack.com/) \n",
        "graph": {
          "edges": {
            "0322529b-284f-4048-8553-8036380ddffa": {
              "id": "0322529b-284f-4048-8553-8036380ddffa",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "b8535a75-a3cd-46f7-9a68-5d947e3c5741",
              "toNodeId": "32efb909-6f93-4897-a309-441b9a4891f3"
            },
            "0aa7664e-eca3-487d-8484-4e422e39954f": {
              "id": "0aa7664e-eca3-487d-8484-4e422e39954f",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "toNodeId": "d240e754-3a8c-4857-bb52-c9ee101b7cc2"
            },
            "0c520a80-820e-4298-9d97-1e76c3e458a0": {
              "id": "0c520a80-820e-4298-9d97-1e76c3e458a0",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe",
              "toNodeId": ""
            },
            "1272ff2c-2a1b-4168-9db8-c9c0da135656": {
              "id": "1272ff2c-2a1b-4168-9db8-c9c0da135656",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5",
              "toNodeId": "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad"
            },
            "166ae1a5-f90a-45dc-9e8b-82f70ea90571": {
              "id": "166ae1a5-f90a-45dc-9e8b-82f70ea90571",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "32efb909-6f93-4897-a309-441b9a4891f3",
              "toNodeId": ""
            },
            "3059c102-5cd9-4d4e-b92e-ae2cd83c4ffc": {
              "id": "3059c102-5cd9-4d4e-b92e-ae2cd83c4ffc",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "1e21dea6-0b68-47ed-9027-31ce2e3b05d2",
              "toNodeId": "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5"
            },
            "480f8d56-b6a6-472e-86d1-a80517ad5631": {
              "id": "480f8d56-b6a6-472e-86d1-a80517ad5631",
              "name": "No",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "e5e0df29-405c-46a0-bc37-2c5096d7b68c",
              "toNodeId": "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe"
            },
            "530e60ab-f619-4d7b-8d44-47f3639ed2b4": {
              "id": "530e60ab-f619-4d7b-8d44-47f3639ed2b4",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "toNodeId": "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c"
            },
            "5e4e5d89-f6f5-4452-b428-0524cdac320c": {
              "id": "5e4e5d89-f6f5-4452-b428-0524cdac320c",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "c769b518-c83f-4320-b550-4c99cf247e84",
              "toNodeId": "8616c858-7096-4f47-af10-b395ab25e937"
            },
            "5fe20ebc-a99f-4594-8441-ecde24a15b36": {
              "id": "5fe20ebc-a99f-4594-8441-ecde24a15b36",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "888024e7-5d63-4809-8a60-63d6faa4d725",
              "toNodeId": "43eb66c0-96cc-441b-80a0-199d8642d1da"
            },
            "64859157-619e-474a-86b3-e5547d3b99c5": {
              "id": "64859157-619e-474a-86b3-e5547d3b99c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "43eb66c0-96cc-441b-80a0-199d8642d1da",
              "toNodeId": ""
            },
            "740ffab2-d722-4eef-9e20-d2fef995ba0f": {
              "id": "740ffab2-d722-4eef-9e20-d2fef995ba0f",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "09ab9304-c3e6-4e31-b660-65d0f017fe9e",
              "toNodeId": ""
            },
            "7f7c1a71-722b-4c4b-9e63-ade9e943d9da": {
              "id": "7f7c1a71-722b-4c4b-9e63-ade9e943d9da",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "66a5247a-6dd7-4afa-8bec-5e10410a2af9",
              "toNodeId": "1e21dea6-0b68-47ed-9027-31ce2e3b05d2"
            },
            "82efdf61-edb3-4e6d-91f0-ef587f40fc27": {
              "id": "82efdf61-edb3-4e6d-91f0-ef587f40fc27",
              "name": "Success",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8",
              "toNodeId": "e5e0df29-405c-46a0-bc37-2c5096d7b68c"
            },
            "8a637348-90f2-4366-ba9b-bbfdedf2ab21": {
              "id": "8a637348-90f2-4366-ba9b-bbfdedf2ab21",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "9f017013-ca2c-41ab-98b2-cf17fca386dc",
              "toNodeId": ""
            },
            "8cd8951d-e3e5-4622-ad2c-f4538fe4f9f0": {
              "id": "8cd8951d-e3e5-4622-ad2c-f4538fe4f9f0",
              "name": "Success",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad",
              "toNodeId": "c769b518-c83f-4320-b550-4c99cf247e84"
            },
            "97b3caaf-7ec2-4b06-82d5-78ebb7720be3": {
              "id": "97b3caaf-7ec2-4b06-82d5-78ebb7720be3",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "d240e754-3a8c-4857-bb52-c9ee101b7cc2",
              "toNodeId": "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8"
            },
            "9e1541ac-fca3-4c65-b89c-a1046dcbee40": {
              "id": "9e1541ac-fca3-4c65-b89c-a1046dcbee40",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "toNodeId": "66a5247a-6dd7-4afa-8bec-5e10410a2af9"
            },
            "affd1430-cac6-499e-b535-5968d8bd4092": {
              "id": "affd1430-cac6-499e-b535-5968d8bd4092",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c",
              "toNodeId": ""
            },
            "b156d4dc-fb09-4f3a-9063-8ac299d2c5ff": {
              "id": "b156d4dc-fb09-4f3a-9063-8ac299d2c5ff",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "toNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "b32dc7de-ae38-4711-b25a-d395e2a6f538": {
              "id": "b32dc7de-ae38-4711-b25a-d395e2a6f538",
              "name": "Yes",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "e5e0df29-405c-46a0-bc37-2c5096d7b68c",
              "toNodeId": "aa8976a0-b3e1-4aca-a04a-f653fa890c17"
            },
            "b4f81df7-5c84-423f-8e0e-14a33531d0e3": {
              "id": "b4f81df7-5c84-423f-8e0e-14a33531d0e3",
              "name": "",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "8616c858-7096-4f47-af10-b395ab25e937",
              "toNodeId": ""
            },
            "b799dc83-78ff-4c44-89b8-ccb71b9810fb": {
              "id": "b799dc83-78ff-4c44-89b8-ccb71b9810fb",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "888024e7-5d63-4809-8a60-63d6faa4d725",
              "toNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "bb9b355f-dd7f-454c-8419-e271c171e0d3": {
              "id": "bb9b355f-dd7f-454c-8419-e271c171e0d3",
              "name": "Failure",
              "description": "",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "fromNodeId": "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad",
              "toNodeId": "9f017013-ca2c-41ab-98b2-cf17fca386dc"
            },
            "c8ad5c5f-fc7f-491d-b325-e30d8948696a": {
              "id": "c8ad5c5f-fc7f-491d-b325-e30d8948696a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "fbe690e0-1341-41f1-aef7-5ff47f3ccfac",
              "toNodeId": "41f603ca-047a-482b-9eab-a9bb3f0b1734"
            },
            "cf297028-f847-488c-bb26-78fcc4606484": {
              "id": "cf297028-f847-488c-bb26-78fcc4606484",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "7faffc5a-fa6a-4214-9857-139ef43a893e",
              "toNodeId": "b8535a75-a3cd-46f7-9a68-5d947e3c5741"
            },
            "de4c002d-015c-469d-9d7e-118e91e62450": {
              "id": "de4c002d-015c-469d-9d7e-118e91e62450",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "41f603ca-047a-482b-9eab-a9bb3f0b1734",
              "toNodeId": "888024e7-5d63-4809-8a60-63d6faa4d725"
            },
            "e70d2eb1-6636-48ca-a7c4-464d74228f36": {
              "id": "e70d2eb1-6636-48ca-a7c4-464d74228f36",
              "name": "Failure",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8",
              "toNodeId": "09ab9304-c3e6-4e31-b660-65d0f017fe9e"
            },
            "ede99632-af00-45b2-8e63-5aa8c7251fe6": {
              "id": "ede99632-af00-45b2-8e63-5aa8c7251fe6",
              "name": "",
              "description": "",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
              "fromNodeId": "aa8976a0-b3e1-4aca-a04a-f653fa890c17",
              "toNodeId": "7faffc5a-fa6a-4214-9857-139ef43a893e"
            },
            "fe44fea8-741b-4164-bf43-3b47ae456076": {
              "id": "fe44fea8-741b-4164-bf43-3b47ae456076",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d4b99849-7404-4271-83a0-2301855e4098",
              "toNodeId": "fbe690e0-1341-41f1-aef7-5ff47f3ccfac"
            }
          },
          "nodes": {
            "09ab9304-c3e6-4e31-b660-65d0f017fe9e": {
              "id": "09ab9304-c3e6-4e31-b660-65d0f017fe9e",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "1e21dea6-0b68-47ed-9027-31ce2e3b05d2": {
              "id": "1e21dea6-0b68-47ed-9027-31ce2e3b05d2",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "32efb909-6f93-4897-a309-441b9a4891f3": {
              "id": "32efb909-6f93-4897-a309-441b9a4891f3",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "364ef08d-d955-478c-860f-272d74eb5c81": {
              "id": "364ef08d-d955-478c-860f-272d74eb5c81",
              "parentNodeId": ""
            },
            "41f603ca-047a-482b-9eab-a9bb3f0b1734": {
              "id": "41f603ca-047a-482b-9eab-a9bb3f0b1734",
              "parentNodeId": ""
            },
            "43eb66c0-96cc-441b-80a0-199d8642d1da": {
              "id": "43eb66c0-96cc-441b-80a0-199d8642d1da",
              "parentNodeId": ""
            },
            "66a5247a-6dd7-4afa-8bec-5e10410a2af9": {
              "id": "66a5247a-6dd7-4afa-8bec-5e10410a2af9",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "7faffc5a-fa6a-4214-9857-139ef43a893e": {
              "id": "7faffc5a-fa6a-4214-9857-139ef43a893e",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "8616c858-7096-4f47-af10-b395ab25e937": {
              "id": "8616c858-7096-4f47-af10-b395ab25e937",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "888024e7-5d63-4809-8a60-63d6faa4d725": {
              "id": "888024e7-5d63-4809-8a60-63d6faa4d725",
              "parentNodeId": ""
            },
            "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c": {
              "id": "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c",
              "parentNodeId": ""
            },
            "9f017013-ca2c-41ab-98b2-cf17fca386dc": {
              "id": "9f017013-ca2c-41ab-98b2-cf17fca386dc",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "aa8976a0-b3e1-4aca-a04a-f653fa890c17": {
              "id": "aa8976a0-b3e1-4aca-a04a-f653fa890c17",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "af308e8e-ba3b-48e8-9863-7703017a1fc6": {
              "id": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
              "parentNodeId": ""
            },
            "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe": {
              "id": "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8": {
              "id": "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "b8535a75-a3cd-46f7-9a68-5d947e3c5741": {
              "id": "b8535a75-a3cd-46f7-9a68-5d947e3c5741",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad": {
              "id": "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "c769b518-c83f-4320-b550-4c99cf247e84": {
              "id": "c769b518-c83f-4320-b550-4c99cf247e84",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            },
            "d240e754-3a8c-4857-bb52-c9ee101b7cc2": {
              "id": "d240e754-3a8c-4857-bb52-c9ee101b7cc2",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "d4b99849-7404-4271-83a0-2301855e4098": {
              "id": "d4b99849-7404-4271-83a0-2301855e4098",
              "parentNodeId": ""
            },
            "e5e0df29-405c-46a0-bc37-2c5096d7b68c": {
              "id": "e5e0df29-405c-46a0-bc37-2c5096d7b68c",
              "parentNodeId": "364ef08d-d955-478c-860f-272d74eb5c81"
            },
            "fbe690e0-1341-41f1-aef7-5ff47f3ccfac": {
              "id": "fbe690e0-1341-41f1-aef7-5ff47f3ccfac",
              "parentNodeId": ""
            },
            "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5": {
              "id": "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5",
              "parentNodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6"
            }
          }
        },
        "steps": {
          "09ab9304-c3e6-4e31-b660-65d0f017fe9e": {
            "nodeId": "09ab9304-c3e6-4e31-b660-65d0f017fe9e",
            "name": "Post Failure Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":warning: A lookup for `{{[364ef08d-d955-478c-860f-272d74eb5c81].[$item]}}` has failed :warning:\n\nThis is likely because no VirusTotal results were found for this URL.\n\nSee the job for more info: {{[$job].[URL]}}",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "1e21dea6-0b68-47ed-9027-31ce2e3b05d2": {
            "nodeId": "1e21dea6-0b68-47ed-9027-31ce2e3b05d2",
            "name": "IPStack Lookup",
            "type": "action",
            "plugin": {
              "name": "IPStack",
              "slugVendor": "rapid7",
              "slugName": "ipstack",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/ipstack/2.0.0/icon.png"
            },
            "identifier": "lookup",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "host": "{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "host": {
                  "description": "Host to Lookup",
                  "order": 1,
                  "title": "Host",
                  "type": "string"
                }
              },
              "required": [
                "host"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 2,
                  "title": "City",
                  "type": "string"
                },
                "country_code": {
                  "description": "Country code",
                  "order": 4,
                  "title": "Country Code",
                  "type": "string"
                },
                "country_name": {
                  "description": "Country name",
                  "order": 3,
                  "title": "Country Name",
                  "type": "string"
                },
                "latitude": {
                  "description": "Latitude",
                  "order": 5,
                  "title": "Latitude",
                  "type": "string"
                },
                "longitude": {
                  "description": "Longitude",
                  "order": 6,
                  "title": "Latitude",
                  "type": "string"
                },
                "metro_code": {
                  "description": "Metro code",
                  "order": 7,
                  "title": "Metro Code",
                  "type": "integer"
                },
                "region_code": {
                  "description": "Region code",
                  "order": 8,
                  "title": "Region Code",
                  "type": "string"
                },
                "region_name": {
                  "description": "Region name",
                  "order": 9,
                  "title": "Region Name",
                  "type": "string"
                },
                "time_zone": {
                  "description": "Time zone",
                  "order": 10,
                  "title": "Public IP Address in Decimal",
                  "type": "string"
                },
                "zip_code": {
                  "description": "ZIP code",
                  "order": 11,
                  "title": "ZIP Code",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "32efb909-6f93-4897-a309-441b9a4891f3": {
            "nodeId": "32efb909-6f93-4897-a309-441b9a4891f3",
            "name": "Post Malicious URL Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Malicious URL Found!*\n`{{[364ef08d-d955-478c-860f-272d74eb5c81].[$item]}}`\n_________________________\n\nLast Analysis Results:\n- Harmless: \n- Malicious: {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[malicious]}}\n- Suspicious: {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[suspicious]}}\n- Undetected: {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[undetected]}}\n\nMalicious Hits: {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[malicious]}} / {{[aa8976a0-b3e1-4aca-a04a-f653fa890c17].[result]}}\n\n_Report Link:_\n[https://www.virustotal.com/gui/url/{{[7faffc5a-fa6a-4214-9857-139ef43a893e].[sha256]}}/detection](https://www.virustotal.com/gui/url/{{[7faffc5a-fa6a-4214-9857-139ef43a893e].[sha256]}}/detection)",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "364ef08d-d955-478c-860f-272d74eb5c81": {
            "nodeId": "364ef08d-d955-478c-860f-272d74eb5c81",
            "name": "URL Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "0aa7664e-eca3-487d-8484-4e422e39954f",
              "nextEdgeId": "530e60ab-f619-4d7b-8d44-47f3639ed2b4",
              "repeatVariable": "{{[d4b99849-7404-4271-83a0-2301855e4098].[message].[indicators].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "41f603ca-047a-482b-9eab-a9bb3f0b1734": {
            "nodeId": "41f603ca-047a-482b-9eab-a9bb3f0b1734",
            "name": "Combine IPs",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.7.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.7.0/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[d4b99849-7404-4271-83a0-2301855e4098].[message].[indicators].[ip_addresses].[ipv4_addresses]}}",
                "array2": "{{[d4b99849-7404-4271-83a0-2301855e4098].[message].[indicators].[ip_addresses].[ipv6_addresses]}}",
                "array3": [],
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "43eb66c0-96cc-441b-80a0-199d8642d1da": {
            "nodeId": "43eb66c0-96cc-441b-80a0-199d8642d1da",
            "name": "Post No Valid Indicators",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":octagonal_sign: *Workflow did not execute* :octagonal_sign:\nNo valid indicators were given! Please input the command and one or more indicators (IPv4, IPv6, URLs).",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "66a5247a-6dd7-4afa-8bec-5e10410a2af9": {
            "nodeId": "66a5247a-6dd7-4afa-8bec-5e10410a2af9",
            "name": "Whois Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.1/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}}",
                "registrar": "Autodetect"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "registrar": {
                  "default": "Autodetect",
                  "description": "Domain Registrar",
                  "enum": [
                    "Autodetect",
                    "RIPE",
                    "ARIN",
                    "LACNIC",
                    "APNIC"
                  ],
                  "order": 2,
                  "title": "Registrar",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7faffc5a-fa6a-4214-9857-139ef43a893e": {
            "nodeId": "7faffc5a-fa6a-4214-9857-139ef43a893e",
            "name": "Hash the URL",
            "type": "action",
            "plugin": {
              "name": "HashIt",
              "slugVendor": "rapid7",
              "slugName": "hashit",
              "slugVersion": "2.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hashit/2.0.4/icon.png"
            },
            "identifier": "string",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "string": "{{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[url]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "string": {
                  "description": "String of text to hash",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "required": [
                "string"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1 Hash",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256 Hash",
                  "type": "string"
                },
                "sha512": {
                  "description": "SHA512 hash",
                  "order": 4,
                  "title": "SHA512 Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "8616c858-7096-4f47-af10-b395ab25e937": {
            "nodeId": "8616c858-7096-4f47-af10-b395ab25e937",
            "name": "Post IP Results",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "*Results*\n{{[c769b518-c83f-4320-b550-4c99cf247e84].[content]}}",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "888024e7-5d63-4809-8a60-63d6faa4d725": {
            "nodeId": "888024e7-5d63-4809-8a60-63d6faa4d725",
            "name": "At Least 1 Valid Indicator?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b799dc83-78ff-4c44-89b8-ccb71b9810fb",
              "stepControlParams": [
                {
                  "edgeId": "b799dc83-78ff-4c44-89b8-ccb71b9810fb",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "5fe20ebc-a99f-4594-8441-ecde24a15b36",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "41f603ca-047a-482b-9eab-a9bb3f0b1734.combined_array",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "args": [
                          {
                            "name": "d4b99849-7404-4271-83a0-2301855e4098.message.indicators.urls",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[41f603ca-047a-482b-9eab-a9bb3f0b1734].[combined_array]}})=0 and length({{[d4b99849-7404-4271-83a0-2301855e4098].[message].[indicators].[urls]}})=0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c": {
            "nodeId": "8abb74e8-1a6b-4d71-b6c4-805d6f139f3c",
            "name": "Workflow Complete Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":rocket: *Workflow complete!* :rocket:",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "9f017013-ca2c-41ab-98b2-cf17fca386dc": {
            "nodeId": "9f017013-ca2c-41ab-98b2-cf17fca386dc",
            "name": "Lookup Failure Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":warning: A lookup for `{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}}` has failed :warning:\n\nSee the job for more info: {{[$job].[URL]}}",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "aa8976a0-b3e1-4aca-a04a-f653fa890c17": {
            "nodeId": "aa8976a0-b3e1-4aca-a04a-f653fa890c17",
            "name": "Calculate Total Reports",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[harmless]}} + {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[malicious]}} + {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[suspicious]}} + {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[undetected]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "af308e8e-ba3b-48e8-9863-7703017a1fc6": {
            "nodeId": "af308e8e-ba3b-48e8-9863-7703017a1fc6",
            "name": "IP Lookup Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "9e1541ac-fca3-4c65-b89c-a1046dcbee40",
              "nextEdgeId": "b156d4dc-fb09-4f3a-9063-8ac299d2c5ff",
              "repeatVariable": "{{[41f603ca-047a-482b-9eab-a9bb3f0b1734].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe": {
            "nodeId": "b11e7b95-cb1c-4541-89a0-79e3d50dd8fe",
            "name": "Post No Malicious URL",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "The VirusTotal report indicated that the URL `{{[364ef08d-d955-478c-860f-272d74eb5c81].[$item]}}` was not malicious.",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8": {
            "nodeId": "b23bf334-fa50-49cc-9c31-5fda1b8ae4f8",
            "name": "URL Lookup Successful?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "82efdf61-edb3-4e6d-91f0-ef587f40fc27",
              "stepControlParams": [
                {
                  "edgeId": "82efdf61-edb3-4e6d-91f0-ef587f40fc27",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "e70d2eb1-6636-48ca-a7c4-464d74228f36",
                  "expression": {
                    "left": {
                      "name": "d240e754-3a8c-4857-bb52-c9ee101b7cc2.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[$success]}} = false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b8535a75-a3cd-46f7-9a68-5d947e3c5741": {
            "nodeId": "b8535a75-a3cd-46f7-9a68-5d947e3c5741",
            "name": "URL Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*Malicious URL Found!*\n`{{[364ef08d-d955-478c-860f-272d74eb5c81].[$item]}}`\n_________________________\n\nPositive Hits: {{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_stats].[malicious]}}\nTotal AV Scans: {{[aa8976a0-b3e1-4aca-a04a-f653fa890c17].[result]}}\n\n_AV Scans:_\n{{#each [d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[last_analysis_results]}}\n{{#if result}}\n{{engine_name}}: {{result}}\n{{/if}}\n{{/each}}\n\n_Report Link:_\n[https://www.virustotal.com/gui/url/{{[7faffc5a-fa6a-4214-9857-139ef43a893e].[sha256]}}/detection](https://www.virustotal.com/gui/url/{{[7faffc5a-fa6a-4214-9857-139ef43a893e].[sha256]}}/detection)"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad": {
            "nodeId": "b9dfa8ce-b81d-4111-990c-5c8bca93a2ad",
            "name": "All Lookups Successful?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "8cd8951d-e3e5-4622-ad2c-f4538fe4f9f0",
              "stepControlParams": [
                {
                  "edgeId": "8cd8951d-e3e5-4622-ad2c-f4538fe4f9f0",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "bb9b355f-dd7f-454c-8419-e271c171e0d3",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "66a5247a-6dd7-4afa-8bec-5e10410a2af9.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": false
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "1e21dea6-0b68-47ed-9027-31ce2e3b05d2.$success",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5.$success",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[$success]}} = false or {{[1e21dea6-0b68-47ed-9027-31ce2e3b05d2].[$success]}} = false or {{[ff5b8fa7-74ee-4046-acc6-4d63ac4442c5].[$success]}} = false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c769b518-c83f-4320-b550-4c99cf247e84": {
            "nodeId": "c769b518-c83f-4320-b550-4c99cf247e84",
            "name": "IP Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "`{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}}`\n_________________________\n\n_IP Stack_\nCity: {{[1e21dea6-0b68-47ed-9027-31ce2e3b05d2].[city]}}\nLongitude: {{[1e21dea6-0b68-47ed-9027-31ce2e3b05d2].[longitude]}}\nLatitude: {{[1e21dea6-0b68-47ed-9027-31ce2e3b05d2].[latitude]}}\n\n_WhoIs_\nReg Date: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[regdate]}}\nOrg Name: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[orgname]}}\nNet Name: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[netname]}}\nNet Type: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[nettype]}}\nNet Range: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[netrange]}}\n\n_Location Details_\nAddress: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[address]}}\nCity: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[city]}}\nCountry: {{[66a5247a-6dd7-4afa-8bec-5e10410a2af9].[country]}}\n\n_AbuseIP Database_\n{{#if [ff5b8fa7-74ee-4046-acc6-4d63ac4442c5].[found]}}\nNumber of Reports: {{[ff5b8fa7-74ee-4046-acc6-4d63ac4442c5].[totalReports]}}\n{{else}}\n{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}} was not found.\n{{/if}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "d240e754-3a8c-4857-bb52-c9ee101b7cc2": {
            "nodeId": "d240e754-3a8c-4857-bb52-c9ee101b7cc2",
            "name": "URL Lookup",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[364ef08d-d955-478c-860f-272d74eb5c81].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "malicious": {
                      "order": 25,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d4b99849-7404-4271-83a0-2301855e4098": {
            "nodeId": "d4b99849-7404-4271-83a0-2301855e4098",
            "name": "Slack Investigate Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "{{$workflow.[Slack Channel]}}",
                "matchText": "investigate",
                "type": "any"
              }
            },
            "triggerId": "7c595176-1678-4cfe-ad2c-11c1935b8862",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "e5e0df29-405c-46a0-bc37-2c5096d7b68c": {
            "nodeId": "e5e0df29-405c-46a0-bc37-2c5096d7b68c",
            "name": "Malicious?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "480f8d56-b6a6-472e-86d1-a80517ad5631",
              "stepControlParams": [
                {
                  "edgeId": "480f8d56-b6a6-472e-86d1-a80517ad5631",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "b32dc7de-ae38-4711-b25a-d395e2a6f538",
                  "expression": {
                    "name": "d240e754-3a8c-4857-bb52-c9ee101b7cc2.report.malicious",
                    "type": "variable"
                  },
                  "expressionText": "{{[d240e754-3a8c-4857-bb52-c9ee101b7cc2].[report].[malicious]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "fbe690e0-1341-41f1-aef7-5ff47f3ccfac": {
            "nodeId": "fbe690e0-1341-41f1-aef7-5ff47f3ccfac",
            "name": "Post Command Received",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": ":rocket: *Starting Workflow!* :rocket:\n_{{[d4b99849-7404-4271-83a0-2301855e4098].[message].[first_word]}}_",
                "recipient": "{{$workflow.[Slack Channel]}}",
                "thread_ts": "{{[d4b99849-7404-4271-83a0-2301855e4098].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5": {
            "nodeId": "ff5b8fa7-74ee-4046-acc6-4d63ac4442c5",
            "name": "AbuseIP Lookup",
            "type": "action",
            "plugin": {
              "name": "AbuseIPDB",
              "slugVendor": "rapid7",
              "slugName": "abuseipdb",
              "slugVersion": "5.0.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/abuseipdb/5.0.6/icon.png"
            },
            "identifier": "check_ip",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[af308e8e-ba3b-48e8-9863-7703017a1fc6].[$item]}}",
                "days": "365",
                "verbose": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IPv4 or IPv6 address e.g. 198.51.100.100, ::1, must be subscribed to accept bitmask wider than 255.255.255.0 (/24)",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "days": {
                  "default": "30",
                  "description": "Check for IP reports in the last x days",
                  "order": 2,
                  "title": "Days",
                  "type": "string"
                },
                "verbose": {
                  "default": true,
                  "description": "When set, reports will include the comment (if any) and the reporter's user ID number (0 if reported anonymously)",
                  "order": 3,
                  "title": "Verbose",
                  "type": "boolean"
                }
              },
              "required": [
                "address",
                "days",
                "verbose"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "categories": {
                      "description": "List of categories",
                      "items": {
                        "type": "integer"
                      },
                      "order": 3,
                      "title": "Categories",
                      "type": "array"
                    },
                    "comment": {
                      "description": "Comment by reporter",
                      "order": 2,
                      "title": "Comment",
                      "type": "string"
                    },
                    "reportedAt": {
                      "description": "Date and time of report",
                      "order": 1,
                      "title": "Reported At",
                      "type": "string"
                    },
                    "reporterCountryCode": {
                      "description": "Country code of the reporter",
                      "order": 5,
                      "title": "Reporter Country Code",
                      "type": "string"
                    },
                    "reporterCountryName": {
                      "description": "Name of country reporter is from",
                      "order": 6,
                      "title": "Reporter Country Name",
                      "type": "string"
                    },
                    "reporterId": {
                      "description": "ID number of reporter",
                      "order": 4,
                      "title": "Reporter ID",
                      "type": "integer"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "abuseConfidenceScore": {
                  "description": "Confidence of Abuse",
                  "order": 5,
                  "title": "Abuse Confidence Score",
                  "type": "integer"
                },
                "countryCode": {
                  "description": "Code of country IP is registered in",
                  "order": 6,
                  "title": "Country Code",
                  "type": "string"
                },
                "countryName": {
                  "description": "Name of Country IP is registered in",
                  "order": 10,
                  "title": "Country Name",
                  "type": "string"
                },
                "domain": {
                  "description": "Domain Name of IP",
                  "order": 9,
                  "title": "Domain",
                  "type": "string"
                },
                "found": {
                  "description": "Whether an IP address was found in the database",
                  "order": 15,
                  "title": "Found",
                  "type": "boolean"
                },
                "ipAddress": {
                  "description": "Queried IP Address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "ipVersion": {
                  "description": "Version of IP Address",
                  "order": 3,
                  "title": "IP Version",
                  "type": "integer"
                },
                "isPublic": {
                  "description": "Whether or not the IP Address is public",
                  "order": 2,
                  "title": "Is Public",
                  "type": "boolean"
                },
                "isWhitelisted": {
                  "description": "Whether or not IP Address is whitelisted",
                  "order": 4,
                  "title": "Is Whitelisted",
                  "type": "boolean"
                },
                "isp": {
                  "description": "Internet Service Provider for IP",
                  "order": 8,
                  "title": "ISP",
                  "type": "string"
                },
                "lastReportedAt": {
                  "description": "Date of last report",
                  "order": 13,
                  "title": "Last Reported At",
                  "type": "string"
                },
                "numDistinctUsers": {
                  "description": "Number of distinct users who reported IP",
                  "order": 12,
                  "title": "Number of Distinct Users",
                  "type": "integer"
                },
                "reports": {
                  "description": "List of reports",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 14,
                  "title": "Reports",
                  "type": "array"
                },
                "totalReports": {
                  "description": "Total number of reports of abuse",
                  "order": 11,
                  "title": "Total Reports",
                  "type": "integer"
                },
                "usageType": {
                  "description": "How IP is used",
                  "order": 7,
                  "title": "Usage Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Slack",
          "Threat Intelligence",
          "Virustotal"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Slack Channel": {
                "type": "string",
                "description": "Enter Slack channel name in \"Current Value\" Field\n\nex: #channelname"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "7c595176-1678-4cfe-ad2c-11c1935b8862",
        "name": "Slack Investigate Trigger",
        "description": "",
        "input": {
          "matchChannel": "{{$workflow.[Slack Channel]}}",
          "matchText": "investigate",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}