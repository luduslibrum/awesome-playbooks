{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:52:17.080852769Z",
    "workflowVersions": [
      {
        "name": "Lookup Exploit with AttackerKB from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nLookup an AttackerKB exploit to receive exploit details, including a description, exploit references, vulnerable software versions, attacker value, and exploitability score from Microsoft Teams.\n\nSample Trigger Commands:\n\n`!lookup-vuln CVE-2020-0674`\n\n# Key Features\n\n* Lookup vulnerability exploit information from Microsoft Teams\n* Find all vulnerabilities that match a search term\n* Get description, disclosure date, attack vector, and vulnerable software versions in an easy to consume Microsoft Teams message\n\n# Requirements\n\n* InsightConnect License\n* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere are three parameters you will need to configure in order to complete setup of your workflow:\n\n* Team Name: The Microsoft Teams team name in your environment where the workflow should be triggered and respond\n* Channel Name: The Microsoft Teams channel name in your environment where the workflow should be triggered and respond (the channel should exist in the aforementioned team)\n* Max Exploits: The number of AttackerKB exploits returned\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameters, activate the workflow in order to trigger it.\n\n## Usage\n\n*This workflow will only trigger in the channel specified in the Microsoft Teams workflow steps.*\n\nTo run the workflow, in the channel you are monitoring send a message to Insight Connect using !lookup-vuln <search term>.\n\nFor example:\n*!lookup-vuln CVE-2020-0674`\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 AttackerKB|1.0.3|1|\n|Microsoft Teams|3.1.2|7|\n|HTML|1.2.2|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.1 - Update keywords\n* 2.0.0 - Leverage Parameters Feature | Remove Settings step | Update documentation | Update screenshots | Update Microsoft Teams plugin to version 3.1.2 | Update HTML plugin to version 1.2.2 | Update Rapid7 AttackerKB plugin to version 1.0.3\n* 1.1.0 - Replace the preset text of \"change_me\" with automatic team and channel name extraction in all Microsoft Teams steps except the first one | Update Microsoft Teams to version 3.1.0 | Update documentation\n* 1.0.1 - Update to make Microsoft Teams plugin the latest version\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 AttackerKB](https://attackerkb.com)\n* [Microsoft Teams](https://teams.microsoft.com)\n* [Microsoft Teams Setup](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n",
        "graph": {
          "edges": {
            "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb": {
              "id": "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb",
              "name": "",
              "description": "",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "fromNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "toNodeId": "6b6885e6-3751-40f0-a76c-13721a09c26a"
            },
            "2a3bed4a-4c20-4b4f-9d86-e9054a2c70e2": {
              "id": "2a3bed4a-4c20-4b4f-9d86-e9054a2c70e2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4dc678bc-0acc-4457-84e5-8dfd1314adac",
              "toNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905"
            },
            "2d03d788-8be5-4207-8ce9-038e99f46107": {
              "id": "2d03d788-8be5-4207-8ce9-038e99f46107",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5afb873e-7c14-46ea-8ce0-04c4a77a0700",
              "toNodeId": "4fd815f2-48b1-48f6-b108-e8366ae76c10"
            },
            "31e61448-e453-4025-a608-eccf995e9efc": {
              "id": "31e61448-e453-4025-a608-eccf995e9efc",
              "name": "One Result",
              "description": "This path automatically posts vulnerability information when there is only one matching result.",
              "parentNodeId": "",
              "fromNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "toNodeId": "5afb873e-7c14-46ea-8ce0-04c4a77a0700"
            },
            "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67": {
              "id": "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "toNodeId": "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df"
            },
            "4cce3b57-d624-4df2-8bcf-ebcb46165139": {
              "id": "4cce3b57-d624-4df2-8bcf-ebcb46165139",
              "name": "",
              "description": "",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "fromNodeId": "6b6885e6-3751-40f0-a76c-13721a09c26a",
              "toNodeId": ""
            },
            "54f4f816-1b34-4322-bc57-1aa27b968681": {
              "id": "54f4f816-1b34-4322-bc57-1aa27b968681",
              "name": "Too Many Results",
              "description": "This path posts a message when the search was too broad and resulting in too many results.",
              "parentNodeId": "",
              "fromNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "toNodeId": "b8bcf717-4a05-4fc3-b0ef-6a14b244468a"
            },
            "57213ce0-d2de-4f5f-9060-e52e52d0bf0b": {
              "id": "57213ce0-d2de-4f5f-9060-e52e52d0bf0b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4fd815f2-48b1-48f6-b108-e8366ae76c10",
              "toNodeId": ""
            },
            "63f2b999-c436-4ba3-acc3-b3cb600742b7": {
              "id": "63f2b999-c436-4ba3-acc3-b3cb600742b7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e2c1efab-3959-44b2-b245-34201728c59d",
              "toNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1"
            },
            "6bd75f27-a36a-479b-9ab5-75fa971edaac": {
              "id": "6bd75f27-a36a-479b-9ab5-75fa971edaac",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1e9fb9bf-7496-4a49-96ad-99c0ba73313e",
              "toNodeId": ""
            },
            "6dd11ccd-5010-4441-a0dc-aa43a501857b": {
              "id": "6dd11ccd-5010-4441-a0dc-aa43a501857b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13f4a072-a1e7-4e71-8287-c5b47059126e",
              "toNodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299"
            },
            "78ee22cd-6b02-4443-a369-b1e6ce2d087d": {
              "id": "78ee22cd-6b02-4443-a369-b1e6ce2d087d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "toNodeId": "13f4a072-a1e7-4e71-8287-c5b47059126e"
            },
            "80315753-ea8f-4e00-9449-a98cb878baf8": {
              "id": "80315753-ea8f-4e00-9449-a98cb878baf8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "60872f33-4696-4cad-a6f5-3e80636ec7e3",
              "toNodeId": "e2c1efab-3959-44b2-b245-34201728c59d"
            },
            "8ae00e4d-47a4-4c00-9402-21ef4dcd6ea8": {
              "id": "8ae00e4d-47a4-4c00-9402-21ef4dcd6ea8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b8bcf717-4a05-4fc3-b0ef-6a14b244468a",
              "toNodeId": "1e9fb9bf-7496-4a49-96ad-99c0ba73313e"
            },
            "8bf6fd1a-6235-414d-8d25-739c60f7f769": {
              "id": "8bf6fd1a-6235-414d-8d25-739c60f7f769",
              "name": "Multiple Results",
              "description": "This path posts vulnerability information for each matching exploit based on the results.",
              "parentNodeId": "",
              "fromNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "toNodeId": "4dc678bc-0acc-4457-84e5-8dfd1314adac"
            },
            "9fd9b028-abfa-49cb-ba52-e673ff26217a": {
              "id": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
              "name": "Vulnerability Not Found",
              "description": "Notify the user the provided CVE did not match any vulnerabilities in the AttackerKB database.",
              "parentNodeId": "",
              "fromNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "toNodeId": "a33e0278-63ef-423e-a24c-14693f93e4ef"
            },
            "be5d4625-5e78-4ba1-ba58-b50730e7ac4f": {
              "id": "be5d4625-5e78-4ba1-ba58-b50730e7ac4f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a33e0278-63ef-423e-a24c-14693f93e4ef",
              "toNodeId": ""
            },
            "c148234f-e796-469d-b16d-52efdf2bfe76": {
              "id": "c148234f-e796-469d-b16d-52efdf2bfe76",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
              "toNodeId": "60872f33-4696-4cad-a6f5-3e80636ec7e3"
            },
            "c20b633e-f9ed-4a8b-9f11-83e37e42364c": {
              "id": "c20b633e-f9ed-4a8b-9f11-83e37e42364c",
              "name": "Vulnerability Found",
              "description": "If the CVE identifier matches a vulnerability in the AttackerKB database, then proceed with the workflow.",
              "parentNodeId": "",
              "fromNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "toNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d"
            },
            "eb912929-4f5f-48cb-9057-edc369e5abbf": {
              "id": "eb912929-4f5f-48cb-9057-edc369e5abbf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df",
              "toNodeId": ""
            }
          },
          "nodes": {
            "13f4a072-a1e7-4e71-8287-c5b47059126e": {
              "id": "13f4a072-a1e7-4e71-8287-c5b47059126e",
              "parentNodeId": ""
            },
            "1e9fb9bf-7496-4a49-96ad-99c0ba73313e": {
              "id": "1e9fb9bf-7496-4a49-96ad-99c0ba73313e",
              "parentNodeId": ""
            },
            "4dc678bc-0acc-4457-84e5-8dfd1314adac": {
              "id": "4dc678bc-0acc-4457-84e5-8dfd1314adac",
              "parentNodeId": ""
            },
            "4fd815f2-48b1-48f6-b108-e8366ae76c10": {
              "id": "4fd815f2-48b1-48f6-b108-e8366ae76c10",
              "parentNodeId": ""
            },
            "5afb873e-7c14-46ea-8ce0-04c4a77a0700": {
              "id": "5afb873e-7c14-46ea-8ce0-04c4a77a0700",
              "parentNodeId": ""
            },
            "60872f33-4696-4cad-a6f5-3e80636ec7e3": {
              "id": "60872f33-4696-4cad-a6f5-3e80636ec7e3",
              "parentNodeId": ""
            },
            "61855db7-9d9e-46ab-8176-6e18cd3d8299": {
              "id": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
              "parentNodeId": ""
            },
            "6b6885e6-3751-40f0-a76c-13721a09c26a": {
              "id": "6b6885e6-3751-40f0-a76c-13721a09c26a",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905"
            },
            "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
              "id": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "parentNodeId": ""
            },
            "931acedc-cff6-4f18-b348-3ff465c997c1": {
              "id": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "parentNodeId": ""
            },
            "a33e0278-63ef-423e-a24c-14693f93e4ef": {
              "id": "a33e0278-63ef-423e-a24c-14693f93e4ef",
              "parentNodeId": ""
            },
            "b8bcf717-4a05-4fc3-b0ef-6a14b244468a": {
              "id": "b8bcf717-4a05-4fc3-b0ef-6a14b244468a",
              "parentNodeId": ""
            },
            "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df": {
              "id": "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df",
              "parentNodeId": ""
            },
            "c3d2bd63-4c3b-4e31-828e-2943cdb05905": {
              "id": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "parentNodeId": ""
            },
            "e2c1efab-3959-44b2-b245-34201728c59d": {
              "id": "e2c1efab-3959-44b2-b245-34201728c59d",
              "parentNodeId": ""
            },
            "f181f5db-0152-4bd8-a82f-c7ec1f7f349d": {
              "id": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "13f4a072-a1e7-4e71-8287-c5b47059126e": {
            "nodeId": "13f4a072-a1e7-4e71-8287-c5b47059126e",
            "name": "Strip HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[body].[content]}}",
                "remove_scripts": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "1e9fb9bf-7496-4a49-96ad-99c0ba73313e": {
            "nodeId": "1e9fb9bf-7496-4a49-96ad-99c0ba73313e",
            "name": "Final Report (Too Many Results)",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Trigger\n{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[from].[user].[displayName]}}_started Lookup Exploit with AttackerKB from Microsoft Teams workflow with search term {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}. \n\n# Search Results\n{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}} yielded too many search results in Rapid7's AttackerKB Database.\n\n# Outcome\nWorkflow posted notification to Microsoft Teams channel {{$workflow.[Channel Name]}} to refine search and try again."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "4dc678bc-0acc-4457-84e5-8dfd1314adac": {
            "nodeId": "4dc678bc-0acc-4457-84e5-8dfd1314adac",
            "name": "Multiple Results Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message": "InsightConnect: There are multiple search results for {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}} in Rapid7's AttackerKB database. ",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4fd815f2-48b1-48f6-b108-e8366ae76c10": {
            "nodeId": "4fd815f2-48b1-48f6-b108-e8366ae76c10",
            "name": "Final Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Trigger\n{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[from].[user].[displayName]}} started Lookup Exploit with AttackerKB from Microsoft Teams workflow with search term {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}. \n\n# Search Results\n{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}} yielded the following search results in Rapid7's AttackerKB Database:\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data]}}\n{{this.[name]}}\n{{/each}}\n\n# Outcome\nWorkflow posted vulnerability details to Microsoft Teams channel {{$workflow.[Channel Name]}}."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5afb873e-7c14-46ea-8ce0-04c4a77a0700": {
            "nodeId": "5afb873e-7c14-46ea-8ce0-04c4a77a0700",
            "name": "Post Results to Teams",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message_content": "InsightConnect: <b>Exploit found</b><br>\n Name: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[name]}}<br>\n Disclosure Date: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[disclosureDate]}}<br>\n Last Updated: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[revisionDate]}}<br>\n Attack Vector: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[attackVector]}}<br>\n Privileges Required: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[privilegesRequired]}}<br>\n User Interaction: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[userInteraction]}}<br>\n AttackerKB Attacker Value Score: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[attackerValue]}} {{#equal [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[attackerValue] 0}}(Unknown){{/equal}}<br>\n AttackerKB Exploitability Score: {{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[exploitability]}} {{#equal [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[exploitability] 0}}(Unknown){{/equal}}<br>\n<br>\n<b>Description:</b><br>\n<blockquote>\n{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[document]}}\n</blockquote>\n<br>\n<b>References:</b><br>\n<blockquote>\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[references]}}\n{{this}}<br>\n{{/each}}\n</blockquote>\n<br>\n<b>Vulnerable Versions:</b><br>\n<blockquote>\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[vulnerable-versions]}}\n{{this}}<br>\n{{/each}}\n</blockquote>",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "60872f33-4696-4cad-a6f5-3e80636ec7e3": {
            "nodeId": "60872f33-4696-4cad-a6f5-3e80636ec7e3",
            "name": "Searching Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message": "InsightConnect: Searching for {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}...",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "61855db7-9d9e-46ab-8176-6e18cd3d8299": {
            "nodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
            "name": "Extract Argument",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "!lookup-vuln\\s+{{argument:/.*/}}",
              "expressions": [
                {
                  "type": "text",
                  "value": "!lookup-vuln\\s+"
                },
                {
                  "type": "variable",
                  "value": {
                    "ident": "argument",
                    "regex": ".*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[13f4a072-a1e7-4e71-8287-c5b47059126e].[text]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "6b6885e6-3751-40f0-a76c-13721a09c26a": {
            "nodeId": "6b6885e6-3751-40f0-a76c-13721a09c26a",
            "name": "Post Result to Teams (multiple results)",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message_content": "InsightConnect: <b>Exploit found</b><br>\n Name:  {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[name]}}<br>\n Disclosure Date: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[disclosureDate]}}<br>\n Last Updated*: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[revisionDate]}}<br>\n Attack Vector: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[attackVector]}}<br>\n Privileges Required: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[privilegesRequired]}}<br>\n User Interaction: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[userInteraction]}}<br>\n AttackerKB Attacker Value Score: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[attackerValue]}} {{#equal [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[attackerValue] 0}}(Unknown){{/equal}}<br>\n AttackerKB Exploitability Score: {{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[exploitability]}} {{#equal [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[exploitability] 0}}(Unknown){{/equal}}<br>\n<br>\n<b>Description:</b><br>\n<blockquote>\n{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[document]}}<br>\n</blockquote>\n<br>\n<b>References:</b><br>\n<blockquote>\n{{#each [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[references]}}\n{{this}}<br>\n{{/each}}\n</blockquote>\n<br>\n<b>Vulnerable Versions:</b><br>\n<blockquote>\n{{#each [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[vulnerable-versions]}}\n{{this}}<br>\n{{/each}}\n</blockquote>",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
            "nodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
            "name": "lookup-vuln Trigger",
            "description": "Trigger this workflow by using the !lookup-vuln command.\n\nExamples:\n!lookup-vuln CVE-2020-0674",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "!lookup-vuln",
                "team_name": "{{$workflow.[Team Name]}}"
              }
            },
            "triggerId": "99026c33-b28d-41c8-bf3d-93bf7b04a48d",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "931acedc-cff6-4f18-b348-3ff465c997c1": {
            "nodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
            "name": "Vulnerability Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
              "stepControlParams": [
                {
                  "edgeId": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "c20b633e-f9ed-4a8b-9f11-83e37e42364c",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) > 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a33e0278-63ef-423e-a24c-14693f93e4ef": {
            "nodeId": "a33e0278-63ef-423e-a24c-14693f93e4ef",
            "name": "Exploit Not Found Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message": "InsightConnect: Failed to find AttackerKB exploit relevant to {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}.",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b8bcf717-4a05-4fc3-b0ef-6a14b244468a": {
            "nodeId": "b8bcf717-4a05-4fc3-b0ef-6a14b244468a",
            "name": "Too Many Results Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[channel_name]}}",
                "message": "InsightConnect: Too many results were returned for an AttackerKB search of {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}.  Please refine your search and try again.",
                "team_name": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[team_name]}}",
                "thread_id": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df": {
            "nodeId": "ba81e462-cf7d-4e3f-9eb9-0bea814fc5df",
            "name": "Final Report (Multiple Results)",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Trigger\n{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[from].[user].[displayName]}} started Lookup Exploit with AttackerKB from Microsoft Teams workflow with search term {{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}. \n\n# Search Results\n{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}} yielded the following search results in Rapid7's AttackerKB Database:\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data]}}\n{{this.[name]}}\n{{/each}}\n\n# Outcome\nWorkflow posted vulnerability details to Microsoft Teams channel {{$workflow.[Channel Name]}}."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c3d2bd63-4c3b-4e31-828e-2943cdb05905": {
            "nodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
            "name": "Loop Over Exploits",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb",
              "nextEdgeId": "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67",
              "repeatVariable": "{{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e2c1efab-3959-44b2-b245-34201728c59d": {
            "nodeId": "e2c1efab-3959-44b2-b245-34201728c59d",
            "name": "Search for Exploit based on Vulnerability",
            "type": "action",
            "plugin": {
              "name": "Rapid7 AttackerKB",
              "slugVendor": "rapid7",
              "slugName": "rapid7_attackerkb",
              "slugVersion": "1.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_attackerkb/1.0.3/icon.png"
            },
            "identifier": "topics",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "created": "",
                "disclosureDate": "",
                "document": "",
                "editorId": "",
                "id": "",
                "name": "{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}",
                "page": 0,
                "revisionDate": "",
                "size": 10
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "created": {
                  "description": "Return all topics that were created on the given date, eg. 2019-07-04",
                  "order": 4,
                  "title": "Created",
                  "type": "string"
                },
                "disclosureDate": {
                  "description": "Return all topics that were disclosed on the given date, eg. 2019-07-04",
                  "order": 6,
                  "title": "Disclosure Date",
                  "type": "string"
                },
                "document": {
                  "description": "Text to query the document parameter. A substring match is performed, eg. RDP",
                  "order": 7,
                  "title": "Document",
                  "type": "string"
                },
                "editorId": {
                  "description": "The UUID of a contributor",
                  "order": 2,
                  "title": "Editor ID",
                  "type": "string"
                },
                "id": {
                  "description": "The UUID of a specific topic to return",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "name": {
                  "description": "Text to query the name parameter. A substring match is performed",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "page": {
                  "default": 0,
                  "description": "Pagination page number, default value is 0, example value is 1",
                  "order": 8,
                  "title": "Page",
                  "type": "integer"
                },
                "revisionDate": {
                  "description": "Return all topics that were last edited on the given date, eg. 2019-07-04",
                  "order": 5,
                  "title": "Revision Date",
                  "type": "string"
                },
                "size": {
                  "default": 10,
                  "description": "The number of topics returned per page, default value is 10, maximum size value is 500",
                  "order": 9,
                  "title": "Size",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "metadata": {
                  "properties": {
                    "commonEnterprise": {
                      "description": "The 'Common in enterprise' score",
                      "order": 1,
                      "title": "Common Enterprise",
                      "type": "number"
                    },
                    "defaultConfiguration": {
                      "description": "The 'Present in default configuration' score",
                      "order": 2,
                      "title": "Default Configuration",
                      "type": "number"
                    },
                    "difficultToDevelop": {
                      "description": "The 'Difficult to develop' score",
                      "order": 3,
                      "title": "Difficult To Develop",
                      "type": "number"
                    },
                    "difficultToExploit": {
                      "description": "The 'High barrier to exploitation' score",
                      "order": 6,
                      "title": "Difficult To Exploit",
                      "type": "number"
                    },
                    "difficultToPatch": {
                      "description": "The 'Difficult to patch' score",
                      "order": 7,
                      "title": "Difficult To Patch",
                      "type": "number"
                    },
                    "easyToDevelop": {
                      "description": "The 'Easy to develop' score",
                      "order": 8,
                      "title": "Easy To Develop",
                      "type": "number"
                    },
                    "highPrivilegeAccess": {
                      "description": "The 'Allows high-privileged access' score",
                      "order": 9,
                      "title": "High Privilege Access",
                      "type": "number"
                    },
                    "noUsefulData": {
                      "description": "The 'Does not produce useful data' score",
                      "order": 10,
                      "title": "No Useful Data",
                      "type": "number"
                    },
                    "obscureConfiguration": {
                      "description": "The 'Only present in obscure configuration' score",
                      "order": 11,
                      "title": "Obscure Configuration",
                      "type": "number"
                    },
                    "postAuth": {
                      "description": "The 'Post-Auth' score",
                      "order": 5,
                      "title": "Post Auth",
                      "type": "number"
                    },
                    "preAuth": {
                      "description": "The 'Pre-Auth' score",
                      "order": 4,
                      "title": "Pre Auth",
                      "type": "number"
                    },
                    "requiresInteraction": {
                      "description": "The 'Requires user interaction' score",
                      "order": 12,
                      "title": "Requires Interaction",
                      "type": "number"
                    }
                  },
                  "title": "Metadata",
                  "type": "object"
                },
                "score": {
                  "properties": {
                    "attackerValue": {
                      "description": "The attacker value score",
                      "order": 1,
                      "title": "Attacker Value",
                      "type": "number"
                    },
                    "exploitability": {
                      "description": "The exploitability score",
                      "order": 2,
                      "title": "Exploitability",
                      "type": "number"
                    }
                  },
                  "title": "Score",
                  "type": "object"
                },
                "tags": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "metadata": {
                      "$ref": "#/definitions/metadata",
                      "description": "Metadata",
                      "order": 2,
                      "title": "Metadata"
                    }
                  },
                  "title": "Tags",
                  "type": "object"
                },
                "topic": {
                  "properties": {
                    "created": {
                      "description": "The date and time the topic was created, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 1,
                      "title": "Created",
                      "type": "string"
                    },
                    "disclosureDate": {
                      "description": "The date and time the topic was disclosed, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 8,
                      "title": "Disclosure Date",
                      "type": "string"
                    },
                    "document": {
                      "description": "The main content of the topic",
                      "order": 2,
                      "title": "Document",
                      "type": "string"
                    },
                    "editorId": {
                      "description": "The UUID of the contributor who last edited the topic",
                      "order": 3,
                      "title": "Editor ID",
                      "type": "string"
                    },
                    "id": {
                      "description": "The UUID of the topic",
                      "order": 4,
                      "title": "ID",
                      "type": "string"
                    },
                    "metadata": {
                      "description": "A JSON value containing key/value pairs describing various attributes about this topic",
                      "order": 5,
                      "title": "Metadata",
                      "type": "object"
                    },
                    "name": {
                      "description": "The name or title of the topic",
                      "order": 6,
                      "title": "Name",
                      "type": "string"
                    },
                    "revisionDate": {
                      "description": "The date and time the topic was last changed, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 7,
                      "title": "Revision Date",
                      "type": "string"
                    },
                    "score": {
                      "$ref": "#/definitions/score",
                      "description": "The topic score properties",
                      "order": 9,
                      "title": "Score"
                    },
                    "tags": {
                      "description": "The frequencies with which various tags appear on assessments",
                      "items": {
                        "$ref": "#/definitions/tags"
                      },
                      "order": 10,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "required": [
                    "document",
                    "name"
                  ],
                  "title": "Topic",
                  "type": "object"
                }
              },
              "properties": {
                "data": {
                  "description": "Returned topic data",
                  "items": {
                    "$ref": "#/definitions/topic"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f181f5db-0152-4bd8-a82f-c7ec1f7f349d": {
            "nodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
            "name": "Multiple Results?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "31e61448-e453-4025-a608-eccf995e9efc",
              "stepControlParams": [
                {
                  "edgeId": "31e61448-e453-4025-a608-eccf995e9efc",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "54f4f816-1b34-4322-bc57-1aa27b968681",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "name": "$workflow.Max Exploits",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) > {{$workflow.[Max Exploits]}}"
                },
                {
                  "edgeId": "8bf6fd1a-6235-414d-8d25-739c60f7f769",
                  "expression": {
                    "left": {
                      "left": {
                        "args": [
                          {
                            "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": ">",
                      "right": {
                        "type": "literal",
                        "value": 1
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "args": [
                          {
                            "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                            "type": "variable"
                          }
                        ],
                        "name": "length",
                        "type": "function"
                      },
                      "op": "<=",
                      "right": {
                        "name": "$workflow.Max Exploits",
                        "type": "variable"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) > 1 AND length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) <= {{$workflow.[Max Exploits]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Microsoft",
          "Rapid7",
          "Threat Intelligence",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Team Name": {
                "type": "string",
                "description": "The Microsoft Teams team name in your environment where the workflow should be triggered and respond"
              },
              "Channel Name": {
                "type": "string",
                "description": "The Microsoft Teams channel name in your environment where the workflow should be triggered and respond (the channel should exist in the aforementioned team)"
              },
              "Max Exploits": {
                "type": "integer",
                "description": "The number of AttackerKB exploits returned."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "99026c33-b28d-41c8-bf3d-93bf7b04a48d",
        "identifier": "new_message_received",
        "name": "lookup-vuln Trigger",
        "description": "Trigger this workflow by using the !lookup-vuln command.\n\nExamples:\n!lookup-vuln CVE-2020-0674",
        "input": {
          "channel_name": "{{$workflow.[Channel Name]}}",
          "message_content": "!lookup-vuln",
          "team_name": "{{$workflow.[Team Name]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "words",
                "first_word"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.1.2",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.2/icon.png"
        }
      }
    ]
  }
}