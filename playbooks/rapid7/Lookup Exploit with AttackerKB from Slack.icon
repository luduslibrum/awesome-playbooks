{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:52:14.596534924Z",
    "workflowVersions": [
      {
        "name": "Lookup Exploit with AttackerKB from Slack",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nLookup an AttackerKB exploit to receive exploit details, including a description, exploit references, vulnerable software versions, attacker value, and exploitability score from Slack.\n\nSample Slack trigger command:\n\n`@Rapid7 InsightConnect lookup-vuln CVE-2020-0674`\n\n# Key Features\n\n* Lookup vulnerability exploit information from Slack\n* Find all vulnerabilities that match a search term\n* Get description, disclosure date, attack vector, and vulnerable software versions in an easy to consume Slack message\n\n# Requirements\n\n* InsightConnect License\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\n\nThere is one parameter you will need to configure in order to complete setup of your workflow:\n\n* Channel: The Slack channel name in your environment where the workflow should be triggered\n\nTo begin, select \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\n\nAfter configuring the parameter, activate the workflow in order to trigger it.\n\n## Usage\n\n*This workflow will trigger in any direct messages to your Chatbot **or** any message in a channel directed @ your Chatbot. Note the Chatbot must be in the channel in order to trigger the workflow this way.*\n\nTo run the workflow, send a direct message to your InsightConnect Slack Chatbot or @ your Chatbot in a public channel starting with the command `lookup-vuln`.\n\nFor example, in a direct message to your Chatbot:\n* `lookup-vuln CVE-2020-0674`\n\nOr in a channel including your Chatbot:\n* `@Rapid7 InsightConnect lookup-vuln CVE-2020-6806`\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 AttackerKB|1.0.3|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 2.0.0 - Leverage Parameters Feature | Update documentation | Update Rapid7 AttackerKB plugin to version 1.0.3 | Add missing workflow loop view screenshot\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 AttackerKB](https://attackerkb.com)\n* [Slack](https://slack.com)\n",
        "graph": {
          "edges": {
            "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb": {
              "id": "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb",
              "name": "",
              "description": "",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "fromNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "toNodeId": "9704b0ba-d5ff-46fa-8544-e0691c57f977"
            },
            "1a6ce45e-6bd3-4300-9be3-d0356535d5ec": {
              "id": "1a6ce45e-6bd3-4300-9be3-d0356535d5ec",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4ed047f9-5f93-49d0-8acd-500eed04bc16",
              "toNodeId": ""
            },
            "31e61448-e453-4025-a608-eccf995e9efc": {
              "id": "31e61448-e453-4025-a608-eccf995e9efc",
              "name": "One Result",
              "description": "This path automatically posts vulnerability information when there is only one matching result.",
              "parentNodeId": "",
              "fromNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "toNodeId": "4ed047f9-5f93-49d0-8acd-500eed04bc16"
            },
            "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67": {
              "id": "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "toNodeId": ""
            },
            "63f2b999-c436-4ba3-acc3-b3cb600742b7": {
              "id": "63f2b999-c436-4ba3-acc3-b3cb600742b7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e2c1efab-3959-44b2-b245-34201728c59d",
              "toNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1"
            },
            "72538f30-297b-4717-a52b-dfe8da06b0db": {
              "id": "72538f30-297b-4717-a52b-dfe8da06b0db",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e767bbff-4878-4818-b628-ff805bf609c9",
              "toNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905"
            },
            "78ee22cd-6b02-4443-a369-b1e6ce2d087d": {
              "id": "78ee22cd-6b02-4443-a369-b1e6ce2d087d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "toNodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299"
            },
            "79c7a1d6-04a6-4469-80b8-9ca0482ee533": {
              "id": "79c7a1d6-04a6-4469-80b8-9ca0482ee533",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "aa8aef01-53a9-436c-9bca-d6a25121c028",
              "toNodeId": "e2c1efab-3959-44b2-b245-34201728c59d"
            },
            "8bf6fd1a-6235-414d-8d25-739c60f7f769": {
              "id": "8bf6fd1a-6235-414d-8d25-739c60f7f769",
              "name": "Multiple Results",
              "description": "This path posts an interactive message where the user can select the appropriate vulnerability to receive detailed information on it.",
              "parentNodeId": "",
              "fromNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "toNodeId": "e767bbff-4878-4818-b628-ff805bf609c9"
            },
            "9fd9b028-abfa-49cb-ba52-e673ff26217a": {
              "id": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
              "name": "Vulnerability Not Found",
              "description": "Notify the user the provided CVE did not match any vulnerabilities in the AttackerKB database.",
              "parentNodeId": "",
              "fromNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "toNodeId": "083c5e17-52fc-49f3-a5e4-a8288f944434"
            },
            "c148234f-e796-469d-b16d-52efdf2bfe76": {
              "id": "c148234f-e796-469d-b16d-52efdf2bfe76",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
              "toNodeId": "aa8aef01-53a9-436c-9bca-d6a25121c028"
            },
            "c20b633e-f9ed-4a8b-9f11-83e37e42364c": {
              "id": "c20b633e-f9ed-4a8b-9f11-83e37e42364c",
              "name": "Vulnerability Found",
              "description": "If the CVE identifier matches a vulnerability in the AttackerKB database, then proceed with the workflow.",
              "parentNodeId": "",
              "fromNodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "toNodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d"
            },
            "d11bdcc2-53a6-412f-b657-9b28c2dbf810": {
              "id": "d11bdcc2-53a6-412f-b657-9b28c2dbf810",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "083c5e17-52fc-49f3-a5e4-a8288f944434",
              "toNodeId": ""
            },
            "dde0fd52-c459-4166-a97b-258ba2c658e3": {
              "id": "dde0fd52-c459-4166-a97b-258ba2c658e3",
              "name": "",
              "description": "",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "fromNodeId": "9704b0ba-d5ff-46fa-8544-e0691c57f977",
              "toNodeId": ""
            }
          },
          "nodes": {
            "083c5e17-52fc-49f3-a5e4-a8288f944434": {
              "id": "083c5e17-52fc-49f3-a5e4-a8288f944434",
              "parentNodeId": ""
            },
            "4ed047f9-5f93-49d0-8acd-500eed04bc16": {
              "id": "4ed047f9-5f93-49d0-8acd-500eed04bc16",
              "parentNodeId": ""
            },
            "61855db7-9d9e-46ab-8176-6e18cd3d8299": {
              "id": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
              "parentNodeId": ""
            },
            "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
              "id": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
              "parentNodeId": ""
            },
            "931acedc-cff6-4f18-b348-3ff465c997c1": {
              "id": "931acedc-cff6-4f18-b348-3ff465c997c1",
              "parentNodeId": ""
            },
            "9704b0ba-d5ff-46fa-8544-e0691c57f977": {
              "id": "9704b0ba-d5ff-46fa-8544-e0691c57f977",
              "parentNodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905"
            },
            "aa8aef01-53a9-436c-9bca-d6a25121c028": {
              "id": "aa8aef01-53a9-436c-9bca-d6a25121c028",
              "parentNodeId": ""
            },
            "c3d2bd63-4c3b-4e31-828e-2943cdb05905": {
              "id": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
              "parentNodeId": ""
            },
            "e2c1efab-3959-44b2-b245-34201728c59d": {
              "id": "e2c1efab-3959-44b2-b245-34201728c59d",
              "parentNodeId": ""
            },
            "e767bbff-4878-4818-b628-ff805bf609c9": {
              "id": "e767bbff-4878-4818-b628-ff805bf609c9",
              "parentNodeId": ""
            },
            "f181f5db-0152-4bd8-a82f-c7ec1f7f349d": {
              "id": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "083c5e17-52fc-49f3-a5e4-a8288f944434": {
            "nodeId": "083c5e17-52fc-49f3-a5e4-a8288f944434",
            "name": "Vuln Not Found Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "No results matching `{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}` were found in Rapid7's AttackerKB Database.\nhttps://media.giphy.com/media/xTiTnm8AGoS75Cvyko/giphy.gif",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "4ed047f9-5f93-49d0-8acd-500eed04bc16": {
            "nodeId": "4ed047f9-5f93-49d0-8acd-500eed04bc16",
            "name": "Post Results to Slack",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_*Exploit found:*_\n *Name*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[name]}}`\n *Disclosure Date*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[disclosureDate]}}`\n *Last Updated*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[revisionDate]}}`\n *Attack Vector*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[attackVector]}}`\n *Privileges Required*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[privilegesRequired]}}`\n *User Interaction*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[baseMetricV3].[cvssV3].[userInteraction]}}`\n *AttackerKB Attacker Value Score*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[attackerValue]}}` {{#equal [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[attackerValue] 0}}(Unknown){{/equal}}\n *AttackerKB Exploitability Score*: `{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[exploitability]}}` {{#equal [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[score].[exploitability] 0}}(Unknown){{/equal}}\n\n*Description*:\n```{{[e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[document]}}```\n\n*References*\n```\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[references]}}\n{{this}}\n{{/each}}\n```\n\n*Vulnerable Versions*\n```\n{{#each [e2c1efab-3959-44b2-b245-34201728c59d].[data].[0].[metadata].[vulnerable-versions]}}\n{{this}}\n{{/each}}\n```",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "61855db7-9d9e-46ab-8176-6e18cd3d8299": {
            "nodeId": "61855db7-9d9e-46ab-8176-6e18cd3d8299",
            "name": "Extract Argument",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "lookup-vuln\\s+{{argument:/.*/}}",
              "expressions": [
                {
                  "type": "text",
                  "value": "lookup-vuln\\s+"
                },
                {
                  "type": "variable",
                  "value": {
                    "ident": "argument",
                    "regex": ".*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[text]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99": {
            "nodeId": "8b5f067d-03aa-4d9e-a06b-5ad7dda77b99",
            "name": "lookup-vuln Trigger",
            "description": "Trigger this workflow by entering a Slack command in the following format:\n\"@Rapid7 InsightConnect lookup-vuln CVE-XXXX-XXXX\"",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "matchChannel": "",
                "matchText": "(?i)lookup-vuln\\s+\\S+",
                "type": "any"
              }
            },
            "triggerId": "930920c8-8ea6-45ce-a6fc-3a7d8ca538fc",
            "defaultInputJSONSchema": {
              "properties": {
                "matchChannel": {
                  "description": "Regex to match for channel name",
                  "order": 1,
                  "title": "Match Channel",
                  "type": "string"
                },
                "matchText": {
                  "description": "Regex to match for Slack message content",
                  "order": 2,
                  "title": "Match Text",
                  "type": "string"
                },
                "type": {
                  "default": "any",
                  "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
                  "enum": [
                    "any",
                    "direct",
                    "group"
                  ],
                  "order": 3,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "MD5 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "SHA1 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "SHA256 hashes found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "domains": {
                      "description": "Domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Email addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Hashes found within the message",
                      "order": 5,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "IP addresses found within the message",
                      "order": 7,
                      "title": "IP Addresses"
                    },
                    "mac_addresses": {
                      "description": "MAC addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "parent_domains": {
                      "description": "Parent domains found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Parent Domains",
                      "type": "array"
                    },
                    "urls": {
                      "description": "URLs found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "URLs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "IPv4 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addresses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "IPv6 addresses found within the message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addresses",
                      "type": "array"
                    }
                  },
                  "title": "IP Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "channel": {
                      "description": "Channel name",
                      "order": 3,
                      "title": "Channel",
                      "type": "string"
                    },
                    "channel_id": {
                      "description": "Slack channel ID",
                      "order": 4,
                      "title": "Channel ID",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "First word of the message, for example a chat command (ignoring mentions)",
                      "order": 5,
                      "title": "First Word",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Potential threat indicators found within the message",
                      "order": 7,
                      "title": "Indicators"
                    },
                    "text": {
                      "description": "Text",
                      "order": 5,
                      "title": "Text",
                      "type": "string"
                    },
                    "ts": {
                      "description": "Timestamp",
                      "order": 6,
                      "title": "Ts",
                      "type": "string"
                    },
                    "user": {
                      "description": "User name",
                      "order": 1,
                      "title": "User",
                      "type": "string"
                    },
                    "user_id": {
                      "description": "Slack User ID",
                      "order": 2,
                      "title": "User ID",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "title": "Message",
                  "type": "object"
                }
              },
              "properties": {
                "display_name": {
                  "description": "User display name",
                  "order": 4,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "Message",
                  "order": 1,
                  "title": "Message"
                },
                "timestamp": {
                  "description": "Timestamp",
                  "order": 3,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "Message Type",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/chatops.svg",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "message"
          },
          "931acedc-cff6-4f18-b348-3ff465c997c1": {
            "nodeId": "931acedc-cff6-4f18-b348-3ff465c997c1",
            "name": "Vulnerability Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
              "stepControlParams": [
                {
                  "edgeId": "9fd9b028-abfa-49cb-ba52-e673ff26217a",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "c20b633e-f9ed-4a8b-9f11-83e37e42364c",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) > 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9704b0ba-d5ff-46fa-8544-e0691c57f977": {
            "nodeId": "9704b0ba-d5ff-46fa-8544-e0691c57f977",
            "name": "Post Result to Slack (multiple results loop)",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_*Exploit found:*_\n *Name*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[name]}}`\n *Disclosure Date*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[disclosureDate]}}`\n *Last Updated*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[revisionDate]}}`\n *Attack Vector*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[attackVector]}}`\n *Privileges Required*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[privilegesRequired]}}`\n *User Interaction*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[baseMetricV3].[cvssV3].[userInteraction]}}`\n *AttackerKB Attacker Value Score*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[attackerValue]}}` {{#equal [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[attackerValue] 0}}(Unknown){{/equal}}\n *AttackerKB Exploitability Score*: `{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[exploitability]}}` {{#equal [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[score].[exploitability] 0}}(Unknown){{/equal}}\n\n*Description*:\n```{{[c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[document]}}```\n\n*References*\n```\n{{#each [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[references]}}\n{{this}}\n{{/each}}\n```\n\n*Vulnerable Versions*\n```\n{{#each [c3d2bd63-4c3b-4e31-828e-2943cdb05905].[$item].[metadata].[vulnerable-versions]}}\n{{this}}\n{{/each}}\n```",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "aa8aef01-53a9-436c-9bca-d6a25121c028": {
            "nodeId": "aa8aef01-53a9-436c-9bca-d6a25121c028",
            "name": "Searching Notification",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "_Searching for `{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}`..._",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "c3d2bd63-4c3b-4e31-828e-2943cdb05905": {
            "nodeId": "c3d2bd63-4c3b-4e31-828e-2943cdb05905",
            "name": "Loop Over Exploits",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "005c81f6-8c60-4a6f-b11d-3150cf4d7dbb",
              "nextEdgeId": "3aa5e9fc-7de0-45bd-8df1-d4b76c2f4f67",
              "repeatVariable": "{{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e2c1efab-3959-44b2-b245-34201728c59d": {
            "nodeId": "e2c1efab-3959-44b2-b245-34201728c59d",
            "name": "Search for Exploit based on Vulnerability",
            "type": "action",
            "plugin": {
              "name": "Rapid7 AttackerKB",
              "slugVendor": "rapid7",
              "slugName": "rapid7_attackerkb",
              "slugVersion": "1.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_attackerkb/1.0.3/icon.png"
            },
            "identifier": "topics",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "created": "",
                "disclosureDate": "",
                "document": "",
                "editorId": "",
                "id": "",
                "name": "{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}",
                "page": 0,
                "revisionDate": "",
                "size": 10
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "created": {
                  "description": "Return all topics that were created on the given date, eg. 2019-07-04",
                  "order": 4,
                  "title": "Created",
                  "type": "string"
                },
                "disclosureDate": {
                  "description": "Return all topics that were disclosed on the given date, eg. 2019-07-04",
                  "order": 6,
                  "title": "Disclosure Date",
                  "type": "string"
                },
                "document": {
                  "description": "Text to query the document parameter. A substring match is performed, eg. RDP",
                  "order": 7,
                  "title": "Document",
                  "type": "string"
                },
                "editorId": {
                  "description": "The UUID of a contributor",
                  "order": 2,
                  "title": "Editor ID",
                  "type": "string"
                },
                "id": {
                  "description": "The UUID of a specific topic to return",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "name": {
                  "description": "Text to query the name parameter. A substring match is performed",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "page": {
                  "default": 0,
                  "description": "Pagination page number, default value is 0, example value is 1",
                  "order": 8,
                  "title": "Page",
                  "type": "integer"
                },
                "revisionDate": {
                  "description": "Return all topics that were last edited on the given date, eg. 2019-07-04",
                  "order": 5,
                  "title": "Revision Date",
                  "type": "string"
                },
                "size": {
                  "default": 10,
                  "description": "The number of topics returned per page, default value is 10, maximum size value is 500",
                  "order": 9,
                  "title": "Size",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "metadata": {
                  "properties": {
                    "commonEnterprise": {
                      "description": "The 'Common in enterprise' score",
                      "order": 1,
                      "title": "Common Enterprise",
                      "type": "number"
                    },
                    "defaultConfiguration": {
                      "description": "The 'Present in default configuration' score",
                      "order": 2,
                      "title": "Default Configuration",
                      "type": "number"
                    },
                    "difficultToDevelop": {
                      "description": "The 'Difficult to develop' score",
                      "order": 3,
                      "title": "Difficult To Develop",
                      "type": "number"
                    },
                    "difficultToExploit": {
                      "description": "The 'High barrier to exploitation' score",
                      "order": 6,
                      "title": "Difficult To Exploit",
                      "type": "number"
                    },
                    "difficultToPatch": {
                      "description": "The 'Difficult to patch' score",
                      "order": 7,
                      "title": "Difficult To Patch",
                      "type": "number"
                    },
                    "easyToDevelop": {
                      "description": "The 'Easy to develop' score",
                      "order": 8,
                      "title": "Easy To Develop",
                      "type": "number"
                    },
                    "highPrivilegeAccess": {
                      "description": "The 'Allows high-privileged access' score",
                      "order": 9,
                      "title": "High Privilege Access",
                      "type": "number"
                    },
                    "noUsefulData": {
                      "description": "The 'Does not produce useful data' score",
                      "order": 10,
                      "title": "No Useful Data",
                      "type": "number"
                    },
                    "obscureConfiguration": {
                      "description": "The 'Only present in obscure configuration' score",
                      "order": 11,
                      "title": "Obscure Configuration",
                      "type": "number"
                    },
                    "postAuth": {
                      "description": "The 'Post-Auth' score",
                      "order": 5,
                      "title": "Post Auth",
                      "type": "number"
                    },
                    "preAuth": {
                      "description": "The 'Pre-Auth' score",
                      "order": 4,
                      "title": "Pre Auth",
                      "type": "number"
                    },
                    "requiresInteraction": {
                      "description": "The 'Requires user interaction' score",
                      "order": 12,
                      "title": "Requires Interaction",
                      "type": "number"
                    }
                  },
                  "title": "Metadata",
                  "type": "object"
                },
                "score": {
                  "properties": {
                    "attackerValue": {
                      "description": "The attacker value score",
                      "order": 1,
                      "title": "Attacker Value",
                      "type": "number"
                    },
                    "exploitability": {
                      "description": "The exploitability score",
                      "order": 2,
                      "title": "Exploitability",
                      "type": "number"
                    }
                  },
                  "title": "Score",
                  "type": "object"
                },
                "tags": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "metadata": {
                      "$ref": "#/definitions/metadata",
                      "description": "Metadata",
                      "order": 2,
                      "title": "Metadata"
                    }
                  },
                  "title": "Tags",
                  "type": "object"
                },
                "topic": {
                  "properties": {
                    "created": {
                      "description": "The date and time the topic was created, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 1,
                      "title": "Created",
                      "type": "string"
                    },
                    "disclosureDate": {
                      "description": "The date and time the topic was disclosed, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 8,
                      "title": "Disclosure Date",
                      "type": "string"
                    },
                    "document": {
                      "description": "The main content of the topic",
                      "order": 2,
                      "title": "Document",
                      "type": "string"
                    },
                    "editorId": {
                      "description": "The UUID of the contributor who last edited the topic",
                      "order": 3,
                      "title": "Editor ID",
                      "type": "string"
                    },
                    "id": {
                      "description": "The UUID of the topic",
                      "order": 4,
                      "title": "ID",
                      "type": "string"
                    },
                    "metadata": {
                      "description": "A JSON value containing key/value pairs describing various attributes about this topic",
                      "order": 5,
                      "title": "Metadata",
                      "type": "object"
                    },
                    "name": {
                      "description": "The name or title of the topic",
                      "order": 6,
                      "title": "Name",
                      "type": "string"
                    },
                    "revisionDate": {
                      "description": "The date and time the topic was last changed, eg. 2019-07-02T16:22:15.879357Z",
                      "order": 7,
                      "title": "Revision Date",
                      "type": "string"
                    },
                    "score": {
                      "$ref": "#/definitions/score",
                      "description": "The topic score properties",
                      "order": 9,
                      "title": "Score"
                    },
                    "tags": {
                      "description": "The frequencies with which various tags appear on assessments",
                      "items": {
                        "$ref": "#/definitions/tags"
                      },
                      "order": 10,
                      "title": "Tags",
                      "type": "array"
                    }
                  },
                  "required": [
                    "document",
                    "name"
                  ],
                  "title": "Topic",
                  "type": "object"
                }
              },
              "properties": {
                "data": {
                  "description": "Returned topic data",
                  "items": {
                    "$ref": "#/definitions/topic"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e767bbff-4878-4818-b628-ff805bf609c9": {
            "nodeId": "e767bbff-4878-4818-b628-ff805bf609c9",
            "name": "Multiple Results Notification",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "There are multiple search results for `{{[61855db7-9d9e-46ab-8176-6e18cd3d8299].[argument]}}` in Rapid7's AttackerKB database. ",
                "recipient": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[channel_id]}}",
                "thread_ts": "{{[8b5f067d-03aa-4d9e-a06b-5ad7dda77b99].[message].[ts]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "f181f5db-0152-4bd8-a82f-c7ec1f7f349d": {
            "nodeId": "f181f5db-0152-4bd8-a82f-c7ec1f7f349d",
            "name": "Multiple Results?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "31e61448-e453-4025-a608-eccf995e9efc",
              "stepControlParams": [
                {
                  "edgeId": "31e61448-e453-4025-a608-eccf995e9efc",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "8bf6fd1a-6235-414d-8d25-739c60f7f769",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "e2c1efab-3959-44b2-b245-34201728c59d.data",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[e2c1efab-3959-44b2-b245-34201728c59d].[data]}}) > 1"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Rapid7",
          "Slack",
          "Threat Intelligence",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Channnel": {
                "type": "string",
                "description": "The Slack channel name in your environment where the workflow should be triggered"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "930920c8-8ea6-45ce-a6fc-3a7d8ca538fc",
        "name": "lookup-vuln Trigger",
        "description": "Trigger this workflow by entering a Slack command in the following format:\n\"@Rapid7 InsightConnect lookup-vuln CVE-XXXX-XXXX\"",
        "input": {
          "matchChannel": "",
          "matchText": "(?i)lookup-vuln\\s+\\S+",
          "type": "any"
        },
        "inputJsonSchema": {
          "properties": {
            "matchChannel": {
              "description": "Regex to match for channel name",
              "order": 1,
              "title": "Match Channel",
              "type": "string"
            },
            "matchText": {
              "description": "Regex to match for Slack message content",
              "order": 2,
              "title": "Match Text",
              "type": "string"
            },
            "type": {
              "default": "any",
              "description": "Desired Slack channel type: direct message to Slack app, group chats, or all channels",
              "enum": [
                "any",
                "direct",
                "group"
              ],
              "order": 3,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "type"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "MD5 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "SHA1 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "SHA256 hashes found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "domains": {
                  "description": "Domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Email addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Hashes found within the message",
                  "order": 5,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "IP addresses found within the message",
                  "order": 7,
                  "title": "IP Addresses"
                },
                "mac_addresses": {
                  "description": "MAC addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "parent_domains": {
                  "description": "Parent domains found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Parent Domains",
                  "type": "array"
                },
                "urls": {
                  "description": "URLs found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "IPv4 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addresses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "IPv6 addresses found within the message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addresses",
                  "type": "array"
                }
              },
              "title": "IP Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "channel": {
                  "description": "Channel name",
                  "order": 3,
                  "title": "Channel",
                  "type": "string"
                },
                "channel_id": {
                  "description": "Slack channel ID",
                  "order": 4,
                  "title": "Channel ID",
                  "type": "string"
                },
                "first_word": {
                  "description": "First word of the message, for example a chat command (ignoring mentions)",
                  "order": 5,
                  "title": "First Word",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Potential threat indicators found within the message",
                  "order": 7,
                  "title": "Indicators"
                },
                "text": {
                  "description": "Text",
                  "order": 5,
                  "title": "Text",
                  "type": "string"
                },
                "ts": {
                  "description": "Timestamp",
                  "order": 6,
                  "title": "Ts",
                  "type": "string"
                },
                "user": {
                  "description": "User name",
                  "order": 1,
                  "title": "User",
                  "type": "string"
                },
                "user_id": {
                  "description": "Slack User ID",
                  "order": 2,
                  "title": "User ID",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "Words",
                  "type": "array"
                }
              },
              "title": "Message",
              "type": "object"
            }
          },
          "properties": {
            "display_name": {
              "description": "User display name",
              "order": 4,
              "title": "Display Name",
              "type": "string"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "Message",
              "order": 1,
              "title": "Message"
            },
            "timestamp": {
              "description": "Timestamp",
              "order": 3,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "Message Type",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_chatops",
        "chatOpsAppName": "slack",
        "chatOpsIdentifier": "message"
      }
    ]
  }
}