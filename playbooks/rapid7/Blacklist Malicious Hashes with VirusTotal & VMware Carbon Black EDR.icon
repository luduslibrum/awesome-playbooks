{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T10:18:47.254420404Z",
    "workflowVersions": [
      {
        "name": "Blacklist Malicious Hashes with VirusTotal & VMware Carbon Black EDR",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow automated the process of looking up an associated file hash in VirusTotal from an InsightIDR alert. InsightConnect then posts a user response prompt to the security channel in a synopsis of the incident. Based upon the details, the incident responder will either dismiss as a false positive or block the file with VMware Carbon Black EDR. \n\n# Key Features\n\n* Data enrichment with VirusTotal\n* File blacklist on endpoint with VMware Carbon Black EDR\n\n# Requirements\n\n* InsightConnect License\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* VMware Carbon Black EDR URL and Account Credentials\n* VirusTotal API Key\n\n# Documentation\n\n## Setup\n\nOnce the workflow has been imported and the Slack chatbot selected for your workstation, edit the workflow and configure your CB Response connection in the Block Hash step. Also, configure your VirusTotal connection and confirm where applicable. \n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Cb Response|3.1.8|1|\n|VirusTotal|7.0.0|2|\n|Math|1.2.1|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.1.0 - Updated VirusTotal plugin | Added Math plugin to support the same artifact outputs\n* 1.0.2 - Updated VMware Carbon Black EDR branding\n* 1.0.1 - Updated documentation\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [CB Response](https://extensions.rapid7.com/extension/carbon_black_response)\n* [VirusTotal](https://extensions.rapid7.com/extension/virustotal)\n",
        "graph": {
          "edges": {
            "04946589-2002-417b-963c-8a1b7579d004": {
              "id": "04946589-2002-417b-963c-8a1b7579d004",
              "name": "successful",
              "description": "The file was successfully blocked",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43",
              "toNodeId": "2714e4d7-31dd-4507-93b3-cab900544c31"
            },
            "0bb4fcee-0af2-47cd-88cd-d19fc8630442": {
              "id": "0bb4fcee-0af2-47cd-88cd-d19fc8630442",
              "name": "",
              "description": "",
              "parentNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4",
              "fromNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4",
              "toNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "0c56caee-e9b9-4856-94c6-78dab833f247": {
              "id": "0c56caee-e9b9-4856-94c6-78dab833f247",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "4eac1cd5-8db5-440e-8e2c-43c445473296",
              "toNodeId": ""
            },
            "134520fd-a0b3-4748-87eb-eb5b5bea5ccf": {
              "id": "134520fd-a0b3-4748-87eb-eb5b5bea5ccf",
              "name": "Blacklist",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "efcddea7-b092-40e3-8209-5c1f797521da",
              "toNodeId": "a75150ef-8fda-4965-8ebc-705b3048c7e3"
            },
            "25de078e-1845-4ce5-ab85-a673e3ad8fd5": {
              "id": "25de078e-1845-4ce5-ab85-a673e3ad8fd5",
              "name": "broken",
              "description": "Carbon Black was unable to block the hash.",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43",
              "toNodeId": "764ac227-3d7a-491e-8402-6b01200518e0"
            },
            "26b91f52-dcc1-4b8f-a249-37ac9f074c9b": {
              "id": "26b91f52-dcc1-4b8f-a249-37ac9f074c9b",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "4304a4c6-3aab-45a3-9571-7b51bd3a3029",
              "toNodeId": "b97a6872-de12-40e2-a806-87d2ab8fafdf"
            },
            "2d51e019-4f4f-429a-9043-0034cb429519": {
              "id": "2d51e019-4f4f-429a-9043-0034cb429519",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "7b3c38d3-dfc9-4354-9306-c9d68171a641",
              "toNodeId": "71bbbd9b-35cd-49f3-ac4b-240c016c0637"
            },
            "2e011723-4b4a-45e3-bb55-1e9bf91c3105": {
              "id": "2e011723-4b4a-45e3-bb55-1e9bf91c3105",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "764ac227-3d7a-491e-8402-6b01200518e0",
              "toNodeId": "d7b5abb0-07b4-4720-8a71-966ba40ed69c"
            },
            "45272ee1-a6fe-437a-a4e3-ae48741fd074": {
              "id": "45272ee1-a6fe-437a-a4e3-ae48741fd074",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68",
              "toNodeId": ""
            },
            "508742a6-899f-448a-a686-dc2f77b18706": {
              "id": "508742a6-899f-448a-a686-dc2f77b18706",
              "name": "Dismiss",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "efcddea7-b092-40e3-8209-5c1f797521da",
              "toNodeId": "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68"
            },
            "551fae5c-3c4d-48cf-9baa-8ff6fc449550": {
              "id": "551fae5c-3c4d-48cf-9baa-8ff6fc449550",
              "name": "",
              "description": "",
              "parentNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4",
              "fromNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "toNodeId": ""
            },
            "6cc4dc69-478b-4cb6-b533-ac9b68521320": {
              "id": "6cc4dc69-478b-4cb6-b533-ac9b68521320",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4",
              "toNodeId": ""
            },
            "6ee8a54e-b420-4cd2-954c-23cf5f4dc254": {
              "id": "6ee8a54e-b420-4cd2-954c-23cf5f4dc254",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "2714e4d7-31dd-4507-93b3-cab900544c31",
              "toNodeId": "4eac1cd5-8db5-440e-8e2c-43c445473296"
            },
            "993d8cec-31bf-41c5-b7c8-23d5db8fefa6": {
              "id": "993d8cec-31bf-41c5-b7c8-23d5db8fefa6",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "b97a6872-de12-40e2-a806-87d2ab8fafdf",
              "toNodeId": "efcddea7-b092-40e3-8209-5c1f797521da"
            },
            "9ab6507f-eeaa-42a3-9a3a-71dc2ea162a2": {
              "id": "9ab6507f-eeaa-42a3-9a3a-71dc2ea162a2",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "d7b5abb0-07b4-4720-8a71-966ba40ed69c",
              "toNodeId": ""
            },
            "a2aa3747-c41b-4712-ba58-90500167eca8": {
              "id": "a2aa3747-c41b-4712-ba58-90500167eca8",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "toNodeId": "7b3c38d3-dfc9-4354-9306-c9d68171a641"
            },
            "d52701a5-8ea8-4c0c-8bad-4a77d7c7c42d": {
              "id": "d52701a5-8ea8-4c0c-8bad-4a77d7c7c42d",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "a75150ef-8fda-4965-8ebc-705b3048c7e3",
              "toNodeId": "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43"
            },
            "df66abed-edd8-43ec-bdb4-892ae90ccf02": {
              "id": "df66abed-edd8-43ec-bdb4-892ae90ccf02",
              "name": "",
              "description": "",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "fromNodeId": "71bbbd9b-35cd-49f3-ac4b-240c016c0637",
              "toNodeId": "4304a4c6-3aab-45a3-9571-7b51bd3a3029"
            },
            "ec57bf02-6531-4ff7-b4e1-6813dad15e15": {
              "id": "ec57bf02-6531-4ff7-b4e1-6813dad15e15",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "818e00ab-6a26-49c6-9bbe-8791cef1c6d0",
              "toNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4"
            }
          },
          "nodes": {
            "15b6e09f-6a40-44f1-ae35-4d66b898f81a": {
              "id": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
              "parentNodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4"
            },
            "2714e4d7-31dd-4507-93b3-cab900544c31": {
              "id": "2714e4d7-31dd-4507-93b3-cab900544c31",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "4304a4c6-3aab-45a3-9571-7b51bd3a3029": {
              "id": "4304a4c6-3aab-45a3-9571-7b51bd3a3029",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68": {
              "id": "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "4eac1cd5-8db5-440e-8e2c-43c445473296": {
              "id": "4eac1cd5-8db5-440e-8e2c-43c445473296",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "71bbbd9b-35cd-49f3-ac4b-240c016c0637": {
              "id": "71bbbd9b-35cd-49f3-ac4b-240c016c0637",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "764ac227-3d7a-491e-8402-6b01200518e0": {
              "id": "764ac227-3d7a-491e-8402-6b01200518e0",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "7b3c38d3-dfc9-4354-9306-c9d68171a641": {
              "id": "7b3c38d3-dfc9-4354-9306-c9d68171a641",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "818e00ab-6a26-49c6-9bbe-8791cef1c6d0": {
              "id": "818e00ab-6a26-49c6-9bbe-8791cef1c6d0",
              "parentNodeId": ""
            },
            "a5fab515-967d-4afe-9a35-61759fe31ca4": {
              "id": "a5fab515-967d-4afe-9a35-61759fe31ca4",
              "parentNodeId": ""
            },
            "a75150ef-8fda-4965-8ebc-705b3048c7e3": {
              "id": "a75150ef-8fda-4965-8ebc-705b3048c7e3",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43": {
              "id": "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "b97a6872-de12-40e2-a806-87d2ab8fafdf": {
              "id": "b97a6872-de12-40e2-a806-87d2ab8fafdf",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "d7b5abb0-07b4-4720-8a71-966ba40ed69c": {
              "id": "d7b5abb0-07b4-4720-8a71-966ba40ed69c",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            },
            "efcddea7-b092-40e3-8209-5c1f797521da": {
              "id": "efcddea7-b092-40e3-8209-5c1f797521da",
              "parentNodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a"
            }
          }
        },
        "steps": {
          "15b6e09f-6a40-44f1-ae35-4d66b898f81a": {
            "nodeId": "15b6e09f-6a40-44f1-ae35-4d66b898f81a",
            "name": "Hashes Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "a2aa3747-c41b-4712-ba58-90500167eca8",
              "nextEdgeId": "551fae5c-3c4d-48cf-9baa-8ff6fc449550",
              "repeatVariable": "[a5fab515-967d-4afe-9a35-61759fe31ca4].[$item].[hashes]"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "2714e4d7-31dd-4507-93b3-cab900544c31": {
            "nodeId": "2714e4d7-31dd-4507-93b3-cab900544c31",
            "name": "Success Message",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}} was successfully blocked",
                "recipient": "{{[efcddea7-b092-40e3-8209-5c1f797521da].[channel_id]}}",
                "thread_ts": "{{[efcddea7-b092-40e3-8209-5c1f797521da].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "4304a4c6-3aab-45a3-9571-7b51bd3a3029": {
            "nodeId": "4304a4c6-3aab-45a3-9571-7b51bd3a3029",
            "name": "Calculate Total Reports",
            "type": "action",
            "plugin": {
              "name": "Math",
              "slugVendor": "rapid7",
              "slugName": "math",
              "slugVersion": "1.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/math/1.2.1/icon.png"
            },
            "identifier": "calculate",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "equation": "{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[harmless]}} + {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[malicious]}} + {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[suspicious]}} + {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[undetected]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "equation": {
                  "description": "Equation to calculate. Uses Python arithmetic operators (+, -, /, *, **, %)",
                  "order": 1,
                  "title": "Equation",
                  "type": "string"
                }
              },
              "required": [
                "equation"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result of the arithmetic operation",
                  "order": 1,
                  "title": "Result",
                  "type": "number"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68": {
            "nodeId": "4cd6f1d3-8ba2-446a-a97c-cdf4eb7dab68",
            "name": "Alert Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n**Description:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n**Investigation ID:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n**Name:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}\n**Link:** [{{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}]({{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}})\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n**Timestamp:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n**Type:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors]}}\n**Available Actors**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors].[assets]}}\n{{#if fqdn}}\nAsset FQDN: {{fqdn}}\n{{/if}}\n{{#if shortname}}\nAsset Shortname: {{shortname}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents]}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n**Alert IP Addresses**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n{{#if ip}}\n* Alert IP: {{ip}} ({{type}})\n{{/if}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n\n**Alert Domains**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n\n**Alert URLs**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n\n**Alert Process Hashes**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n{{#if processId}}\n+ Alert Process: {{name}} ({{processId}})\n{{#if cmdLine}}\n  + Command Line: {{cmdLine}}\n{{/if}}\n{{#if assetId}}\n  + Asset ID: {{assetId}}\n{{/if}}\n{{#if hashes}}\n{{#each hashes}}\n  + {{hash}} ({{type}})\n{{/each}}\n{{/if}}\n{{/if}}\n{{/each}}\n{{/if}}\n{{/if}}\n\n## VirusTotal Findings\n\n{{#if [71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}}\nVirusTotal Hash Lookup ( {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}} ):\n\nMalicious: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[malicious]}}\nRisk Score: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[malicious]}} / {{[4304a4c6-3aab-45a3-9571-7b51bd3a3029].[result]}}\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection](https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection)\n{{else}}\nThe VirusTotal hash lookup failed, this is likely because the hash has never been submitted before.\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "4eac1cd5-8db5-440e-8e2c-43c445473296": {
            "nodeId": "4eac1cd5-8db5-440e-8e2c-43c445473296",
            "name": "Incident Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n**Description:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n**Investigation ID:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n**Name:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}\n**Link:** [{{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}]({{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}})\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n**Timestamp:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n**Type:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors]}}\n**Available Actors**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors].[assets]}}\n{{#if fqdn}}\nAsset FQDN: {{fqdn}}\n{{/if}}\n{{#if shortname}}\nAsset Shortname: {{shortname}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents]}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n**Alert IP Addresses**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n{{#if ip}}\n* Alert IP: {{ip}} ({{type}})\n{{/if}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n\n**Alert Domains**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n\n**Alert URLs**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n\n**Alert Process Hashes**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n{{#if processId}}\n+ Alert Process: {{name}} ({{processId}})\n{{#if cmdLine}}\n  + Command Line: {{cmdLine}}\n{{/if}}\n{{#if assetId}}\n  + Asset ID: {{assetId}}\n{{/if}}\n{{#if hashes}}\n{{#each hashes}}\n  + {{hash}} ({{type}})\n{{/each}}\n{{/if}}\n{{/if}}\n{{/each}}\n{{/if}}\n{{/if}}\n\n\n## VirusTotal Findings\n\n{{#if [71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}}\nVirusTotal Hash Lookup ( {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}} ):\n\nMalicious: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[malicious]}}\nRisk Score: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[malicious]}} / {{[4304a4c6-3aab-45a3-9571-7b51bd3a3029].[result]}}\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection](https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection)\n{{else}}\nThe VirusTotal hash lookup failed, this is likely because the hash has never been submitted before.\n{{/if}}\n\n# Carbon Black Response\nBlock Hash: {{[a75150ef-8fda-4965-8ebc-705b3048c7e3].[success]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "71bbbd9b-35cd-49f3-ac4b-240c016c0637": {
            "nodeId": "71bbbd9b-35cd-49f3-ac4b-240c016c0637",
            "name": "VirusTotal Hash Lookup",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 hash to lookup",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "alert_context": {
                  "properties": {
                    "dest_ip": {
                      "description": "Destination IP",
                      "order": 1,
                      "title": "Destination IP",
                      "type": "string"
                    },
                    "dest_port": {
                      "description": "Destination port",
                      "order": 2,
                      "title": "Destination Port",
                      "type": "integer"
                    },
                    "hostname": {
                      "description": "In case the alert is related to an HTTP event, destination hostname",
                      "order": 3,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Communication protocol",
                      "order": 4,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "src_ip": {
                      "description": "Source IP",
                      "order": 5,
                      "title": "Source IP",
                      "type": "string"
                    },
                    "src_port": {
                      "description": "Source port",
                      "order": 6,
                      "title": "Source Port",
                      "type": "integer"
                    },
                    "url": {
                      "description": "In case the alert is related to an HTTP event, destination URL",
                      "order": 7,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Alert Context",
                  "type": "object"
                },
                "crowdsourced_ids_results": {
                  "properties": {
                    "alert_context": {
                      "description": "Context for every match of that alert",
                      "items": {
                        "$ref": "#/definitions/alert_context"
                      },
                      "order": 1,
                      "title": "Alert Context",
                      "type": "array"
                    },
                    "alert_severity": {
                      "description": "Alert severity",
                      "order": 2,
                      "title": "Alert Severity",
                      "type": "string"
                    },
                    "rule_category": {
                      "description": "Alert category description",
                      "order": 3,
                      "title": "Rule Category",
                      "type": "string"
                    },
                    "rule_id": {
                      "description": "Suricata/Snort rule SID",
                      "order": 4,
                      "title": "Rule ID",
                      "type": "string"
                    },
                    "rule_msg": {
                      "description": "Alert description",
                      "order": 5,
                      "title": "Rule Message",
                      "type": "string"
                    },
                    "rule_source": {
                      "description": "Rule source, determined by SID range",
                      "order": 6,
                      "title": "Rule Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Ids Results",
                  "type": "object"
                },
                "crowdsourced_ids_stats": {
                  "properties": {
                    "high": {
                      "description": "Number of matched rules having a high severity",
                      "order": 1,
                      "title": "High",
                      "type": "integer"
                    },
                    "info": {
                      "description": "Number of matched rules having an info severity",
                      "order": 2,
                      "title": "Info",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched rules having a low severity",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched rules having a medium severity",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Crowdsourced Ids Stats",
                  "type": "object"
                },
                "crowdsourced_yara_results": {
                  "properties": {
                    "author": {
                      "description": "Rule author",
                      "order": 1,
                      "title": "Author",
                      "type": "string"
                    },
                    "description": {
                      "description": "Matched rule description",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "match_in_subfile": {
                      "description": "Whether the match was in a subfile or not",
                      "order": 3,
                      "title": "Match in Subfile",
                      "type": "boolean"
                    },
                    "rule_name": {
                      "description": "Matched rule name",
                      "order": 4,
                      "title": "Rule Name",
                      "type": "string"
                    },
                    "ruleset_id": {
                      "description": "VirusTotal's ruleset ID",
                      "order": 5,
                      "title": "Ruleset ID",
                      "type": "string"
                    },
                    "ruleset_name": {
                      "description": "Matched rule's ruleset name",
                      "order": 6,
                      "title": "Ruleset Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Ruleset source",
                      "order": 7,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Crowdsourced Yara Results",
                  "type": "object"
                },
                "file_report": {
                  "properties": {
                    "capabilities_tags": {
                      "description": "List of representative tags related to the file's capabilities",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Capabilities Tags",
                      "type": "array"
                    },
                    "creation_date": {
                      "description": "Extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "crowdsourced_ids_results": {
                      "description": "IDS (Snort and Suricata) matches for the file. If the file is not a PCAP, the matches are taken from a PCAP generated after running the file in a sandbox",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_ids_results"
                      },
                      "order": 3,
                      "title": "Crowdsourced IDS Results",
                      "type": "array"
                    },
                    "crowdsourced_ids_stats": {
                      "$ref": "#/definitions/crowdsourced_ids_stats",
                      "description": "IDS results stats",
                      "order": 4,
                      "title": "Crowdsourced IDS Stats"
                    },
                    "crowdsourced_yara_results": {
                      "description": "YARA matches for the file",
                      "items": {
                        "$ref": "#/definitions/crowdsourced_yara_results"
                      },
                      "order": 5,
                      "title": "Crowdsourced YARA Results",
                      "type": "array"
                    },
                    "downloadable": {
                      "description": "True if the file can be downloaded, false otherwise",
                      "order": 6,
                      "title": "Downloadable",
                      "type": "boolean"
                    },
                    "first_submission_date": {
                      "description": "Date when the file was first seen in VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "last_analysis_date": {
                      "description": "Most recent scan date (UTC timestamp)",
                      "order": 8,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Latest scan results. For more information about its format, check the Analysis object results attribute",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 9,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "A summary of the latest scan results",
                      "order": 10,
                      "title": "Last Analysis Stats"
                    },
                    "last_modification_date": {
                      "description": "Date when the object itself was last modified (UTC timestamp)",
                      "order": 11,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "Most recent date the file was posted to VirusTotal (UTC timestamp)",
                      "order": 12,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "main_icon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the main icon",
                      "order": 13,
                      "title": "Main Icon"
                    },
                    "malicious": {
                      "description": "True if there are one or more votes indicating that the file is malicious",
                      "order": 32,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "File's MD5 hash",
                      "order": 14,
                      "title": "MD5",
                      "type": "string"
                    },
                    "meaningful_name": {
                      "description": "The most interesting name out of all file's names",
                      "order": 15,
                      "title": "Meaningful Name",
                      "type": "string"
                    },
                    "names": {
                      "description": "All file names associated with the file",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Names",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "File's score calculated from all votes posted by the VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "sandbox_verdicts": {
                      "description": "A summary of all sandbox verdicts for a given file",
                      "order": 18,
                      "title": "Sandbox Verdicts",
                      "type": "object"
                    },
                    "sha1": {
                      "description": "File's SHA1 hash",
                      "order": 19,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "File's SHA256 hash",
                      "order": 20,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "sigma_analysis_stats": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules, grouped by its severity",
                      "order": 21,
                      "title": "Sigma Analysis Stats"
                    },
                    "sigma_analysis_summary": {
                      "$ref": "#/definitions/sigma_analysis",
                      "description": "Dictionary containing the number of matched sigma rules group by its severity",
                      "order": 22,
                      "title": "Sigma Analysis Summary"
                    },
                    "size": {
                      "description": "File size in bytes",
                      "order": 23,
                      "title": "Size",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "Tags",
                      "type": "array"
                    },
                    "times_submitted": {
                      "description": "Number of times the file has been posted to VirusTotal",
                      "order": 25,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided by harmless and malicious",
                      "order": 26,
                      "title": "Total Votes"
                    },
                    "type_description": {
                      "description": "Describes the file type",
                      "order": 27,
                      "title": "Type Description",
                      "type": "string"
                    },
                    "type_extension": {
                      "description": "Specifies file extension",
                      "order": 28,
                      "title": "Type Extension",
                      "type": "string"
                    },
                    "type_tag": {
                      "description": "Tag representing the file type",
                      "order": 29,
                      "title": "Type Tag",
                      "type": "string"
                    },
                    "unique_sources": {
                      "description": "Indicates from how many different sources the file has been posted from",
                      "order": 30,
                      "title": "Unique Sources",
                      "type": "integer"
                    },
                    "vhash": {
                      "description": "In-house similarity clustering algorithm value, based on a simple structural feature hash allowing you to find similar files",
                      "order": 31,
                      "title": "VHASH",
                      "type": "string"
                    }
                  },
                  "title": "File Report",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "sigma_analysis": {
                  "properties": {
                    "critical": {
                      "description": "Number of matched critical severity rules/rulesets",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "high": {
                      "description": "Number of matched high severity rules/rulesets",
                      "order": 2,
                      "title": "High",
                      "type": "integer"
                    },
                    "low": {
                      "description": "Number of matched low severity rules/rulesets",
                      "order": 3,
                      "title": "Low",
                      "type": "integer"
                    },
                    "medium": {
                      "description": "Number of matched medium severity rules/rulesets",
                      "order": 4,
                      "title": "Medium",
                      "type": "integer"
                    }
                  },
                  "title": "Sigma Analysis",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file_report",
                  "description": "Hash report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "764ac227-3d7a-491e-8402-6b01200518e0": {
            "nodeId": "764ac227-3d7a-491e-8402-6b01200518e0",
            "name": "Warning",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}} block was unsuccessful, check Carbon Black connection.",
                "recipient": "{{[efcddea7-b092-40e3-8209-5c1f797521da].[channel_id]}}",
                "thread_ts": "{{[efcddea7-b092-40e3-8209-5c1f797521da].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "7b3c38d3-dfc9-4354-9306-c9d68171a641": {
            "nodeId": "7b3c38d3-dfc9-4354-9306-c9d68171a641",
            "name": "VirusTotal File Lookup",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "rescan_file",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 of file to rescan",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "submission_response": {
                  "properties": {
                    "id": {
                      "description": "Submission ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "type": {
                      "description": "Submission type",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Submission Response",
                  "type": "object"
                }
              },
              "properties": {
                "submission_response": {
                  "$ref": "#/definitions/submission_response",
                  "description": "File submission response",
                  "order": 1,
                  "title": "Submission Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "818e00ab-6a26-49c6-9bbe-8791cef1c6d0": {
            "nodeId": "818e00ab-6a26-49c6-9bbe-8791cef1c6d0",
            "name": "InsightIDR Event",
            "description": "This workflow automated the process of looking up an associated file hash in VirusTotal from an InsightIDR alert. InsightConnect then posts a user response prompt to the security channel in a synopsis of the incident. Based upon the details, the incident responder will either dismiss as a false positive or block the file with Carbon Black Response. ",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "e2350ddf-a747-496e-ac64-0181e62db825",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "a5fab515-967d-4afe-9a35-61759fe31ca4": {
            "nodeId": "a5fab515-967d-4afe-9a35-61759fe31ca4",
            "name": "Processes Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "0bb4fcee-0af2-47cd-88cd-d19fc8630442",
              "nextEdgeId": "6cc4dc69-478b-4cb6-b533-ac9b68521320",
              "repeatVariable": "{{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "a75150ef-8fda-4965-8ebc-705b3048c7e3": {
            "nodeId": "a75150ef-8fda-4965-8ebc-705b3048c7e3",
            "name": "CB Response - Block Hash",
            "type": "action",
            "plugin": {
              "name": "Cb Response",
              "slugVendor": "rapid7",
              "slugName": "carbon_black_response",
              "slugVersion": "3.1.8",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/carbon_black_response/3.1.8/icon.png"
            },
            "identifier": "blacklist_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "md5_hash": "{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "md5_hash": {
                  "description": "An MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                }
              },
              "required": [
                "md5_hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Status of request - true if successful, false otherwise",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43": {
            "nodeId": "aec8e3f1-0a11-4c9d-9f22-48cba7d60d43",
            "name": "Carbon Black Integration",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "25de078e-1845-4ce5-ab85-a673e3ad8fd5",
              "stepControlParams": [
                {
                  "edgeId": "04946589-2002-417b-963c-8a1b7579d004",
                  "expression": {
                    "left": {
                      "name": "a75150ef-8fda-4965-8ebc-705b3048c7e3.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[a75150ef-8fda-4965-8ebc-705b3048c7e3].[success]}} = true"
                },
                {
                  "edgeId": "25de078e-1845-4ce5-ab85-a673e3ad8fd5",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b97a6872-de12-40e2-a806-87d2ab8fafdf": {
            "nodeId": "b97a6872-de12-40e2-a806-87d2ab8fafdf",
            "name": "VirusTotal Findings",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "*{{[15b6e09f-6a40-44f1-ae35-4d66b898f81a].[$item].[hash]}}*\n\n{{#if [7b3c38d3-dfc9-4354-9306-c9d68171a641].[$success]}}\nVirusTotal File Lookup ( {{[7b3c38d3-dfc9-4354-9306-c9d68171a641].[$success]}} ):\n\nSubmission Repsonse ID: {{[7b3c38d3-dfc9-4354-9306-c9d68171a641].[submission_response].[id]}}\nSubmission Repsonse Type: {{[7b3c38d3-dfc9-4354-9306-c9d68171a641].[submission_response].[type]}}\n{{else}}\nThe file submission to VirusTotal failed, this is likely because the file has never been submitted before.\n{{/if}}\n\n\n{{#if [71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}}\nVirusTotal Hash Lookup ( {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}} ):\n\nMalicious: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[malicious]}}\nRisk Score: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[malicious]}} / {{[4304a4c6-3aab-45a3-9571-7b51bd3a3029].[result]}}\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection](https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection)\n{{else}}\nThe VirusTotal hash lookup failed, this is likely because the hash has never been submitted before.\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "d7b5abb0-07b4-4720-8a71-966ba40ed69c": {
            "nodeId": "d7b5abb0-07b4-4720-8a71-966ba40ed69c",
            "name": "Block Hash Summary",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n**Description:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[description]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n**Investigation ID:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[investigationId]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n**Name:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[name]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}\n**Link:** [{{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}}]({{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[link]}})\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n**Timestamp:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[timestamp]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n**Type:** {{[818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[type]}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors]}}\n**Available Actors**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[actors].[assets]}}\n{{#if fqdn}}\nAsset FQDN: {{fqdn}}\n{{/if}}\n{{#if shortname}}\nAsset Shortname: {{shortname}}\n{{/if}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents]}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n**Alert IP Addresses**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[ipAddresses]}}\n{{#if ip}}\n* Alert IP: {{ip}} ({{type}})\n{{/if}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n\n**Alert Domains**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[domains]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n\n**Alert URLs**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[urls]}}\n+ {{this}}\n{{/each}}\n{{/if}}\n\n{{#if [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n\n**Alert Process Hashes**\n{{#each [818e00ab-6a26-49c6-9bbe-8791cef1c6d0].[contents].[processes]}}\n{{#if processId}}\n+ Alert Process: {{name}} ({{processId}})\n{{#if cmdLine}}\n  + Command Line: {{cmdLine}}\n{{/if}}\n{{#if assetId}}\n  + Asset ID: {{assetId}}\n{{/if}}\n{{#if hashes}}\n{{#each hashes}}\n  + {{hash}} ({{type}})\n{{/each}}\n{{/if}}\n{{/if}}\n{{/each}}\n{{/if}}\n{{/if}}\n\n\n## VirusTotal Findings\n\n{{#if [71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}}\nVirusTotal Hash Lookup ( {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[$success]}} ):\n\nMalicious: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[malicious]}}\nRisk Score: {{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[last_analysis_stats].[malicious]}} / {{[4304a4c6-3aab-45a3-9571-7b51bd3a3029].[result]}}\n\nFull VirusTotal Report: [https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection](https://www.virustotal.com/gui/file/{{[71bbbd9b-35cd-49f3-ac4b-240c016c0637].[report].[sha256]}}/detection)\n{{else}}\nThe VirusTotal hash lookup failed, this is likely because the hash has never been submitted before.\n{{/if}}\n\n# Carbon Black Response\nBlock Hash: {{[a75150ef-8fda-4965-8ebc-705b3048c7e3].[success]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "efcddea7-b092-40e3-8209-5c1f797521da": {
            "nodeId": "efcddea7-b092-40e3-8209-5c1f797521da",
            "name": "User Response",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "{{[b97a6872-de12-40e2-a806-87d2ab8fafdf].[content]}}\n\n\n_Would you like to blacklist this hash?_",
              "messageType": "button",
              "options": [
                {
                  "answer": "Blacklist",
                  "buttonStyle": "danger",
                  "confirmation": "Blacklisting Hash",
                  "edgeId": "134520fd-a0b3-4748-87eb-eb5b5bea5ccf",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Dismiss",
                  "buttonStyle": "default",
                  "confirmation": "Dismissed",
                  "edgeId": "508742a6-899f-448a-a686-dc2f77b18706",
                  "isTimeoutOnly": false
                }
              ],
              "question": "Thank you for your response",
              "recipient": "#slack-secops",
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "508742a6-899f-448a-a686-dc2f77b18706"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          }
        },
        "tags": [
          "Endpoint Detection & Response",
          "Slack",
          "Virustotal",
          "VMware"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "e2350ddf-a747-496e-ac64-0181e62db825",
        "name": "InsightIDR Event",
        "description": "This workflow automated the process of looking up an associated file hash in VirusTotal from an InsightIDR alert. InsightConnect then posts a user response prompt to the security channel in a synopsis of the incident. Based upon the details, the incident responder will either dismiss as a false positive or block the file with Carbon Black Response. ",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}