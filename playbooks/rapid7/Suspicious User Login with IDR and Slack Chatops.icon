{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T13:02:21.64007559Z",
    "workflowVersions": [
      {
        "name": "Suspicious User Login with IDR and Slack Chatops",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nSuspicious User Login with InsightIDR and Slack automates the process of validating IPs against other office locations tracked in a global artifact and if no match is found, escalates the alert via Slack chatbot to the security team. \n\n# Key Features\n\n* Parses IP addresses and looks up Geolocation with Whois\n* Every location is compared to the Office Location Global Artifact\n* If there is not a match, the InsightConnect workflow will then automatically create a ticket in Jira and escalate alert details to security via Slack Chatbot for a user response.\n* Based if the responder confirms that the user is traveling, the ticket will be transitioned to a closed state.\n* If the alert is truly suspicious, the workflow will query for the user in Active Directory and disabled.\n\n# Requirements\n\n* InsightConnect License\n* [Slack](https://insightconnect.help.rapid7.com/docs/configure-slack-for-chatops)\n* Active Directory Administrative Credentials\n* Jira URL and Account Credentials\n\n# Documentation\n\n## Setup\n\nOnce the workflow has been imported and the Slack Chatbot selected for your Slack Workspace, edit the workflow and setup your Active Directory connection in the Query and Disable user steps.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Active Directory LDAP|3.2.6|4|\n|WHOIS|1.0.5|1|\n|Jira|3.2.1|6|\n|Datetime|2.0.4|2|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time._\n\n# Version History\n\n* 1.0.2 - Updated documentation\n* 1.0.1 - Fix title\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Slack](https://slack.com)\n* [InsightIDR](https://extensions.rapid7.com/extension/rapid7_insightidr)\n* [Active Directory LDAP](https://extensions.rapid7.com/extension/active_directory_ldap)\n* [Datetime](https://extensions.rapid7.com/extension/datetime)\n* [Jira](https://extensions.rapid7.com/extension/jira)\n",
        "graph": {
          "edges": {
            "197293ac-543f-4078-a8b2-1df3db43ba99": {
              "id": "197293ac-543f-4078-a8b2-1df3db43ba99",
              "name": "OOO",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "195ad8ca-708c-479d-8a1f-57b33ce9789d",
              "toNodeId": "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8"
            },
            "29879a1b-bc83-4190-b488-9544a1049662": {
              "id": "29879a1b-bc83-4190-b488-9544a1049662",
              "name": "No",
              "description": "Is there an office in this location? - No",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "753c028b-b0af-4021-b126-0313d715f82f",
              "toNodeId": "f89450a9-9f6f-4643-8d6a-934f73f778d6"
            },
            "2abeabda-6441-4032-a410-a17fcbc10458": {
              "id": "2abeabda-6441-4032-a410-a17fcbc10458",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "toNodeId": ""
            },
            "2ad4a736-f8c5-4be1-b73b-dbaf5cf848e5": {
              "id": "2ad4a736-f8c5-4be1-b73b-dbaf5cf848e5",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "8d0e3208-c1be-42a4-a8bb-12e7204688f1",
              "toNodeId": ""
            },
            "2fea76a7-c267-40a0-8435-7f2570d069f1": {
              "id": "2fea76a7-c267-40a0-8435-7f2570d069f1",
              "name": "Disable User",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "195ad8ca-708c-479d-8a1f-57b33ce9789d",
              "toNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "306976aa-b477-4b28-a77b-0ac8d22dacfc": {
              "id": "306976aa-b477-4b28-a77b-0ac8d22dacfc",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "toNodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3"
            },
            "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6": {
              "id": "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "toNodeId": ""
            },
            "3c2cdb0e-8fb0-4783-9462-5e41eca13c43": {
              "id": "3c2cdb0e-8fb0-4783-9462-5e41eca13c43",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "997ad925-c30d-47a1-92fc-db328a6c1960",
              "toNodeId": "77ba104e-e328-4c3a-8946-0a9ffa29941f"
            },
            "479d89b7-8f95-4515-a334-a6ad9c24a862": {
              "id": "479d89b7-8f95-4515-a334-a6ad9c24a862",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "9dce384b-542b-409b-a759-4e5d3072fb23",
              "toNodeId": "4d31d44b-111b-4c77-9ca2-953442e32dc0"
            },
            "4ca17161-3029-4ebb-94f8-6baaeb09e3a8": {
              "id": "4ca17161-3029-4ebb-94f8-6baaeb09e3a8",
              "name": "No",
              "description": "User not found",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "5af00435-885d-45a8-8529-48c437d8f823",
              "toNodeId": ""
            },
            "4e94139e-e560-40ec-9865-b3ec9307221d": {
              "id": "4e94139e-e560-40ec-9865-b3ec9307221d",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "f665ba31-ff37-44b4-90ab-730240e39ecf",
              "toNodeId": "20f93ac9-3113-4ae1-bd2b-83135904cc4c"
            },
            "50ffef0f-d3c4-4b88-8940-64815f8ed53f": {
              "id": "50ffef0f-d3c4-4b88-8940-64815f8ed53f",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "fc3336ae-c3d0-493a-baf8-02198d1a9920",
              "toNodeId": "5af00435-885d-45a8-8529-48c437d8f823"
            },
            "5957c0a4-4eaa-4429-954d-b98cce51345c": {
              "id": "5957c0a4-4eaa-4429-954d-b98cce51345c",
              "name": "Disable User",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "be6bc2fd-6d87-496a-a571-83d6363aa356",
              "toNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "5c6b0a74-3b5a-4602-b2d8-bb803b1f9f30": {
              "id": "5c6b0a74-3b5a-4602-b2d8-bb803b1f9f30",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "c0516d76-1523-4583-a8aa-41a1e15227d2",
              "toNodeId": "195ad8ca-708c-479d-8a1f-57b33ce9789d"
            },
            "659375a8-4fd8-42ce-bf54-d5a949976455": {
              "id": "659375a8-4fd8-42ce-bf54-d5a949976455",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "49323b4c-33b7-49da-ae97-5a88841d09b5",
              "toNodeId": "933e73cb-4ba2-4f60-81ef-d97a6c37d595"
            },
            "664ea750-bed3-4621-82d8-49743590a8d5": {
              "id": "664ea750-bed3-4621-82d8-49743590a8d5",
              "name": "Yes",
              "description": "User found.",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "5af00435-885d-45a8-8529-48c437d8f823",
              "toNodeId": "0c22c8a6-a7f4-4cee-a642-2216bea43ad0"
            },
            "66c7ebdd-7e1d-40a5-a87f-92391132a7f0": {
              "id": "66c7ebdd-7e1d-40a5-a87f-92391132a7f0",
              "name": "Yes",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "6410a6a6-11e7-4888-a17e-15be2eaa2ccf",
              "toNodeId": "8cf8272a-8d39-4396-a3ac-7b258904ddbf"
            },
            "6fc84ee1-b077-4bf8-a224-0183d07d16cb": {
              "id": "6fc84ee1-b077-4bf8-a224-0183d07d16cb",
              "name": "No",
              "description": "User not found",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9",
              "toNodeId": ""
            },
            "7a985d15-8ade-4a6d-9118-eab371af8d08": {
              "id": "7a985d15-8ade-4a6d-9118-eab371af8d08",
              "name": "timout",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "be6bc2fd-6d87-496a-a571-83d6363aa356",
              "toNodeId": ""
            },
            "7abe00b4-1958-449c-965a-d6ce22f7e0d9": {
              "id": "7abe00b4-1958-449c-965a-d6ce22f7e0d9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
              "toNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "83bdaf7e-6a6f-4a63-b456-7488412a51a0": {
              "id": "83bdaf7e-6a6f-4a63-b456-7488412a51a0",
              "name": "timeout",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "195ad8ca-708c-479d-8a1f-57b33ce9789d",
              "toNodeId": ""
            },
            "89cc7969-f2f4-4aeb-bb52-aadadd35b578": {
              "id": "89cc7969-f2f4-4aeb-bb52-aadadd35b578",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "toNodeId": "6410a6a6-11e7-4888-a17e-15be2eaa2ccf"
            },
            "93518b00-ba7e-4cc0-9e2f-0213cde220f5": {
              "id": "93518b00-ba7e-4cc0-9e2f-0213cde220f5",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "20f93ac9-3113-4ae1-bd2b-83135904cc4c",
              "toNodeId": "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9"
            },
            "95297ccb-35e9-4558-ba00-7ee0de8fab39": {
              "id": "95297ccb-35e9-4558-ba00-7ee0de8fab39",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "0c22c8a6-a7f4-4cee-a642-2216bea43ad0",
              "toNodeId": "77fd9a33-e724-40c7-bb24-41f8b2c90800"
            },
            "985fed27-ac77-4802-891a-a60e36e5b830": {
              "id": "985fed27-ac77-4802-891a-a60e36e5b830",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "bd0d9e99-99ef-4458-87d7-707db8add052",
              "toNodeId": "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68"
            },
            "9ddfb19d-a659-42ea-aac4-4ad731699aed": {
              "id": "9ddfb19d-a659-42ea-aac4-4ad731699aed",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "4d31d44b-111b-4c77-9ca2-953442e32dc0",
              "toNodeId": ""
            },
            "9e592ac3-cd35-480c-9960-da2823e216fe": {
              "id": "9e592ac3-cd35-480c-9960-da2823e216fe",
              "name": "Yes",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "eb0b4792-9a47-42e2-ae42-57dabe017e79",
              "toNodeId": "f665ba31-ff37-44b4-90ab-730240e39ecf"
            },
            "a13c39da-d71d-4322-9412-e895682e9fb9": {
              "id": "a13c39da-d71d-4322-9412-e895682e9fb9",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "0dc88065-7043-4f29-9973-925bdcbf6fdc",
              "toNodeId": "098a8387-cab9-4826-a892-8529f5c285a6"
            },
            "a7201637-8ce4-4be9-8329-c2a14f5e6400": {
              "id": "a7201637-8ce4-4be9-8329-c2a14f5e6400",
              "name": "Yes",
              "description": "Is there an office in this location? - Yes",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "933e73cb-4ba2-4f60-81ef-d97a6c37d595",
              "toNodeId": ""
            },
            "ac0638df-84d9-4a85-8923-0b7aaafbdb6e": {
              "id": "ac0638df-84d9-4a85-8923-0b7aaafbdb6e",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "toNodeId": ""
            },
            "ac6ab8f7-598a-4641-90fb-a69ddd8a0a11": {
              "id": "ac6ab8f7-598a-4641-90fb-a69ddd8a0a11",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "098a8387-cab9-4826-a892-8529f5c285a6",
              "toNodeId": "753c028b-b0af-4021-b126-0313d715f82f"
            },
            "b1bdb314-5265-4909-b6a1-029c4eb460c1": {
              "id": "b1bdb314-5265-4909-b6a1-029c4eb460c1",
              "name": "Yes",
              "description": "Is there an office in this location? - Yes",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "753c028b-b0af-4021-b126-0313d715f82f",
              "toNodeId": "49323b4c-33b7-49da-ae97-5a88841d09b5"
            },
            "b1e5fe04-2e84-4f18-a045-7300cc904d4f": {
              "id": "b1e5fe04-2e84-4f18-a045-7300cc904d4f",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "32b882e0-8635-4210-8871-7d84880cea6b",
              "toNodeId": "8d0e3208-c1be-42a4-a8bb-12e7204688f1"
            },
            "b6cd2a2b-801f-4b45-bf33-91c0d1410894": {
              "id": "b6cd2a2b-801f-4b45-bf33-91c0d1410894",
              "name": "No",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "6410a6a6-11e7-4888-a17e-15be2eaa2ccf",
              "toNodeId": ""
            },
            "b83f2871-ff96-423b-867b-94ffe38e6626": {
              "id": "b83f2871-ff96-423b-867b-94ffe38e6626",
              "name": "Yes",
              "description": "User found",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9",
              "toNodeId": "3304452f-534f-4f7d-81fc-bf089fcda2f8"
            },
            "baaa17c7-f021-4567-8669-0afe89ba01e5": {
              "id": "baaa17c7-f021-4567-8669-0afe89ba01e5",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "f89450a9-9f6f-4643-8d6a-934f73f778d6",
              "toNodeId": "be6bc2fd-6d87-496a-a571-83d6363aa356"
            },
            "c0ed3ec0-139c-4a63-bb29-50853bbd6dfa": {
              "id": "c0ed3ec0-139c-4a63-bb29-50853bbd6dfa",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "toNodeId": "eb0b4792-9a47-42e2-ae42-57dabe017e79"
            },
            "c1eec2e0-74d8-4a33-b8fe-42ed42ff7ab1": {
              "id": "c1eec2e0-74d8-4a33-b8fe-42ed42ff7ab1",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "77fd9a33-e724-40c7-bb24-41f8b2c90800",
              "toNodeId": "cba1ab8a-fae0-42ac-9d50-13a9acaba93e"
            },
            "c74338d6-7ad5-4b85-be60-0624e1a8d641": {
              "id": "c74338d6-7ad5-4b85-be60-0624e1a8d641",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68",
              "toNodeId": ""
            },
            "cb4b1f91-ba8b-465d-a062-ea13d89881da": {
              "id": "cb4b1f91-ba8b-465d-a062-ea13d89881da",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8fb69bee-42ce-4260-8026-333a73099d41",
              "toNodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d"
            },
            "d6ae3aab-fd07-4b6a-aeab-1dfc9a785c63": {
              "id": "d6ae3aab-fd07-4b6a-aeab-1dfc9a785c63",
              "name": "OOO",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "be6bc2fd-6d87-496a-a571-83d6363aa356",
              "toNodeId": "bd0d9e99-99ef-4458-87d7-707db8add052"
            },
            "da88a7c5-21a7-4613-b687-c1ddfa39286c": {
              "id": "da88a7c5-21a7-4613-b687-c1ddfa39286c",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "8cf8272a-8d39-4396-a3ac-7b258904ddbf",
              "toNodeId": "fc3336ae-c3d0-493a-baf8-02198d1a9920"
            },
            "de8cb557-c7cb-4c08-987b-00632dcc087c": {
              "id": "de8cb557-c7cb-4c08-987b-00632dcc087c",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "9852c584-f70f-41fb-99d6-8a1d3094faf9",
              "toNodeId": ""
            },
            "def8f123-a0e6-4918-90ca-f43303a0f855": {
              "id": "def8f123-a0e6-4918-90ca-f43303a0f855",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "77ba104e-e328-4c3a-8946-0a9ffa29941f",
              "toNodeId": "32b882e0-8635-4210-8871-7d84880cea6b"
            },
            "e32f4375-198a-4fde-8c84-e93681ac3c9d": {
              "id": "e32f4375-198a-4fde-8c84-e93681ac3c9d",
              "name": "",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "3304452f-534f-4f7d-81fc-bf089fcda2f8",
              "toNodeId": "997ad925-c30d-47a1-92fc-db328a6c1960"
            },
            "e399bacd-eda4-49a7-b836-da6465a26541": {
              "id": "e399bacd-eda4-49a7-b836-da6465a26541",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8",
              "toNodeId": "9852c584-f70f-41fb-99d6-8a1d3094faf9"
            },
            "e9bc9ccf-e25f-4e31-a447-2ebea36bb1dd": {
              "id": "e9bc9ccf-e25f-4e31-a447-2ebea36bb1dd",
              "name": "No",
              "description": "Is there an office in this location? - No",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "933e73cb-4ba2-4f60-81ef-d97a6c37d595",
              "toNodeId": "c0516d76-1523-4583-a8aa-41a1e15227d2"
            },
            "ec8b4148-e84d-4979-820e-3b03a67601d1": {
              "id": "ec8b4148-e84d-4979-820e-3b03a67601d1",
              "name": "",
              "description": "",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "fromNodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
              "toNodeId": "0dc88065-7043-4f29-9973-925bdcbf6fdc"
            },
            "ef9890f4-46d0-417c-894c-a8a2abee9065": {
              "id": "ef9890f4-46d0-417c-894c-a8a2abee9065",
              "name": "No",
              "description": "",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "fromNodeId": "eb0b4792-9a47-42e2-ae42-57dabe017e79",
              "toNodeId": ""
            },
            "f446064b-257b-45e1-916d-233a4d06ad41": {
              "id": "f446064b-257b-45e1-916d-233a4d06ad41",
              "name": "",
              "description": "",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "fromNodeId": "cba1ab8a-fae0-42ac-9d50-13a9acaba93e",
              "toNodeId": "9dce384b-542b-409b-a759-4e5d3072fb23"
            }
          },
          "nodes": {
            "098a8387-cab9-4826-a892-8529f5c285a6": {
              "id": "098a8387-cab9-4826-a892-8529f5c285a6",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "0c22c8a6-a7f4-4cee-a642-2216bea43ad0": {
              "id": "0c22c8a6-a7f4-4cee-a642-2216bea43ad0",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "0dc88065-7043-4f29-9973-925bdcbf6fdc": {
              "id": "0dc88065-7043-4f29-9973-925bdcbf6fdc",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "195ad8ca-708c-479d-8a1f-57b33ce9789d": {
              "id": "195ad8ca-708c-479d-8a1f-57b33ce9789d",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "20f93ac9-3113-4ae1-bd2b-83135904cc4c": {
              "id": "20f93ac9-3113-4ae1-bd2b-83135904cc4c",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "32b882e0-8635-4210-8871-7d84880cea6b": {
              "id": "32b882e0-8635-4210-8871-7d84880cea6b",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "3304452f-534f-4f7d-81fc-bf089fcda2f8": {
              "id": "3304452f-534f-4f7d-81fc-bf089fcda2f8",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "49323b4c-33b7-49da-ae97-5a88841d09b5": {
              "id": "49323b4c-33b7-49da-ae97-5a88841d09b5",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "4d31d44b-111b-4c77-9ca2-953442e32dc0": {
              "id": "4d31d44b-111b-4c77-9ca2-953442e32dc0",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "5af00435-885d-45a8-8529-48c437d8f823": {
              "id": "5af00435-885d-45a8-8529-48c437d8f823",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "6410a6a6-11e7-4888-a17e-15be2eaa2ccf": {
              "id": "6410a6a6-11e7-4888-a17e-15be2eaa2ccf",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "6e6edb3d-28e5-4209-9a50-b0fe30066988": {
              "id": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
              "parentNodeId": ""
            },
            "72df78cb-6afb-4210-b0a9-df6b348e9d6d": {
              "id": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
              "parentNodeId": ""
            },
            "753c028b-b0af-4021-b126-0313d715f82f": {
              "id": "753c028b-b0af-4021-b126-0313d715f82f",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "77ba104e-e328-4c3a-8946-0a9ffa29941f": {
              "id": "77ba104e-e328-4c3a-8946-0a9ffa29941f",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "77fd9a33-e724-40c7-bb24-41f8b2c90800": {
              "id": "77fd9a33-e724-40c7-bb24-41f8b2c90800",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "808d1ed0-791e-4c0f-a4fb-c8ff35560d07": {
              "id": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8": {
              "id": "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "8cf8272a-8d39-4396-a3ac-7b258904ddbf": {
              "id": "8cf8272a-8d39-4396-a3ac-7b258904ddbf",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "8d0e3208-c1be-42a4-a8bb-12e7204688f1": {
              "id": "8d0e3208-c1be-42a4-a8bb-12e7204688f1",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "8fb69bee-42ce-4260-8026-333a73099d41": {
              "id": "8fb69bee-42ce-4260-8026-333a73099d41",
              "parentNodeId": ""
            },
            "933e73cb-4ba2-4f60-81ef-d97a6c37d595": {
              "id": "933e73cb-4ba2-4f60-81ef-d97a6c37d595",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "9852c584-f70f-41fb-99d6-8a1d3094faf9": {
              "id": "9852c584-f70f-41fb-99d6-8a1d3094faf9",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "997ad925-c30d-47a1-92fc-db328a6c1960": {
              "id": "997ad925-c30d-47a1-92fc-db328a6c1960",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "9dce384b-542b-409b-a759-4e5d3072fb23": {
              "id": "9dce384b-542b-409b-a759-4e5d3072fb23",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e": {
              "id": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68": {
              "id": "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9": {
              "id": "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "bd0d9e99-99ef-4458-87d7-707db8add052": {
              "id": "bd0d9e99-99ef-4458-87d7-707db8add052",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "be6bc2fd-6d87-496a-a571-83d6363aa356": {
              "id": "be6bc2fd-6d87-496a-a571-83d6363aa356",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "c0516d76-1523-4583-a8aa-41a1e15227d2": {
              "id": "c0516d76-1523-4583-a8aa-41a1e15227d2",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "cba1ab8a-fae0-42ac-9d50-13a9acaba93e": {
              "id": "cba1ab8a-fae0-42ac-9d50-13a9acaba93e",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            },
            "eb0b4792-9a47-42e2-ae42-57dabe017e79": {
              "id": "eb0b4792-9a47-42e2-ae42-57dabe017e79",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "f665ba31-ff37-44b4-90ab-730240e39ecf": {
              "id": "f665ba31-ff37-44b4-90ab-730240e39ecf",
              "parentNodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07"
            },
            "f89450a9-9f6f-4643-8d6a-934f73f778d6": {
              "id": "f89450a9-9f6f-4643-8d6a-934f73f778d6",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "fab3f75d-17d8-46b4-bed5-a55a043813d3": {
              "id": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
              "parentNodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988"
            },
            "fc3336ae-c3d0-493a-baf8-02198d1a9920": {
              "id": "fc3336ae-c3d0-493a-baf8-02198d1a9920",
              "parentNodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e"
            }
          }
        },
        "steps": {
          "098a8387-cab9-4826-a892-8529f5c285a6": {
            "nodeId": "098a8387-cab9-4826-a892-8529f5c285a6",
            "name": "Incident Details",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}\n\n_Description: {[8fb69bee-42ce-4260-8026-333a73099d41].[name]}}_\nLink: {{[8fb69bee-42ce-4260-8026-333a73099d41].[link]}}\n\n*Users*\n{{#each [8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}\n{{name}}\n{{/each}}\n\n*WhoIs Results*\n{{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[address]}}\nCountry: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nAbuse Email: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[org_abuse_email]}}\nNet Range: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}\nLast Updated: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[update]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0c22c8a6-a7f4-4cee-a642-2216bea43ad0": {
            "nodeId": "0c22c8a6-a7f4-4cee-a642-2216bea43ad0",
            "name": "Disable Compromised User",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.6/icon.png"
            },
            "identifier": "disable_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "distinguished_name": "{{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[distinguishedName]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "distinguished_name": {
                  "description": "The distinguished name of the user to disable e.g. CN=user,OU=domain_users,DC=mydomain,DC=com",
                  "order": 1,
                  "title": "Distinguished Name",
                  "type": "string"
                }
              },
              "required": [
                "distinguished_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Operation status",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0dc88065-7043-4f29-9973-925bdcbf6fdc": {
            "nodeId": "0dc88065-7043-4f29-9973-925bdcbf6fdc",
            "name": "Office Location",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Country"
                },
                "op": "=",
                "right": {
                  "name": "fab3f75d-17d8-46b4-bed5-a55a043813d3.country",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Country' = {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "City": {
                        "type": "string"
                      },
                      "Country": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "195ad8ca-708c-479d-8a1f-57b33ce9789d": {
            "nodeId": "195ad8ca-708c-479d-8a1f-57b33ce9789d",
            "name": "UserResponse",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "{{[098a8387-cab9-4826-a892-8529f5c285a6].[content]}}",
              "messageType": "button",
              "options": [
                {
                  "answer": "OOO",
                  "buttonStyle": "default",
                  "confirmation": "Alert Dismissed",
                  "edgeId": "197293ac-543f-4078-a8b2-1df3db43ba99",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Disable User",
                  "buttonStyle": "danger",
                  "confirmation": "True Incident",
                  "edgeId": "2fea76a7-c267-40a0-8435-7f2570d069f1",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "timeout",
                  "buttonStyle": null,
                  "confirmation": null,
                  "edgeId": "83bdaf7e-6a6f-4a63-b456-7488412a51a0",
                  "isTimeoutOnly": true
                }
              ],
              "question": "How would you like to respond?",
              "recipient": "#slack-secops",
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "83bdaf7e-6a6f-4a63-b456-7488412a51a0"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "20f93ac9-3113-4ae1-bd2b-83135904cc4c": {
            "nodeId": "20f93ac9-3113-4ae1-bd2b-83135904cc4c",
            "name": "Query",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.6/icon.png"
            },
            "identifier": "query",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "search_base": "{{[f665ba31-ff37-44b4-90ab-730240e39ecf].[search_base]}}",
                "search_filter": "(distinguishedName={{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[distinguishedName]}})"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "search_base": {
                  "description": "The base of the search request",
                  "order": 2,
                  "title": "Search Base",
                  "type": "string"
                },
                "search_filter": {
                  "description": "The filter of the search request. It must conform to the LDAP filter syntax specified in RFC4515. Example: (accountName=joesmith)",
                  "order": 1,
                  "title": "Search Filter",
                  "type": "string"
                }
              },
              "required": [
                "search_base",
                "search_filter"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "result": {
                  "properties": {
                    "attributes": {
                      "order": 1,
                      "title": "Attributes",
                      "type": "object"
                    },
                    "dn": {
                      "order": 2,
                      "title": "Dn",
                      "type": "string"
                    }
                  },
                  "title": "Result",
                  "type": "object"
                }
              },
              "properties": {
                "results": {
                  "description": "Results returned",
                  "items": {
                    "$ref": "#/definitions/result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "32b882e0-8635-4210-8871-7d84880cea6b": {
            "nodeId": "32b882e0-8635-4210-8871-7d84880cea6b",
            "name": "Security Notification",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": " {{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[name]}}'s account was disabled for irregular activity confirmed by the user {{[be6bc2fd-6d87-496a-a571-83d6363aa356].[responding_user]}} in slack. \n\nTo view further, access the ticket: {{[f89450a9-9f6f-4643-8d6a-934f73f778d6].[issue].[url]}}",
                "recipient": "#slack-secops",
                "thread_ts": "{{[be6bc2fd-6d87-496a-a571-83d6363aa356].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "3304452f-534f-4f7d-81fc-bf089fcda2f8": {
            "nodeId": "3304452f-534f-4f7d-81fc-bf089fcda2f8",
            "name": "Disable User",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.6/icon.png"
            },
            "identifier": "disable_user",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "distinguished_name": "{{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[distinguishedName]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "distinguished_name": {
                  "description": "The distinguished name of the user to disable e.g. CN=user,OU=domain_users,DC=mydomain,DC=com",
                  "order": 1,
                  "title": "Distinguished Name",
                  "type": "string"
                }
              },
              "required": [
                "distinguished_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Operation status",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "49323b4c-33b7-49da-ae97-5a88841d09b5": {
            "nodeId": "49323b4c-33b7-49da-ae97-5a88841d09b5",
            "name": "City Found",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "City"
                },
                "op": "=",
                "right": {
                  "name": "fab3f75d-17d8-46b4-bed5-a55a043813d3.city",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'City' = {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "City": {
                        "type": "string"
                      },
                      "Country": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "4d31d44b-111b-4c77-9ca2-953442e32dc0": {
            "nodeId": "4d31d44b-111b-4c77-9ca2-953442e32dc0",
            "name": "Suspicious User Login Incident",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}\n\n_Description: {[8fb69bee-42ce-4260-8026-333a73099d41].[name]}}_\nLink: {{[8fb69bee-42ce-4260-8026-333a73099d41].[link]}}\n____\n### Users:\n{{#each [8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}\n{{name}}\n{{/each}}\n\nWhoIs Results: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[address]}}\n\nCountry {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nAbuse Email: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[org_abuse_email]}}\nNet Range: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}\nLast Updated: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[update]}}\n\n\n## User Response\nUser confirmed if they are traveling: {{[195ad8ca-708c-479d-8a1f-57b33ce9789d].[path]}}\nUser Disabled in Active Directory: {{[0c22c8a6-a7f4-4cee-a642-2216bea43ad0].[success]}}\nTicket Logged: {{[c0516d76-1523-4583-a8aa-41a1e15227d2].[issue].[url]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5af00435-885d-45a8-8529-48c437d8f823": {
            "nodeId": "5af00435-885d-45a8-8529-48c437d8f823",
            "name": "User Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "4ca17161-3029-4ebb-94f8-6baaeb09e3a8",
              "stepControlParams": [
                {
                  "edgeId": "4ca17161-3029-4ebb-94f8-6baaeb09e3a8",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "664ea750-bed3-4621-82d8-49743590a8d5",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "fc3336ae-c3d0-493a-baf8-02198d1a9920.results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[fc3336ae-c3d0-493a-baf8-02198d1a9920].[results]}})>0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "6410a6a6-11e7-4888-a17e-15be2eaa2ccf": {
            "nodeId": "6410a6a6-11e7-4888-a17e-15be2eaa2ccf",
            "name": "DN Exist",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b6cd2a2b-801f-4b45-bf33-91c0d1410894",
              "stepControlParams": [
                {
                  "edgeId": "66c7ebdd-7e1d-40a5-a87f-92391132a7f0",
                  "expression": {
                    "left": {
                      "name": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e.$item.distinguishedName",
                      "type": "variable"
                    },
                    "op": "!=",
                    "right": {
                      "type": "literal",
                      "value": ""
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[distinguishedName]}} != \"\""
                },
                {
                  "edgeId": "b6cd2a2b-801f-4b45-bf33-91c0d1410894",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "6e6edb3d-28e5-4209-9a50-b0fe30066988": {
            "nodeId": "6e6edb3d-28e5-4209-9a50-b0fe30066988",
            "name": "IP Lookp",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "306976aa-b477-4b28-a77b-0ac8d22dacfc",
              "nextEdgeId": "348be0f1-7cd6-42aa-8d26-fd29d3ac49b6",
              "repeatVariable": "{{[72df78cb-6afb-4210-b0a9-df6b348e9d6d].[IP]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "72df78cb-6afb-4210-b0a9-df6b348e9d6d": {
            "nodeId": "72df78cb-6afb-4210-b0a9-df6b348e9d6d",
            "name": "IPExtraction",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "{{IP:/\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "IP",
                    "regex": "\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[8fb69bee-42ce-4260-8026-333a73099d41].[description]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "753c028b-b0af-4021-b126-0313d715f82f": {
            "nodeId": "753c028b-b0af-4021-b126-0313d715f82f",
            "name": "Office Location Exists",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "29879a1b-bc83-4190-b488-9544a1049662",
              "stepControlParams": [
                {
                  "edgeId": "29879a1b-bc83-4190-b488-9544a1049662",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "b1bdb314-5265-4909-b6a1-029c4eb460c1",
                  "expression": {
                    "left": {
                      "name": "0dc88065-7043-4f29-9973-925bdcbf6fdc.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[0dc88065-7043-4f29-9973-925bdcbf6fdc].[found]}}=true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "77ba104e-e328-4c3a-8946-0a9ffa29941f": {
            "nodeId": "77ba104e-e328-4c3a-8946-0a9ffa29941f",
            "name": "Update Ticket",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "comment_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "{{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[name]}} Disabled at {{[997ad925-c30d-47a1-92fc-db328a6c1960].[epoch_timestamp]}}",
                "id": "{{[f89450a9-9f6f-4643-8d6a-934f73f778d6].[issue].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to add",
                  "order": 2,
                  "title": "Comment",
                  "type": "string"
                },
                "id": {
                  "description": "Issue ID",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "comment"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "comment_id": {
                  "description": "Comment ID",
                  "order": 1,
                  "title": "Comment ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "77fd9a33-e724-40c7-bb24-41f8b2c90800": {
            "nodeId": "77fd9a33-e724-40c7-bb24-41f8b2c90800",
            "name": "CurrentTime",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.0.4/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output. Example: %H:%M:%S or %d/%m/%Y",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "808d1ed0-791e-4c0f-a4fb-c8ff35560d07": {
            "nodeId": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07",
            "name": "Users Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "c0ed3ec0-139c-4a63-bb29-50853bbd6dfa",
              "nextEdgeId": "2abeabda-6441-4032-a410-a17fcbc10458",
              "repeatVariable": "{{[8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8": {
            "nodeId": "81b3b215-e641-4bc1-83bf-2a1a8ab6d4e8",
            "name": "Ticket Transition",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "transition_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "User confirmed : {{[195ad8ca-708c-479d-8a1f-57b33ce9789d].[path]}}",
                "fields": {},
                "id": "{{[c0516d76-1523-4583-a8aa-41a1e15227d2].[issue].[id]}}",
                "transition": "Done"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to add",
                  "order": 3,
                  "title": "Comment",
                  "type": "string"
                },
                "fields": {
                  "description": "Custom fields to assign. Fields used must be present on the screen used for project, issue, and transition type e.g: { \"field1\": { \"attribute1\": \"value1\" }, \"field2\": { \"attribute2\": \"value2\" }}",
                  "order": 4,
                  "title": "Fields",
                  "type": "object"
                },
                "id": {
                  "description": "Issue ID",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "transition": {
                  "description": "ID or name of transition to perform, e.g. In Progress",
                  "order": 2,
                  "title": "Transition",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "transition"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "True if successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "8cf8272a-8d39-4396-a3ac-7b258904ddbf": {
            "nodeId": "8cf8272a-8d39-4396-a3ac-7b258904ddbf",
            "name": "SearchBase",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{search_base:/dc=.*/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "search_base",
                    "regex": "dc=.*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[distinguishedName]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "8d0e3208-c1be-42a4-a8bb-12e7204688f1": {
            "nodeId": "8d0e3208-c1be-42a4-a8bb-12e7204688f1",
            "name": "InsightIDR Suspicious User Incident",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}\n\n_Description: {[8fb69bee-42ce-4260-8026-333a73099d41].[name]}}_\nLink: {{[8fb69bee-42ce-4260-8026-333a73099d41].[link]}}\n____\n### Users:\n{{#each [8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}\n{{name}}\n{{/each}}\n\nWhoIs Results: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[address]}}\n\nCountry {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nAbuse Email: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[org_abuse_email]}}\nNet Range: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}\nLast Updated: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[update]}}\n\n\n## User Response\nUser confirmed if they are traveling: {{[be6bc2fd-6d87-496a-a571-83d6363aa356].[path]}}\nUser Disabled in Active Directory: {{[3304452f-534f-4f7d-81fc-bf089fcda2f8].[success]}}\nTicket Logged: {{[f89450a9-9f6f-4643-8d6a-934f73f778d6].[issue].[url]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8fb69bee-42ce-4260-8026-333a73099d41": {
            "nodeId": "8fb69bee-42ce-4260-8026-333a73099d41",
            "name": "InsightIDR Alert",
            "description": "InsightIDR alert around user logging in from new location. ",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "38a7a7f3-596c-4306-a559-4cdf7c320354",
            "defaultInputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "actor": {
                  "properties": {
                    "assets": {
                      "description": "The assets that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/asset"
                      },
                      "order": 2,
                      "title": "Assets",
                      "type": "array"
                    },
                    "users": {
                      "description": "The users that are part of the investigation",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 1,
                      "title": "Users",
                      "type": "array"
                    }
                  },
                  "title": "Actor",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "assetId": {
                      "description": "the ID of the asset",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "fqdn": {
                      "description": "The fully qualified domain name",
                      "order": 3,
                      "title": "Fqdn",
                      "type": "string"
                    },
                    "shortname": {
                      "description": "shortname of the asset",
                      "order": 2,
                      "title": "Shortname",
                      "type": "string"
                    }
                  },
                  "required": [
                    "shortname",
                    "assetId"
                  ],
                  "title": "Asset",
                  "type": "object"
                },
                "content": {
                  "properties": {
                    "domains": {
                      "description": "A list of domains to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "Domains",
                      "type": "array"
                    },
                    "ipAddresses": {
                      "description": "A list of ip addresses to check",
                      "items": {
                        "$ref": "#/definitions/ipAddress"
                      },
                      "order": 3,
                      "title": "IpAddresses",
                      "type": "array"
                    },
                    "processes": {
                      "description": "A list of processes to check",
                      "items": {
                        "$ref": "#/definitions/process"
                      },
                      "order": 4,
                      "title": "Processes",
                      "type": "array"
                    },
                    "urls": {
                      "description": "A list of URLs to check",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Urls",
                      "type": "array"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                },
                "hash": {
                  "properties": {
                    "hash": {
                      "description": "The actual hash",
                      "order": 1,
                      "title": "Hash",
                      "type": "string"
                    },
                    "type": {
                      "description": "The algorithm used to generate the hash",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "hash",
                    "type"
                  ],
                  "title": "Hash",
                  "type": "object"
                },
                "ipAddress": {
                  "properties": {
                    "ip": {
                      "description": "The raw IP",
                      "order": 1,
                      "title": "Ip",
                      "type": "string"
                    },
                    "type": {
                      "description": "Denotes if an IP is internal or external",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "required": [
                    "ip",
                    "type"
                  ],
                  "title": "IpAddress",
                  "type": "object"
                },
                "process": {
                  "properties": {
                    "assetId": {
                      "description": "The asset id associated with the process",
                      "order": 1,
                      "title": "AssetId",
                      "type": "string"
                    },
                    "cmdLine": {
                      "description": "The raw value of the command line call used to invoke the process",
                      "order": 5,
                      "title": "CmdLine",
                      "type": "string"
                    },
                    "hashes": {
                      "description": "The list of hashes to check",
                      "items": {
                        "$ref": "#/definitions/hash"
                      },
                      "order": 3,
                      "title": "Hashes",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the process",
                      "order": 4,
                      "title": "Name",
                      "type": "string"
                    },
                    "processId": {
                      "description": "The PID from the running process on the asset",
                      "order": 2,
                      "title": "ProcessId",
                      "type": "integer"
                    }
                  },
                  "required": [
                    "assetId",
                    "processId"
                  ],
                  "title": "Process",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "distinguishedName": {
                      "description": "The Active Directory distinguished name of the user",
                      "order": 2,
                      "title": "DistinguishedName",
                      "type": "string"
                    },
                    "emails": {
                      "description": "The email addresses associated with the user",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Emails",
                      "type": "array"
                    },
                    "name": {
                      "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "required": [
                    "name",
                    "emails"
                  ],
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "actors": {
                  "$ref": "#/definitions/actor",
                  "description": "The insightIDR actors that are part of the investigation",
                  "order": 7,
                  "title": "Actors"
                },
                "contents": {
                  "$ref": "#/definitions/content",
                  "description": "The contents to enrich",
                  "order": 8,
                  "title": "Contents"
                },
                "description": {
                  "description": "The description of the alert",
                  "order": 4,
                  "title": "Description",
                  "type": "string"
                },
                "investigationId": {
                  "description": "The investigation id",
                  "order": 6,
                  "title": "InvestigationId",
                  "type": "string"
                },
                "link": {
                  "description": "The deep link to the investigation in insightIDR",
                  "order": 5,
                  "title": "Link",
                  "type": "string"
                },
                "name": {
                  "description": "The human-readable name of the alert",
                  "order": 3,
                  "title": "Name",
                  "type": "string"
                },
                "timestamp": {
                  "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
                  "order": 1,
                  "title": "Timestamp",
                  "type": "string"
                },
                "type": {
                  "description": "The type of alert",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "investigationId",
                "actors",
                "timestamp",
                "type",
                "name",
                "description",
                "link"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-idr.svg",
            "connectionType": "NONE"
          },
          "933e73cb-4ba2-4f60-81ef-d97a6c37d595": {
            "nodeId": "933e73cb-4ba2-4f60-81ef-d97a6c37d595",
            "name": "City Exists",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e9bc9ccf-e25f-4e31-a447-2ebea36bb1dd",
              "stepControlParams": [
                {
                  "edgeId": "a7201637-8ce4-4be9-8329-c2a14f5e6400",
                  "expression": {
                    "left": {
                      "name": "49323b4c-33b7-49da-ae97-5a88841d09b5.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[49323b4c-33b7-49da-ae97-5a88841d09b5].[found]}}=true"
                },
                {
                  "edgeId": "e9bc9ccf-e25f-4e31-a447-2ebea36bb1dd",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9852c584-f70f-41fb-99d6-8a1d3094faf9": {
            "nodeId": "9852c584-f70f-41fb-99d6-8a1d3094faf9",
            "name": "Suspicious User Alert",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}\n\n_Description: {[8fb69bee-42ce-4260-8026-333a73099d41].[name]}}_\nLink: {{[8fb69bee-42ce-4260-8026-333a73099d41].[link]}}\n____\n### Users:\n{{#each [8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}\n{{name}}\n{{/each}}\n\nWhoIs Results: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[address]}}\n\nCountry {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nAbuse Email: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[org_abuse_email]}}\nNet Range: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}\nLast Updated: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[update]}}\n\n## User Response\nUser confirmed if they are traveling: {{[195ad8ca-708c-479d-8a1f-57b33ce9789d].[path]}}\nTicket Logged: {{[c0516d76-1523-4583-a8aa-41a1e15227d2].[issue].[url]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "997ad925-c30d-47a1-92fc-db328a6c1960": {
            "nodeId": "997ad925-c30d-47a1-92fc-db328a6c1960",
            "name": "Get Current Time",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.0.4/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output. Example: %H:%M:%S or %d/%m/%Y",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "9dce384b-542b-409b-a759-4e5d3072fb23": {
            "nodeId": "9dce384b-542b-409b-a759-4e5d3072fb23",
            "name": "Notify SecOps",
            "type": "action_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": " {{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[name]}}'s account was disabled for irregular activity confirmed by the user {{[195ad8ca-708c-479d-8a1f-57b33ce9789d].[responding_user]}} in slack. \n\nTo view further, access the ticket: {{[c0516d76-1523-4583-a8aa-41a1e15227d2].[issue].[url]}}",
                "recipient": "#slack-secops",
                "thread_ts": "{{[195ad8ca-708c-479d-8a1f-57b33ce9789d].[timestamp]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e": {
            "nodeId": "a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e",
            "name": "UsersLoop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "innerEdgeId": "89cc7969-f2f4-4aeb-bb52-aadadd35b578",
              "nextEdgeId": "ac0638df-84d9-4a85-8923-0b7aaafbdb6e",
              "repeatVariable": "{{[8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68": {
            "nodeId": "b531d0a8-9e83-451c-9ad2-1c0f7cb66c68",
            "name": "Suspicious User Login Alert",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}\n\n_Description: {[8fb69bee-42ce-4260-8026-333a73099d41].[name]}}_\nLink: {{[8fb69bee-42ce-4260-8026-333a73099d41].[link]}}\n___\n### Users:\n{{#each [8fb69bee-42ce-4260-8026-333a73099d41].[actors].[users]}}\n{{name}}\n{{/each}}\n\nWhoIs Results: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[address]}}\n\nCountry {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[country]}}\nAbuse Email: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[org_abuse_email]}}\nNet Range: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[netrange]}}\nLast Updated: {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[update]}}\n\n## User Response\n\nConfirmed the user is traveling: {{[be6bc2fd-6d87-496a-a571-83d6363aa356].[path]}}\nTicket Logged: {{[f89450a9-9f6f-4643-8d6a-934f73f778d6].[issue].[url]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9": {
            "nodeId": "b63bfa71-0266-4f1d-aa84-fb59e3acb8f9",
            "name": "Found in AD",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "6fc84ee1-b077-4bf8-a224-0183d07d16cb",
              "stepControlParams": [
                {
                  "edgeId": "6fc84ee1-b077-4bf8-a224-0183d07d16cb",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "b83f2871-ff96-423b-867b-94ffe38e6626",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "20f93ac9-3113-4ae1-bd2b-83135904cc4c.results",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[20f93ac9-3113-4ae1-bd2b-83135904cc4c].[results]}})>0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "bd0d9e99-99ef-4458-87d7-707db8add052": {
            "nodeId": "bd0d9e99-99ef-4458-87d7-707db8add052",
            "name": "Transition Ticket",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "transition_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "User confirmed they are currently traveling",
                "fields": {},
                "id": "{{[f89450a9-9f6f-4643-8d6a-934f73f778d6].[issue].[id]}}",
                "transition": "Done"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to add",
                  "order": 3,
                  "title": "Comment",
                  "type": "string"
                },
                "fields": {
                  "description": "Custom fields to assign. Fields used must be present on the screen used for project, issue, and transition type e.g: { \"field1\": { \"attribute1\": \"value1\" }, \"field2\": { \"attribute2\": \"value2\" }}",
                  "order": 4,
                  "title": "Fields",
                  "type": "object"
                },
                "id": {
                  "description": "Issue ID",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "transition": {
                  "description": "ID or name of transition to perform, e.g. In Progress",
                  "order": 2,
                  "title": "Transition",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "transition"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "True if successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "be6bc2fd-6d87-496a-a571-83d6363aa356": {
            "nodeId": "be6bc2fd-6d87-496a-a571-83d6363aa356",
            "name": "User Reponse",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "{{[098a8387-cab9-4826-a892-8529f5c285a6].[content]}}",
              "messageType": "button",
              "options": [
                {
                  "answer": "OOO",
                  "buttonStyle": "default",
                  "confirmation": "Thank you for your response",
                  "edgeId": "d6ae3aab-fd07-4b6a-aeab-1dfc9a785c63",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Disable User",
                  "buttonStyle": "danger",
                  "confirmation": "Ok we'll be escalating this to security. ",
                  "edgeId": "5957c0a4-4eaa-4429-954d-b98cce51345c",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "timout",
                  "buttonStyle": null,
                  "confirmation": null,
                  "edgeId": "7a985d15-8ade-4a6d-9118-eab371af8d08",
                  "isTimeoutOnly": true
                }
              ],
              "question": "How would you like to respond",
              "recipient": "#slack-secops",
              "timeout": 600,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "7a985d15-8ade-4a6d-9118-eab371af8d08"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "c0516d76-1523-4583-a8aa-41a1e15227d2": {
            "nodeId": "c0516d76-1523-4583-a8aa-41a1e15227d2",
            "name": "IDR Incident Jira",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "create_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment_bytes": "",
                "attachment_filename": "",
                "description": "{{[098a8387-cab9-4826-a892-8529f5c285a6].[content]}}\n\nOffice in {{[fab3f75d-17d8-46b4-bed5-a55a043813d3].[city]}}: {{[49323b4c-33b7-49da-ae97-5a88841d09b5].[found]}}\n",
                "fields": {},
                "project": "SPLUN",
                "summary": "InnsightIDR: {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}",
                "type": "Story"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachment_bytes": {
                  "description": "Attachment bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 6,
                  "title": "Attachment bytes",
                  "type": "string"
                },
                "attachment_filename": {
                  "description": "Attachment filename",
                  "order": 7,
                  "title": "Attachment filename",
                  "type": "string"
                },
                "description": {
                  "default": "",
                  "description": "Issue description",
                  "order": 3,
                  "title": "Description",
                  "type": "string"
                },
                "fields": {
                  "description": "Custom fields to assign. Fields used must be present on the same screen as the Create screen in Jira",
                  "order": 5,
                  "title": "Fields",
                  "type": "object"
                },
                "project": {
                  "description": "Project name. If not provided, uses default from connection",
                  "order": 4,
                  "title": "Project",
                  "type": "string"
                },
                "summary": {
                  "description": "Issue summary",
                  "order": 1,
                  "title": "Summary",
                  "type": "string"
                },
                "type": {
                  "default": "Task",
                  "description": "Issue type. Typical issues type include Task, Story, Epic, Bug. You can also specify a custom issue type. This input is case-sensitive",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "description"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "issue": {
                  "properties": {
                    "assignee": {
                      "description": "Assigned User",
                      "order": 11,
                      "title": "Assignee",
                      "type": "string"
                    },
                    "attachments": {
                      "description": "Attachments",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 15,
                      "title": "Attachments",
                      "type": "array"
                    },
                    "created_at": {
                      "description": "Created At",
                      "order": 12,
                      "title": "Created At",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description",
                      "order": 7,
                      "title": "Description",
                      "type": "string"
                    },
                    "fields": {
                      "description": "Full list of fields",
                      "order": 16,
                      "title": "Fields",
                      "type": "object"
                    },
                    "id": {
                      "description": "Issue ID",
                      "order": 1,
                      "title": "Id",
                      "type": "string"
                    },
                    "key": {
                      "description": "Issue Key",
                      "order": 3,
                      "title": "Key",
                      "type": "string"
                    },
                    "labels": {
                      "description": "Labels",
                      "items": {
                        "type": "string"
                      },
                      "order": 9,
                      "title": "Labels",
                      "type": "array"
                    },
                    "project": {
                      "description": "Project",
                      "order": 2,
                      "title": "Project",
                      "type": "string"
                    },
                    "reporter": {
                      "description": "Reporting User",
                      "order": 10,
                      "title": "Reporter",
                      "type": "string"
                    },
                    "resolution": {
                      "description": "Resolution",
                      "order": 8,
                      "title": "Resolution",
                      "type": "string"
                    },
                    "resolved_at": {
                      "description": "Resolved At",
                      "order": 14,
                      "title": "Resolved At",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status",
                      "order": 4,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary": {
                      "description": "Summary",
                      "order": 6,
                      "title": "Summary",
                      "type": "string"
                    },
                    "updated_at": {
                      "description": "Updated At",
                      "order": 13,
                      "title": "Updated At",
                      "type": "string"
                    },
                    "url": {
                      "description": "Issue URL",
                      "order": 5,
                      "title": "Url",
                      "type": "string"
                    }
                  },
                  "title": "Issue",
                  "type": "object"
                }
              },
              "properties": {
                "issue": {
                  "$ref": "#/definitions/issue",
                  "description": "Created issue",
                  "order": 1,
                  "title": "Issue"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "cba1ab8a-fae0-42ac-9d50-13a9acaba93e": {
            "nodeId": "cba1ab8a-fae0-42ac-9d50-13a9acaba93e",
            "name": "UpdateTicket",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "comment_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "{{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[name]}} was disabled {{[77fd9a33-e724-40c7-bb24-41f8b2c90800].[epoch_timestamp]}}.",
                "id": "{{[c0516d76-1523-4583-a8aa-41a1e15227d2].[issue].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to add",
                  "order": 2,
                  "title": "Comment",
                  "type": "string"
                },
                "id": {
                  "description": "Issue ID",
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "comment"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "comment_id": {
                  "description": "Comment ID",
                  "order": 1,
                  "title": "Comment ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "eb0b4792-9a47-42e2-ae42-57dabe017e79": {
            "nodeId": "eb0b4792-9a47-42e2-ae42-57dabe017e79",
            "name": "DN Exists",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ef9890f4-46d0-417c-894c-a8a2abee9065",
              "stepControlParams": [
                {
                  "edgeId": "9e592ac3-cd35-480c-9960-da2823e216fe",
                  "expression": {
                    "left": {
                      "name": "808d1ed0-791e-4c0f-a4fb-c8ff35560d07.$item.distinguishedName",
                      "type": "variable"
                    },
                    "op": "!=",
                    "right": {
                      "type": "literal",
                      "value": ""
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[distinguishedName]}} != \"\""
                },
                {
                  "edgeId": "ef9890f4-46d0-417c-894c-a8a2abee9065",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f665ba31-ff37-44b4-90ab-730240e39ecf": {
            "nodeId": "f665ba31-ff37-44b4-90ab-730240e39ecf",
            "name": "Match Search Base",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{search_base:/dc=.*/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "search_base",
                    "regex": "dc=.*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[808d1ed0-791e-4c0f-a4fb-c8ff35560d07].[$item].[distinguishedName]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "f89450a9-9f6f-4643-8d6a-934f73f778d6": {
            "nodeId": "f89450a9-9f6f-4643-8d6a-934f73f778d6",
            "name": "InsightIDR Incident Ticket",
            "type": "action",
            "plugin": {
              "name": "Jira",
              "slugVendor": "rapid7",
              "slugName": "jira",
              "slugVersion": "3.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/jira/3.2.1/icon.png"
            },
            "identifier": "create_issue",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment_bytes": "",
                "attachment_filename": "",
                "description": "{{[098a8387-cab9-4826-a892-8529f5c285a6].[content]}}\nOffice in Country: {{[0dc88065-7043-4f29-9973-925bdcbf6fdc].[found]}}\n",
                "fields": {},
                "project": "SPLUN",
                "summary": "InsightIDR - {{[8fb69bee-42ce-4260-8026-333a73099d41].[type]}}",
                "type": "Story"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachment_bytes": {
                  "description": "Attachment bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 6,
                  "title": "Attachment bytes",
                  "type": "string"
                },
                "attachment_filename": {
                  "description": "Attachment filename",
                  "order": 7,
                  "title": "Attachment filename",
                  "type": "string"
                },
                "description": {
                  "default": "",
                  "description": "Issue description",
                  "order": 3,
                  "title": "Description",
                  "type": "string"
                },
                "fields": {
                  "description": "Custom fields to assign. Fields used must be present on the same screen as the Create screen in Jira",
                  "order": 5,
                  "title": "Fields",
                  "type": "object"
                },
                "project": {
                  "description": "Project name. If not provided, uses default from connection",
                  "order": 4,
                  "title": "Project",
                  "type": "string"
                },
                "summary": {
                  "description": "Issue summary",
                  "order": 1,
                  "title": "Summary",
                  "type": "string"
                },
                "type": {
                  "default": "Task",
                  "description": "Issue type. Typical issues type include Task, Story, Epic, Bug. You can also specify a custom issue type. This input is case-sensitive",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "description"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "issue": {
                  "properties": {
                    "assignee": {
                      "description": "Assigned User",
                      "order": 11,
                      "title": "Assignee",
                      "type": "string"
                    },
                    "attachments": {
                      "description": "Attachments",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 15,
                      "title": "Attachments",
                      "type": "array"
                    },
                    "created_at": {
                      "description": "Created At",
                      "order": 12,
                      "title": "Created At",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description",
                      "order": 7,
                      "title": "Description",
                      "type": "string"
                    },
                    "fields": {
                      "description": "Full list of fields",
                      "order": 16,
                      "title": "Fields",
                      "type": "object"
                    },
                    "id": {
                      "description": "Issue ID",
                      "order": 1,
                      "title": "Id",
                      "type": "string"
                    },
                    "key": {
                      "description": "Issue Key",
                      "order": 3,
                      "title": "Key",
                      "type": "string"
                    },
                    "labels": {
                      "description": "Labels",
                      "items": {
                        "type": "string"
                      },
                      "order": 9,
                      "title": "Labels",
                      "type": "array"
                    },
                    "project": {
                      "description": "Project",
                      "order": 2,
                      "title": "Project",
                      "type": "string"
                    },
                    "reporter": {
                      "description": "Reporting User",
                      "order": 10,
                      "title": "Reporter",
                      "type": "string"
                    },
                    "resolution": {
                      "description": "Resolution",
                      "order": 8,
                      "title": "Resolution",
                      "type": "string"
                    },
                    "resolved_at": {
                      "description": "Resolved At",
                      "order": 14,
                      "title": "Resolved At",
                      "type": "string"
                    },
                    "status": {
                      "description": "Status",
                      "order": 4,
                      "title": "Status",
                      "type": "string"
                    },
                    "summary": {
                      "description": "Summary",
                      "order": 6,
                      "title": "Summary",
                      "type": "string"
                    },
                    "updated_at": {
                      "description": "Updated At",
                      "order": 13,
                      "title": "Updated At",
                      "type": "string"
                    },
                    "url": {
                      "description": "Issue URL",
                      "order": 5,
                      "title": "Url",
                      "type": "string"
                    }
                  },
                  "title": "Issue",
                  "type": "object"
                }
              },
              "properties": {
                "issue": {
                  "$ref": "#/definitions/issue",
                  "description": "Created issue",
                  "order": 1,
                  "title": "Issue"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "fab3f75d-17d8-46b4-bed5-a55a043813d3": {
            "nodeId": "fab3f75d-17d8-46b4-bed5-a55a043813d3",
            "name": "WhoIs Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "1.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/1.0.5/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[6e6edb3d-28e5-4209-9a50-b0fe30066988].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "fc3336ae-c3d0-493a-baf8-02198d1a9920": {
            "nodeId": "fc3336ae-c3d0-493a-baf8-02198d1a9920",
            "name": "Query AD",
            "type": "action",
            "plugin": {
              "name": "Active Directory LDAP",
              "slugVendor": "rapid7",
              "slugName": "active_directory_ldap",
              "slugVersion": "3.2.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/active_directory_ldap/3.2.6/icon.png"
            },
            "identifier": "query",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "search_base": "{{[8cf8272a-8d39-4396-a3ac-7b258904ddbf].[search_base]}}",
                "search_filter": "(distinguishedName={{[a8e0e1a2-d221-4bfc-883d-4ab7e3ca0c7e].[$item].[distinguishedName]}})"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "search_base": {
                  "description": "The base of the search request",
                  "order": 2,
                  "title": "Search Base",
                  "type": "string"
                },
                "search_filter": {
                  "description": "The filter of the search request. It must conform to the LDAP filter syntax specified in RFC4515. Example: (accountName=joesmith)",
                  "order": 1,
                  "title": "Search Filter",
                  "type": "string"
                }
              },
              "required": [
                "search_base",
                "search_filter"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "result": {
                  "properties": {
                    "attributes": {
                      "order": 1,
                      "title": "Attributes",
                      "type": "object"
                    },
                    "dn": {
                      "order": 2,
                      "title": "Dn",
                      "type": "string"
                    }
                  },
                  "title": "Result",
                  "type": "object"
                }
              },
              "properties": {
                "results": {
                  "description": "Results returned",
                  "items": {
                    "$ref": "#/definitions/result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Alerting & Notifications",
          "Atlassian",
          "Microsoft",
          "Rapid7",
          "Slack",
          "Threat Intelligence"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "38a7a7f3-596c-4306-a559-4cdf7c320354",
        "name": "InsightIDR Alert",
        "description": "InsightIDR alert around user logging in from new location. ",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "actor": {
              "properties": {
                "assets": {
                  "description": "The assets that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 2,
                  "title": "Assets",
                  "type": "array"
                },
                "users": {
                  "description": "The users that are part of the investigation",
                  "items": {
                    "$ref": "#/definitions/user"
                  },
                  "order": 1,
                  "title": "Users",
                  "type": "array"
                }
              },
              "title": "Actor",
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetId": {
                  "description": "the ID of the asset",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "fqdn": {
                  "description": "The fully qualified domain name",
                  "order": 3,
                  "title": "Fqdn",
                  "type": "string"
                },
                "shortname": {
                  "description": "shortname of the asset",
                  "order": 2,
                  "title": "Shortname",
                  "type": "string"
                }
              },
              "required": [
                "shortname",
                "assetId"
              ],
              "title": "Asset",
              "type": "object"
            },
            "content": {
              "properties": {
                "domains": {
                  "description": "A list of domains to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Domains",
                  "type": "array"
                },
                "ipAddresses": {
                  "description": "A list of ip addresses to check",
                  "items": {
                    "$ref": "#/definitions/ipAddress"
                  },
                  "order": 3,
                  "title": "IpAddresses",
                  "type": "array"
                },
                "processes": {
                  "description": "A list of processes to check",
                  "items": {
                    "$ref": "#/definitions/process"
                  },
                  "order": 4,
                  "title": "Processes",
                  "type": "array"
                },
                "urls": {
                  "description": "A list of URLs to check",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Urls",
                  "type": "array"
                }
              },
              "title": "Content",
              "type": "object"
            },
            "hash": {
              "properties": {
                "hash": {
                  "description": "The actual hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                },
                "type": {
                  "description": "The algorithm used to generate the hash",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "hash",
                "type"
              ],
              "title": "Hash",
              "type": "object"
            },
            "ipAddress": {
              "properties": {
                "ip": {
                  "description": "The raw IP",
                  "order": 1,
                  "title": "Ip",
                  "type": "string"
                },
                "type": {
                  "description": "Denotes if an IP is internal or external",
                  "order": 2,
                  "title": "Type",
                  "type": "string"
                }
              },
              "required": [
                "ip",
                "type"
              ],
              "title": "IpAddress",
              "type": "object"
            },
            "process": {
              "properties": {
                "assetId": {
                  "description": "The asset id associated with the process",
                  "order": 1,
                  "title": "AssetId",
                  "type": "string"
                },
                "cmdLine": {
                  "description": "The raw value of the command line call used to invoke the process",
                  "order": 5,
                  "title": "CmdLine",
                  "type": "string"
                },
                "hashes": {
                  "description": "The list of hashes to check",
                  "items": {
                    "$ref": "#/definitions/hash"
                  },
                  "order": 3,
                  "title": "Hashes",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the process",
                  "order": 4,
                  "title": "Name",
                  "type": "string"
                },
                "processId": {
                  "description": "The PID from the running process on the asset",
                  "order": 2,
                  "title": "ProcessId",
                  "type": "integer"
                }
              },
              "required": [
                "assetId",
                "processId"
              ],
              "title": "Process",
              "type": "object"
            },
            "user": {
              "properties": {
                "distinguishedName": {
                  "description": "The Active Directory distinguished name of the user",
                  "order": 2,
                  "title": "DistinguishedName",
                  "type": "string"
                },
                "emails": {
                  "description": "The email addresses associated with the user",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Emails",
                  "type": "array"
                },
                "name": {
                  "description": "The name of the user, as '<firstname> <lastname>' if available, or account name otherwise",
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "required": [
                "name",
                "emails"
              ],
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "actors": {
              "$ref": "#/definitions/actor",
              "description": "The insightIDR actors that are part of the investigation",
              "order": 7,
              "title": "Actors"
            },
            "contents": {
              "$ref": "#/definitions/content",
              "description": "The contents to enrich",
              "order": 8,
              "title": "Contents"
            },
            "description": {
              "description": "The description of the alert",
              "order": 4,
              "title": "Description",
              "type": "string"
            },
            "investigationId": {
              "description": "The investigation id",
              "order": 6,
              "title": "InvestigationId",
              "type": "string"
            },
            "link": {
              "description": "The deep link to the investigation in insightIDR",
              "order": 5,
              "title": "Link",
              "type": "string"
            },
            "name": {
              "description": "The human-readable name of the alert",
              "order": 3,
              "title": "Name",
              "type": "string"
            },
            "timestamp": {
              "description": "The time the alert was triggered in ISO 8601 extended timestamp format",
              "order": 1,
              "title": "Timestamp",
              "type": "string"
            },
            "type": {
              "description": "The type of alert",
              "order": 2,
              "title": "Type",
              "type": "string"
            }
          },
          "required": [
            "investigationId",
            "actors",
            "timestamp",
            "type",
            "name",
            "description",
            "link"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_idr"
      }
    ]
  }
}