{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:51:59.12610835Z",
    "workflowVersions": [
      {
        "name": "Lookup Vulnerability with Rapid7 Vulnerability Database",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nLookup a vulnerability to receive an overview, including CVSS score, publish date, alternate identifiers, description, and solutions.\n\nAfter importing the workflow, click the Test button and insert a vulnerability CVE ID or title (eg, Bluekeep). View the Artifact in the Job Details pane for an overview of the vulnerability. \n\n# Key Features\n\n* Lookup vulnerability information\n* Find all vulnerabilities that match a search term\n* Get severity, description, publish date, and solution information\n\n# Requirements\n\n* InsightConnect\n\n# Documentation\n\n## Setup\n\nImport the workflow and proceed through the Import Workflow wizard in InsightConnect. Import plugins and set them to run on the Rapid7 Insight cloud for the fastest results.\n\n## Usage\n\nOpen the workflow draft and click the Test button. Enter a CVE ID or vulnerability title (eg, Bluekeep) and run the workflow. In the resulting Job Details pane, view the Artifact once the workflow completes to see the results.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 Vulnerability & Exploit Database|2.1.0|2|\n|HTML|1.2.2|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.1 - Update Rapid7 Vulnerability & Exploit Database plugin to version 2.1.0\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 Vulnerability Database](https://www.rapid7.com/db)\n",
        "graph": {
          "edges": {
            "237c4ea4-a2ba-41ba-96db-d6b4b8405531": {
              "id": "237c4ea4-a2ba-41ba-96db-d6b4b8405531",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c7eb0fa9-239b-4e63-9eda-12a79546d1c2",
              "toNodeId": ""
            },
            "313aa0d7-1861-4f81-a9b1-0c581e71fbf8": {
              "id": "313aa0d7-1861-4f81-a9b1-0c581e71fbf8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "db207625-b211-4143-81cf-7889759c0a37",
              "toNodeId": "b5bddbce-61b6-4efa-bf83-b0bb77b27f92"
            },
            "4436b12c-47f8-4384-87b3-551608d64aef": {
              "id": "4436b12c-47f8-4384-87b3-551608d64aef",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0ec725f7-35e0-4801-983b-a5ebeaed682c",
              "toNodeId": ""
            },
            "448503bd-3fcd-48f4-a92b-5dd1b4af6bde": {
              "id": "448503bd-3fcd-48f4-a92b-5dd1b4af6bde",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b5bddbce-61b6-4efa-bf83-b0bb77b27f92",
              "toNodeId": "87f62442-6900-4c89-9605-7ae7295d319f"
            },
            "4fbf5c57-6df0-4a95-8d98-2e4d64a16396": {
              "id": "4fbf5c57-6df0-4a95-8d98-2e4d64a16396",
              "name": "Yes",
              "description": "The search term returned relevant vulnerability results.",
              "parentNodeId": "",
              "fromNodeId": "87f62442-6900-4c89-9605-7ae7295d319f",
              "toNodeId": "edc28ac2-d540-465f-8aa2-8ac4db39476f"
            },
            "b38df27c-f4c8-43e5-bb57-ca2da20c03db": {
              "id": "b38df27c-f4c8-43e5-bb57-ca2da20c03db",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "edc28ac2-d540-465f-8aa2-8ac4db39476f",
              "toNodeId": "7958f384-a423-448b-a7a0-2b8d6e4832ab"
            },
            "d1f926f1-ff72-4a18-acdb-0e400c46f2e0": {
              "id": "d1f926f1-ff72-4a18-acdb-0e400c46f2e0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7958f384-a423-448b-a7a0-2b8d6e4832ab",
              "toNodeId": "0ec725f7-35e0-4801-983b-a5ebeaed682c"
            },
            "eac6b99a-d10b-4922-b3cd-a206cd224209": {
              "id": "eac6b99a-d10b-4922-b3cd-a206cd224209",
              "name": "No",
              "description": "The search term did not return relevant vulnerability results.",
              "parentNodeId": "",
              "fromNodeId": "87f62442-6900-4c89-9605-7ae7295d319f",
              "toNodeId": "c7eb0fa9-239b-4e63-9eda-12a79546d1c2"
            }
          },
          "nodes": {
            "0ec725f7-35e0-4801-983b-a5ebeaed682c": {
              "id": "0ec725f7-35e0-4801-983b-a5ebeaed682c",
              "parentNodeId": ""
            },
            "7958f384-a423-448b-a7a0-2b8d6e4832ab": {
              "id": "7958f384-a423-448b-a7a0-2b8d6e4832ab",
              "parentNodeId": ""
            },
            "87f62442-6900-4c89-9605-7ae7295d319f": {
              "id": "87f62442-6900-4c89-9605-7ae7295d319f",
              "parentNodeId": ""
            },
            "b5bddbce-61b6-4efa-bf83-b0bb77b27f92": {
              "id": "b5bddbce-61b6-4efa-bf83-b0bb77b27f92",
              "parentNodeId": ""
            },
            "c7eb0fa9-239b-4e63-9eda-12a79546d1c2": {
              "id": "c7eb0fa9-239b-4e63-9eda-12a79546d1c2",
              "parentNodeId": ""
            },
            "db207625-b211-4143-81cf-7889759c0a37": {
              "id": "db207625-b211-4143-81cf-7889759c0a37",
              "parentNodeId": ""
            },
            "edc28ac2-d540-465f-8aa2-8ac4db39476f": {
              "id": "edc28ac2-d540-465f-8aa2-8ac4db39476f",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "0ec725f7-35e0-4801-983b-a5ebeaed682c": {
            "nodeId": "0ec725f7-35e0-4801-983b-a5ebeaed682c",
            "name": "Vulnerability Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Rapid7 Vulnerability Database\n*Congratulations! You've successfully run a workflow using the Rapid7 Vulnerability Database plugin. The complete database is available online at [https://rapid7.com/db](https://rapid7.com/db).*\n\n## Vulnerability Details\n*You searched for: `{{[db207625-b211-4143-81cf-7889759c0a37].[Search]}}`*\n* Identifier: `{{[b5bddbce-61b6-4efa-bf83-b0bb77b27f92].[search_results].[0].[identifier]}}`\n* Title: `{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[title]}}`\n* Severity: `{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[severity]}}`\n* Published: `{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[published_at]}}`\n* Alternate Identifiers: `{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[alternate_ids]}}`\n\n---\n**Description**\n{{[7958f384-a423-448b-a7a0-2b8d6e4832ab].[text]}}\n___\n**Solutions**\n{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[solutions]}}\n\n*Please note that this workflow simply returns vulnerability details for the first relevant result.*\n\n## Up Next\nHead on back to the **[Discover](#/home?loadDiscover=1)** tab in InsightConnect to try your next workflow!"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "7958f384-a423-448b-a7a0-2b8d6e4832ab": {
            "nodeId": "7958f384-a423-448b-a7a0-2b8d6e4832ab",
            "name": "Strip HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[edc28ac2-d540-465f-8aa2-8ac4db39476f].[content_result].[description]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "87f62442-6900-4c89-9605-7ae7295d319f": {
            "nodeId": "87f62442-6900-4c89-9605-7ae7295d319f",
            "name": "Vulnerability Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "eac6b99a-d10b-4922-b3cd-a206cd224209",
              "stepControlParams": [
                {
                  "edgeId": "4fbf5c57-6df0-4a95-8d98-2e4d64a16396",
                  "expression": {
                    "name": "b5bddbce-61b6-4efa-bf83-b0bb77b27f92.results_found",
                    "type": "variable"
                  },
                  "expressionText": "{{[b5bddbce-61b6-4efa-bf83-b0bb77b27f92].[results_found]}}"
                },
                {
                  "edgeId": "eac6b99a-d10b-4922-b3cd-a206cd224209",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "b5bddbce-61b6-4efa-bf83-b0bb77b27f92": {
            "nodeId": "b5bddbce-61b6-4efa-bf83-b0bb77b27f92",
            "name": "Search Vulnerability Database",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.1.0/icon.png"
            },
            "identifier": "search_db",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "database": "Vulnerability Database",
                "search": "{{[db207625-b211-4143-81cf-7889759c0a37].[Search]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "database": {
                  "description": "Name of the database",
                  "enum": [
                    "Vulnerability Database",
                    "Metasploit Modules"
                  ],
                  "order": 1,
                  "title": "Database",
                  "type": "string"
                },
                "search": {
                  "description": "Search parameter for database",
                  "order": 2,
                  "title": "Search",
                  "type": "string"
                }
              },
              "required": [
                "database",
                "search"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "search_result": {
                  "properties": {
                    "identifier": {
                      "description": "Content identifier for module or vulnerability",
                      "order": 4,
                      "title": "Content Identifier",
                      "type": "string"
                    },
                    "link": {
                      "description": "Link to vulnerability",
                      "order": 2,
                      "title": "Link",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 3,
                      "title": "Published At",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 5,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Search Result",
                  "type": "object"
                }
              },
              "properties": {
                "results_found": {
                  "description": "Will return false if no results are found",
                  "order": 2,
                  "title": "Results Found",
                  "type": "boolean"
                },
                "search_results": {
                  "description": "Vulnerability and exploits found",
                  "items": {
                    "$ref": "#/definitions/search_result"
                  },
                  "order": 1,
                  "title": "Results",
                  "type": "array"
                }
              },
              "required": [
                "results_found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "c7eb0fa9-239b-4e63-9eda-12a79546d1c2": {
            "nodeId": "c7eb0fa9-239b-4e63-9eda-12a79546d1c2",
            "name": "No Matching Vulnerabilities",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "No vulnerabilities in the Rapid7 Vulnerability Database matched your search for `{{[db207625-b211-4143-81cf-7889759c0a37].[Search]}}`."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "db207625-b211-4143-81cf-7889759c0a37": {
            "nodeId": "db207625-b211-4143-81cf-7889759c0a37",
            "name": "Lookup Vulnerability Trigger",
            "type": "trigger",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "46d7c47e-6084-4f0e-aa4f-49ba473533a6",
            "defaultInputJSONSchema": {
              "definitions": {},
              "properties": {
                "Search": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {},
              "properties": {
                "Search": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api.svg",
            "connectionType": "NONE"
          },
          "edc28ac2-d540-465f-8aa2-8ac4db39476f": {
            "nodeId": "edc28ac2-d540-465f-8aa2-8ac4db39476f",
            "name": "Get Vulnerability Content",
            "type": "action",
            "plugin": {
              "name": "Rapid7 Vulnerability & Exploit Database",
              "slugVendor": "rapid7",
              "slugName": "rapid7_vulndb",
              "slugVersion": "2.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_vulndb/2.1.0/icon.png"
            },
            "identifier": "get_content",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "identifier": "{{[b5bddbce-61b6-4efa-bf83-b0bb77b27f92].[search_results].[0].[identifier]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "identifier": {
                  "description": "Rapid7 vulnerability/module identifier",
                  "order": 1,
                  "title": "Identifier",
                  "type": "string"
                }
              },
              "required": [
                "identifier"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "content": {
                  "properties": {
                    "alternate_ids": {
                      "description": "List of alternative identifiers for the vulnerability",
                      "order": 12,
                      "title": "Alternative Identifiers",
                      "type": "string"
                    },
                    "architectures": {
                      "description": "List of applicable architectures for the module",
                      "order": 4,
                      "title": "architectures",
                      "type": "string"
                    },
                    "authors": {
                      "description": "List of module authors",
                      "order": 7,
                      "title": "Authors",
                      "type": "string"
                    },
                    "content_type": {
                      "description": "Type of returned content for module or vulnerability",
                      "order": 3,
                      "title": "Content type",
                      "type": "string"
                    },
                    "description": {
                      "description": "Brief summary of the returned content",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "published_at": {
                      "description": "Published date of vulnerability",
                      "order": 5,
                      "title": "Published_at",
                      "type": "string"
                    },
                    "rank": {
                      "description": "Rank of module",
                      "order": 8,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "references": {
                      "description": "List of references",
                      "order": 6,
                      "title": "References",
                      "type": "string"
                    },
                    "reliability": {
                      "description": "Reliability of module",
                      "order": 9,
                      "title": "Reliability",
                      "type": "string"
                    },
                    "severity": {
                      "description": "Severity of vulnerability",
                      "order": 10,
                      "title": "Severity",
                      "type": "string"
                    },
                    "solutions": {
                      "description": "List of possible solutions for the vulnerability",
                      "order": 11,
                      "title": "Solutions",
                      "type": "string"
                    },
                    "title": {
                      "description": "Title of Vulnerability",
                      "order": 1,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Content",
                  "type": "object"
                }
              },
              "properties": {
                "content_result": {
                  "$ref": "#/definitions/content",
                  "description": "Content record for the vulnerability or module",
                  "order": 1,
                  "title": "Result"
                }
              },
              "required": [
                "content_result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": [
          "Rapid7",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 180,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "46d7c47e-6084-4f0e-aa4f-49ba473533a6",
        "name": "Lookup Vulnerability Trigger",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {},
          "properties": {
            "Search": {
              "type": "string"
            }
          },
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {},
          "properties": {
            "Search": {
              "type": "string"
            }
          },
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api",
        "options": {
          "webhookEnabled": true
        }
      }
    ]
  }
}