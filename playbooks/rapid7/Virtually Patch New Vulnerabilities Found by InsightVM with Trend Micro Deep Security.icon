{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T13:04:25.952757221Z",
    "workflowVersions": [
      {
        "name": "Virtually Patch New Vulnerabilities Found by InsightVM with Trend Micro Deep Security",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nAutomatically protect your assets against exploitation of vulnerabilities found by InsightVM with Trend Micro Deep Security Virtual Patching (IPS).\nThis workflow is seamlessly integrated into InsightVM using the InsightVM Events trigger executing every time a new vulnerability was found.\n\n# Key Features\n\n* Automatically triggers on a new vulnerability found by InsightVM\n* Searches for IPS rules for every found vulnerability\n* Finds matching assets in Deep Security based on FQDN and hostname\n* Assigns the IPS rules to the Deep Security assets\n* Sets exceptions for protected vulnerabilities in InsightVM\n\n# Requirements\n\n* Rapid7 InsightConnect\n* Rapid7 InsightVM\n* Trend Micro Deep Security (Intrusion Prevention Module)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nOnce imported, you will need to register a webhook for events to flow from InsightVM to InsightConnect. Open the workflow and click the trigger step for instructions.\n\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Rapid7 InsightVM|4.9.1|3|\n|Trend Micro Deep Security|2.2.1|4|\n|Advanced Regex|1.0.3|1|\n|Python 3 Script|2.0.2|3|\n|Type Converter|1.8.1|3|\n|Base64|1.1.6|1|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Rapid7 InsightVM](https://www.rapid7.com/products/insightvm/)\n* [Trend Micro Deep Security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)\n* [Rapid7 InsightConnect](https://www.rapid7.com/products/insightconnect/)\n* [Rapid7 Vulnerability Database](https://www.rapid7.com/db)\n* [Rapid7 InsightVM - InsightConnect Plugin](https://extensions.rapid7.com/extension/rapid7_insightvm)\n* [Trend Micro Deep Security - InsightConnect Plugin](https://extensions.rapid7.com/extension/trendmicro_deepsecurity)\n",
        "graph": {
          "edges": {
            "0687143c-8096-475a-82d6-3fd6572976f8": {
              "id": "0687143c-8096-475a-82d6-3fd6572976f8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677",
              "toNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08"
            },
            "17e5f5ed-609d-4d6b-b475-a5f14b4c92ac": {
              "id": "17e5f5ed-609d-4d6b-b475-a5f14b4c92ac",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "446661fd-8f30-43c3-a65a-a19473e07645",
              "toNodeId": "4212b78a-3f0d-41be-8344-74839a651b44"
            },
            "19829b48-d5b2-4acf-9c4f-06d81e3b072c": {
              "id": "19829b48-d5b2-4acf-9c4f-06d81e3b072c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ad81e9c1-40c2-4f36-a71a-03c679003c33",
              "toNodeId": "446661fd-8f30-43c3-a65a-a19473e07645"
            },
            "22d406b6-bd48-4128-b303-69423093c753": {
              "id": "22d406b6-bd48-4128-b303-69423093c753",
              "name": "One Asset Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "toNodeId": "311072a4-e9f7-40ae-86d5-c2e39b5022a7"
            },
            "3707f593-94ec-4406-b43e-7172a14ec7cb": {
              "id": "3707f593-94ec-4406-b43e-7172a14ec7cb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "311072a4-e9f7-40ae-86d5-c2e39b5022a7",
              "toNodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2"
            },
            "3b0d1e8c-8bf9-415f-bba9-fa91b52b27b3": {
              "id": "3b0d1e8c-8bf9-415f-bba9-fa91b52b27b3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "008496d4-ed7b-4354-a24a-b5c33879f5ee",
              "toNodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677"
            },
            "3c513f4a-2774-4a6d-935e-32cdbb42069c": {
              "id": "3c513f4a-2774-4a6d-935e-32cdbb42069c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
              "toNodeId": ""
            },
            "40dc01c8-076f-4c3a-93c0-7fecae1cb583": {
              "id": "40dc01c8-076f-4c3a-93c0-7fecae1cb583",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4212b78a-3f0d-41be-8344-74839a651b44",
              "toNodeId": "5e72f333-6598-4051-b3ac-e2e5317416ee"
            },
            "4a42ce4a-23ab-4d25-86fd-36231ceb8039": {
              "id": "4a42ce4a-23ab-4d25-86fd-36231ceb8039",
              "name": "",
              "description": "",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "fromNodeId": "ca63b383-d6a0-4cf6-b93d-a637945fb428",
              "toNodeId": "249b1b29-ae03-4b41-a0a6-2807aa3d639a"
            },
            "52fa5e62-8281-40e1-9660-0909d4200efe": {
              "id": "52fa5e62-8281-40e1-9660-0909d4200efe",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a",
              "toNodeId": "256effb8-575a-4565-a5e9-901ae18b7d17"
            },
            "63f4d6d7-c69f-4c3f-841f-3f895728b464": {
              "id": "63f4d6d7-c69f-4c3f-841f-3f895728b464",
              "name": "No Rules",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "toNodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03"
            },
            "6bffbc81-99a8-447c-af75-9e4717694931": {
              "id": "6bffbc81-99a8-447c-af75-9e4717694931",
              "name": "",
              "description": "",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "fromNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "toNodeId": "9ee868aa-b40a-43eb-8e59-a411120f5091"
            },
            "6ca5ff85-2c60-442c-bf45-a5f4d8daa73c": {
              "id": "6ca5ff85-2c60-442c-bf45-a5f4d8daa73c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
              "toNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e"
            },
            "6e7dc084-a5c1-451e-a82f-68fbc97cb37e": {
              "id": "6e7dc084-a5c1-451e-a82f-68fbc97cb37e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
              "toNodeId": ""
            },
            "73f98fa4-0bb9-4ab0-ad33-773732b93631": {
              "id": "73f98fa4-0bb9-4ab0-ad33-773732b93631",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4807ef5e-7609-4d58-9616-9e5fc936376d",
              "toNodeId": "ad81e9c1-40c2-4f36-a71a-03c679003c33"
            },
            "7ed0d376-e79f-451d-ac38-8fdc2d671592": {
              "id": "7ed0d376-e79f-451d-ac38-8fdc2d671592",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "256effb8-575a-4565-a5e9-901ae18b7d17",
              "toNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3"
            },
            "940c0621-56f3-4350-b0e4-bb836ef593f2": {
              "id": "940c0621-56f3-4350-b0e4-bb836ef593f2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f",
              "toNodeId": "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a"
            },
            "98bc175e-1f3f-4115-84d6-9944ecdd51bf": {
              "id": "98bc175e-1f3f-4115-84d6-9944ecdd51bf",
              "name": "",
              "description": "",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "fromNodeId": "9ee868aa-b40a-43eb-8e59-a411120f5091",
              "toNodeId": "ca63b383-d6a0-4cf6-b93d-a637945fb428"
            },
            "a20f502e-9d65-46c2-af20-430a2b55d47a": {
              "id": "a20f502e-9d65-46c2-af20-430a2b55d47a",
              "name": "",
              "description": "",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "fromNodeId": "26d28c63-da55-45e4-9a8b-2976040d4516",
              "toNodeId": ""
            },
            "aba8145b-9908-4e43-93fb-93d07517b4b9": {
              "id": "aba8145b-9908-4e43-93fb-93d07517b4b9",
              "name": "No or Multiple Assets Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "toNodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8"
            },
            "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506": {
              "id": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
              "name": "No or Multiple Assets Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "toNodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d"
            },
            "b73f301e-607a-4a97-8d8f-65282d1eb16d": {
              "id": "b73f301e-607a-4a97-8d8f-65282d1eb16d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6c421629-5742-4fe5-ace3-ff0ff86a0bce",
              "toNodeId": "008496d4-ed7b-4354-a24a-b5c33879f5ee"
            },
            "b7a3891b-6546-43e0-88ec-2603f60b03e6": {
              "id": "b7a3891b-6546-43e0-88ec-2603f60b03e6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d",
              "toNodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7"
            },
            "bb84335b-47ad-4e3b-b653-a4131e73b8db": {
              "id": "bb84335b-47ad-4e3b-b653-a4131e73b8db",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5e72f333-6598-4051-b3ac-e2e5317416ee",
              "toNodeId": "6c421629-5742-4fe5-ace3-ff0ff86a0bce"
            },
            "c790327d-9b36-479e-9d1c-5f83a169b4b6": {
              "id": "c790327d-9b36-479e-9d1c-5f83a169b4b6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "cd4cc555-b09e-40e3-9779-6b8087adf770",
              "toNodeId": "4807ef5e-7609-4d58-9616-9e5fc936376d"
            },
            "c9db80e9-3909-4a05-bf69-23b6b31e7550": {
              "id": "c9db80e9-3909-4a05-bf69-23b6b31e7550",
              "name": "",
              "description": "",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "fromNodeId": "249b1b29-ae03-4b41-a0a6-2807aa3d639a",
              "toNodeId": "26d28c63-da55-45e4-9a8b-2976040d4516"
            },
            "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9": {
              "id": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
              "name": "Rules Found",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "toNodeId": "12d2c682-31db-45be-9702-fd7ace048ae4"
            },
            "d51d9151-669c-4f0f-bcac-21e1ae007541": {
              "id": "d51d9151-669c-4f0f-bcac-21e1ae007541",
              "name": "One Asset Found by Hostname",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "toNodeId": "311072a4-e9f7-40ae-86d5-c2e39b5022a7"
            },
            "d754ca62-b52c-4320-b075-903440ff926d": {
              "id": "d754ca62-b52c-4320-b075-903440ff926d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "12d2c682-31db-45be-9702-fd7ace048ae4",
              "toNodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f"
            },
            "db30aefe-584e-44ec-b7ea-314f5139e52b": {
              "id": "db30aefe-584e-44ec-b7ea-314f5139e52b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7",
              "toNodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52"
            },
            "fe1553ad-1789-423a-8c8a-8e6589587dd8": {
              "id": "fe1553ad-1789-423a-8c8a-8e6589587dd8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "toNodeId": ""
            }
          },
          "nodes": {
            "008496d4-ed7b-4354-a24a-b5c33879f5ee": {
              "id": "008496d4-ed7b-4354-a24a-b5c33879f5ee",
              "parentNodeId": ""
            },
            "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8": {
              "id": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
              "parentNodeId": ""
            },
            "0e430408-e589-4fd4-b80e-4cd7ba2a6a03": {
              "id": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
              "parentNodeId": ""
            },
            "12d2c682-31db-45be-9702-fd7ace048ae4": {
              "id": "12d2c682-31db-45be-9702-fd7ace048ae4",
              "parentNodeId": ""
            },
            "1c6f6b18-1a43-4142-8216-08331b247f2f": {
              "id": "1c6f6b18-1a43-4142-8216-08331b247f2f",
              "parentNodeId": ""
            },
            "249b1b29-ae03-4b41-a0a6-2807aa3d639a": {
              "id": "249b1b29-ae03-4b41-a0a6-2807aa3d639a",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3"
            },
            "256effb8-575a-4565-a5e9-901ae18b7d17": {
              "id": "256effb8-575a-4565-a5e9-901ae18b7d17",
              "parentNodeId": ""
            },
            "26d28c63-da55-45e4-9a8b-2976040d4516": {
              "id": "26d28c63-da55-45e4-9a8b-2976040d4516",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3"
            },
            "311072a4-e9f7-40ae-86d5-c2e39b5022a7": {
              "id": "311072a4-e9f7-40ae-86d5-c2e39b5022a7",
              "parentNodeId": ""
            },
            "40826fbe-d5f2-4638-bce7-3b39631d1bd3": {
              "id": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
              "parentNodeId": ""
            },
            "418d2858-b0ec-4d0b-b238-9d0f7eadcd52": {
              "id": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
              "parentNodeId": ""
            },
            "4212b78a-3f0d-41be-8344-74839a651b44": {
              "id": "4212b78a-3f0d-41be-8344-74839a651b44",
              "parentNodeId": ""
            },
            "446661fd-8f30-43c3-a65a-a19473e07645": {
              "id": "446661fd-8f30-43c3-a65a-a19473e07645",
              "parentNodeId": ""
            },
            "4807ef5e-7609-4d58-9616-9e5fc936376d": {
              "id": "4807ef5e-7609-4d58-9616-9e5fc936376d",
              "parentNodeId": ""
            },
            "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a": {
              "id": "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a",
              "parentNodeId": ""
            },
            "5ba09430-c569-41a4-b10e-712476e8ad08": {
              "id": "5ba09430-c569-41a4-b10e-712476e8ad08",
              "parentNodeId": ""
            },
            "5e72f333-6598-4051-b3ac-e2e5317416ee": {
              "id": "5e72f333-6598-4051-b3ac-e2e5317416ee",
              "parentNodeId": ""
            },
            "6c421629-5742-4fe5-ace3-ff0ff86a0bce": {
              "id": "6c421629-5742-4fe5-ace3-ff0ff86a0bce",
              "parentNodeId": ""
            },
            "877536f9-b731-4215-9d63-397bd5cd5ce7": {
              "id": "877536f9-b731-4215-9d63-397bd5cd5ce7",
              "parentNodeId": ""
            },
            "89d7ec9f-d138-4fac-addd-d47e103f9677": {
              "id": "89d7ec9f-d138-4fac-addd-d47e103f9677",
              "parentNodeId": ""
            },
            "95d758d7-5538-415c-965d-09a4bf23ed5e": {
              "id": "95d758d7-5538-415c-965d-09a4bf23ed5e",
              "parentNodeId": ""
            },
            "9adcd58c-da41-46ee-ac8d-39f5d48b07c2": {
              "id": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
              "parentNodeId": ""
            },
            "9ee868aa-b40a-43eb-8e59-a411120f5091": {
              "id": "9ee868aa-b40a-43eb-8e59-a411120f5091",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3"
            },
            "ab54df2c-c300-4649-b805-a3845efe7a1d": {
              "id": "ab54df2c-c300-4649-b805-a3845efe7a1d",
              "parentNodeId": ""
            },
            "ad81e9c1-40c2-4f36-a71a-03c679003c33": {
              "id": "ad81e9c1-40c2-4f36-a71a-03c679003c33",
              "parentNodeId": ""
            },
            "ca63b383-d6a0-4cf6-b93d-a637945fb428": {
              "id": "ca63b383-d6a0-4cf6-b93d-a637945fb428",
              "parentNodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3"
            },
            "cd4cc555-b09e-40e3-9779-6b8087adf770": {
              "id": "cd4cc555-b09e-40e3-9779-6b8087adf770",
              "parentNodeId": ""
            }
          }
        },
        "steps": {
          "008496d4-ed7b-4354-a24a-b5c33879f5ee": {
            "nodeId": "008496d4-ed7b-4354-a24a-b5c33879f5ee",
            "name": "Extract List of CVEs",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    input = params.get('input')\n    \n    lines=input.split()[1:]\n    \n    result = set()\n    for item in lines:\n        result.update(item.split(\",\")[1:]) \n\n    return {\"cves\": list(result)}",
                "input": {
                  "input": "{{[4212b78a-3f0d-41be-8344-74839a651b44].[data]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "cves": {
                  "description": "Sample output result1 (delete or edit)",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result1",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8": {
            "nodeId": "0131ed50-9d8d-49dc-befc-bab4e2a2f7f8",
            "name": "No or Multiple Matching Assets Found in Deep Security",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Hostname/FQDN IVM: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}\nDS search result: {{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}\n\nExtracted Hostname: {{[ab54df2c-c300-4649-b805-a3845efe7a1d].[result].[0]}}\nDS search result: {{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0e430408-e589-4fd4-b80e-4cd7ba2a6a03": {
            "nodeId": "0e430408-e589-4fd4-b80e-4cd7ba2a6a03",
            "name": "No IPS Rule",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "No IPS rules found!"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "12d2c682-31db-45be-9702-fd7ace048ae4": {
            "nodeId": "12d2c682-31db-45be-9702-fd7ace048ae4",
            "name": "Convert ID to Integer",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "string_to_integer",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{{[311072a4-e9f7-40ae-86d5-c2e39b5022a7].[DS asset ID].[0]}}",
                "strip": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                },
                "strip": {
                  "description": "Strip whitespace",
                  "order": 2,
                  "title": "Strip",
                  "type": "boolean"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "integer"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "1c6f6b18-1a43-4142-8216-08331b247f2f": {
            "nodeId": "1c6f6b18-1a43-4142-8216-08331b247f2f",
            "name": "Deploy to Computer",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.1/icon.png"
            },
            "identifier": "deploy_rules",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "computer_or_policy": "computer",
                "id": "{{[12d2c682-31db-45be-9702-fd7ace048ae4].[output]}}",
                "rules": "{{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[ips_rules]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "computer_or_policy": {
                  "description": "Target for rule assignment",
                  "enum": [
                    "computer",
                    "policy"
                  ],
                  "order": 1,
                  "title": "Target",
                  "type": "string"
                },
                "id": {
                  "description": "ID of the target computer or policy",
                  "order": 2,
                  "title": "ID",
                  "type": "integer"
                },
                "rules": {
                  "description": "IPS rules to assign",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "IPS Rules",
                  "type": "array"
                }
              },
              "required": [
                "computer_or_policy",
                "id",
                "rules"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "rules_assigned": {
                  "description": "All IPS rules currently assigned",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Rules Assigned",
                  "type": "array"
                },
                "rules_not_assigned": {
                  "description": "Unassigned IPS rules",
                  "items": {
                    "type": "integer"
                  },
                  "order": 2,
                  "title": "Not Assigned Rules",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "249b1b29-ae03-4b41-a0a6-2807aa3d639a": {
            "nodeId": "249b1b29-ae03-4b41-a0a6-2807aa3d639a",
            "name": "Create Exception",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "create_exception",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "Protected by Trend Micro Deep Security",
                "expiration": "",
                "key": "",
                "port": 0,
                "reason": "Compensating Control",
                "scope": "{{[ca63b383-d6a0-4cf6-b93d-a637945fb428].[output]}}",
                "type": "Asset",
                "vulnerability": "{{[40826fbe-d5f2-4638-bce7-3b39631d1bd3].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "default": "Exception created with InsightConnect",
                  "description": "Comment to include in the vulnerability exception submission",
                  "order": 5,
                  "title": "Comment",
                  "type": "string"
                },
                "expiration": {
                  "description": "The date the vulnerability exception expires",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 4,
                  "title": "Expiration",
                  "type": "string"
                },
                "key": {
                  "description": "The key to identify a specific instance if the type is Instance",
                  "order": 7,
                  "title": "Vulnerability Key",
                  "type": "string"
                },
                "port": {
                  "description": "The port the vulnerability appears on if the type is Instance",
                  "order": 8,
                  "title": "Vulnerability Port",
                  "type": "integer"
                },
                "reason": {
                  "description": "Reason for the exception",
                  "enum": [
                    "False Positive",
                    "Compensating Control",
                    "Acceptable Use",
                    "Acceptable Risk",
                    "Other"
                  ],
                  "order": 6,
                  "title": "Reason",
                  "type": "string"
                },
                "scope": {
                  "description": "The ID of the scope the vulnerability exception applies to.  May be empty if type is Global",
                  "order": 3,
                  "title": "Scope ID",
                  "type": "integer"
                },
                "type": {
                  "description": "The type of vulnerability exception to create",
                  "enum": [
                    "Global",
                    "Site",
                    "Asset",
                    "Asset Group",
                    "Instance"
                  ],
                  "order": 1,
                  "title": "Exception Type",
                  "type": "string"
                },
                "vulnerability": {
                  "description": "The vulnerability this exception applies to",
                  "order": 2,
                  "title": "Vulnerability",
                  "type": "string"
                }
              },
              "required": [
                "type",
                "vulnerability",
                "comment",
                "reason"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "id": {
                  "description": "The vulnerability exception that was created",
                  "order": 1,
                  "title": "Created Exception ID",
                  "type": "integer"
                },
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 2,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links",
                "id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "256effb8-575a-4565-a5e9-901ae18b7d17": {
            "nodeId": "256effb8-575a-4565-a5e9-901ae18b7d17",
            "name": "Rules Deployed",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "Rules deployed!\n\nIVM Hostname: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}\nDS Asset ID: {{[311072a4-e9f7-40ae-86d5-c2e39b5022a7].[DS asset ID]}}\n\nAssigned\n{{[1c6f6b18-1a43-4142-8216-08331b247f2f].[rules_assigned]}}\n\nFailed to assign\n{{[1c6f6b18-1a43-4142-8216-08331b247f2f].[rules_not_assigned]}}\n\nProtected vulnerability IDs\n{{[52e3dbc1-5386-43c8-b1f4-55765c8b4d3a].[vulnids]}}\n\nMatched CVEs\n{{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[matched_cves]}}\n\nMissed CVEs\n{{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[missed_cves]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "26d28c63-da55-45e4-9a8b-2976040d4516": {
            "nodeId": "26d28c63-da55-45e4-9a8b-2976040d4516",
            "name": "Approve Exception",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "review_exception",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "comment": "Automatically approved by InsightConnect",
                "exception": "{{[249b1b29-ae03-4b41-a0a6-2807aa3d639a].[id]}}",
                "review": "Approved"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "comment": {
                  "description": "Comment to include in the review",
                  "order": 3,
                  "title": "Review Comment",
                  "type": "string"
                },
                "exception": {
                  "description": "The vulnerability exception ID to approve or reject",
                  "order": 1,
                  "title": "Exception ID",
                  "type": "integer"
                },
                "review": {
                  "description": "Approval or rejection of the exception",
                  "enum": [
                    "Approved",
                    "Rejected"
                  ],
                  "order": 2,
                  "title": "Review Outcome",
                  "type": "string"
                }
              },
              "required": [
                "exception",
                "review"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "311072a4-e9f7-40ae-86d5-c2e39b5022a7": {
            "nodeId": "311072a4-e9f7-40ae-86d5-c2e39b5022a7",
            "name": "Asset Identified",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "22d406b6-bd48-4128-b303-69423093c753",
                "d51d9151-669c-4f0f-bcac-21e1ae007541"
              ],
              "variableSets": [
                {
                  "arrayType": "integer",
                  "inputBuilderSchemas": null,
                  "name": "DS asset ID",
                  "type": "array",
                  "variables": {
                    "22d406b6-bd48-4128-b303-69423093c753": "{{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}",
                    "d51d9151-669c-4f0f-bcac-21e1ae007541": "{{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "DS asset ID": {
                  "description": "Emitted variable \"DS asset ID\"",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "DS asset ID",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "DS asset ID": {
                  "description": "Emitted variable \"DS asset ID\"",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "DS asset ID",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "40826fbe-d5f2-4638-bce7-3b39631d1bd3": {
            "nodeId": "40826fbe-d5f2-4638-bce7-3b39631d1bd3",
            "name": "For Each Vulnerability ID",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "6bffbc81-99a8-447c-af75-9e4717694931",
              "nextEdgeId": "fe1553ad-1789-423a-8c8a-8e6589587dd8",
              "repeatVariable": "{{[52e3dbc1-5386-43c8-b1f4-55765c8b4d3a].[vulnids]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "418d2858-b0ec-4d0b-b238-9d0f7eadcd52": {
            "nodeId": "418d2858-b0ec-4d0b-b238-9d0f7eadcd52",
            "name": "Check if Asset Was Found By Hostname",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "aba8145b-9908-4e43-93fb-93d07517b4b9",
              "stepControlParams": [
                {
                  "edgeId": "aba8145b-9908-4e43-93fb-93d07517b4b9",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "d51d9151-669c-4f0f-bcac-21e1ae007541",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "877536f9-b731-4215-9d63-397bd5cd5ce7.computer_ids",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[877536f9-b731-4215-9d63-397bd5cd5ce7].[computer_ids]}}) = 1"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "4212b78a-3f0d-41be-8344-74839a651b44": {
            "nodeId": "4212b78a-3f0d-41be-8344-74839a651b44",
            "name": "Decode CVE Report",
            "type": "action",
            "plugin": {
              "name": "Base64",
              "slugVendor": "rapid7",
              "slugName": "base64",
              "slugVersion": "1.1.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/base64/1.1.6/icon.png"
            },
            "identifier": "decode",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "base64": "{{[446661fd-8f30-43c3-a65a-a19473e07645].[report].[content]}}",
                "errors": "nothing"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "base64": {
                  "description": "Data to decode",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Base64",
                  "type": "string"
                },
                "errors": {
                  "default": "nothing",
                  "description": "How errors should be handled when decoding Base64",
                  "enum": [
                    "replace",
                    "ignore",
                    "nothing"
                  ],
                  "order": 2,
                  "title": "Errors",
                  "type": "string"
                }
              },
              "required": [
                "base64"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Decoded data result",
                  "order": 1,
                  "title": "Decoded Data",
                  "type": "string"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "446661fd-8f30-43c3-a65a-a19473e07645": {
            "nodeId": "446661fd-8f30-43c3-a65a-a19473e07645",
            "name": "Get CVEs",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "generate_adhoc_sql_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "filters": "{}",
                "query": "SELECT nexpose_id, array_to_string(array_agg(reference), ', ') AS references\nFROM dim_vulnerability\nJOIN dim_vulnerability_reference USING (vulnerability_id)\nWHERE reference LIKE'CVE%' AND nexpose_id IN ('{{[4807ef5e-7609-4d58-9616-9e5fc936376d].[output]}}')\nGROUP BY nexpose_id",
                "scope": "none",
                "scope_ids": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "filters": {
                  "default": "{}",
                  "description": "Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options",
                  "order": 4,
                  "title": "Report Filters",
                  "type": "string"
                },
                "query": {
                  "description": "Reporting Data Model SQL query",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                },
                "scope": {
                  "default": "none",
                  "description": "Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input",
                  "enum": [
                    "none",
                    "assets",
                    "assetGroups",
                    "sites",
                    "tags",
                    "scan"
                  ],
                  "order": 2,
                  "title": "Scope",
                  "type": "string"
                },
                "scope_ids": {
                  "default": [],
                  "description": "Scope IDs for which tickets should be generated, by default all are included",
                  "items": {
                    "type": "integer"
                  },
                  "order": 3,
                  "title": "Scope IDs",
                  "type": "array"
                }
              },
              "required": [
                "query",
                "scope"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/file",
                  "description": "Base64 encoded file making up the report",
                  "order": 1,
                  "title": "Base64 Encoded Report"
                }
              },
              "required": [
                "report"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4807ef5e-7609-4d58-9616-9e5fc936376d": {
            "nodeId": "4807ef5e-7609-4d58-9616-9e5fc936376d",
            "name": "Array to String",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "array_to_string",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delimiter": "','",
                "input": "{{[cd4cc555-b09e-40e3-9779-6b8087adf770].[changes].[asset_vulnerabilities_found]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delimiter": {
                  "description": "Characters used to join an array to a string. Default is a space, if not provided by user",
                  "order": 2,
                  "title": "Delimiter",
                  "type": "string"
                },
                "input": {
                  "description": "Array to convert",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Input",
                  "type": "array"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Joined string",
                  "order": 1,
                  "title": "Output",
                  "type": "string"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a": {
            "nodeId": "52e3dbc1-5386-43c8-b1f4-55765c8b4d3a",
            "name": "Generate List of Protected Vulnerability IDs",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    \n\t# Get input parameter\n\tprotected_cves = params.get('cves')\n\tvulnids = params.get('vulnids')\n    \n\t# Initialize result\n\tresult = {}\n\tresult[\"vulnids\"] = []    \n    \n\t# Find vulnerability ID for CVEs protected by Deep Security\n\tfor cve in protected_cves:\n\t\tfor vulnerability_id, cves in vulnids.items():\n\t\t\tif cve in cves:\n\t\t\t\tresult[\"vulnids\"].append(vulnerability_id)\n    \n\treturn result",
                "input": {
                  "cves": "{{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[matched_cves]}}",
                  "vulnids": "{{[6c421629-5742-4fe5-ace3-ff0ff86a0bce].[result]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "vulnids": {
                  "description": "Sample output result1 (delete or edit)",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result1",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "5ba09430-c569-41a4-b10e-712476e8ad08": {
            "nodeId": "5ba09430-c569-41a4-b10e-712476e8ad08",
            "name": "Check If One Asset Was Found",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
              "stepControlParams": [
                {
                  "edgeId": "22d406b6-bd48-4128-b303-69423093c753",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "89d7ec9f-d138-4fac-addd-d47e103f9677.computer_ids",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 1
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[89d7ec9f-d138-4fac-addd-d47e103f9677].[computer_ids]}}) = 1"
                },
                {
                  "edgeId": "ae41fe2a-5bfc-4984-adfd-0f4f2fe78506",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "5e72f333-6598-4051-b3ac-e2e5317416ee": {
            "nodeId": "5e72f333-6598-4051-b3ac-e2e5317416ee",
            "name": "Info",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "### Host ###\n\nHostname: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}\nIP: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[ip]}}\nOS: {{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[operating_system]}}\n\n### Vulnerabilities ###\n\n{{[4212b78a-3f0d-41be-8344-74839a651b44].[data]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6c421629-5742-4fe5-ace3-ff0ff86a0bce": {
            "nodeId": "6c421629-5742-4fe5-ace3-ff0ff86a0bce",
            "name": "Convert to Dictionary",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    input = params.get('input')\n    lines = input.split()\n    del lines[0]\n\n    result = {}\n    for item in lines:\n        splitted = item.split(\",\")\n        result[splitted[0]] = splitted[1:] \n\n    return {\"result\": result}",
                "input": {
                  "input": "{{[4212b78a-3f0d-41be-8344-74839a651b44].[data]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "result": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "collection"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "877536f9-b731-4215-9d63-397bd5cd5ce7": {
            "nodeId": "877536f9-b731-4215-9d63-397bd5cd5ce7",
            "name": "Search For Hostname Only",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.1/icon.png"
            },
            "identifier": "search_computers",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "field_name": "hostName",
                "information": "none",
                "max_items": 2,
                "number_value": 0,
                "search_type": "string",
                "string_value": "{{[ab54df2c-c300-4649-b805-a3845efe7a1d].[result].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "field_name": {
                  "default": "hostName",
                  "description": "Name of the field to be tested",
                  "order": 3,
                  "title": "Search Field",
                  "type": "string"
                },
                "information": {
                  "default": "none",
                  "description": "Determines the computer information to include in the response",
                  "enum": [
                    "none",
                    "all",
                    "computerStatus",
                    "tasks",
                    "securityUpdates",
                    "computerSettings",
                    "allSecurityModules",
                    "antiMalware",
                    "webReputation",
                    "activityMonitoring",
                    "firewall",
                    "intrusionPrevention",
                    "integrityMonitoring",
                    "logInspection",
                    "applicationControl",
                    "SAP",
                    "interfaces",
                    "ESXSummary",
                    "allVirtualMachineSummaries",
                    "azureARMVirtualMachineSummary",
                    "azureVMVirtualMachineSummary",
                    "ec2VirtualMachineSummary",
                    "noConnectorVirtualMachineSummary",
                    "vmwareVMVirtualMachineSummary",
                    "vcloudVMVirtualMachineSummary",
                    "workspaceVirtualMachineSummary",
                    "gcpVirtualMachineSummary"
                  ],
                  "order": 1,
                  "title": "Information",
                  "type": "string"
                },
                "max_items": {
                  "default": 5000,
                  "description": "Limits the number of objects returned",
                  "order": 2,
                  "title": "Maximum Items",
                  "type": "integer"
                },
                "number_value": {
                  "default": "",
                  "description": "Number to search for",
                  "order": 6,
                  "title": "Number Value",
                  "type": "integer"
                },
                "search_type": {
                  "default": "string",
                  "description": "Select the search type",
                  "enum": [
                    "string",
                    "integer"
                  ],
                  "order": 4,
                  "title": "Search Type",
                  "type": "string"
                },
                "string_value": {
                  "default": "",
                  "description": "String to search for",
                  "order": 5,
                  "title": "String Value",
                  "type": "string"
                }
              },
              "required": [
                "information",
                "max_items"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "computer_ids": {
                  "description": "IDs of matching computers",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Computer IDs",
                  "type": "array"
                },
                "response_json": {
                  "description": "Full response in JSON format",
                  "order": 2,
                  "title": "Response JSON",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "89d7ec9f-d138-4fac-addd-d47e103f9677": {
            "nodeId": "89d7ec9f-d138-4fac-addd-d47e103f9677",
            "name": "Search Computer in Deep Security",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.1/icon.png"
            },
            "identifier": "search_computers",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "field_name": "hostName",
                "information": "none",
                "max_items": 2,
                "number_value": 0,
                "search_type": "string",
                "string_value": "{{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "field_name": {
                  "default": "hostName",
                  "description": "Name of the field to be tested",
                  "order": 3,
                  "title": "Search Field",
                  "type": "string"
                },
                "information": {
                  "default": "none",
                  "description": "Determines the computer information to include in the response",
                  "enum": [
                    "none",
                    "all",
                    "computerStatus",
                    "tasks",
                    "securityUpdates",
                    "computerSettings",
                    "allSecurityModules",
                    "antiMalware",
                    "webReputation",
                    "activityMonitoring",
                    "firewall",
                    "intrusionPrevention",
                    "integrityMonitoring",
                    "logInspection",
                    "applicationControl",
                    "SAP",
                    "interfaces",
                    "ESXSummary",
                    "allVirtualMachineSummaries",
                    "azureARMVirtualMachineSummary",
                    "azureVMVirtualMachineSummary",
                    "ec2VirtualMachineSummary",
                    "noConnectorVirtualMachineSummary",
                    "vmwareVMVirtualMachineSummary",
                    "vcloudVMVirtualMachineSummary",
                    "workspaceVirtualMachineSummary",
                    "gcpVirtualMachineSummary"
                  ],
                  "order": 1,
                  "title": "Information",
                  "type": "string"
                },
                "max_items": {
                  "default": 5000,
                  "description": "Limits the number of objects returned",
                  "order": 2,
                  "title": "Maximum Items",
                  "type": "integer"
                },
                "number_value": {
                  "default": "",
                  "description": "Number to search for",
                  "order": 6,
                  "title": "Number Value",
                  "type": "integer"
                },
                "search_type": {
                  "default": "string",
                  "description": "Select the search type",
                  "enum": [
                    "string",
                    "integer"
                  ],
                  "order": 4,
                  "title": "Search Type",
                  "type": "string"
                },
                "string_value": {
                  "default": "",
                  "description": "String to search for",
                  "order": 5,
                  "title": "String Value",
                  "type": "string"
                }
              },
              "required": [
                "information",
                "max_items"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "computer_ids": {
                  "description": "IDs of matching computers",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "Computer IDs",
                  "type": "array"
                },
                "response_json": {
                  "description": "Full response in JSON format",
                  "order": 2,
                  "title": "Response JSON",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "95d758d7-5538-415c-965d-09a4bf23ed5e": {
            "nodeId": "95d758d7-5538-415c-965d-09a4bf23ed5e",
            "name": "Check if Rules Are Available",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
              "stepControlParams": [
                {
                  "edgeId": "63f4d6d7-c69f-4c3f-841f-3f895728b464",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2.ips_rules",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "(length({{[9adcd58c-da41-46ee-ac8d-39f5d48b07c2].[ips_rules]}}) = 0)"
                },
                {
                  "edgeId": "cc9ce2cc-4721-4132-b354-48a3e8c2c7f9",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9adcd58c-da41-46ee-ac8d-39f5d48b07c2": {
            "nodeId": "9adcd58c-da41-46ee-ac8d-39f5d48b07c2",
            "name": "Search For IPS Rules in Deep Security",
            "type": "action",
            "plugin": {
              "name": "Trend Micro Deep Security",
              "slugVendor": "rapid7",
              "slugName": "trendmicro_deepsecurity",
              "slugVersion": "2.2.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/trendmicro_deepsecurity/2.2.1/icon.png"
            },
            "identifier": "search_rules",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "vulnerabilities": "{{[008496d4-ed7b-4354-a24a-b5c33879f5ee].[cves]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "vulnerabilities": {
                  "description": "CVEs to protect against",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Vulnerabilities",
                  "type": "array"
                }
              },
              "required": [
                "vulnerabilities"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "ips_rules": {
                  "description": "IPS rules matching the given CVEs",
                  "items": {
                    "type": "integer"
                  },
                  "order": 1,
                  "title": "IPS Rules",
                  "type": "array"
                },
                "matched_cves": {
                  "description": "CVEs with at least one matching IPS rule",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Matched CVEs",
                  "type": "array"
                },
                "missed_cves": {
                  "description": "CVEs without matching IPS rules",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Missed CVEs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "9ee868aa-b40a-43eb-8e59-a411120f5091": {
            "nodeId": "9ee868aa-b40a-43eb-8e59-a411120f5091",
            "name": "Extract Asset ID",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{id:/\\d+/}}$",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "id",
                    "regex": "\\d+"
                  }
                },
                {
                  "type": "text",
                  "value": "$"
                }
              ],
              "ignoreCase": true,
              "input": "{{[cd4cc555-b09e-40e3-9779-6b8087adf770].[id]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "ab54df2c-c300-4649-b805-a3845efe7a1d": {
            "nodeId": "ab54df2c-c300-4649-b805-a3845efe7a1d",
            "name": "Extract Hostname From FQDN",
            "type": "action",
            "plugin": {
              "name": "Advanced Regex",
              "slugVendor": "rapid7",
              "slugName": "advanced_regex",
              "slugVersion": "1.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/advanced_regex/1.0.3/icon.png"
            },
            "identifier": "split",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "ascii": false,
                "dotall": false,
                "ignorecase": true,
                "in_regex": "\\.",
                "in_string": "{{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}",
                "max_split": 1,
                "multiline": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "ascii": {
                  "default": false,
                  "description": "Make \\w \\W \\b \\B follow ASCII rules",
                  "order": 7,
                  "title": "ASCII",
                  "type": "boolean"
                },
                "dotall": {
                  "default": false,
                  "description": "Make . match newline",
                  "order": 6,
                  "title": "Dot All",
                  "type": "boolean"
                },
                "ignorecase": {
                  "default": false,
                  "description": "Make regex non-case sensitive",
                  "order": 4,
                  "title": "Ignore Case",
                  "type": "boolean"
                },
                "in_regex": {
                  "description": "Regex to split string on matches",
                  "order": 2,
                  "title": "Regex",
                  "type": "string"
                },
                "in_string": {
                  "description": "Input string",
                  "order": 1,
                  "title": "Input String",
                  "type": "string"
                },
                "max_split": {
                  "default": 0,
                  "description": "Max splits - if non-zero last element is remainder of string",
                  "order": 3,
                  "title": "Max Split",
                  "type": "integer"
                },
                "multiline": {
                  "default": false,
                  "description": "Make begin/end consider each line",
                  "order": 5,
                  "title": "Multiline",
                  "type": "boolean"
                }
              },
              "required": [
                "in_string",
                "in_regex"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "An array of the strings returned by the split operation",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result Strings",
                  "type": "array"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "ad81e9c1-40c2-4f36-a71a-03c679003c33": {
            "nodeId": "ad81e9c1-40c2-4f36-a71a-03c679003c33",
            "name": "Check Hostname",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "19829b48-d5b2-4acf-9c4f-06d81e3b072c",
                "expression": {
                  "left": {
                    "args": [
                      {
                        "name": "cd4cc555-b09e-40e3-9779-6b8087adf770.summary.host_name",
                        "type": "variable"
                      }
                    ],
                    "name": "length",
                    "type": "function"
                  },
                  "op": ">",
                  "right": {
                    "type": "literal",
                    "value": 0
                  },
                  "type": "binary"
                },
                "expressionText": "length({{[cd4cc555-b09e-40e3-9779-6b8087adf770].[summary].[host_name]}}) > 0"
              },
              "stopOnMatch": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE"
          },
          "ca63b383-d6a0-4cf6-b93d-a637945fb428": {
            "nodeId": "ca63b383-d6a0-4cf6-b93d-a637945fb428",
            "name": "Convert Asset ID to Integer",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.1/icon.png"
            },
            "identifier": "string_to_integer",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{{[9ee868aa-b40a-43eb-8e59-a411120f5091].[id]}}",
                "strip": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                },
                "strip": {
                  "description": "Strip whitespace",
                  "order": 2,
                  "title": "Strip",
                  "type": "boolean"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "integer"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "cd4cc555-b09e-40e3-9779-6b8087adf770": {
            "nodeId": "cd4cc555-b09e-40e3-9779-6b8087adf770",
            "name": "New Vulnerability Found",
            "type": "trigger",
            "identifier": "vulnerabilities_found",
            "continueOnFailure": false,
            "isDisabled": false,
            "triggerId": "de73f057-2ca0-4eac-9f56-3ec1f87bdf6c",
            "defaultInputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "changes": {
                  "properties": {
                    "asset_vulnerabilities_found": {
                      "description": "Object containing details of vulnerabilities found",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "asset_vulnerabilities_found",
                      "type": "array"
                    }
                  },
                  "title": "changes",
                  "type": "object"
                },
                "summary": {
                  "properties": {
                    "agent_id": {
                      "description": "Identifier of agent that is on the asset",
                      "order": 4,
                      "title": "agent_id",
                      "type": "string"
                    },
                    "critical_vulnerability_count": {
                      "description": "Number of critical vulnerabilities on the asset",
                      "order": 9,
                      "title": "critical_vulnerability_count",
                      "type": "number"
                    },
                    "host_name": {
                      "description": "Asset hostname",
                      "order": 5,
                      "title": "host_name",
                      "type": "string"
                    },
                    "ip": {
                      "description": "Asset ip address",
                      "order": 1,
                      "title": "ip",
                      "type": "string"
                    },
                    "last_assessed_for_policy": {
                      "description": "Epoch time millis of last policy assessment",
                      "order": 12,
                      "title": "last_assessed_for_policy",
                      "type": "number"
                    },
                    "last_assessed_for_vulnerability": {
                      "description": "Epoch time millis of last vulnerability assessment",
                      "order": 11,
                      "title": "last_assessed_for_vulnerability",
                      "type": "number"
                    },
                    "last_scanned": {
                      "description": "Epoch time millis of last scanned",
                      "order": 7,
                      "title": "last_scanned",
                      "type": "number"
                    },
                    "mac": {
                      "description": "Asset mac address",
                      "order": 3,
                      "title": "mac",
                      "type": "string"
                    },
                    "moderate_vulnerability_count": {
                      "description": "Number of moderate vulnerabilities on the asset",
                      "order": 10,
                      "title": "moderate_vulnerability_count",
                      "type": "number"
                    },
                    "operating_system": {
                      "description": "Asset operating system",
                      "order": 2,
                      "title": "operating_system",
                      "type": "string"
                    },
                    "services_count": {
                      "description": "Number of services on the asset",
                      "order": 6,
                      "title": "services_count",
                      "type": "number"
                    },
                    "severe_vulnerability_count": {
                      "description": "Number of severe vulnerabilities on the asset",
                      "order": 8,
                      "title": "severe_vulnerability_count",
                      "type": "number"
                    },
                    "vulnerability_count": {
                      "description": "Total vulnerability count",
                      "order": 13,
                      "title": "vulnerability_count",
                      "type": "number"
                    }
                  },
                  "title": "summary",
                  "type": "object"
                }
              },
              "properties": {
                "changes": {
                  "$ref": "#/definitions/changes",
                  "description": "Object containing details of vulnerabilities found",
                  "order": 2,
                  "title": "changes"
                },
                "id": {
                  "description": "Asset ID",
                  "order": 3,
                  "title": "id",
                  "type": "string"
                },
                "summary": {
                  "$ref": "#/definitions/summary",
                  "description": "Object containing details of asset found",
                  "order": 1,
                  "title": "summary"
                }
              },
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/trigger-api-vm.svg",
            "connectionType": "NONE"
          }
        },
        "tags": [
          "Vulnerability Management"
        ],
        "humanCostSeconds": 3600,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "de73f057-2ca0-4eac-9f56-3ec1f87bdf6c",
        "identifier": "vulnerabilities_found",
        "name": "New Vulnerability Found",
        "description": "",
        "input": null,
        "inputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "changes": {
              "properties": {
                "asset_vulnerabilities_found": {
                  "description": "Object containing details of vulnerabilities found",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "asset_vulnerabilities_found",
                  "type": "array"
                }
              },
              "title": "changes",
              "type": "object"
            },
            "summary": {
              "properties": {
                "agent_id": {
                  "description": "Identifier of agent that is on the asset",
                  "order": 4,
                  "title": "agent_id",
                  "type": "string"
                },
                "critical_vulnerability_count": {
                  "description": "Number of critical vulnerabilities on the asset",
                  "order": 9,
                  "title": "critical_vulnerability_count",
                  "type": "number"
                },
                "host_name": {
                  "description": "Asset hostname",
                  "order": 5,
                  "title": "host_name",
                  "type": "string"
                },
                "ip": {
                  "description": "Asset ip address",
                  "order": 1,
                  "title": "ip",
                  "type": "string"
                },
                "last_assessed_for_policy": {
                  "description": "Epoch time millis of last policy assessment",
                  "order": 12,
                  "title": "last_assessed_for_policy",
                  "type": "number"
                },
                "last_assessed_for_vulnerability": {
                  "description": "Epoch time millis of last vulnerability assessment",
                  "order": 11,
                  "title": "last_assessed_for_vulnerability",
                  "type": "number"
                },
                "last_scanned": {
                  "description": "Epoch time millis of last scanned",
                  "order": 7,
                  "title": "last_scanned",
                  "type": "number"
                },
                "mac": {
                  "description": "Asset mac address",
                  "order": 3,
                  "title": "mac",
                  "type": "string"
                },
                "moderate_vulnerability_count": {
                  "description": "Number of moderate vulnerabilities on the asset",
                  "order": 10,
                  "title": "moderate_vulnerability_count",
                  "type": "number"
                },
                "operating_system": {
                  "description": "Asset operating system",
                  "order": 2,
                  "title": "operating_system",
                  "type": "string"
                },
                "services_count": {
                  "description": "Number of services on the asset",
                  "order": 6,
                  "title": "services_count",
                  "type": "number"
                },
                "severe_vulnerability_count": {
                  "description": "Number of severe vulnerabilities on the asset",
                  "order": 8,
                  "title": "severe_vulnerability_count",
                  "type": "number"
                },
                "vulnerability_count": {
                  "description": "Total vulnerability count",
                  "order": 13,
                  "title": "vulnerability_count",
                  "type": "number"
                }
              },
              "title": "summary",
              "type": "object"
            }
          },
          "properties": {
            "changes": {
              "$ref": "#/definitions/changes",
              "description": "Object containing details of vulnerabilities found",
              "order": 2,
              "title": "changes"
            },
            "id": {
              "description": "Asset ID",
              "order": 3,
              "title": "id",
              "type": "string"
            },
            "summary": {
              "$ref": "#/definitions/summary",
              "description": "Object containing details of asset found",
              "order": 1,
              "title": "summary"
            }
          },
          "type": "object"
        },
        "tags": [],
        "type": "trigger_api_vm_webhook"
      }
    ]
  }
}