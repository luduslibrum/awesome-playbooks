{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:54:52.376114548Z",
    "workflowVersions": [
      {
        "name": "Office 365 Analysis",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nThis workflow is designed to automatically analyze incoming emails to determine if they are malicious. This workflow assumes a user is using their report phishing button to send an email to an administrative account with the suspicious email attached. The workflow will then analyze the attached email for any suspicious links or files. If any malicious indicators are found the email will be remediated across the organization.\n\n# Key Features\n\n* Identifies malicious emails\n* Removes identified emails from the entire organization\n* Blocks sender from the organization\n\n# Requirements\n\nAPI and account credentials for:\n\n* Microsoft Office365\n* VirusTotal\n* Hybrid Analysis\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nOnce the workflow has been imported, **update the first step with the mailbox and subject to suit your environment** by editing the input with the preset text of `change_me`.\n\nAdditionally, update the predefined `change_me` inputs in _Send Notification Email_ - you can specify the sender of the notification email and who should be notified. The **Email To** field accepts a list of email addresses, so if you wish you can add multiple mailboxes to notify. \n\nThe remediation steps are disabled due to their destructive nature. To use them, they must be manually enabled after importing the workflow.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Datetime|2.2.0|2|\n|ExtractIt|2.0.0|3|\n|HashIt|2.0.4|1|\n|Hybrid Analysis|2.0.1|1|\n|Microsoft Office 365 Email|4.0.0|1|\n|Microsoft Office 365 Email|5.0.0|1|\n|Microsoft Office365 Email Security|2.2.3|2|\n|WHOIS|3.0.0|1|\n|VirusTotal|7.0.0|3|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.2.0 - Update VirusTotal plugin\n* 1.1.0 - Workflow improvements | Support for nested EML attachments | Domain headers analysis\n* 1.0.1 - Update workflow title to enrichment\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Office365](https://www.office.com)\n* [VirusTotal](https://www.virustotal.com)\n* [Hybrid Analysis](https://www.hybrid-analysis.com/)\n",
        "graph": {
          "edges": {
            "0002c613-39c2-47c0-8538-4c5dfa852132": {
              "id": "0002c613-39c2-47c0-8538-4c5dfa852132",
              "name": "False",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "58635117-4d0f-4f41-9bd6-d824a95867ba",
              "toNodeId": ""
            },
            "00f263d2-f504-47de-81ff-29a41cdd59be": {
              "id": "00f263d2-f504-47de-81ff-29a41cdd59be",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "721e875d-7460-4369-8bb5-60c70da053c7",
              "toNodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef"
            },
            "0970ccfc-bc23-4f50-a486-a47131a23f82": {
              "id": "0970ccfc-bc23-4f50-a486-a47131a23f82",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d",
              "toNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "0e78c211-528a-437e-b1fd-9438972a3409": {
              "id": "0e78c211-528a-437e-b1fd-9438972a3409",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "toNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c"
            },
            "1330ce33-9e95-462c-84c7-3e2777f07f85": {
              "id": "1330ce33-9e95-462c-84c7-3e2777f07f85",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "b1b9246d-8e0f-4fc5-986e-034040586ba7",
              "toNodeId": "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d"
            },
            "1657948c-0208-4256-9dd2-c8f9e577a4ac": {
              "id": "1657948c-0208-4256-9dd2-c8f9e577a4ac",
              "name": "True",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "58635117-4d0f-4f41-9bd6-d824a95867ba",
              "toNodeId": "e04a53f1-43c7-41e9-b8c8-069a2acd56de"
            },
            "25c91fa1-e7e9-4ec5-a64f-58dc9a29b877": {
              "id": "25c91fa1-e7e9-4ec5-a64f-58dc9a29b877",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "a562607a-8f03-46c3-81c2-d253eb99070b",
              "toNodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98"
            },
            "34d94566-db4d-444a-87cf-7b3299132627": {
              "id": "34d94566-db4d-444a-87cf-7b3299132627",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "e04a53f1-43c7-41e9-b8c8-069a2acd56de",
              "toNodeId": "cf599e7a-1928-488f-be0b-c03afbe6e6dd"
            },
            "38e4e865-49c5-4b48-8ce6-b78fff6f1ca3": {
              "id": "38e4e865-49c5-4b48-8ce6-b78fff6f1ca3",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "toNodeId": "5f0ca425-a326-4a54-bf3e-7d976252caa7"
            },
            "47ce318a-ddd4-4320-a996-47c69945b1c0": {
              "id": "47ce318a-ddd4-4320-a996-47c69945b1c0",
              "name": "True",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
              "toNodeId": "8030f309-b134-4a90-aab3-577dc9213cf7"
            },
            "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91": {
              "id": "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
              "toNodeId": ""
            },
            "563c9f5c-44b4-41e9-8b03-839eb4bc71c5": {
              "id": "563c9f5c-44b4-41e9-8b03-839eb4bc71c5",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "toNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "5c7108aa-a930-49f6-8ba3-76e79e364b73": {
              "id": "5c7108aa-a930-49f6-8ba3-76e79e364b73",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "cf599e7a-1928-488f-be0b-c03afbe6e6dd",
              "toNodeId": ""
            },
            "63565622-53c7-4478-8f69-e455b4cd6d8e": {
              "id": "63565622-53c7-4478-8f69-e455b4cd6d8e",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "5f0ca425-a326-4a54-bf3e-7d976252caa7",
              "toNodeId": "926f2d8b-5fc5-473b-8741-fd69b2aee7b8"
            },
            "687029fe-3173-4b05-8230-e5f6364d4491": {
              "id": "687029fe-3173-4b05-8230-e5f6364d4491",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac",
              "toNodeId": "99db80ee-511b-47b3-82d9-ea5bc5168f08"
            },
            "6a85734f-8b71-4e7f-a5ce-00144e61a93e": {
              "id": "6a85734f-8b71-4e7f-a5ce-00144e61a93e",
              "name": "Malicious File",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
              "toNodeId": "a562607a-8f03-46c3-81c2-d253eb99070b"
            },
            "71ad802a-ec8b-4ab9-95d1-90ac3357ebad": {
              "id": "71ad802a-ec8b-4ab9-95d1-90ac3357ebad",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "toNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "7885e52a-a487-4510-9364-751a0efcff17": {
              "id": "7885e52a-a487-4510-9364-751a0efcff17",
              "name": "False",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8"
            },
            "7b03effc-a2c8-42a6-b978-792935514bfa": {
              "id": "7b03effc-a2c8-42a6-b978-792935514bfa",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "8030f309-b134-4a90-aab3-577dc9213cf7",
              "toNodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e"
            },
            "82200da4-4655-4acf-aa29-d5ce4cccf079": {
              "id": "82200da4-4655-4acf-aa29-d5ce4cccf079",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "toNodeId": "721e875d-7460-4369-8bb5-60c70da053c7"
            },
            "8e53d640-6d8f-421c-ab3f-28ef741bc091": {
              "id": "8e53d640-6d8f-421c-ab3f-28ef741bc091",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "toNodeId": ""
            },
            "9d59bde7-bea4-41c2-bc9d-37f7c183e15c": {
              "id": "9d59bde7-bea4-41c2-bc9d-37f7c183e15c",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "892fd49f-e1ab-4130-9696-d05df39d7997",
              "toNodeId": "209b6ff3-926a-4e5f-83d8-97a5731003ef"
            },
            "a1342d47-eacd-4e99-8e0e-fd526916be0f": {
              "id": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
              "name": "Not Malicious",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
              "toNodeId": ""
            },
            "ae990a5e-f632-4c36-89e0-153b9371a353": {
              "id": "ae990a5e-f632-4c36-89e0-153b9371a353",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "toNodeId": "9f646b0c-55ab-4f9e-9b24-10bd69246b9a"
            },
            "b0f60fdd-8950-494c-915b-1e46cd3dd118": {
              "id": "b0f60fdd-8950-494c-915b-1e46cd3dd118",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "toNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "b667ae5a-48b3-458e-badf-060be34a524f": {
              "id": "b667ae5a-48b3-458e-badf-060be34a524f",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
              "toNodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527"
            },
            "bb5192d3-bf05-4cf8-a407-f57f2c825b99": {
              "id": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
              "name": "False",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
              "toNodeId": ""
            },
            "bfb53559-6904-4d57-a915-676d42202518": {
              "id": "bfb53559-6904-4d57-a915-676d42202518",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "9f646b0c-55ab-4f9e-9b24-10bd69246b9a",
              "toNodeId": "40cb415f-385e-4112-a02f-709646fc467e"
            },
            "c6b5ad9b-e19b-449f-a94f-5f73aa2d602a": {
              "id": "c6b5ad9b-e19b-449f-a94f-5f73aa2d602a",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "99db80ee-511b-47b3-82d9-ea5bc5168f08",
              "toNodeId": "37a0304d-f836-4d95-b39e-c800344822c7"
            },
            "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5": {
              "id": "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "toNodeId": "b1b9246d-8e0f-4fc5-986e-034040586ba7"
            },
            "ce9fd058-cee0-44ee-91ac-229bb4089252": {
              "id": "ce9fd058-cee0-44ee-91ac-229bb4089252",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527",
              "toNodeId": ""
            },
            "d1c7966f-8ec5-4cc2-b8c6-da2ebc93cc5b": {
              "id": "d1c7966f-8ec5-4cc2-b8c6-da2ebc93cc5b",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "209b6ff3-926a-4e5f-83d8-97a5731003ef",
              "toNodeId": "58635117-4d0f-4f41-9bd6-d824a95867ba"
            },
            "d2ac308d-a1c1-40d2-8fc7-f5cc76525d58": {
              "id": "d2ac308d-a1c1-40d2-8fc7-f5cc76525d58",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "2418a918-0a59-4429-ab4e-522b48851486",
              "toNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "d5481036-02f9-4c2d-90bc-90896072b477": {
              "id": "d5481036-02f9-4c2d-90bc-90896072b477",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
              "toNodeId": ""
            },
            "d8245176-59e6-49e8-9e41-2995aa20188e": {
              "id": "d8245176-59e6-49e8-9e41-2995aa20188e",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "toNodeId": "2418a918-0a59-4429-ab4e-522b48851486"
            },
            "e87f37bd-653c-47b2-b70b-089737c1c5c4": {
              "id": "e87f37bd-653c-47b2-b70b-089737c1c5c4",
              "name": "",
              "description": "",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "fromNodeId": "926f2d8b-5fc5-473b-8741-fd69b2aee7b8",
              "toNodeId": "892fd49f-e1ab-4130-9696-d05df39d7997"
            },
            "ed18d5d5-60ce-4070-961f-650467859b7f": {
              "id": "ed18d5d5-60ce-4070-961f-650467859b7f",
              "name": "",
              "description": "",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "fromNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "toNodeId": "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac"
            },
            "ee900a2d-604a-4d95-ae02-a9bee97a4ab6": {
              "id": "ee900a2d-604a-4d95-ae02-a9bee97a4ab6",
              "name": "",
              "description": "",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1",
              "fromNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "toNodeId": ""
            },
            "f05e1eff-e9e4-4729-b227-bdc532fd67e4": {
              "id": "f05e1eff-e9e4-4729-b227-bdc532fd67e4",
              "name": "",
              "description": "",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "fromNodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
              "toNodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44"
            },
            "f709bfc0-3279-489f-b3f7-c9244f075aaf": {
              "id": "f709bfc0-3279-489f-b3f7-c9244f075aaf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
              "toNodeId": ""
            },
            "fceaae38-58dd-4400-96b9-582929fcc93f": {
              "id": "fceaae38-58dd-4400-96b9-582929fcc93f",
              "name": "True",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "toNodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8"
            },
            "fff1c981-3b46-453c-bf82-69c109166862": {
              "id": "fff1c981-3b46-453c-bf82-69c109166862",
              "name": "",
              "description": "",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "fromNodeId": "40cb415f-385e-4112-a02f-709646fc467e",
              "toNodeId": "c0faa121-1c25-4477-8b7c-590b90787321"
            }
          },
          "nodes": {
            "0e565ff0-8d8f-45f7-8d22-a64e150ee93e": {
              "id": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "13b918db-b65a-42cb-97f4-832498591da1": {
              "id": "13b918db-b65a-42cb-97f4-832498591da1",
              "parentNodeId": ""
            },
            "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
              "id": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
              "parentNodeId": ""
            },
            "19279ef7-3ff3-4228-ae2f-91eb49656fed": {
              "id": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "1b82897d-95a2-4799-87d8-881d201d8fa8": {
              "id": "1b82897d-95a2-4799-87d8-881d201d8fa8",
              "parentNodeId": ""
            },
            "209b6ff3-926a-4e5f-83d8-97a5731003ef": {
              "id": "209b6ff3-926a-4e5f-83d8-97a5731003ef",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "2418a918-0a59-4429-ab4e-522b48851486": {
              "id": "2418a918-0a59-4429-ab4e-522b48851486",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "2a72a629-1bcc-4910-9adf-efb271f43a15": {
              "id": "2a72a629-1bcc-4910-9adf-efb271f43a15",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "37a0304d-f836-4d95-b39e-c800344822c7": {
              "id": "37a0304d-f836-4d95-b39e-c800344822c7",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "386a3b7d-72c1-4989-8ac7-49d668e36b4e": {
              "id": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "39730100-c4f1-49b7-acf9-7cfa6f53f6c8": {
              "id": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
              "parentNodeId": ""
            },
            "40cb415f-385e-4112-a02f-709646fc467e": {
              "id": "40cb415f-385e-4112-a02f-709646fc467e",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "58635117-4d0f-4f41-9bd6-d824a95867ba": {
              "id": "58635117-4d0f-4f41-9bd6-d824a95867ba",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "5f0ca425-a326-4a54-bf3e-7d976252caa7": {
              "id": "5f0ca425-a326-4a54-bf3e-7d976252caa7",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "721e875d-7460-4369-8bb5-60c70da053c7": {
              "id": "721e875d-7460-4369-8bb5-60c70da053c7",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "8030f309-b134-4a90-aab3-577dc9213cf7": {
              "id": "8030f309-b134-4a90-aab3-577dc9213cf7",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "892fd49f-e1ab-4130-9696-d05df39d7997": {
              "id": "892fd49f-e1ab-4130-9696-d05df39d7997",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "926f2d8b-5fc5-473b-8741-fd69b2aee7b8": {
              "id": "926f2d8b-5fc5-473b-8741-fd69b2aee7b8",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "99db80ee-511b-47b3-82d9-ea5bc5168f08": {
              "id": "99db80ee-511b-47b3-82d9-ea5bc5168f08",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "9f646b0c-55ab-4f9e-9b24-10bd69246b9a": {
              "id": "9f646b0c-55ab-4f9e-9b24-10bd69246b9a",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "a562607a-8f03-46c3-81c2-d253eb99070b": {
              "id": "a562607a-8f03-46c3-81c2-d253eb99070b",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "b1b9246d-8e0f-4fc5-986e-034040586ba7": {
              "id": "b1b9246d-8e0f-4fc5-986e-034040586ba7",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            },
            "bbcebfec-b733-4106-a9d7-995b0c37ba44": {
              "id": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "c0faa121-1c25-4477-8b7c-590b90787321": {
              "id": "c0faa121-1c25-4477-8b7c-590b90787321",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "c179d3b1-bc28-42e0-80e1-c562d0761cef": {
              "id": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "cf599e7a-1928-488f-be0b-c03afbe6e6dd": {
              "id": "cf599e7a-1928-488f-be0b-c03afbe6e6dd",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac": {
              "id": "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac",
              "parentNodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15"
            },
            "e04a53f1-43c7-41e9-b8c8-069a2acd56de": {
              "id": "e04a53f1-43c7-41e9-b8c8-069a2acd56de",
              "parentNodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e"
            },
            "e32ea6c8-9365-4283-a863-9a354d56dceb": {
              "id": "e32ea6c8-9365-4283-a863-9a354d56dceb",
              "parentNodeId": ""
            },
            "e423f975-9e30-4d03-aef0-de6dc5e77d98": {
              "id": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
              "parentNodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed"
            },
            "e970ce0c-5976-4b41-866b-34fa0c65a527": {
              "id": "e970ce0c-5976-4b41-866b-34fa0c65a527",
              "parentNodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb"
            },
            "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
              "id": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
              "parentNodeId": ""
            },
            "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d": {
              "id": "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d",
              "parentNodeId": "13b918db-b65a-42cb-97f4-832498591da1"
            }
          }
        },
        "steps": {
          "0e565ff0-8d8f-45f7-8d22-a64e150ee93e": {
            "nodeId": "0e565ff0-8d8f-45f7-8d22-a64e150ee93e",
            "name": "Malicious URL Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "4ef2fe69-e0e2-4a02-8b3e-759ef0367e91",
                "expression": {
                  "left": {
                    "name": "99db80ee-511b-47b3-82d9-ea5bc5168f08.report.malicious",
                    "type": "variable"
                  },
                  "op": "==",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "{{[99db80ee-511b-47b3-82d9-ea5bc5168f08].[report].[malicious]}} == true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "13b918db-b65a-42cb-97f4-832498591da1": {
            "nodeId": "13b918db-b65a-42cb-97f4-832498591da1",
            "name": "Analysis Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "2a72a629-1bcc-4910-9adf-efb271f43a15.is_malicious",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "AND",
                        "right": {
                          "left": {
                            "name": "2a72a629-1bcc-4910-9adf-efb271f43a15.is_malicious",
                            "type": "variable"
                          },
                          "op": "==",
                          "right": {
                            "type": "literal",
                            "value": true
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "left": {
                            "args": [
                              {
                                "name": "386a3b7d-72c1-4989-8ac7-49d668e36b4e.is_malicious",
                                "type": "variable"
                              }
                            ],
                            "name": "is_defined",
                            "type": "function"
                          },
                          "op": "AND",
                          "right": {
                            "left": {
                              "name": "386a3b7d-72c1-4989-8ac7-49d668e36b4e.is_malicious",
                              "type": "variable"
                            },
                            "op": "==",
                            "right": {
                              "type": "literal",
                              "value": true
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "op": "OR",
                        "right": {
                          "left": {
                            "args": [
                              {
                                "name": "19279ef7-3ff3-4228-ae2f-91eb49656fed.is_malicious",
                                "type": "variable"
                              }
                            ],
                            "name": "is_defined",
                            "type": "function"
                          },
                          "op": "AND",
                          "right": {
                            "left": {
                              "name": "19279ef7-3ff3-4228-ae2f-91eb49656fed.is_malicious",
                              "type": "variable"
                            },
                            "op": "==",
                            "right": {
                              "type": "literal",
                              "value": true
                            },
                            "type": "binary"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[2a72a629-1bcc-4910-9adf-efb271f43a15].[is_malicious]}}) && {{[2a72a629-1bcc-4910-9adf-efb271f43a15].[is_malicious]}} == true || is_defined({{[386a3b7d-72c1-4989-8ac7-49d668e36b4e].[is_malicious]}}) && {{[386a3b7d-72c1-4989-8ac7-49d668e36b4e].[is_malicious]}} == true || is_defined({{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[is_malicious]}}) && {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[is_malicious]}} == true",
                    "value": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item]}}",
                    "valueType": "object"
                  },
                  "name": "malicious_emails",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "d8245176-59e6-49e8-9e41-2995aa20188e",
              "nextEdgeId": "0e78c211-528a-437e-b1fd-9438972a3409",
              "repeatVariable": "{{[17edb1e0-ffca-4ff7-ad48-adbd19429a29].[icon_email].[flattened_attached_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "malicious_emails": {
                  "description": "Custom output: \"malicious_emails\"",
                  "items": {
                    "properties": {},
                    "type": "object"
                  },
                  "title": "malicious_emails",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "17edb1e0-ffca-4ff7-ad48-adbd19429a29": {
            "nodeId": "17edb1e0-ffca-4ff7-ad48-adbd19429a29",
            "name": "Office 365 New Email Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": true,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "{{[$workflow].[Mailbox ID]}}",
                "subject_query": "{{[$workflow].[Email Subject Query]}}"
              }
            },
            "triggerId": "c103fcec-5661-4194-8e3c-532c98a0756d",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": "",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "19279ef7-3ff3-4228-ae2f-91eb49656fed": {
            "nodeId": "19279ef7-3ff3-4228-ae2f-91eb49656fed",
            "name": "Attached File Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "name": "40cb415f-385e-4112-a02f-709646fc467e.found",
                        "type": "variable"
                      },
                      "op": "==",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[40cb415f-385e-4112-a02f-709646fc467e].[found]}} == true"
                  },
                  "name": "is_malicious",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "ae990a5e-f632-4c36-89e0-153b9371a353",
              "nextEdgeId": "ee900a2d-604a-4d95-ae02-a9bee97a4ab6",
              "repeatVariable": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item].[attached_files]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "is_malicious": {
                  "description": "Custom output: \"is_malicious\"",
                  "title": "is_malicious",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "1b82897d-95a2-4799-87d8-881d201d8fa8": {
            "nodeId": "1b82897d-95a2-4799-87d8-881d201d8fa8",
            "name": "# Remediation",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Remediation Goes Here\n\n(this artifact can be removed)\n\nAt this point in the workflow, we've established we have a malicious email. \n\nRemediation steps go on this branch of the flow. They can be email notifications, Slack notifications for human follow up. Remediation can also go further and block the sender and delete the email from your organization. \n\nIn this example, I will send a notification via email, and use the Office Admin plugin to both delete the email and block the sender from our organization. "
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "209b6ff3-926a-4e5f-83d8-97a5731003ef": {
            "nodeId": "209b6ff3-926a-4e5f-83d8-97a5731003ef",
            "name": "Check Domain Age",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.2.0/icon.png"
            },
            "identifier": "time_elapsed",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "first_time": "{{[926f2d8b-5fc5-473b-8741-fd69b2aee7b8].[creation_date]}}",
                "result_unit": "Days",
                "second_time": "{{[892fd49f-e1ab-4130-9696-d05df39d7997].[datetime]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "first_time": {
                  "description": "First date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "First Date",
                  "type": "string"
                },
                "result_unit": {
                  "description": "Time unit of measurement for result",
                  "enum": [
                    "Years",
                    "Months",
                    "Days",
                    "Hours",
                    "Minutes",
                    "Seconds"
                  ],
                  "order": 3,
                  "title": "Result Unit",
                  "type": "string"
                },
                "second_time": {
                  "description": "Second date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 2,
                  "title": "Second Date",
                  "type": "string"
                }
              },
              "required": [
                "first_time",
                "second_time",
                "result_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "difference": {
                  "description": "Quantity of time difference",
                  "order": 1,
                  "title": "Difference",
                  "type": "integer"
                },
                "time_unit": {
                  "description": "Time unit of measurement",
                  "order": 2,
                  "title": "Unit of Time",
                  "type": "string"
                }
              },
              "required": [
                "difference",
                "time_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "2418a918-0a59-4429-ab4e-522b48851486": {
            "nodeId": "2418a918-0a59-4429-ab4e-522b48851486",
            "name": "Extract URLs",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item].[body]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "2a72a629-1bcc-4910-9adf-efb271f43a15": {
            "nodeId": "2a72a629-1bcc-4910-9adf-efb271f43a15",
            "name": "URL Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "args": [
                          {
                            "name": "99db80ee-511b-47b3-82d9-ea5bc5168f08.report.malicious",
                            "type": "variable"
                          }
                        ],
                        "name": "is_defined",
                        "type": "function"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "99db80ee-511b-47b3-82d9-ea5bc5168f08.report.malicious",
                          "type": "variable"
                        },
                        "op": "==",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[99db80ee-511b-47b3-82d9-ea5bc5168f08].[report].[malicious]}}) && {{[99db80ee-511b-47b3-82d9-ea5bc5168f08].[report].[malicious]}} == true"
                  },
                  "name": "is_malicious",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "ed18d5d5-60ce-4070-961f-650467859b7f",
              "nextEdgeId": "cdbde14d-a4dd-4a2a-ba6f-7ccf7a449cf5",
              "repeatVariable": "{{[2418a918-0a59-4429-ab4e-522b48851486].[urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "is_malicious": {
                  "description": "Custom output: \"is_malicious\"",
                  "title": "is_malicious",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "37a0304d-f836-4d95-b39e-c800344822c7": {
            "nodeId": "37a0304d-f836-4d95-b39e-c800344822c7",
            "name": "Is URL Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
              "stepControlParams": [
                {
                  "edgeId": "47ce318a-ddd4-4320-a996-47c69945b1c0",
                  "expression": {
                    "left": {
                      "name": "99db80ee-511b-47b3-82d9-ea5bc5168f08.report.malicious",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[99db80ee-511b-47b3-82d9-ea5bc5168f08].[report].[malicious]}} == true"
                },
                {
                  "edgeId": "bb5192d3-bf05-4cf8-a407-f57f2c825b99",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "386a3b7d-72c1-4989-8ac7-49d668e36b4e": {
            "nodeId": "386a3b7d-72c1-4989-8ac7-49d668e36b4e",
            "name": "Domain Lookup Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "args": [
                          {
                            "name": "209b6ff3-926a-4e5f-83d8-97a5731003ef.difference",
                            "type": "variable"
                          }
                        ],
                        "name": "is_defined",
                        "type": "function"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "209b6ff3-926a-4e5f-83d8-97a5731003ef.difference",
                          "type": "variable"
                        },
                        "op": "<",
                        "right": {
                          "type": "literal",
                          "value": 30
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[209b6ff3-926a-4e5f-83d8-97a5731003ef].[difference]}}) && {{[209b6ff3-926a-4e5f-83d8-97a5731003ef].[difference]}} < 30"
                  },
                  "name": "is_malicious",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "38e4e865-49c5-4b48-8ce6-b78fff6f1ca3",
              "nextEdgeId": "71ad802a-ec8b-4ab9-95d1-90ac3357ebad",
              "repeatVariable": "{{[f780a80e-0b1d-4e4b-8cf6-f776f16ab35d].[domains]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "is_malicious": {
                  "description": "Custom output: \"is_malicious\"",
                  "title": "is_malicious",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "39730100-c4f1-49b7-acf9-7cfa6f53f6c8": {
            "nodeId": "39730100-c4f1-49b7-acf9-7cfa6f53f6c8",
            "name": "Email Not Malicious",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Email Not Malicious\n\nAfter checking the indicators within the email, and any attached emails and files, the workflow was unable to find any malicious indicators."
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "40cb415f-385e-4112-a02f-709646fc467e": {
            "nodeId": "40cb415f-385e-4112-a02f-709646fc467e",
            "name": "Check Hash",
            "type": "action",
            "plugin": {
              "name": "Hybrid Analysis",
              "slugVendor": "rapid7",
              "slugName": "hybrid_analysis",
              "slugVersion": "2.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hybrid_analysis/2.0.1/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[9f646b0c-55ab-4f9e-9b24-10bd69246b9a].[sha256]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 Hash",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "analysis_start_time": {
                      "order": 14,
                      "title": "Analysis Start Time",
                      "type": "string"
                    },
                    "compromised_hosts": {
                      "description": "Compromised Hosts",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Compromised Hosts",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 19,
                      "title": "Domains",
                      "type": "array"
                    },
                    "environmentDescription": {
                      "description": "Environment Description",
                      "order": 6,
                      "title": "EnvironmentDescription",
                      "type": "string"
                    },
                    "environment_id": {
                      "description": "Environment ID",
                      "order": 1,
                      "title": "Environment Id",
                      "type": "string"
                    },
                    "hosts": {
                      "description": "Hosts",
                      "items": {
                        "type": "string"
                      },
                      "order": 20,
                      "title": "Hosts",
                      "type": "array"
                    },
                    "isinteresting": {
                      "description": "Is Interesting",
                      "order": 16,
                      "title": "Isinteresting",
                      "type": "boolean"
                    },
                    "isurlanalysis": {
                      "order": 13,
                      "title": "Isurlanalysis",
                      "type": "boolean"
                    },
                    "md5": {
                      "description": "MD5",
                      "order": 3,
                      "title": "Md5",
                      "type": "string"
                    },
                    "multiscan_detectrate_pcnt": {
                      "order": 10,
                      "title": "Multiscan Detectrate Pcnt",
                      "type": "number"
                    },
                    "sha1": {
                      "description": "SHA1",
                      "order": 2,
                      "title": "Sha1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256",
                      "order": 4,
                      "title": "Sha256",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size",
                      "order": 7,
                      "title": "Size",
                      "type": "integer"
                    },
                    "submitname": {
                      "description": "Submission Name",
                      "order": 5,
                      "title": "Submitname",
                      "type": "string"
                    },
                    "targeturl": {
                      "description": "Target URL",
                      "order": 9,
                      "title": "Targeturl",
                      "type": "string"
                    },
                    "threatlevel": {
                      "description": "Threat Level",
                      "order": 17,
                      "title": "Threatlevel",
                      "type": "integer"
                    },
                    "threatscore": {
                      "order": 15,
                      "title": "Threatscore",
                      "type": "integer"
                    },
                    "type": {
                      "description": "ASCII Text",
                      "order": 8,
                      "title": "Type",
                      "type": "string"
                    },
                    "virustotal_detectrate_pcnt": {
                      "description": "VT Detect Rate Percent",
                      "order": 12,
                      "title": "Virustotal Detectrate Pcnt",
                      "type": "number"
                    },
                    "virustotal_familyname": {
                      "description": "VT Family Name",
                      "order": 11,
                      "title": "Virustotal Familyname",
                      "type": "string"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 1,
                  "title": "Found",
                  "type": "boolean"
                },
                "reports": {
                  "description": "Reports",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 3,
                  "title": "Reports",
                  "type": "array"
                },
                "threatscore": {
                  "description": "Threat Score (max found)",
                  "order": 2,
                  "title": "Threatscore",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "58635117-4d0f-4f41-9bd6-d824a95867ba": {
            "nodeId": "58635117-4d0f-4f41-9bd6-d824a95867ba",
            "name": "Domain Age Under 30 Days",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "0002c613-39c2-47c0-8538-4c5dfa852132",
              "stepControlParams": [
                {
                  "edgeId": "0002c613-39c2-47c0-8538-4c5dfa852132",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "1657948c-0208-4256-9dd2-c8f9e577a4ac",
                  "expression": {
                    "left": {
                      "name": "209b6ff3-926a-4e5f-83d8-97a5731003ef.difference",
                      "type": "variable"
                    },
                    "op": "<",
                    "right": {
                      "type": "literal",
                      "value": 30
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[209b6ff3-926a-4e5f-83d8-97a5731003ef].[difference]}} < 30"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "5f0ca425-a326-4a54-bf3e-7d976252caa7": {
            "nodeId": "5f0ca425-a326-4a54-bf3e-7d976252caa7",
            "name": "Virus Total Domain Report",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[386a3b7d-72c1-4989-8ac7-49d668e36b4e].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "categories": {
                      "description": "Mapping that relates categorization services with the assigned domain category. These services are, among others: Alexa, BitDefender, TrendMicro, Websense ThreatSeeker, etc.",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Creation date extracted from the Domain's WHOIS (UTC timestamp)",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the domain's favicon",
                      "order": 3,
                      "title": "Favicon"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 4,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 5,
                      "title": "Last Analysis Statistics"
                    },
                    "last_dns_records": {
                      "description": "Domain's DNS records on its last scan",
                      "items": {
                        "$ref": "#/definitions/last_dns_records"
                      },
                      "order": 6,
                      "title": "Last DNS Records",
                      "type": "array"
                    },
                    "last_dns_records_date": {
                      "description": "Date when the DNS records list was retrieved by VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "Last DNS Records Date",
                      "type": "integer"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL certificate object retrieved last time the domain was analyzed",
                      "order": 8,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 9,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the domain's information was last updated",
                      "order": 10,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_update_date": {
                      "description": "Updated date extracted from WHOIS (UTC timestamp)",
                      "order": 11,
                      "title": "Last Update Date",
                      "type": "integer"
                    },
                    "popularity_ranks": {
                      "$ref": "#/definitions/popularity_ranks",
                      "description": "Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo, etc.",
                      "order": 12,
                      "title": "Popularity Ranks"
                    },
                    "registrar": {
                      "description": "Company that registered the domain",
                      "order": 13,
                      "title": "Registrar",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "Domain's score calculated from the votes of the VirusTotal's community",
                      "order": 14,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 16,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 17,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 18,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "last_dns_records": {
                  "properties": {
                    "expire": {
                      "description": "Expire",
                      "order": 1,
                      "title": "Expire",
                      "type": "integer"
                    },
                    "flag": {
                      "description": "Flag",
                      "order": 2,
                      "title": "Flag",
                      "type": "integer"
                    },
                    "minimum": {
                      "description": "Minimum",
                      "order": 3,
                      "title": "Minimum",
                      "type": "integer"
                    },
                    "priority": {
                      "description": "Priority",
                      "order": 4,
                      "title": "Priority",
                      "type": "integer"
                    },
                    "refresh": {
                      "description": "Refresh",
                      "order": 5,
                      "title": "Refresh",
                      "type": "integer"
                    },
                    "retry": {
                      "description": "Retry",
                      "order": 7,
                      "title": "Retry",
                      "type": "integer"
                    },
                    "rname": {
                      "description": "RNAME",
                      "order": 6,
                      "title": "RNAME",
                      "type": "string"
                    },
                    "serial": {
                      "description": "Serial",
                      "order": 8,
                      "title": "Serial",
                      "type": "integer"
                    },
                    "tag": {
                      "description": "Tag",
                      "order": 9,
                      "title": "Tag",
                      "type": "string"
                    },
                    "ttl": {
                      "description": "Time to live",
                      "order": 10,
                      "title": "TTL",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type",
                      "order": 11,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 12,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Last Dns Records",
                  "type": "object"
                },
                "popularity_ranks": {
                  "properties": {
                    "rank": {
                      "description": "Rank position",
                      "order": 1,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "UTC timestamp when the rank was ingested",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Popularity Ranks",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "721e875d-7460-4369-8bb5-60c70da053c7": {
            "nodeId": "721e875d-7460-4369-8bb5-60c70da053c7",
            "name": "Malicious Email Details",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious Email found\nThe following attached email was found to be malicious. \n\nFrom: {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\n\nSubject: {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "8030f309-b134-4a90-aab3-577dc9213cf7": {
            "nodeId": "8030f309-b134-4a90-aab3-577dc9213cf7",
            "name": "Malicious URL Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Malicious URL Found\n\nURL: {{[2a72a629-1bcc-4910-9adf-efb271f43a15].[$item]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "892fd49f-e1ab-4130-9696-d05df39d7997": {
            "nodeId": "892fd49f-e1ab-4130-9696-d05df39d7997",
            "name": "Get Current Date Time",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.2.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.2.0/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "926f2d8b-5fc5-473b-8741-fd69b2aee7b8": {
            "nodeId": "926f2d8b-5fc5-473b-8741-fd69b2aee7b8",
            "name": "Domain Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.0/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[386a3b7d-72c1-4989-8ac7-49d668e36b4e].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "99db80ee-511b-47b3-82d9-ea5bc5168f08": {
            "nodeId": "99db80ee-511b-47b3-82d9-ea5bc5168f08",
            "name": "Get Result",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[2a72a629-1bcc-4910-9adf-efb271f43a15].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "malicious": {
                      "order": 25,
                      "title": "Malicious",
                      "type": "boolean"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "9f646b0c-55ab-4f9e-9b24-10bd69246b9a": {
            "nodeId": "9f646b0c-55ab-4f9e-9b24-10bd69246b9a",
            "name": "HashIT",
            "type": "action",
            "plugin": {
              "name": "HashIt",
              "slugVendor": "rapid7",
              "slugName": "hashit",
              "slugVersion": "2.0.4",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/hashit/2.0.4/icon.png"
            },
            "identifier": "bytes",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "bytes": "{{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "bytes": {
                  "description": "Base64 encoded file bytes to hash",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Bytes",
                  "type": "string"
                }
              },
              "required": [
                "bytes"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5 Hash",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1 Hash",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256 Hash",
                  "type": "string"
                },
                "sha512": {
                  "description": "SHA512 hash",
                  "order": 4,
                  "title": "SHA512 Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a562607a-8f03-46c3-81c2-d253eb99070b": {
            "nodeId": "a562607a-8f03-46c3-81c2-d253eb99070b",
            "name": "Malicious File Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# Malicious File Found: \n\nName: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[file_name]}}\nType: {{[19279ef7-3ff3-4228-ae2f-91eb49656fed].[$item].[content_type]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "b1b9246d-8e0f-4fc5-986e-034040586ba7": {
            "nodeId": "b1b9246d-8e0f-4fc5-986e-034040586ba7",
            "name": "Extract URLs from Headers",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[13b918db-b65a-42cb-97f4-832498591da1].[$item].[headers]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "bbcebfec-b733-4106-a9d7-995b0c37ba44": {
            "nodeId": "bbcebfec-b733-4106-a9d7-995b0c37ba44",
            "name": "Block Sender from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.2.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.2.3/icon.png"
            },
            "identifier": "block_sender_transport_rule",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain_or_email_to_block": "{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}",
                "transport_rule_name": "Block {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain_or_email_to_block": {
                  "description": "Domain or email address to block",
                  "order": 1,
                  "title": "Domain or Email to Block",
                  "type": "string"
                },
                "transport_rule_name": {
                  "default": "InsightConnect Block List",
                  "description": "Transport rule name",
                  "order": 2,
                  "title": "Transport Rule Name",
                  "type": "string"
                }
              },
              "required": [
                "domain_or_email_to_block",
                "transport_rule_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result": {
                  "description": "Result",
                  "order": 1,
                  "title": "Result",
                  "type": "string"
                }
              },
              "required": [
                "result"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c0faa121-1c25-4477-8b7c-590b90787321": {
            "nodeId": "c0faa121-1c25-4477-8b7c-590b90787321",
            "name": "Is File Malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
              "stepControlParams": [
                {
                  "edgeId": "6a85734f-8b71-4e7f-a5ce-00144e61a93e",
                  "expression": {
                    "left": {
                      "name": "40cb415f-385e-4112-a02f-709646fc467e.found",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[40cb415f-385e-4112-a02f-709646fc467e].[found]}} == true"
                },
                {
                  "edgeId": "a1342d47-eacd-4e99-8e0e-fd526916be0f",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c179d3b1-bc28-42e0-80e1-c562d0761cef": {
            "nodeId": "c179d3b1-bc28-42e0-80e1-c562d0761cef",
            "name": "Send Notification Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.0/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": [],
                "bcc": [],
                "body": "The following attached email was found to be malicious. \n\nEmail From:\n{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\n\nEmail Subject:\n{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}\n\nJob URL:\n{{[$job].[URL]}}",
                "cc": [],
                "email_from": "change_me",
                "email_to": [
                  "change_me"
                ],
                "is_html": false,
                "subject": "Malicious Email Found"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "description": "Accepts one or more attachment represented as a file type which contains the filename and the file content encoded with base64",
                  "items": {
                    "$ref": "#/definitions/file"
                  },
                  "order": 8,
                  "title": "Attachment",
                  "type": "array"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "One or more email addresses of recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Email To",
                  "type": "array"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "cf599e7a-1928-488f-be0b-c03afbe6e6dd": {
            "nodeId": "cf599e7a-1928-488f-be0b-c03afbe6e6dd",
            "name": "Malicious Domain Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "5c7108aa-a930-49f6-8ba3-76e79e364b73",
                "expression": {
                  "left": {
                    "name": "209b6ff3-926a-4e5f-83d8-97a5731003ef.difference",
                    "type": "variable"
                  },
                  "op": "<",
                  "right": {
                    "type": "literal",
                    "value": 30
                  },
                  "type": "binary"
                },
                "expressionText": "{{[209b6ff3-926a-4e5f-83d8-97a5731003ef].[difference]}} < 30"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac": {
            "nodeId": "d9dfe953-1380-44d4-a7e1-78d0de8fa4ac",
            "name": "VirusTotal Scan URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "7.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/7.0.0/icon.png"
            },
            "identifier": "scan_url",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[2a72a629-1bcc-4910-9adf-efb271f43a15].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL to scan",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "submission_response": {
                  "properties": {
                    "id": {
                      "description": "Submission ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "type": {
                      "description": "Submission type",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Submission Response",
                  "type": "object"
                }
              },
              "properties": {
                "submission_response": {
                  "$ref": "#/definitions/submission_response",
                  "description": "URL submission response",
                  "order": 1,
                  "title": "Submission Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "e04a53f1-43c7-41e9-b8c8-069a2acd56de": {
            "nodeId": "e04a53f1-43c7-41e9-b8c8-069a2acd56de",
            "name": "Domain Look-up Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Domain Look-up Report\n\n**Domain Name**: {{[926f2d8b-5fc5-473b-8741-fd69b2aee7b8].[name]}}\n\n**Registrar**: {{[926f2d8b-5fc5-473b-8741-fd69b2aee7b8].[registrar]}}\n\n**Creation Date**: {{[926f2d8b-5fc5-473b-8741-fd69b2aee7b8].[creation_date]}}\n\n**Days Since Domain created**: {{[209b6ff3-926a-4e5f-83d8-97a5731003ef].[difference]}}\n\n**WhoIs Report**:\n{{[5f0ca425-a326-4a54-bf3e-7d976252caa7].[report].[whois]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "e32ea6c8-9365-4283-a863-9a354d56dceb": {
            "nodeId": "e32ea6c8-9365-4283-a863-9a354d56dceb",
            "name": "Remediate Malicious Emails",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "82200da4-4655-4acf-aa29-d5ce4cccf079",
              "nextEdgeId": "8e53d640-6d8f-421c-ab3f-28ef741bc091",
              "repeatVariable": "{{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "e423f975-9e30-4d03-aef0-de6dc5e77d98": {
            "nodeId": "e423f975-9e30-4d03-aef0-de6dc5e77d98",
            "name": "Break on Malicious File",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "d5481036-02f9-4c2d-90bc-90896072b477",
                "expression": {
                  "left": {
                    "name": "40cb415f-385e-4112-a02f-709646fc467e.found",
                    "type": "variable"
                  },
                  "op": "==",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "{{[40cb415f-385e-4112-a02f-709646fc467e].[found]}} == true"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "e970ce0c-5976-4b41-866b-34fa0c65a527": {
            "nodeId": "e970ce0c-5976-4b41-866b-34fa0c65a527",
            "name": "Purge Email from Org",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.2.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.2.3/icon.png"
            },
            "identifier": "mass_search_and_purge",
            "continueOnFailure": false,
            "isDisabled": true,
            "isCloud": false,
            "parameters": {
              "input": {
                "compliance_search_name": "Search for {{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}",
                "content_match_query": "subject: \"{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[subject]}}\" from: \"{{[e32ea6c8-9365-4283-a863-9a354d56dceb].[$item].[sender]}}\"",
                "delete_items": true,
                "query_timeout": 60
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "compliance_search_name": {
                  "description": "Name of compliance search",
                  "order": 1,
                  "title": "Compliance Search Name",
                  "type": "string"
                },
                "content_match_query": {
                  "description": "This parameter uses a text search string or a query that's formatted by using the Keyword Query Language (KQL). For more information about KQL, see Keyword Query Language syntax reference (https://go.microsoft.com/fwlink/p/?linkid=269603)",
                  "order": 2,
                  "title": "Content Match Query",
                  "type": "string"
                },
                "delete_items": {
                  "default": false,
                  "description": "The script only executes the delete action if this parameter is true",
                  "order": 4,
                  "title": "Delete Items",
                  "type": "boolean"
                },
                "query_timeout": {
                  "default": 60,
                  "description": "Query timeout in minutes",
                  "order": 3,
                  "title": "Query Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "compliance_search_name",
                "content_match_query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f15c9ec4-4e01-4647-91cb-b84e04cdc67c": {
            "nodeId": "f15c9ec4-4e01-4647-91cb-b84e04cdc67c",
            "name": "Was overall mail malicious",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "7885e52a-a487-4510-9364-751a0efcff17",
              "stepControlParams": [
                {
                  "edgeId": "7885e52a-a487-4510-9364-751a0efcff17",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "fceaae38-58dd-4400-96b9-582929fcc93f",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "13b918db-b65a-42cb-97f4-832498591da1.malicious_emails",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "13b918db-b65a-42cb-97f4-832498591da1.malicious_emails",
                        "type": "variable"
                      },
                      "op": "!=",
                      "right": {
                        "elements": [],
                        "type": "array"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "is_defined({{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}}) && {{[13b918db-b65a-42cb-97f4-832498591da1].[malicious_emails]}} != []"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d": {
            "nodeId": "f780a80e-0b1d-4e4b-8cf6-f776f16ab35d",
            "name": "Extract Header Domains",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "domain_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[b1b9246d-8e0f-4fc5-986e-034040586ba7].[urls]}}",
                "subdomain": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                },
                "subdomain": {
                  "description": "Include subdomain in result",
                  "order": 3,
                  "title": "Subdomain",
                  "type": "boolean"
                }
              },
              "required": [
                "subdomain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "domains": {
                  "description": "List of extracted Domain names",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domain Names",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          }
        },
        "tags": [
          "Microsoft",
          "Phishing",
          "Threat Intelligence",
          "Virustotal",
          "Whois"
        ],
        "humanCostSeconds": 10800,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Mailbox ID": {
                "type": "string",
                "description": "Name of the mailbox to monitor, eg. example@hotmail.com"
              },
              "Email Subject Query": {
                "type": "string",
                "description": "Regex-capable subject for emails to trigger on"
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "c103fcec-5661-4194-8e3c-532c98a0756d",
        "identifier": "email_received",
        "name": "Office 365 New Email Trigger",
        "description": "",
        "input": {
          "flatten_attachments": true,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "{{[$workflow].[Mailbox ID]}}",
          "subject_query": "{{[$workflow].[Email Subject Query]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email e.g. bob@hotmail.com",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": "",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "file_name": {
                  "order": 1,
                  "title": "File Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "4.0.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.0.0/icon.png"
        }
      }
    ]
  }
}