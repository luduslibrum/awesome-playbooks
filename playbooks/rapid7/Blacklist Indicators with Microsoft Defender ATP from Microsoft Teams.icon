{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T10:16:29.65624577Z",
    "workflowVersions": [
      {
        "name": "Blacklist Indicators with Microsoft Defender ATP from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nBlacklist or unblacklist indicators with Microsoft Defender ATP via Microsoft Teams command and report information back to Microsoft Teams.\nIndicators supported in this workflow are SHA1 hashes, SHA256 hashes, IPv4 addresses, IPv6 addresses, URLs, and domains.\n\n**Note**: Microsoft Defender ATP does not support MD5 hashes. \n\nMultiple indicators can be specified within a single command.\n\nSample Microsoft Teams Trigger Commands:\n\n`!blacklist-indicators 08518B71617EB0B46C053F3766069649F664E9A3FBACA168D6A861FBEC870082`\n\n`!blacklist-indicators 9.9.9.9 aadroid.net CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A90`\n\n`!unblacklist-indicators 08518B71617EB0B46C053F3766069649F664E9A3FBACA168D6A861FBEC870082`\n\n`!unblacklist-indicators 9.9.9.9 aadroid.net CF80CD8AED482D5D1527D7DC72FCEFF84E6326592848447D2DC0B0E87DFC9A90`\n\nThe indicators will show up in the \"Indicators\" list within Settings in the Microsoft Defender Security Center. They will be sorted by indicator type (file hash, IP addresses, URLs/domains).\n\n# Key Features\n\n* Blacklist indicators from Microsoft Teams\n\n# Requirements\n\n* [Microsoft Teams](https://docs.rapid7.com/insightconnect/microsoft-teams/)\n* [Microsoft Security ATP](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/minimum-requirements)\n\n# Documentation\n\n## Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\nOnce the workflow has been imported, **the first Microsoft Teams step will need the team name and channel name updated to suit your Microsoft Teams environment!** Edit the input with the preset text of `change_me` in the first Microsoft Teams step in the workflow.\n\nAdditionally, in order to use the Microsoft Defender ATP blacklist action, create a connection using your Application ID, Directory ID and Secret Key from Microsoft Defender ATP. \nYou may also have to create a connection to Microsoft Teams, using your Secret Key, Application ID, Directory ID and username/password credentials\n\nAfter configuring the steps, activate the workflow in order to trigger it. \n \n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Microsoft Windows Defender ATP|4.4.0|2|\n|Datetime|2.0.6|2|\n|Type Converter|1.6.0|2|\n|Microsoft Teams|3.1.0|6|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.0.2 - Update keywords | Update description in .icon file\n* 1.0.1 - Update Microsoft Teams to version 3.1.0 | Update documentation\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Defender ATP](https://docs.microsoft.com/en-us/windows/security/threat-protection/)\n* [Microsoft Defender Security Center](https://securitycenter.windows.com/)\n* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-365/microsoft-teams/group-chat-software)\n* [Microsoft Teams Plugin](https://docs.rapid7.com/insightconnect/microsoft-teams/)\n",
        "graph": {
          "edges": {
            "109f03bc-1d9f-4b8b-9287-4ba32f881ebb": {
              "id": "109f03bc-1d9f-4b8b-9287-4ba32f881ebb",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "1b8eb660-2521-477c-bf87-fb3874e42805",
              "toNodeId": "46f49ad5-a076-4064-815f-95906da7e7f6"
            },
            "11fcb961-f4d2-4e3a-97ee-b4ee7638f60a": {
              "id": "11fcb961-f4d2-4e3a-97ee-b4ee7638f60a",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "toNodeId": "133954a8-e24d-4e0e-bb95-bea85414cc70"
            },
            "1fe0a263-8a04-4f1c-9332-725d47a7c380": {
              "id": "1fe0a263-8a04-4f1c-9332-725d47a7c380",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "46f49ad5-a076-4064-815f-95906da7e7f6",
              "toNodeId": "a05dc55a-3e28-4744-9575-922efe0b34bf"
            },
            "27c5f32b-d618-41ab-8ec2-f2cdc75605b8": {
              "id": "27c5f32b-d618-41ab-8ec2-f2cdc75605b8",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "f661e858-4b00-4ece-8461-f4911c018924",
              "toNodeId": ""
            },
            "2f22b84f-9dd6-46c7-bd27-43a93f03b987": {
              "id": "2f22b84f-9dd6-46c7-bd27-43a93f03b987",
              "name": "Failure",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "a05dc55a-3e28-4744-9575-922efe0b34bf",
              "toNodeId": "a6ef9a13-3ba2-4604-acda-5b71375aac60"
            },
            "366c45dd-ca10-4f99-8078-95c6eed7c6a7": {
              "id": "366c45dd-ca10-4f99-8078-95c6eed7c6a7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1f8c626d-a56e-435d-a74e-6583801475e9",
              "toNodeId": "b0359d40-34c5-402e-abc6-19157d78bd0a"
            },
            "3cb04b59-73f8-44fd-a0a5-ebe55697cae2": {
              "id": "3cb04b59-73f8-44fd-a0a5-ebe55697cae2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "toNodeId": "dff40251-27d4-4bd5-a8e8-721b2ddd55a7"
            },
            "52af924b-cf63-46c6-a46b-d9a9681c255e": {
              "id": "52af924b-cf63-46c6-a46b-d9a9681c255e",
              "name": "Blacklist",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "133954a8-e24d-4e0e-bb95-bea85414cc70",
              "toNodeId": "1b8eb660-2521-477c-bf87-fb3874e42805"
            },
            "55fe24e5-1670-4653-996b-ba17f89e3bb8": {
              "id": "55fe24e5-1670-4653-996b-ba17f89e3bb8",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "864d0e2a-072e-4d6d-8c80-96f2f1ae0027",
              "toNodeId": "46f49ad5-a076-4064-815f-95906da7e7f6"
            },
            "5b87a5ab-576c-4460-a044-8b298b083a99": {
              "id": "5b87a5ab-576c-4460-a044-8b298b083a99",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5bba0f0e-af49-4098-94e3-898c1efdaeb3",
              "toNodeId": "14dd424a-5a69-4119-94a4-b2940cae783d"
            },
            "6781b42b-c5ca-4cbe-971d-2d25b0e319ab": {
              "id": "6781b42b-c5ca-4cbe-971d-2d25b0e319ab",
              "name": "Unblacklist",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "133954a8-e24d-4e0e-bb95-bea85414cc70",
              "toNodeId": "864d0e2a-072e-4d6d-8c80-96f2f1ae0027"
            },
            "6ef8a020-97ef-4de2-b3c4-d7767a011590": {
              "id": "6ef8a020-97ef-4de2-b3c4-d7767a011590",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e",
              "toNodeId": ""
            },
            "79d808bb-3b2a-46b9-8f36-6d227e03c26f": {
              "id": "79d808bb-3b2a-46b9-8f36-6d227e03c26f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "14dd424a-5a69-4119-94a4-b2940cae783d",
              "toNodeId": "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c"
            },
            "8608e8ca-0635-4cb7-99be-1b0f326e1614": {
              "id": "8608e8ca-0635-4cb7-99be-1b0f326e1614",
              "name": "No",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "692cf210-d453-4d75-a302-aadba0f0eaec",
              "toNodeId": "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e"
            },
            "8bc86b5a-a19e-4019-9465-b5746983306d": {
              "id": "8bc86b5a-a19e-4019-9465-b5746983306d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b0359d40-34c5-402e-abc6-19157d78bd0a",
              "toNodeId": "a2217d01-ebac-447e-be2c-07f5505c7043"
            },
            "90edfd1c-c2f9-4e6e-99e1-3bc3c42e2c64": {
              "id": "90edfd1c-c2f9-4e6e-99e1-3bc3c42e2c64",
              "name": "Success",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "a05dc55a-3e28-4744-9575-922efe0b34bf",
              "toNodeId": "f661e858-4b00-4ece-8461-f4911c018924"
            },
            "b9c9adb7-afc5-4346-aa79-b51be8061264": {
              "id": "b9c9adb7-afc5-4346-aa79-b51be8061264",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dff40251-27d4-4bd5-a8e8-721b2ddd55a7",
              "toNodeId": ""
            },
            "c7ce4180-e0ff-404d-8d85-fec7d865c18b": {
              "id": "c7ce4180-e0ff-404d-8d85-fec7d865c18b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c",
              "toNodeId": "1f8c626d-a56e-435d-a74e-6583801475e9"
            },
            "d14ac002-e5bb-4eb4-9e21-d9d9efd19d35": {
              "id": "d14ac002-e5bb-4eb4-9e21-d9d9efd19d35",
              "name": "Yes",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "692cf210-d453-4d75-a302-aadba0f0eaec",
              "toNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "d7d95554-1134-4e4b-aee1-0cd20d591342": {
              "id": "d7d95554-1134-4e4b-aee1-0cd20d591342",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a2217d01-ebac-447e-be2c-07f5505c7043",
              "toNodeId": "692cf210-d453-4d75-a302-aadba0f0eaec"
            },
            "f95b8a1d-8c3d-46a8-90e7-a5db978e4d1a": {
              "id": "f95b8a1d-8c3d-46a8-90e7-a5db978e4d1a",
              "name": "",
              "description": "",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
              "fromNodeId": "a6ef9a13-3ba2-4604-acda-5b71375aac60",
              "toNodeId": ""
            }
          },
          "nodes": {
            "133954a8-e24d-4e0e-bb95-bea85414cc70": {
              "id": "133954a8-e24d-4e0e-bb95-bea85414cc70",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "14dd424a-5a69-4119-94a4-b2940cae783d": {
              "id": "14dd424a-5a69-4119-94a4-b2940cae783d",
              "parentNodeId": ""
            },
            "1b8eb660-2521-477c-bf87-fb3874e42805": {
              "id": "1b8eb660-2521-477c-bf87-fb3874e42805",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "1f8c626d-a56e-435d-a74e-6583801475e9": {
              "id": "1f8c626d-a56e-435d-a74e-6583801475e9",
              "parentNodeId": ""
            },
            "46f49ad5-a076-4064-815f-95906da7e7f6": {
              "id": "46f49ad5-a076-4064-815f-95906da7e7f6",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "5bba0f0e-af49-4098-94e3-898c1efdaeb3": {
              "id": "5bba0f0e-af49-4098-94e3-898c1efdaeb3",
              "parentNodeId": ""
            },
            "692cf210-d453-4d75-a302-aadba0f0eaec": {
              "id": "692cf210-d453-4d75-a302-aadba0f0eaec",
              "parentNodeId": ""
            },
            "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e": {
              "id": "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e",
              "parentNodeId": ""
            },
            "864d0e2a-072e-4d6d-8c80-96f2f1ae0027": {
              "id": "864d0e2a-072e-4d6d-8c80-96f2f1ae0027",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "a05dc55a-3e28-4744-9575-922efe0b34bf": {
              "id": "a05dc55a-3e28-4744-9575-922efe0b34bf",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "a2217d01-ebac-447e-be2c-07f5505c7043": {
              "id": "a2217d01-ebac-447e-be2c-07f5505c7043",
              "parentNodeId": ""
            },
            "a6ef9a13-3ba2-4604-acda-5b71375aac60": {
              "id": "a6ef9a13-3ba2-4604-acda-5b71375aac60",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            },
            "b0359d40-34c5-402e-abc6-19157d78bd0a": {
              "id": "b0359d40-34c5-402e-abc6-19157d78bd0a",
              "parentNodeId": ""
            },
            "b8f32920-8289-4162-9809-eba176e4d79e": {
              "id": "b8f32920-8289-4162-9809-eba176e4d79e",
              "parentNodeId": ""
            },
            "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c": {
              "id": "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c",
              "parentNodeId": ""
            },
            "dff40251-27d4-4bd5-a8e8-721b2ddd55a7": {
              "id": "dff40251-27d4-4bd5-a8e8-721b2ddd55a7",
              "parentNodeId": ""
            },
            "f661e858-4b00-4ece-8461-f4911c018924": {
              "id": "f661e858-4b00-4ece-8461-f4911c018924",
              "parentNodeId": "b8f32920-8289-4162-9809-eba176e4d79e"
            }
          }
        },
        "steps": {
          "133954a8-e24d-4e0e-bb95-bea85414cc70": {
            "nodeId": "133954a8-e24d-4e0e-bb95-bea85414cc70",
            "name": "Blacklist or Unblacklist?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "52af924b-cf63-46c6-a46b-d9a9681c255e",
              "stepControlParams": [
                {
                  "edgeId": "52af924b-cf63-46c6-a46b-d9a9681c255e",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "6781b42b-c5ca-4cbe-971d-2d25b0e319ab",
                  "expression": {
                    "left": {
                      "name": "5bba0f0e-af49-4098-94e3-898c1efdaeb3.message.first_word",
                      "type": "variable"
                    },
                    "op": "==",
                    "right": {
                      "type": "literal",
                      "value": "!unblacklist-indicators"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[first_word]}} == \"!unblacklist-indicators\""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "14dd424a-5a69-4119-94a4-b2940cae783d": {
            "nodeId": "14dd424a-5a69-4119-94a4-b2940cae783d",
            "name": "Post Command Received",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[channel_name]}}",
                "message_content": "🚀 &ensp;<b>Starting Workflow!</b>&ensp;🚀<br>\n<br>\n\nCommand: {{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[first_word]}}",
                "team_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[team_name]}}",
                "thread_id": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1b8eb660-2521-477c-bf87-fb3874e42805": {
            "nodeId": "1b8eb660-2521-477c-bf87-fb3874e42805",
            "name": "Blacklist Indicator",
            "type": "action",
            "plugin": {
              "name": "Microsoft Windows Defender ATP",
              "slugVendor": "rapid7",
              "slugName": "microsoft_atp",
              "slugVersion": "4.4.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_atp/4.4.0/icon.png"
            },
            "identifier": "blacklist",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "AlertAndBlock",
                "application": "",
                "description": "Blacklisted {{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}} from Microsoft Teams using insightConnect workflow",
                "expiration_time": "{{[1f8c626d-a56e-435d-a74e-6583801475e9].[date]}}",
                "indicator": "{{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}",
                "indicator_state": true,
                "rbac_group_names": [],
                "recommended_actions": "",
                "severity": "High",
                "title": "Blacklist {{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "default": "AlertAndBlock",
                  "description": "The action that will be taken if the indicator will be discovered in the organization",
                  "enum": [
                    "Alert",
                    "AlertAndBlock",
                    "Allowed"
                  ],
                  "order": 2,
                  "title": "Action",
                  "type": "string"
                },
                "application": {
                  "description": "The application associated with the indicator",
                  "order": 3,
                  "title": "Application",
                  "type": "string"
                },
                "description": {
                  "description": "Description of the indicator",
                  "order": 5,
                  "title": "Description",
                  "type": "string"
                },
                "expiration_time": {
                  "description": "The expiration time of the indicator",
                  "order": 6,
                  "title": "Expiration Time",
                  "type": "string"
                },
                "indicator": {
                  "description": "A supported indicator to blacklist or unblacklist. Supported indicators are IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                  "order": 1,
                  "title": "Indicator",
                  "type": "string"
                },
                "indicator_state": {
                  "default": false,
                  "description": "True to add indicator, false to remove it from the list",
                  "order": 10,
                  "title": "Indicator State",
                  "type": "boolean"
                },
                "rbac_group_names": {
                  "description": "List of RBAC group names the indicator would be applied to",
                  "items": {
                    "type": "string"
                  },
                  "order": 9,
                  "title": "RBAC Group Names",
                  "type": "array"
                },
                "recommended_actions": {
                  "description": "TI indicator alert recommended actions",
                  "order": 8,
                  "title": "Recommended Actions",
                  "type": "string"
                },
                "severity": {
                  "default": "High",
                  "description": "The severity of the indicator",
                  "enum": [
                    "Informational",
                    "Low",
                    "Medium",
                    "High"
                  ],
                  "order": 7,
                  "title": "Severity",
                  "type": "string"
                },
                "title": {
                  "description": "Indicator alert title",
                  "order": 4,
                  "title": "Title",
                  "type": "string"
                }
              },
              "required": [
                "indicator"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "indicator_action": {
                  "properties": {
                    "@odata.context": {
                      "description": "@odata.context",
                      "order": 1,
                      "title": "@Odata.Context",
                      "type": "string"
                    },
                    "action": {
                      "description": "The action that will be taken if the indicator will be discovered in the organization",
                      "order": 6,
                      "title": "Action",
                      "type": "string"
                    },
                    "application": {
                      "description": "The application associated with the indicator",
                      "order": 5,
                      "title": "Application",
                      "type": "string"
                    },
                    "createdBy": {
                      "description": "Unique identity of the user/application that submitted the indicator",
                      "order": 9,
                      "title": "Created By",
                      "type": "string"
                    },
                    "createdByDisplayName": {
                      "description": "Created by display name",
                      "order": 10,
                      "title": "Created By Display Name",
                      "type": "string"
                    },
                    "createdBySource": {
                      "description": "Created by source",
                      "order": 11,
                      "title": "Created By Source",
                      "type": "string"
                    },
                    "creationTimeDateTimeUtc": {
                      "description": "The date and time when the indicator was created",
                      "order": 16,
                      "title": "Creation Time",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description of the indicator",
                      "order": 21,
                      "title": "Description",
                      "type": "string"
                    },
                    "expirationTime": {
                      "description": "The expiration time of the indicator",
                      "order": 17,
                      "title": "Expiration Time",
                      "type": "string"
                    },
                    "generateAlert": {
                      "description": "Generate alert",
                      "order": 12,
                      "title": "Generate Alert",
                      "type": "boolean"
                    },
                    "historicalDetection": {
                      "description": "Historical detection",
                      "order": 13,
                      "title": "Historical Detection",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "Identity of the indicator entity",
                      "order": 2,
                      "title": "Indicator ID",
                      "type": "string"
                    },
                    "indicatorType": {
                      "description": "Type of the indicator",
                      "order": 4,
                      "title": "Indicator Type",
                      "type": "string"
                    },
                    "indicatorValue": {
                      "description": "The potentially malicious indicator of one of the following types: IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                      "order": 3,
                      "title": "Indicator Value",
                      "type": "string"
                    },
                    "lastUpdateTime": {
                      "description": "The last time the indicator was updated",
                      "order": 18,
                      "title": "Last Update Time",
                      "type": "string"
                    },
                    "lastUpdatedBy": {
                      "description": "Identity of the user/application that last updated the indicator",
                      "order": 14,
                      "title": "Last Updated By",
                      "type": "string"
                    },
                    "mitreTechniques": {
                      "description": "MITRE techniques",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "MITRE Techniques",
                      "type": "array"
                    },
                    "rbacGroupIds": {
                      "description": "RBAC group IDs",
                      "items": {
                        "type": "string"
                      },
                      "order": 23,
                      "title": "RBAC Group IDs",
                      "type": "array"
                    },
                    "rbacGroupNames": {
                      "description": "RBAC device group names where the indicator is exposed and active. Empty list in case it exposed to all devices",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "RBAC Group Names",
                      "type": "array"
                    },
                    "recommendedActions": {
                      "description": "Recommended actions for the indicator",
                      "order": 22,
                      "title": "Recommended Actions",
                      "type": "string"
                    },
                    "severity": {
                      "description": "The severity of the indicator",
                      "order": 19,
                      "title": "Severity",
                      "type": "string"
                    },
                    "source": {
                      "description": "The name of the user/application that submitted the indicator",
                      "order": 8,
                      "title": "Source",
                      "type": "string"
                    },
                    "sourceType": {
                      "description": "User in case the Indicator created by a user (e.g. from the portal), AadApp in case it submitted using automated application via the API.",
                      "order": 7,
                      "title": "Source Type",
                      "type": "string"
                    },
                    "title": {
                      "description": "Indicator alert title",
                      "order": 20,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Indicator Action",
                  "type": "object"
                }
              },
              "properties": {
                "indicator_action_response": {
                  "$ref": "#/definitions/indicator_action",
                  "description": "A response that includes the result of the action, and supplemental information about the action taken",
                  "order": 1,
                  "title": "Indicator Action Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1f8c626d-a56e-435d-a74e-6583801475e9": {
            "nodeId": "1f8c626d-a56e-435d-a74e-6583801475e9",
            "name": "Add Year to Current Date",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.0.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.0.6/icon.png"
            },
            "identifier": "add_to_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "base_time": "{{[dce0fb5b-123c-4512-aa8c-04d8e23d0a3c].[datetime]}}",
                "days": 0,
                "hours": 0,
                "minutes": 0,
                "months": 0,
                "seconds": 0,
                "years": 1
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "base_time": {
                  "description": "Datetime with which to add to",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Base Time",
                  "type": "string"
                },
                "days": {
                  "default": 0,
                  "description": "How many days to add to the specified Datetime",
                  "order": 4,
                  "title": "Days",
                  "type": "integer"
                },
                "hours": {
                  "default": 0,
                  "description": "How many hours to add to the specified Datetime",
                  "order": 5,
                  "title": "Hours",
                  "type": "integer"
                },
                "minutes": {
                  "default": 0,
                  "description": "How many minutes to add to the specified Datetime",
                  "order": 6,
                  "title": "Minutes",
                  "type": "integer"
                },
                "months": {
                  "default": 0,
                  "description": "How many months to add to the specified Datetime",
                  "order": 3,
                  "title": "Months",
                  "type": "integer"
                },
                "seconds": {
                  "default": 0,
                  "description": "How many seconds to add to the specified Datetime",
                  "order": 7,
                  "title": "Seconds",
                  "type": "integer"
                },
                "years": {
                  "default": 0,
                  "description": "How many years to add to the specified Datetime",
                  "order": 2,
                  "title": "Years",
                  "type": "integer"
                }
              },
              "required": [
                "days",
                "hours",
                "minutes",
                "seconds",
                "base_time",
                "years",
                "months"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "date": {
                  "description": "The Datetime after addition",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "Date",
                  "type": "string"
                }
              },
              "required": [
                "date"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "46f49ad5-a076-4064-815f-95906da7e7f6": {
            "nodeId": "46f49ad5-a076-4064-815f-95906da7e7f6",
            "name": "Join",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "55fe24e5-1670-4653-996b-ba17f89e3bb8",
                "109f03bc-1d9f-4b8b-9287-4ba32f881ebb"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Is Successful Action",
                  "type": "boolean",
                  "variables": {
                    "109f03bc-1d9f-4b8b-9287-4ba32f881ebb": "{{[1b8eb660-2521-477c-bf87-fb3874e42805].[$success]}}",
                    "55fe24e5-1670-4653-996b-ba17f89e3bb8": "{{[864d0e2a-072e-4d6d-8c80-96f2f1ae0027].[$success]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Is Successful Action": {
                  "description": "Emitted variable \"Is Successful Action\"",
                  "order": 1,
                  "title": "Is Successful Action",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Is Successful Action": {
                  "description": "Emitted variable \"Is Successful Action\"",
                  "order": 1,
                  "title": "Is Successful Action",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "5bba0f0e-af49-4098-94e3-898c1efdaeb3": {
            "nodeId": "5bba0f0e-af49-4098-94e3-898c1efdaeb3",
            "name": "Microsoft Teams Blacklist Request",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "change_me",
                "message_content": "^(!blacklist-indicators|!unblacklist-indicators)",
                "team_name": "change_me"
              }
            },
            "triggerId": "c1d254b2-d773-4594-81b3-8fc76bd66772",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "692cf210-d453-4d75-a302-aadba0f0eaec": {
            "nodeId": "692cf210-d453-4d75-a302-aadba0f0eaec",
            "name": "At Least 1 Valid Indicator?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "d14ac002-e5bb-4eb4-9e21-d9d9efd19d35",
              "stepControlParams": [
                {
                  "edgeId": "d14ac002-e5bb-4eb4-9e21-d9d9efd19d35",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "8608e8ca-0635-4cb7-99be-1b0f326e1614",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "a2217d01-ebac-447e-be2c-07f5505c7043.combined_array",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[a2217d01-ebac-447e-be2c-07f5505c7043].[combined_array]}}) = 0"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e": {
            "nodeId": "7373ffc7-e5e4-44c5-8d66-7e4de9b1b85e",
            "name": "Post No Valid Indicators Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[channel_name]}}",
                "message_content": "🛑 &ensp;<b>Workflow not executed</b>&ensp;🛑<br><br>\nAt least <i>one valid indicator</i> must be specified",
                "team_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[team_name]}}",
                "thread_id": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "864d0e2a-072e-4d6d-8c80-96f2f1ae0027": {
            "nodeId": "864d0e2a-072e-4d6d-8c80-96f2f1ae0027",
            "name": "Unblacklist Indicator",
            "type": "action",
            "plugin": {
              "name": "Microsoft Windows Defender ATP",
              "slugVendor": "rapid7",
              "slugName": "microsoft_atp",
              "slugVersion": "4.4.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_atp/4.4.0/icon.png"
            },
            "identifier": "blacklist",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "AlertAndBlock",
                "application": "",
                "description": "Unblacklisted {{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}} from Microsoft Teams using insightConnect workflow",
                "expiration_time": "{{[1f8c626d-a56e-435d-a74e-6583801475e9].[date]}}",
                "indicator": "{{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}",
                "indicator_state": false,
                "rbac_group_names": [],
                "recommended_actions": "",
                "severity": "High",
                "title": "Unblacklist {{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "default": "AlertAndBlock",
                  "description": "The action that will be taken if the indicator will be discovered in the organization",
                  "enum": [
                    "Alert",
                    "AlertAndBlock",
                    "Allowed"
                  ],
                  "order": 2,
                  "title": "Action",
                  "type": "string"
                },
                "application": {
                  "description": "The application associated with the indicator",
                  "order": 3,
                  "title": "Application",
                  "type": "string"
                },
                "description": {
                  "description": "Description of the indicator",
                  "order": 5,
                  "title": "Description",
                  "type": "string"
                },
                "expiration_time": {
                  "description": "The expiration time of the indicator",
                  "order": 6,
                  "title": "Expiration Time",
                  "type": "string"
                },
                "indicator": {
                  "description": "A supported indicator to blacklist or unblacklist. Supported indicators are IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                  "order": 1,
                  "title": "Indicator",
                  "type": "string"
                },
                "indicator_state": {
                  "default": false,
                  "description": "True to add indicator, false to remove it from the list",
                  "order": 10,
                  "title": "Indicator State",
                  "type": "boolean"
                },
                "rbac_group_names": {
                  "description": "List of RBAC group names the indicator would be applied to",
                  "items": {
                    "type": "string"
                  },
                  "order": 9,
                  "title": "RBAC Group Names",
                  "type": "array"
                },
                "recommended_actions": {
                  "description": "TI indicator alert recommended actions",
                  "order": 8,
                  "title": "Recommended Actions",
                  "type": "string"
                },
                "severity": {
                  "default": "High",
                  "description": "The severity of the indicator",
                  "enum": [
                    "Informational",
                    "Low",
                    "Medium",
                    "High"
                  ],
                  "order": 7,
                  "title": "Severity",
                  "type": "string"
                },
                "title": {
                  "description": "Indicator alert title",
                  "order": 4,
                  "title": "Title",
                  "type": "string"
                }
              },
              "required": [
                "indicator"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "indicator_action": {
                  "properties": {
                    "@odata.context": {
                      "description": "@odata.context",
                      "order": 1,
                      "title": "@Odata.Context",
                      "type": "string"
                    },
                    "action": {
                      "description": "The action that will be taken if the indicator will be discovered in the organization",
                      "order": 6,
                      "title": "Action",
                      "type": "string"
                    },
                    "application": {
                      "description": "The application associated with the indicator",
                      "order": 5,
                      "title": "Application",
                      "type": "string"
                    },
                    "createdBy": {
                      "description": "Unique identity of the user/application that submitted the indicator",
                      "order": 9,
                      "title": "Created By",
                      "type": "string"
                    },
                    "createdByDisplayName": {
                      "description": "Created by display name",
                      "order": 10,
                      "title": "Created By Display Name",
                      "type": "string"
                    },
                    "createdBySource": {
                      "description": "Created by source",
                      "order": 11,
                      "title": "Created By Source",
                      "type": "string"
                    },
                    "creationTimeDateTimeUtc": {
                      "description": "The date and time when the indicator was created",
                      "order": 16,
                      "title": "Creation Time",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description of the indicator",
                      "order": 21,
                      "title": "Description",
                      "type": "string"
                    },
                    "expirationTime": {
                      "description": "The expiration time of the indicator",
                      "order": 17,
                      "title": "Expiration Time",
                      "type": "string"
                    },
                    "generateAlert": {
                      "description": "Generate alert",
                      "order": 12,
                      "title": "Generate Alert",
                      "type": "boolean"
                    },
                    "historicalDetection": {
                      "description": "Historical detection",
                      "order": 13,
                      "title": "Historical Detection",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "Identity of the indicator entity",
                      "order": 2,
                      "title": "Indicator ID",
                      "type": "string"
                    },
                    "indicatorType": {
                      "description": "Type of the indicator",
                      "order": 4,
                      "title": "Indicator Type",
                      "type": "string"
                    },
                    "indicatorValue": {
                      "description": "The potentially malicious indicator of one of the following types: IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                      "order": 3,
                      "title": "Indicator Value",
                      "type": "string"
                    },
                    "lastUpdateTime": {
                      "description": "The last time the indicator was updated",
                      "order": 18,
                      "title": "Last Update Time",
                      "type": "string"
                    },
                    "lastUpdatedBy": {
                      "description": "Identity of the user/application that last updated the indicator",
                      "order": 14,
                      "title": "Last Updated By",
                      "type": "string"
                    },
                    "mitreTechniques": {
                      "description": "MITRE techniques",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "MITRE Techniques",
                      "type": "array"
                    },
                    "rbacGroupIds": {
                      "description": "RBAC group IDs",
                      "items": {
                        "type": "string"
                      },
                      "order": 23,
                      "title": "RBAC Group IDs",
                      "type": "array"
                    },
                    "rbacGroupNames": {
                      "description": "RBAC device group names where the indicator is exposed and active. Empty list in case it exposed to all devices",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "RBAC Group Names",
                      "type": "array"
                    },
                    "recommendedActions": {
                      "description": "Recommended actions for the indicator",
                      "order": 22,
                      "title": "Recommended Actions",
                      "type": "string"
                    },
                    "severity": {
                      "description": "The severity of the indicator",
                      "order": 19,
                      "title": "Severity",
                      "type": "string"
                    },
                    "source": {
                      "description": "The name of the user/application that submitted the indicator",
                      "order": 8,
                      "title": "Source",
                      "type": "string"
                    },
                    "sourceType": {
                      "description": "User in case the Indicator created by a user (e.g. from the portal), AadApp in case it submitted using automated application via the API.",
                      "order": 7,
                      "title": "Source Type",
                      "type": "string"
                    },
                    "title": {
                      "description": "Indicator alert title",
                      "order": 20,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Indicator Action",
                  "type": "object"
                }
              },
              "properties": {
                "indicator_action_response": {
                  "$ref": "#/definitions/indicator_action",
                  "description": "A response that includes the result of the action, and supplemental information about the action taken",
                  "order": 1,
                  "title": "Indicator Action Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a05dc55a-3e28-4744-9575-922efe0b34bf": {
            "nodeId": "a05dc55a-3e28-4744-9575-922efe0b34bf",
            "name": "Was Blacklist Successful?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2f22b84f-9dd6-46c7-bd27-43a93f03b987",
              "stepControlParams": [
                {
                  "edgeId": "90edfd1c-c2f9-4e6e-99e1-3bc3c42e2c64",
                  "expression": {
                    "name": "46f49ad5-a076-4064-815f-95906da7e7f6.Is Successful Action",
                    "type": "variable"
                  },
                  "expressionText": "{{[46f49ad5-a076-4064-815f-95906da7e7f6].[Is Successful Action]}}"
                },
                {
                  "edgeId": "2f22b84f-9dd6-46c7-bd27-43a93f03b987",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "a2217d01-ebac-447e-be2c-07f5505c7043": {
            "nodeId": "a2217d01-ebac-447e-be2c-07f5505c7043",
            "name": "Combine Indicator Array 2",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.6.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.6.0/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[b0359d40-34c5-402e-abc6-19157d78bd0a].[combined_array]}}",
                "array2": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[urls]}}",
                "array3": [],
                "array4": [],
                "array5": []
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a6ef9a13-3ba2-4604-acda-5b71375aac60": {
            "nodeId": "a6ef9a13-3ba2-4604-acda-5b71375aac60",
            "name": "Post Failure Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[channel_name]}}",
                "message_content": "🚨 &ensp;<b>Could not perform action</b>&ensp;🚨<br>\n<code>{{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}</code><br><br>\n\nJob URL: <a href={{[$job].[URL]}}>{{[$job].[URL]}}</a>",
                "team_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[team_name]}}",
                "thread_id": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b0359d40-34c5-402e-abc6-19157d78bd0a": {
            "nodeId": "b0359d40-34c5-402e-abc6-19157d78bd0a",
            "name": "Combine Indicator Array",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.6.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.6.0/icon.png"
            },
            "identifier": "combine_arrays",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "array1": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[hashes].[sha1_hashes]}}",
                "array2": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[hashes].[sha256_hashes]}}",
                "array3": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[ip_addresses].[ipv4_addresses]}}",
                "array4": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[ip_addresses].[ipv6_addresses]}}",
                "array5": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[indicators].[domains]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "array1": {
                  "description": "First array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Array1",
                  "type": "array"
                },
                "array2": {
                  "description": "Second array",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Array2",
                  "type": "array"
                },
                "array3": {
                  "description": "Third array",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Array3",
                  "type": "array"
                },
                "array4": {
                  "description": "Fourth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Array4",
                  "type": "array"
                },
                "array5": {
                  "description": "Fifth array",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Array5",
                  "type": "array"
                }
              },
              "required": [
                "array1",
                "array2"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "combined_array": {
                  "description": "Combined array",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Combined Array",
                  "type": "array"
                }
              },
              "required": [
                "combined_array"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "b8f32920-8289-4162-9809-eba176e4d79e": {
            "nodeId": "b8f32920-8289-4162-9809-eba176e4d79e",
            "name": "Blacklist Indicator Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "11fcb961-f4d2-4e3a-97ee-b4ee7638f60a",
              "nextEdgeId": "3cb04b59-73f8-44fd-a0a5-ebe55697cae2",
              "repeatVariable": "{{[a2217d01-ebac-447e-be2c-07f5505c7043].[combined_array]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c": {
            "nodeId": "dce0fb5b-123c-4512-aa8c-04d8e23d0a3c",
            "name": "Get Current Date",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "2.0.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/2.0.6/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "dff40251-27d4-4bd5-a8e8-721b2ddd55a7": {
            "nodeId": "dff40251-27d4-4bd5-a8e8-721b2ddd55a7",
            "name": "Post Workflow Complete Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[channel_name]}}",
                "message_content": "🚀 &ensp;<b>Workflow Complete</b>&ensp;🚀 ",
                "team_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[team_name]}}",
                "thread_id": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f661e858-4b00-4ece-8461-f4911c018924": {
            "nodeId": "f661e858-4b00-4ece-8461-f4911c018924",
            "name": "Post Success Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[channel_name]}}",
                "message_content": "✅ &ensp;<b>Blacklist Action was Successful</b>&ensp;✅<br>\n\nIndicator: <code>{{[b8f32920-8289-4162-9809-eba176e4d79e].[$item]}}<code>",
                "team_name": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[team_name]}}",
                "thread_id": "{{[5bba0f0e-af49-4098-94e3-898c1efdaeb3].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message_content"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Endpoint Detection & Response",
          "Microsoft"
        ],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": null
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "c1d254b2-d773-4594-81b3-8fc76bd66772",
        "identifier": "new_message_received",
        "name": "Microsoft Teams Blacklist Request",
        "description": "",
        "input": {
          "channel_name": "change_me",
          "message_content": "^(!blacklist-indicators|!unblacklist-indicators)",
          "team_name": "change_me"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "words",
                "first_word"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.1.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.0/icon.png"
        }
      }
    ]
  }
}