{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T12:56:57.968174771Z",
    "workflowVersions": [
      {
        "name": "Phishing Workflow Template",
        "type": "runnable",
        "version": "",
        "description": "# Description\r\n\r\nPhishing workflow created to handle multiple email types (attached malicious emails / in-line malicious emails), and respond automatically based on learned behaviors.\r\n\r\n\r\n# Key Features\r\n\r\n* Database of phishing emails via Global Artifacts\r\n* Automated decision making process via data in Global Artifacts\r\n* Time triggered notifications and actions for after-hours alerts\r\n\r\n\r\n# Requirements\r\n\r\n#### Global Artifacts utilized by workflow:\r\n\r\n1. Phishing Database\r\n\tFields:\r\n\t\tSender - Malicious Sender\r\n\t\tSubject - Original Subject\r\n\t\tDecision\r\n\t\t\tSpam\r\n\t\t\tLegitimate\r\n\t\t\tMalicious\r\n\r\n2. Workflow Metrics\r\n\tFields:\r\n\t\tDecision\r\n\t\tDecision Maker \r\n\t\t\tEmployee\r\n\t\t\tWorkflow Step\r\n\t\tDecision Method\r\n\t\t\tHuman\r\n\t\t\tAutomated\r\n\r\n#### Python Plugin Add-Ons\r\n\r\n1. Beautiful Soup (BS4)\r\n\r\n# Documentation\r\n\r\n## Setup\r\n\r\n###### Workflow Walk Through\r\n1. Trigger picks up email.\r\n2. Initial email artifact is generated (Reported By / Subject).\r\n3. Automated Reply Decision (Pattern Match).\r\nPath 1: If the email is an Auto Reply, move email to a specified folder.\r\nPath 2: If the email is new, proceed with Emergency Response Check (Used for known bad campaigns to decide before any analysis. Determined via pattern match). If the response check matches, Send Response Email and Move from inbox. If there is no match, continue with workflow.\r\n4. Header Loop - parses header for sender and ip addresses, and then creates artifacts around sender and subject. If the IP address lookup failed, lookup the sender domain with whois. If it is successful, skip that step.\r\n5. Lookup Sender / Subject in Phishing Database (Global Artifact).\r\nPath 1: Single Match/No Match - exit the loop and continue on (Note â€“ This is a good place to add pattern matches for emails that get sent from same sender but different subject etc., to make decisions and auto-respond on them. For example, HR emails with different employee names but same message. (John Smith Payroll Data, Mary Jackson Payroll Data). You can combine pattern matches of Sender and Payroll Data in the subject line to make an auto decision on it).\r\nPath 2: Dual Match - Send Response Email based on Decision field from Global Artifact, Move from inbox & Kill workflow.\r\n6. Attachment Loop - confirms attachment not header, checks for image or pdf - if pdf do attachment analysis & create artifact with results.\r\n7. Email Type Decision Step (Checks if email has attached email to analyze or not). Path 1: If the email has attached emails -  extracts URLs from the attached emails & enter Attached Email Loop to strip HTML from attached emails. Path 2: No Attached Email - Pull body of email via Python, Strip HTML & Extract URLs.\r\n8. URL Analysis Loop - Check for proofpoint encoding. If decoded, leave the loop. If encoded, decode with proofpoint, extract domain from URL, checks to see if present on the palo alto blocklist, screenshot grab of URL, lookup URL domain in whois, put all results in URL Analysis Results artifact & exit loop.\r\n9. Phishing Database 2nd Check Loop (Checks Global Artifact for Sender/Subject match). Path 1: Matched - Send Response Email, move email from inbox & end workflow. Path 2: No Match, continue with workflow.\r\n10. Human Decision Point - the analyst decides based on artifact information if the email is malicious & sends response decision. \r\nPath 1: Human decision time out - If the decision times out after 30 minutes, it will prompt the analyst with a Slack message asking to make a response. If there is no response within an additional 15 minutes, the workflow will default to a malicious decision, sending a time out email to notify the team a time out occured, sends a malicious response email, and moves email from inbox.\r\nPath 2: Make a human decision allowing the user to mark the email as malicious, spam, or not malicious. Send response emails based on choice, add to metrics (Global Artifact) and move email from inbox. If the email is marked as malicious, perform search and purge step, check for success, and move email from inbox. \r\n\r\n\r\n## Technical Details\r\n\r\nPlugins utilized by workflow:\r\n\r\n|Plugin|Version|Count|\r\n|----|----|--------|\r\nMicrosoft Office 365 Email | 5.1.0 | 17\r\nPython (BeautifulSoup)| 2.0.3 | 1\r\nHTML | 1.2.2 | 1\r\nExtractIt | 2.2.0 | 3\r\nPython (No Modules) | 2.0.3 | 2\r\nChatOps (Slack) | n/a | 2\r\nMicrosoft Email Security | 2.3.3 | 1\r\nBase64 | 1.1.6 | 1\r\nWHOIS | 3.0.3 | 3\r\nPaloAlto Wild Fire | 1.1.2 | 1\r\nThreat Crowd | 3.0.3 | 1\r\nVirusTotal | 7.0.0 | 1\r\nProofPoint URL Defense | 1.2.3 | 1\r\nPowerShell | 2.1.4 | 1\r\nScreenshot a URL | 1.0.1 | 1\r\nSleep | 1.0.2 | 1\r\n\r\n\r\n## Troubleshooting\r\n\r\n_There is no troubleshooting information at this time_\r\n\r\n# Version History\r\n\r\n* 1.0.0 - Initial workflow\r\n\r\n# Links\r\n\r\n## References\r\n\r\n",
        "graph": {
          "edges": {
            "000221bd-6883-4367-8d06-1db61809852c": {
              "id": "000221bd-6883-4367-8d06-1db61809852c",
              "name": "False",
              "description": "Do not perform Search and Purge",
              "parentNodeId": "",
              "fromNodeId": "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "027c3f80-972b-434a-9663-c44b1198edc8": {
              "id": "027c3f80-972b-434a-9663-c44b1198edc8",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "82246ef6-485b-4871-b024-df70469e40d7",
              "toNodeId": "bee9301f-349c-451e-8e0c-85ffdc970bad"
            },
            "065fac6b-2457-44d9-8971-4d4c955ec3a2": {
              "id": "065fac6b-2457-44d9-8971-4d4c955ec3a2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "85333f2b-5aa6-46f4-af09-c738cf0d8523",
              "toNodeId": "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6"
            },
            "06883733-d664-4ae7-b5c7-d57cc15ad56e": {
              "id": "06883733-d664-4ae7-b5c7-d57cc15ad56e",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63",
              "toNodeId": "90b542cf-e534-458d-b29d-09bba147bd6f"
            },
            "06c6bba5-84c3-421b-989d-6680daccaf12": {
              "id": "06c6bba5-84c3-421b-989d-6680daccaf12",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "2c7a768c-90be-4842-803a-21a2ea9bc427",
              "toNodeId": "e4a61c22-bab6-4271-b38e-36480c995f31"
            },
            "07392133-d52f-4929-90b7-c1c354daec0f": {
              "id": "07392133-d52f-4929-90b7-c1c354daec0f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "toNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
            },
            "0bce2227-3360-4947-8fa2-91f06368936c": {
              "id": "0bce2227-3360-4947-8fa2-91f06368936c",
              "name": "Malicious - Duplicate",
              "description": "Email will be marked as malicious and a response will be sent back to the client. A search and purge will NOT be performed.",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b"
            },
            "0d04074b-c8bc-432e-8b7e-d2cc83644955": {
              "id": "0d04074b-c8bc-432e-8b7e-d2cc83644955",
              "name": "Non Image",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "ec480a75-3600-433a-9dd4-b1f02c5b1f9b",
              "toNodeId": "4850cf11-b7b2-4a3f-8674-13fb59b7713e"
            },
            "0d7c0dd2-9593-44f0-815a-bbbd28295683": {
              "id": "0d7c0dd2-9593-44f0-815a-bbbd28295683",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "7a0470b1-8d15-4b5f-8b58-423179b2c73d",
              "toNodeId": "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf"
            },
            "0f6e9632-ff5a-488d-bdf4-cafc325b6012": {
              "id": "0f6e9632-ff5a-488d-bdf4-cafc325b6012",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6deb7d73-397b-4c4e-b675-d44c3df6b3c2",
              "toNodeId": "1d768b4b-de25-459b-b8b1-cdc69fe075c6"
            },
            "1190502f-c865-4bf4-a752-b7bf92b228b6": {
              "id": "1190502f-c865-4bf4-a752-b7bf92b228b6",
              "name": "Move Only",
              "description": "Moves email from inbox and does not send a response to the client. ",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9"
            },
            "12a932b8-152c-4883-bcc5-ff4e7ae32011": {
              "id": "12a932b8-152c-4883-bcc5-ff4e7ae32011",
              "name": "Successful",
              "description": "IP Lookup successful in WhoIs",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "d4d3458c-86ff-4ca8-a169-2156a26a5fdb",
              "toNodeId": "c62efedd-92c3-461f-95fc-e68f499af5bf"
            },
            "14abec94-ded8-4d2b-9c63-ee644f81e205": {
              "id": "14abec94-ded8-4d2b-9c63-ee644f81e205",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "3988477a-043e-4649-b43d-b7ad49d10d98",
              "toNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d"
            },
            "14d075fc-c90b-4148-a336-8f58e36246dc": {
              "id": "14d075fc-c90b-4148-a336-8f58e36246dc",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "67f18fe7-b650-4c5a-b8d1-b65d1d08e241",
              "toNodeId": "66b11adc-777d-42cf-9ef3-823b79bb3b4d"
            },
            "173afced-bbe1-4d47-904e-5348ab894c1a": {
              "id": "173afced-bbe1-4d47-904e-5348ab894c1a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "690f7f6f-e73c-4697-a864-bd24890d3ea3",
              "toNodeId": "f2310ff3-c087-463e-9193-5b36a011710f"
            },
            "17c428c1-cfd4-4216-a771-d221a3dbbdfe": {
              "id": "17c428c1-cfd4-4216-a771-d221a3dbbdfe",
              "name": "Legitimate",
              "description": "Sends a Legitimate response notice",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5",
              "toNodeId": "53d69710-7fd5-4da7-b987-340f574ff50c"
            },
            "1a3ade89-7c24-4a4d-89e6-d8930e13cbe6": {
              "id": "1a3ade89-7c24-4a4d-89e6-d8930e13cbe6",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "toNodeId": "3bd68547-f860-4725-874b-42f284fa0340"
            },
            "1b5192bd-536f-4691-93da-2b79a2ee9982": {
              "id": "1b5192bd-536f-4691-93da-2b79a2ee9982",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "4850cf11-b7b2-4a3f-8674-13fb59b7713e",
              "toNodeId": "e548779c-7d46-4ec3-b6ff-3a3762169ea4"
            },
            "1be0f05f-bc48-43f0-b84e-47df1608851d": {
              "id": "1be0f05f-bc48-43f0-b84e-47df1608851d",
              "name": "Spam",
              "description": "Sends a Spam Notice",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "db200383-9d5f-4902-afde-7cea924d9b4b",
              "toNodeId": "6f89ada2-f1f6-4be7-baf9-e2614ac931e5"
            },
            "1fe72f14-040c-4709-bc86-4d3769593863": {
              "id": "1fe72f14-040c-4709-bc86-4d3769593863",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "44cf989f-13e5-4491-a14c-03ff136c63c7",
              "toNodeId": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5"
            },
            "202de0a3-0929-42ba-a10a-c8dad5f76043": {
              "id": "202de0a3-0929-42ba-a10a-c8dad5f76043",
              "name": "Spam - Search and Purge",
              "description": "Email will be marked as spam and a response will be sent back to the client. Perform Search and Purge on email.",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "f9ead5e0-e71b-42da-b9e6-171e659634bb"
            },
            "21655065-c34c-4490-8266-79d8d8fd1b2b": {
              "id": "21655065-c34c-4490-8266-79d8d8fd1b2b",
              "name": "Move Only",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "22f5ec8e-fe24-43a7-bc16-de37521ef060": {
              "id": "22f5ec8e-fe24-43a7-bc16-de37521ef060",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "b89f9f45-1da7-4ecf-bd55-7d11c79e4379",
              "toNodeId": "ea580d9a-7197-41f6-bf89-9bdf2248f43b"
            },
            "24fe358c-3c0e-4845-89b6-34e7212c92bf": {
              "id": "24fe358c-3c0e-4845-89b6-34e7212c92bf",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "314e5653-a364-49b3-bf08-6812c1ed9038",
              "toNodeId": "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63"
            },
            "258c3742-2d91-4a69-b025-3ec04989557d": {
              "id": "258c3742-2d91-4a69-b025-3ec04989557d",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f552eaf6-5636-448f-9027-a481a30019d9",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "2689611e-affa-4114-8eba-1b6cd3d69f42": {
              "id": "2689611e-affa-4114-8eba-1b6cd3d69f42",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4291176f-1aaf-415b-96e6-c6ac812f6c90",
              "toNodeId": "e9f74950-f2cd-491d-8a9c-bce149e870c3"
            },
            "29bbef39-03bf-404e-be63-00511db3cc73": {
              "id": "29bbef39-03bf-404e-be63-00511db3cc73",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1d768b4b-de25-459b-b8b1-cdc69fe075c6",
              "toNodeId": "fab37fff-5672-4689-9023-3af4e8cbaf60"
            },
            "29bcd7c1-b4ca-4c99-bb17-7ed6bfce5604": {
              "id": "29bcd7c1-b4ca-4c99-bb17-7ed6bfce5604",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189",
              "toNodeId": "d6508a73-a938-4c0d-9413-2b90e28b2bf6"
            },
            "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06": {
              "id": "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06",
              "name": "Legitimate",
              "description": "Email will be marked as legitimate and a response will be sent back to the client.",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "f630ffdd-6958-4773-baee-6db6c0a2326c"
            },
            "2b13118a-dff9-4228-a694-760589a587b8": {
              "id": "2b13118a-dff9-4228-a694-760589a587b8",
              "name": "In Body",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5b2815ca-42bf-42c0-8764-4af5d963288e",
              "toNodeId": "4291176f-1aaf-415b-96e6-c6ac812f6c90"
            },
            "2b2a6a5f-51cc-4538-b79d-3bf766078d97": {
              "id": "2b2a6a5f-51cc-4538-b79d-3bf766078d97",
              "name": "Slack Message",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface"
            },
            "2b6d5d75-e506-4f8f-82a6-6074a6952838": {
              "id": "2b6d5d75-e506-4f8f-82a6-6074a6952838",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "a5e0212f-9108-4790-bde7-f9b9424db280",
              "toNodeId": "ff9b4235-bbca-4378-a25b-c890f4fd2934"
            },
            "2d4d5211-983a-43ad-8ec7-c441547f6c14": {
              "id": "2d4d5211-983a-43ad-8ec7-c441547f6c14",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e9f74950-f2cd-491d-8a9c-bce149e870c3",
              "toNodeId": "e1e19b83-9f7f-4796-93e8-45b83e4eb56a"
            },
            "2dcb5d64-51ac-433b-8157-eaf273ed3047": {
              "id": "2dcb5d64-51ac-433b-8157-eaf273ed3047",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "53d69710-7fd5-4da7-b987-340f574ff50c",
              "toNodeId": "501db4bb-46db-41b3-a31e-759c5f470156"
            },
            "2fc3f890-acba-4790-9f4e-60ff24721c7c": {
              "id": "2fc3f890-acba-4790-9f4e-60ff24721c7c",
              "name": "Header",
              "description": "Header file analysis",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "2ad959a3-e4fd-4113-ba68-a5154a59e1f5",
              "toNodeId": "21722583-47f3-4912-95fd-53b88384c00f"
            },
            "314d9bec-c0af-4628-b652-f54ca302723b": {
              "id": "314d9bec-c0af-4628-b652-f54ca302723b",
              "name": "Blank",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "00bad604-5693-4f41-9554-f3bd588ad7fb",
              "toNodeId": "e165e514-e977-4925-ad67-34e4237f8690"
            },
            "351fbca7-99f7-47fd-bde0-b5000b1e2f4a": {
              "id": "351fbca7-99f7-47fd-bde0-b5000b1e2f4a",
              "name": "Decoded",
              "description": "Internal URL will not be analyzed",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "ea580d9a-7197-41f6-bf89-9bdf2248f43b",
              "toNodeId": ""
            },
            "3749d0b0-46a1-4837-a6db-608ad6b8b384": {
              "id": "3749d0b0-46a1-4837-a6db-608ad6b8b384",
              "name": "No Match",
              "description": "Workflow continues",
              "parentNodeId": "",
              "fromNodeId": "977cd375-1e31-446e-9643-95e0834e80cc",
              "toNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "3929f142-a9c1-4624-9f3d-6fccaf5429e2": {
              "id": "3929f142-a9c1-4624-9f3d-6fccaf5429e2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f9ead5e0-e71b-42da-b9e6-171e659634bb",
              "toNodeId": "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b"
            },
            "393824ec-6108-4fab-b529-9650630f31af": {
              "id": "393824ec-6108-4fab-b529-9650630f31af",
              "name": "Header",
              "description": "Stops loop and runs next attachment",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e",
              "toNodeId": ""
            },
            "394d4025-6fba-41b5-b99f-047d8c3e9f8c": {
              "id": "394d4025-6fba-41b5-b99f-047d8c3e9f8c",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "7df69e7c-5be3-49e6-af5f-01fdfc0a4864",
              "toNodeId": "a5e0212f-9108-4790-bde7-f9b9424db280"
            },
            "3a126479-2838-427f-8b17-41272d823a87": {
              "id": "3a126479-2838-427f-8b17-41272d823a87",
              "name": "Spam",
              "description": "Sends a Spam response notice",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5",
              "toNodeId": "67f18fe7-b650-4c5a-b8d1-b65d1d08e241"
            },
            "3efe44f7-b972-45f3-9f3e-c35177a728b2": {
              "id": "3efe44f7-b972-45f3-9f3e-c35177a728b2",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1e315dc2-b058-4179-bfca-57d3354f37e7",
              "toNodeId": ""
            },
            "3f1973f8-3838-4938-994a-2e8f0ec46f0e": {
              "id": "3f1973f8-3838-4938-994a-2e8f0ec46f0e",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a",
              "toNodeId": ""
            },
            "3fe37469-e01a-40c3-961c-399d9c4860d1": {
              "id": "3fe37469-e01a-40c3-961c-399d9c4860d1",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "cb49145d-05f3-4942-b9a9-343a73885baf",
              "toNodeId": "4b0e710c-c958-40c9-b4e1-4d04a5730c8e"
            },
            "401e6e2f-0d3d-48cc-9a54-f3b2010e11e7": {
              "id": "401e6e2f-0d3d-48cc-9a54-f3b2010e11e7",
              "name": "All Others",
              "description": "Continues loop",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e",
              "toNodeId": "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8"
            },
            "4179d02d-4b78-4a04-86f0-99460500ad80": {
              "id": "4179d02d-4b78-4a04-86f0-99460500ad80",
              "name": "New",
              "description": "Continues workflow",
              "parentNodeId": "",
              "fromNodeId": "f041b903-bfd6-4807-8dad-b825b5266694",
              "toNodeId": "e1bb581f-c9ba-4ddb-bb52-1404f29634e7"
            },
            "41b2054e-05f5-431c-8436-18ccb899faf5": {
              "id": "41b2054e-05f5-431c-8436-18ccb899faf5",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "690633fd-7bc5-43bd-9dda-df85e0fd4a98",
              "toNodeId": "c9200333-bd34-4bbf-b3ca-cedbe640200b"
            },
            "41de6e03-50df-43e8-88a3-87b357682567": {
              "id": "41de6e03-50df-43e8-88a3-87b357682567",
              "name": "Malicious",
              "description": "Sends a Malicious response notice",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5",
              "toNodeId": "3a062890-a1b1-4e4d-97ef-80b45dc43c69"
            },
            "46855705-02a5-48ea-bb63-8ebaed0b471b": {
              "id": "46855705-02a5-48ea-bb63-8ebaed0b471b",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "c62efedd-92c3-461f-95fc-e68f499af5bf",
              "toNodeId": "2c7a768c-90be-4842-803a-21a2ea9bc427"
            },
            "46b44777-a8b1-4318-92cd-37e4fda8f214": {
              "id": "46b44777-a8b1-4318-92cd-37e4fda8f214",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "61b8f486-3577-4100-a005-4a32173f0e77",
              "toNodeId": ""
            },
            "481aa9a1-9b06-4270-9aad-4849ca0dd723": {
              "id": "481aa9a1-9b06-4270-9aad-4849ca0dd723",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "fab37fff-5672-4689-9023-3af4e8cbaf60",
              "toNodeId": "f041b903-bfd6-4807-8dad-b825b5266694"
            },
            "4a977bd1-2862-45d7-970d-7b3d961a9df9": {
              "id": "4a977bd1-2862-45d7-970d-7b3d961a9df9",
              "name": "Malicious",
              "description": "Email will be marked as malicious and a response will be sent back to the client. A search and purge will also be performed to scan and remove the email from all LOBs.",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b"
            },
            "4bd6c62f-f6de-44c7-867c-6e4aacb09a21": {
              "id": "4bd6c62f-f6de-44c7-867c-6e4aacb09a21",
              "name": "Malicious",
              "description": "Sends a Malicious Notice",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "db200383-9d5f-4902-afde-7cea924d9b4b",
              "toNodeId": "c502d2e3-d855-4cfa-a9c9-78376047b4b5"
            },
            "53bf890c-f1a9-4332-8663-b0a218160f72": {
              "id": "53bf890c-f1a9-4332-8663-b0a218160f72",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f",
              "toNodeId": "6f8501ec-2962-469d-90d1-d4e422598efc"
            },
            "54a92444-ffe6-4540-be82-49a9e78ff977": {
              "id": "54a92444-ffe6-4540-be82-49a9e78ff977",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "toNodeId": "c5ff84f8-a45c-496e-aa18-2753aaff5911"
            },
            "57049438-b27e-4f7c-ab75-3326b23561e8": {
              "id": "57049438-b27e-4f7c-ab75-3326b23561e8",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "c17cdd06-06fd-474d-abf8-052fbf783705",
              "toNodeId": "7a0470b1-8d15-4b5f-8b58-423179b2c73d"
            },
            "581e00c8-cb1e-4817-b330-3c3af49cbf1e": {
              "id": "581e00c8-cb1e-4817-b330-3c3af49cbf1e",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "66b11adc-777d-42cf-9ef3-823b79bb3b4d",
              "toNodeId": "690633fd-7bc5-43bd-9dda-df85e0fd4a98"
            },
            "59e9b243-5ac6-4768-b1a9-f0051f30ee69": {
              "id": "59e9b243-5ac6-4768-b1a9-f0051f30ee69",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e1e19b83-9f7f-4796-93e8-45b83e4eb56a",
              "toNodeId": "2b2508ba-5a8d-4271-9bf0-90e316f45485"
            },
            "5bed4293-39fb-4172-a7af-225e0d459691": {
              "id": "5bed4293-39fb-4172-a7af-225e0d459691",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e1bb581f-c9ba-4ddb-bb52-1404f29634e7",
              "toNodeId": "977cd375-1e31-446e-9643-95e0834e80cc"
            },
            "5e21463f-be46-4d78-ae31-9341348525c6": {
              "id": "5e21463f-be46-4d78-ae31-9341348525c6",
              "name": "",
              "description": "",
              "parentNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
              "fromNodeId": "68ba176b-5c2c-4f19-9c58-d7ce436ab359",
              "toNodeId": ""
            },
            "5f3921bd-272f-48ee-ab47-f7ee2e5bad71": {
              "id": "5f3921bd-272f-48ee-ab47-f7ee2e5bad71",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "toNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "62def443-07c9-410c-a163-7722a77d75ef": {
              "id": "62def443-07c9-410c-a163-7722a77d75ef",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "80f39b12-16ae-45ed-ab52-18e0b2433b65",
              "toNodeId": "273eaa07-0b6f-49f1-ae04-8966fa3385f9"
            },
            "62e10598-fd9b-4b31-be02-bfc915ee0346": {
              "id": "62e10598-fd9b-4b31-be02-bfc915ee0346",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "f5b6133e-9280-4e08-b950-7a5c223425da",
              "toNodeId": "15899f2f-0d41-486d-b55f-1395b27518f9"
            },
            "6311f39e-8a3d-4870-81ba-ee37c53b5643": {
              "id": "6311f39e-8a3d-4870-81ba-ee37c53b5643",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2b2508ba-5a8d-4271-9bf0-90e316f45485",
              "toNodeId": "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f"
            },
            "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6": {
              "id": "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
              "toNodeId": "2b2508ba-5a8d-4271-9bf0-90e316f45485"
            },
            "643d0f2f-1175-4837-9eac-a8e5f685414b": {
              "id": "643d0f2f-1175-4837-9eac-a8e5f685414b",
              "name": "Image File",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "ec480a75-3600-433a-9dd4-b1f02c5b1f9b",
              "toNodeId": "c0396569-5cc0-4862-b17b-ef30ef76c88e"
            },
            "65594ab2-2b97-4ce0-80f3-74230ecfdb06": {
              "id": "65594ab2-2b97-4ce0-80f3-74230ecfdb06",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "3a062890-a1b1-4e4d-97ef-80b45dc43c69",
              "toNodeId": "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8"
            },
            "6868bdea-c9f6-4e3b-94a5-6b10db06cedb": {
              "id": "6868bdea-c9f6-4e3b-94a5-6b10db06cedb",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "e782dcb8-5bdb-459f-8e20-c7953f0aab9d",
              "toNodeId": "c3b82488-db93-4658-9e3a-aea776396fac"
            },
            "6c3eb218-52fe-42db-bc68-435a2d14e2e9": {
              "id": "6c3eb218-52fe-42db-bc68-435a2d14e2e9",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "10410922-dc49-47a5-89d0-a15590e842a1",
              "toNodeId": "1e315dc2-b058-4179-bfca-57d3354f37e7"
            },
            "6c575f04-23f1-4e2a-94bf-74bc42e01930": {
              "id": "6c575f04-23f1-4e2a-94bf-74bc42e01930",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "3bd68547-f860-4725-874b-42f284fa0340",
              "toNodeId": "2ad959a3-e4fd-4113-ba68-a5154a59e1f5"
            },
            "6ef52702-30eb-42b1-9bf1-688763294536": {
              "id": "6ef52702-30eb-42b1-9bf1-688763294536",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "7002f74a-f7ce-457c-b808-be54d3a13c6f": {
              "id": "7002f74a-f7ce-457c-b808-be54d3a13c6f",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "e165e514-e977-4925-ad67-34e4237f8690",
              "toNodeId": ""
            },
            "7341ff9e-7dd2-494f-9a80-b63f44bedeea": {
              "id": "7341ff9e-7dd2-494f-9a80-b63f44bedeea",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "toNodeId": "5b2815ca-42bf-42c0-8764-4af5d963288e"
            },
            "75af2b42-b74e-4144-9d11-d827d83855ca": {
              "id": "75af2b42-b74e-4144-9d11-d827d83855ca",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e",
              "toNodeId": "82246ef6-485b-4871-b024-df70469e40d7"
            },
            "7ab57999-041c-434c-99c7-fc73791df043": {
              "id": "7ab57999-041c-434c-99c7-fc73791df043",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "e4a61c22-bab6-4271-b38e-36480c995f31",
              "toNodeId": "e782dcb8-5bdb-459f-8e20-c7953f0aab9d"
            },
            "7ac5fc3e-692b-4883-9115-8fc6b050e705": {
              "id": "7ac5fc3e-692b-4883-9115-8fc6b050e705",
              "name": "Failed",
              "description": "IP lookup failed in WhoIs",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "d4d3458c-86ff-4ca8-a169-2156a26a5fdb",
              "toNodeId": "8f23af0b-dbc6-4937-a55d-3bf79399ad13"
            },
            "7accf892-3a15-4d23-8a10-fa653009ad96": {
              "id": "7accf892-3a15-4d23-8a10-fa653009ad96",
              "name": "",
              "description": "",
              "parentNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
              "fromNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
              "toNodeId": "68ba176b-5c2c-4f19-9c58-d7ce436ab359"
            },
            "7ad13bfb-8758-41b9-b35b-7911f0ba14eb": {
              "id": "7ad13bfb-8758-41b9-b35b-7911f0ba14eb",
              "name": "True",
              "description": "Perform Search and Purge",
              "parentNodeId": "",
              "fromNodeId": "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27",
              "toNodeId": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e"
            },
            "7f17bc3a-ac13-4e53-aae3-5e3a2efe90b0": {
              "id": "7f17bc3a-ac13-4e53-aae3-5e3a2efe90b0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6",
              "toNodeId": "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687"
            },
            "839d1b11-a348-4235-bccf-2b83d718fd28": {
              "id": "839d1b11-a348-4235-bccf-2b83d718fd28",
              "name": "Encoded",
              "description": "External URL with ProofPoint encoding",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "ea580d9a-7197-41f6-bf89-9bdf2248f43b",
              "toNodeId": "7df69e7c-5be3-49e6-af5f-01fdfc0a4864"
            },
            "85c26fb1-6243-4759-a7f8-f3bd7eb11750": {
              "id": "85c26fb1-6243-4759-a7f8-f3bd7eb11750",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a",
              "toNodeId": "a33cec55-fe59-43bb-a5ee-e8721aa57fb7"
            },
            "85d84264-d977-4a1f-b2cb-f77697600c5c": {
              "id": "85d84264-d977-4a1f-b2cb-f77697600c5c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f2310ff3-c087-463e-9193-5b36a011710f",
              "toNodeId": ""
            },
            "885e355f-a099-4768-bfad-77252114c36c": {
              "id": "885e355f-a099-4768-bfad-77252114c36c",
              "name": "Slack Timeout",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "3ce6e171-5374-49e5-94f6-f7d059f7dc87"
            },
            "8a8908aa-e7af-41d9-afc2-452c8a9776a3": {
              "id": "8a8908aa-e7af-41d9-afc2-452c8a9776a3",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "c5ff84f8-a45c-496e-aa18-2753aaff5911",
              "toNodeId": "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e"
            },
            "8d966f51-146c-4bf9-a6c1-2b394c14dd3a": {
              "id": "8d966f51-146c-4bf9-a6c1-2b394c14dd3a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d",
              "toNodeId": "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27"
            },
            "8e35c770-75eb-4f17-ae4f-3285b096231e": {
              "id": "8e35c770-75eb-4f17-ae4f-3285b096231e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d6508a73-a938-4c0d-9413-2b90e28b2bf6",
              "toNodeId": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e"
            },
            "8f1c5a30-abe1-4390-916d-a22a76a0fba3": {
              "id": "8f1c5a30-abe1-4390-916d-a22a76a0fba3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "97c230b0-575b-4eee-8c25-1a2b8b5bffc2",
              "toNodeId": "52fd62b5-e6cb-4d32-965a-8a747cb77cf3"
            },
            "8f609b4b-9e3f-4141-88b7-13f1f205b816": {
              "id": "8f609b4b-9e3f-4141-88b7-13f1f205b816",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "a33cec55-fe59-43bb-a5ee-e8721aa57fb7",
              "toNodeId": "00bad604-5693-4f41-9554-f3bd588ad7fb"
            },
            "92375286-f055-4673-8004-70b3a51fb583": {
              "id": "92375286-f055-4673-8004-70b3a51fb583",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "a84e53f0-c48f-4980-b509-fdb75ee6f055",
              "toNodeId": "2c7a768c-90be-4842-803a-21a2ea9bc427"
            },
            "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5": {
              "id": "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "6f89ada2-f1f6-4be7-baf9-e2614ac931e5",
              "toNodeId": "7a0470b1-8d15-4b5f-8b58-423179b2c73d"
            },
            "994d0dc7-dff4-4657-a312-cee14e682896": {
              "id": "994d0dc7-dff4-4657-a312-cee14e682896",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf",
              "toNodeId": "45f8c588-227a-4745-ae51-a753b9e5aa17"
            },
            "9c250229-fae6-45ef-a500-35ac55f9a480": {
              "id": "9c250229-fae6-45ef-a500-35ac55f9a480",
              "name": "True",
              "description": "Search and Purge completed across all LOBs",
              "parentNodeId": "",
              "fromNodeId": "bee9301f-349c-451e-8e0c-85ffdc970bad",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "9da2a3a0-43cf-49bf-910d-61ee0f5e4767": {
              "id": "9da2a3a0-43cf-49bf-910d-61ee0f5e4767",
              "name": "Attached",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5b2815ca-42bf-42c0-8764-4af5d963288e",
              "toNodeId": "3988477a-043e-4649-b43d-b7ad49d10d98"
            },
            "a35f8f80-2c0b-403e-949d-9838c93102cf": {
              "id": "a35f8f80-2c0b-403e-949d-9838c93102cf",
              "name": "Spam",
              "description": "Email will be marked as spam and a response will be sent back to the client.",
              "parentNodeId": "",
              "fromNodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "toNodeId": "f9ead5e0-e71b-42da-b9e6-171e659634bb"
            },
            "a463b032-a213-417b-958f-488ec8d7a146": {
              "id": "a463b032-a213-417b-958f-488ec8d7a146",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "e761af32-69c3-453a-ab25-bec6300d7892",
              "toNodeId": "6be7944f-d0b8-48d2-90a9-4c0f48521084"
            },
            "a528f454-fd0a-4d2d-af56-8c65b953c544": {
              "id": "a528f454-fd0a-4d2d-af56-8c65b953c544",
              "name": "No Match",
              "description": "Sender and Subject did not match any records in Phishing Database",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "32fd691d-0758-409e-815a-e4b61e67ebc4",
              "toNodeId": ""
            },
            "a77b3245-9358-45b4-a4d6-91c4adeb8d91": {
              "id": "a77b3245-9358-45b4-a4d6-91c4adeb8d91",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "21722583-47f3-4912-95fd-53b88384c00f",
              "toNodeId": "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf"
            },
            "aa372050-6d13-490e-8e63-e016534efcc8": {
              "id": "aa372050-6d13-490e-8e63-e016534efcc8",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "ca318aa3-f50e-4d6d-bebf-6532862cbad8",
              "toNodeId": "f5b6133e-9280-4e08-b950-7a5c223425da"
            },
            "ae63493f-3adf-4c5c-8d43-5264161bd82d": {
              "id": "ae63493f-3adf-4c5c-8d43-5264161bd82d",
              "name": "PDF File",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "e548779c-7d46-4ec3-b6ff-3a3762169ea4",
              "toNodeId": "644803ff-4329-48ad-9a04-9b52d8c261a2"
            },
            "af7c7f91-b614-4c8c-9380-9ba592fb2609": {
              "id": "af7c7f91-b614-4c8c-9380-9ba592fb2609",
              "name": "Legitimate",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "f630ffdd-6958-4773-baee-6db6c0a2326c"
            },
            "aff98891-0668-4bb4-8792-2f8dd4dfe284": {
              "id": "aff98891-0668-4bb4-8792-2f8dd4dfe284",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "273eaa07-0b6f-49f1-ae04-8966fa3385f9",
              "toNodeId": "db200383-9d5f-4902-afde-7cea924d9b4b"
            },
            "b1ee66be-8f24-4d9b-b6ef-15248135e087": {
              "id": "b1ee66be-8f24-4d9b-b6ef-15248135e087",
              "name": "True",
              "description": "Perform Search and Purge",
              "parentNodeId": "",
              "fromNodeId": "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687",
              "toNodeId": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e"
            },
            "bc80a6c5-890d-4851-94d5-702e26e6db6a": {
              "id": "bc80a6c5-890d-4851-94d5-702e26e6db6a",
              "name": "Legitimate",
              "description": "Sends a Legitimate Notice",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "db200383-9d5f-4902-afde-7cea924d9b4b",
              "toNodeId": "c17cdd06-06fd-474d-abf8-052fbf783705"
            },
            "bcaabcbc-6e98-47e1-a493-c69f2c20768b": {
              "id": "bcaabcbc-6e98-47e1-a493-c69f2c20768b",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "c0396569-5cc0-4862-b17b-ef30ef76c88e",
              "toNodeId": ""
            },
            "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89": {
              "id": "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89",
              "name": "Malicious",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b"
            },
            "beb790f8-b4c6-43c8-b7a3-3ff98ec8294a": {
              "id": "beb790f8-b4c6-43c8-b7a3-3ff98ec8294a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f630ffdd-6958-4773-baee-6db6c0a2326c",
              "toNodeId": "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f"
            },
            "bf1ccaa6-cb3b-42e2-814a-d82572ebc93c": {
              "id": "bf1ccaa6-cb3b-42e2-814a-d82572ebc93c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "toNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "c3451891-8b51-48dc-a05e-c1d72dcbab77": {
              "id": "c3451891-8b51-48dc-a05e-c1d72dcbab77",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "a522e423-bf66-43dc-9de1-c99dbde69e7a",
              "toNodeId": ""
            },
            "c3b7153a-0167-4fd5-aeae-c6f74a80410c": {
              "id": "c3b7153a-0167-4fd5-aeae-c6f74a80410c",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "c502d2e3-d855-4cfa-a9c9-78376047b4b5",
              "toNodeId": "7a0470b1-8d15-4b5f-8b58-423179b2c73d"
            },
            "c4065bdd-31a2-4000-a842-261a7bf44d68": {
              "id": "c4065bdd-31a2-4000-a842-261a7bf44d68",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "ff9b4235-bbca-4378-a25b-c890f4fd2934",
              "toNodeId": "2f249df2-05dc-475f-8913-a4c596291a21"
            },
            "c4634e6c-bf34-469e-94fa-1e54e75bffcf": {
              "id": "c4634e6c-bf34-469e-94fa-1e54e75bffcf",
              "name": "Not Found",
              "description": "Sender / Subject not found in phishing database",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "c3b82488-db93-4658-9e3a-aea776396fac",
              "toNodeId": ""
            },
            "c4831743-5efe-4317-beb0-98f698908aaf": {
              "id": "c4831743-5efe-4317-beb0-98f698908aaf",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "toNodeId": "b89f9f45-1da7-4ecf-bd55-7d11c79e4379"
            },
            "c6308e49-4804-4ad3-a3fc-66ed849a3078": {
              "id": "c6308e49-4804-4ad3-a3fc-66ed849a3078",
              "name": "False",
              "description": "Do Not perform Search and Purge",
              "parentNodeId": "",
              "fromNodeId": "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "c6df127d-613d-4a5c-a070-a308b26a4503": {
              "id": "c6df127d-613d-4a5c-a070-a308b26a4503",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "d19d069c-a155-4e9f-9e39-a92368e571da",
              "toNodeId": ""
            },
            "c8e979ba-3fee-43d2-9358-b11edf44134e": {
              "id": "c8e979ba-3fee-43d2-9358-b11edf44134e",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "toNodeId": "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a"
            },
            "cb20bea5-ad1c-40f4-89ad-4c38de0d4314": {
              "id": "cb20bea5-ad1c-40f4-89ad-4c38de0d4314",
              "name": "All Others",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "e548779c-7d46-4ec3-b6ff-3a3762169ea4",
              "toNodeId": ""
            },
            "cb407d68-0ab8-46a5-ab55-e1bd48e68463": {
              "id": "cb407d68-0ab8-46a5-ab55-e1bd48e68463",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "501db4bb-46db-41b3-a31e-759c5f470156",
              "toNodeId": "690633fd-7bc5-43bd-9dda-df85e0fd4a98"
            },
            "d04e5da7-b71d-40c7-bee8-3672cf6627c5": {
              "id": "d04e5da7-b71d-40c7-bee8-3672cf6627c5",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8",
              "toNodeId": "690633fd-7bc5-43bd-9dda-df85e0fd4a98"
            },
            "d07b3a0c-8120-4a2d-8139-2bac783d7260": {
              "id": "d07b3a0c-8120-4a2d-8139-2bac783d7260",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8",
              "toNodeId": "ec480a75-3600-433a-9dd4-b1f02c5b1f9b"
            },
            "d2305b9e-9a8c-486e-addf-fa0296e323a5": {
              "id": "d2305b9e-9a8c-486e-addf-fa0296e323a5",
              "name": "Spam",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "f9ead5e0-e71b-42da-b9e6-171e659634bb"
            },
            "d37c1823-d6b5-4910-aee8-71ca6eaf6fba": {
              "id": "d37c1823-d6b5-4910-aee8-71ca6eaf6fba",
              "name": "Found",
              "description": "Sender / Subject found in phishing database",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "c3b82488-db93-4658-9e3a-aea776396fac",
              "toNodeId": "e761af32-69c3-453a-ab25-bec6300d7892"
            },
            "d55a7ae3-b689-4ab5-a0f2-2a3102f7386f": {
              "id": "d55a7ae3-b689-4ab5-a0f2-2a3102f7386f",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4d53647b-3359-4ac3-adc7-8d98098d5ae9",
              "toNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "d591d46e-0f83-4307-866c-fde26e742919": {
              "id": "d591d46e-0f83-4307-866c-fde26e742919",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b",
              "toNodeId": "97c230b0-575b-4eee-8c25-1a2b8b5bffc2"
            },
            "d846c2a1-8c15-4438-9d30-ab117d0ff341": {
              "id": "d846c2a1-8c15-4438-9d30-ab117d0ff341",
              "name": "False",
              "description": "Search and Purge failed on one or more LOBs",
              "parentNodeId": "",
              "fromNodeId": "bee9301f-349c-451e-8e0c-85ffdc970bad",
              "toNodeId": "f552eaf6-5636-448f-9027-a481a30019d9"
            },
            "d89431a3-096d-421e-aa0a-8ee0788440c0": {
              "id": "d89431a3-096d-421e-aa0a-8ee0788440c0",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "014137b4-2a9f-46c3-8d4e-f682ce2b3f09",
              "toNodeId": "d4d3458c-86ff-4ca8-a169-2156a26a5fdb"
            },
            "d9043464-a397-4495-8fe7-f0ab8675da48": {
              "id": "d9043464-a397-4495-8fe7-f0ab8675da48",
              "name": "Reply",
              "description": "Moves auto-reply from email box",
              "parentNodeId": "",
              "fromNodeId": "f041b903-bfd6-4807-8dad-b825b5266694",
              "toNodeId": "690f7f6f-e73c-4697-a864-bd24890d3ea3"
            },
            "d93a76bc-f086-4997-96bc-29471a533165": {
              "id": "d93a76bc-f086-4997-96bc-29471a533165",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "644803ff-4329-48ad-9a04-9b52d8c261a2",
              "toNodeId": "cb49145d-05f3-4942-b9a9-343a73885baf"
            },
            "e115c992-0bd2-4571-a545-e16da411c191": {
              "id": "e115c992-0bd2-4571-a545-e16da411c191",
              "name": "Complete String",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "00bad604-5693-4f41-9554-f3bd588ad7fb",
              "toNodeId": "32fd691d-0758-409e-815a-e4b61e67ebc4"
            },
            "e12514c8-49a7-4d92-928e-8c9d87843e64": {
              "id": "e12514c8-49a7-4d92-928e-8c9d87843e64",
              "name": "Malicious - Duplicate",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "toNodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b"
            },
            "e4f753b2-2447-4722-b2ac-827ae0f921be": {
              "id": "e4f753b2-2447-4722-b2ac-827ae0f921be",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6f8501ec-2962-469d-90d1-d4e422598efc",
              "toNodeId": "68fe6e99-5170-434d-b25c-61679046b716"
            },
            "e8235a5b-332e-43c7-847f-b64d9ec8c9e6": {
              "id": "e8235a5b-332e-43c7-847f-b64d9ec8c9e6",
              "name": "",
              "description": "",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "45f8c588-227a-4745-ae51-a753b9e5aa17",
              "toNodeId": "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a"
            },
            "e8402c38-84ef-441d-bfbc-df3cbf32d339": {
              "id": "e8402c38-84ef-441d-bfbc-df3cbf32d339",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "90b542cf-e534-458d-b29d-09bba147bd6f",
              "toNodeId": "a522e423-bf66-43dc-9de1-c99dbde69e7a"
            },
            "ed6a19f0-948d-474d-a078-5c52d9cb2547": {
              "id": "ed6a19f0-948d-474d-a078-5c52d9cb2547",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf",
              "toNodeId": "ca318aa3-f50e-4d6d-bebf-6532862cbad8"
            },
            "ed92bb48-1764-4c57-bb57-1a8c42a25824": {
              "id": "ed92bb48-1764-4c57-bb57-1a8c42a25824",
              "name": "Matched",
              "description": "Email matched the emergency response pattern match and will be auto responded to.",
              "parentNodeId": "",
              "fromNodeId": "977cd375-1e31-446e-9643-95e0834e80cc",
              "toNodeId": "10410922-dc49-47a5-89d0-a15590e842a1"
            },
            "ee19a44f-7527-4fd4-8a8d-365b1f6996c3": {
              "id": "ee19a44f-7527-4fd4-8a8d-365b1f6996c3",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b",
              "toNodeId": ""
            },
            "eebbb59c-b6ac-447b-9d2a-ad486014813c": {
              "id": "eebbb59c-b6ac-447b-9d2a-ad486014813c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f",
              "toNodeId": "4d53647b-3359-4ac3-adc7-8d98098d5ae9"
            },
            "ef03d3bb-7ffb-47ce-9251-919afa67b124": {
              "id": "ef03d3bb-7ffb-47ce-9251-919afa67b124",
              "name": "All Others",
              "description": "Exits loop and continues workflow",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "2ad959a3-e4fd-4113-ba68-a5154a59e1f5",
              "toNodeId": ""
            },
            "ef6a6588-36bb-4a1b-833c-fb8b43801a14": {
              "id": "ef6a6588-36bb-4a1b-833c-fb8b43801a14",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "15899f2f-0d41-486d-b55f-1395b27518f9",
              "toNodeId": "014137b4-2a9f-46c3-8d4e-f682ce2b3f09"
            },
            "f1bb0d48-1993-4987-86ba-2c4d60f72c4e": {
              "id": "f1bb0d48-1993-4987-86ba-2c4d60f72c4e",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "6be7944f-d0b8-48d2-90a9-4c0f48521084",
              "toNodeId": "44cf989f-13e5-4491-a14c-03ff136c63c7"
            },
            "f1bd3e7b-e1d3-4a6b-8d06-b21fcd853f41": {
              "id": "f1bd3e7b-e1d3-4a6b-8d06-b21fcd853f41",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "52fd62b5-e6cb-4d32-965a-8a747cb77cf3",
              "toNodeId": "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d"
            },
            "f4d6f245-ac42-4cd2-a49f-88f85afb264a": {
              "id": "f4d6f245-ac42-4cd2-a49f-88f85afb264a",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "8f23af0b-dbc6-4937-a55d-3bf79399ad13",
              "toNodeId": "a84e53f0-c48f-4980-b509-fdb75ee6f055"
            },
            "f7c6587d-284c-4e73-9e01-836a325b0455": {
              "id": "f7c6587d-284c-4e73-9e01-836a325b0455",
              "name": "Matched",
              "description": "Sender and Subject match found on 2nd check.",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "fromNodeId": "32fd691d-0758-409e-815a-e4b61e67ebc4",
              "toNodeId": "80f39b12-16ae-45ed-ab52-18e0b2433b65"
            },
            "f8ef1536-0aba-4840-80fa-4a76920a85d0": {
              "id": "f8ef1536-0aba-4840-80fa-4a76920a85d0",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b",
              "toNodeId": "85333f2b-5aa6-46f4-af09-c738cf0d8523"
            },
            "fc6718a0-bb67-44ec-81e6-ceef2a16b271": {
              "id": "fc6718a0-bb67-44ec-81e6-ceef2a16b271",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "3ce6e171-5374-49e5-94f6-f7d059f7dc87",
              "toNodeId": "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189"
            },
            "fd0ad173-2b88-4436-9935-091cfa75599c": {
              "id": "fd0ad173-2b88-4436-9935-091cfa75599c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74",
              "toNodeId": "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b"
            },
            "fd859e29-c570-460a-87ed-183be2ec294e": {
              "id": "fd859e29-c570-460a-87ed-183be2ec294e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "68fe6e99-5170-434d-b25c-61679046b716",
              "toNodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74"
            },
            "fdf8f57c-a504-434b-b746-7736c3f4aac5": {
              "id": "fdf8f57c-a504-434b-b746-7736c3f4aac5",
              "name": "",
              "description": "",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "fromNodeId": "2f249df2-05dc-475f-8913-a4c596291a21",
              "toNodeId": "314e5653-a364-49b3-bf08-6812c1ed9038"
            },
            "fe2cf1fe-50c3-4df5-a205-be7faa7864b6": {
              "id": "fe2cf1fe-50c3-4df5-a205-be7faa7864b6",
              "name": "",
              "description": "",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "fromNodeId": "c9200333-bd34-4bbf-b3ca-cedbe640200b",
              "toNodeId": "61b8f486-3577-4100-a005-4a32173f0e77"
            },
            "febdc1df-9eb8-4f1e-8dd5-baee548ca810": {
              "id": "febdc1df-9eb8-4f1e-8dd5-baee548ca810",
              "name": "",
              "description": "",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "fromNodeId": "4b0e710c-c958-40c9-b4e1-4d04a5730c8e",
              "toNodeId": "d19d069c-a155-4e9f-9e39-a92368e571da"
            }
          },
          "nodes": {
            "00bad604-5693-4f41-9554-f3bd588ad7fb": {
              "id": "00bad604-5693-4f41-9554-f3bd588ad7fb",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "014137b4-2a9f-46c3-8d4e-f682ce2b3f09": {
              "id": "014137b4-2a9f-46c3-8d4e-f682ce2b3f09",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687": {
              "id": "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687",
              "parentNodeId": ""
            },
            "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6": {
              "id": "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6",
              "parentNodeId": ""
            },
            "10410922-dc49-47a5-89d0-a15590e842a1": {
              "id": "10410922-dc49-47a5-89d0-a15590e842a1",
              "parentNodeId": ""
            },
            "15899f2f-0d41-486d-b55f-1395b27518f9": {
              "id": "15899f2f-0d41-486d-b55f-1395b27518f9",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e": {
              "id": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e",
              "parentNodeId": ""
            },
            "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27": {
              "id": "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27",
              "parentNodeId": ""
            },
            "1d768b4b-de25-459b-b8b1-cdc69fe075c6": {
              "id": "1d768b4b-de25-459b-b8b1-cdc69fe075c6",
              "parentNodeId": ""
            },
            "1e315dc2-b058-4179-bfca-57d3354f37e7": {
              "id": "1e315dc2-b058-4179-bfca-57d3354f37e7",
              "parentNodeId": ""
            },
            "21722583-47f3-4912-95fd-53b88384c00f": {
              "id": "21722583-47f3-4912-95fd-53b88384c00f",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "273eaa07-0b6f-49f1-ae04-8966fa3385f9": {
              "id": "273eaa07-0b6f-49f1-ae04-8966fa3385f9",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "29cf0d94-e6e4-4bee-9995-b09a2f1580a5": {
              "id": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "2ad959a3-e4fd-4113-ba68-a5154a59e1f5": {
              "id": "2ad959a3-e4fd-4113-ba68-a5154a59e1f5",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a": {
              "id": "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "2b2508ba-5a8d-4271-9bf0-90e316f45485": {
              "id": "2b2508ba-5a8d-4271-9bf0-90e316f45485",
              "parentNodeId": ""
            },
            "2c7a768c-90be-4842-803a-21a2ea9bc427": {
              "id": "2c7a768c-90be-4842-803a-21a2ea9bc427",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "2f249df2-05dc-475f-8913-a4c596291a21": {
              "id": "2f249df2-05dc-475f-8913-a4c596291a21",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "2fd2481b-af28-42ff-ab10-b57d1272e77b": {
              "id": "2fd2481b-af28-42ff-ab10-b57d1272e77b",
              "parentNodeId": ""
            },
            "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8": {
              "id": "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "314e5653-a364-49b3-bf08-6812c1ed9038": {
              "id": "314e5653-a364-49b3-bf08-6812c1ed9038",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "32fd691d-0758-409e-815a-e4b61e67ebc4": {
              "id": "32fd691d-0758-409e-815a-e4b61e67ebc4",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "3988477a-043e-4649-b43d-b7ad49d10d98": {
              "id": "3988477a-043e-4649-b43d-b7ad49d10d98",
              "parentNodeId": ""
            },
            "3a062890-a1b1-4e4d-97ef-80b45dc43c69": {
              "id": "3a062890-a1b1-4e4d-97ef-80b45dc43c69",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "3bd68547-f860-4725-874b-42f284fa0340": {
              "id": "3bd68547-f860-4725-874b-42f284fa0340",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "3ce6e171-5374-49e5-94f6-f7d059f7dc87": {
              "id": "3ce6e171-5374-49e5-94f6-f7d059f7dc87",
              "parentNodeId": ""
            },
            "4291176f-1aaf-415b-96e6-c6ac812f6c90": {
              "id": "4291176f-1aaf-415b-96e6-c6ac812f6c90",
              "parentNodeId": ""
            },
            "44cf989f-13e5-4491-a14c-03ff136c63c7": {
              "id": "44cf989f-13e5-4491-a14c-03ff136c63c7",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "45f8c588-227a-4745-ae51-a753b9e5aa17": {
              "id": "45f8c588-227a-4745-ae51-a753b9e5aa17",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "4850cf11-b7b2-4a3f-8674-13fb59b7713e": {
              "id": "4850cf11-b7b2-4a3f-8674-13fb59b7713e",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "4b0e710c-c958-40c9-b4e1-4d04a5730c8e": {
              "id": "4b0e710c-c958-40c9-b4e1-4d04a5730c8e",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "4d53647b-3359-4ac3-adc7-8d98098d5ae9": {
              "id": "4d53647b-3359-4ac3-adc7-8d98098d5ae9",
              "parentNodeId": ""
            },
            "4dc47e0e-2e3c-4308-9c41-39ca6597b585": {
              "id": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
              "parentNodeId": ""
            },
            "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d": {
              "id": "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d",
              "parentNodeId": ""
            },
            "501db4bb-46db-41b3-a31e-759c5f470156": {
              "id": "501db4bb-46db-41b3-a31e-759c5f470156",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "52fd62b5-e6cb-4d32-965a-8a747cb77cf3": {
              "id": "52fd62b5-e6cb-4d32-965a-8a747cb77cf3",
              "parentNodeId": ""
            },
            "53d69710-7fd5-4da7-b987-340f574ff50c": {
              "id": "53d69710-7fd5-4da7-b987-340f574ff50c",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "5b2815ca-42bf-42c0-8764-4af5d963288e": {
              "id": "5b2815ca-42bf-42c0-8764-4af5d963288e",
              "parentNodeId": ""
            },
            "61b8f486-3577-4100-a005-4a32173f0e77": {
              "id": "61b8f486-3577-4100-a005-4a32173f0e77",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "644803ff-4329-48ad-9a04-9b52d8c261a2": {
              "id": "644803ff-4329-48ad-9a04-9b52d8c261a2",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "66b11adc-777d-42cf-9ef3-823b79bb3b4d": {
              "id": "66b11adc-777d-42cf-9ef3-823b79bb3b4d",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "67f18fe7-b650-4c5a-b8d1-b65d1d08e241": {
              "id": "67f18fe7-b650-4c5a-b8d1-b65d1d08e241",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "68ba176b-5c2c-4f19-9c58-d7ce436ab359": {
              "id": "68ba176b-5c2c-4f19-9c58-d7ce436ab359",
              "parentNodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d"
            },
            "68fe6e99-5170-434d-b25c-61679046b716": {
              "id": "68fe6e99-5170-434d-b25c-61679046b716",
              "parentNodeId": ""
            },
            "690633fd-7bc5-43bd-9dda-df85e0fd4a98": {
              "id": "690633fd-7bc5-43bd-9dda-df85e0fd4a98",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "690f7f6f-e73c-4697-a864-bd24890d3ea3": {
              "id": "690f7f6f-e73c-4697-a864-bd24890d3ea3",
              "parentNodeId": ""
            },
            "6b2b38e4-5baa-4cc2-9c93-22189dbec73d": {
              "id": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
              "parentNodeId": ""
            },
            "6be7944f-d0b8-48d2-90a9-4c0f48521084": {
              "id": "6be7944f-d0b8-48d2-90a9-4c0f48521084",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "6c5aa972-c945-40d0-ac6e-9a23bca67de7": {
              "id": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
              "parentNodeId": ""
            },
            "6deb7d73-397b-4c4e-b675-d44c3df6b3c2": {
              "id": "6deb7d73-397b-4c4e-b675-d44c3df6b3c2",
              "parentNodeId": ""
            },
            "6f8501ec-2962-469d-90d1-d4e422598efc": {
              "id": "6f8501ec-2962-469d-90d1-d4e422598efc",
              "parentNodeId": ""
            },
            "6f89ada2-f1f6-4be7-baf9-e2614ac931e5": {
              "id": "6f89ada2-f1f6-4be7-baf9-e2614ac931e5",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "709ad45a-7e3b-4815-be07-31dd93397b00": {
              "id": "709ad45a-7e3b-4815-be07-31dd93397b00",
              "parentNodeId": ""
            },
            "7a0470b1-8d15-4b5f-8b58-423179b2c73d": {
              "id": "7a0470b1-8d15-4b5f-8b58-423179b2c73d",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "7df69e7c-5be3-49e6-af5f-01fdfc0a4864": {
              "id": "7df69e7c-5be3-49e6-af5f-01fdfc0a4864",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a": {
              "id": "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b": {
              "id": "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b",
              "parentNodeId": ""
            },
            "80f39b12-16ae-45ed-ab52-18e0b2433b65": {
              "id": "80f39b12-16ae-45ed-ab52-18e0b2433b65",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "82246ef6-485b-4871-b024-df70469e40d7": {
              "id": "82246ef6-485b-4871-b024-df70469e40d7",
              "parentNodeId": ""
            },
            "85333f2b-5aa6-46f4-af09-c738cf0d8523": {
              "id": "85333f2b-5aa6-46f4-af09-c738cf0d8523",
              "parentNodeId": ""
            },
            "87d6ae7a-3d87-4dbc-994e-7a814b2fba74": {
              "id": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74",
              "parentNodeId": ""
            },
            "8f23af0b-dbc6-4937-a55d-3bf79399ad13": {
              "id": "8f23af0b-dbc6-4937-a55d-3bf79399ad13",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "90b542cf-e534-458d-b29d-09bba147bd6f": {
              "id": "90b542cf-e534-458d-b29d-09bba147bd6f",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "96b7e996-b326-425f-8d47-46ef7fdf8dc9": {
              "id": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
              "parentNodeId": ""
            },
            "977cd375-1e31-446e-9643-95e0834e80cc": {
              "id": "977cd375-1e31-446e-9643-95e0834e80cc",
              "parentNodeId": ""
            },
            "97c230b0-575b-4eee-8c25-1a2b8b5bffc2": {
              "id": "97c230b0-575b-4eee-8c25-1a2b8b5bffc2",
              "parentNodeId": ""
            },
            "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b": {
              "id": "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b",
              "parentNodeId": ""
            },
            "a33cec55-fe59-43bb-a5ee-e8721aa57fb7": {
              "id": "a33cec55-fe59-43bb-a5ee-e8721aa57fb7",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "a522e423-bf66-43dc-9de1-c99dbde69e7a": {
              "id": "a522e423-bf66-43dc-9de1-c99dbde69e7a",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "a5e0212f-9108-4790-bde7-f9b9424db280": {
              "id": "a5e0212f-9108-4790-bde7-f9b9424db280",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "a84e53f0-c48f-4980-b509-fdb75ee6f055": {
              "id": "a84e53f0-c48f-4980-b509-fdb75ee6f055",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63": {
              "id": "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "b89f9f45-1da7-4ecf-bd55-7d11c79e4379": {
              "id": "b89f9f45-1da7-4ecf-bd55-7d11c79e4379",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9": {
              "id": "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9",
              "parentNodeId": ""
            },
            "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f": {
              "id": "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f",
              "parentNodeId": ""
            },
            "bee9301f-349c-451e-8e0c-85ffdc970bad": {
              "id": "bee9301f-349c-451e-8e0c-85ffdc970bad",
              "parentNodeId": ""
            },
            "c0396569-5cc0-4862-b17b-ef30ef76c88e": {
              "id": "c0396569-5cc0-4862-b17b-ef30ef76c88e",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "c17cdd06-06fd-474d-abf8-052fbf783705": {
              "id": "c17cdd06-06fd-474d-abf8-052fbf783705",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "c1cf7d0c-2033-43e2-9236-b7b7141dbc83": {
              "id": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
              "parentNodeId": ""
            },
            "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8": {
              "id": "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf": {
              "id": "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "c3b82488-db93-4658-9e3a-aea776396fac": {
              "id": "c3b82488-db93-4658-9e3a-aea776396fac",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "c502d2e3-d855-4cfa-a9c9-78376047b4b5": {
              "id": "c502d2e3-d855-4cfa-a9c9-78376047b4b5",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "c5ff84f8-a45c-496e-aa18-2753aaff5911": {
              "id": "c5ff84f8-a45c-496e-aa18-2753aaff5911",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "c62efedd-92c3-461f-95fc-e68f499af5bf": {
              "id": "c62efedd-92c3-461f-95fc-e68f499af5bf",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "c9200333-bd34-4bbf-b3ca-cedbe640200b": {
              "id": "c9200333-bd34-4bbf-b3ca-cedbe640200b",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "ca318aa3-f50e-4d6d-bebf-6532862cbad8": {
              "id": "ca318aa3-f50e-4d6d-bebf-6532862cbad8",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "cb49145d-05f3-4942-b9a9-343a73885baf": {
              "id": "cb49145d-05f3-4942-b9a9-343a73885baf",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "d19d069c-a155-4e9f-9e39-a92368e571da": {
              "id": "d19d069c-a155-4e9f-9e39-a92368e571da",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "d4d3458c-86ff-4ca8-a169-2156a26a5fdb": {
              "id": "d4d3458c-86ff-4ca8-a169-2156a26a5fdb",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "d6508a73-a938-4c0d-9413-2b90e28b2bf6": {
              "id": "d6508a73-a938-4c0d-9413-2b90e28b2bf6",
              "parentNodeId": ""
            },
            "db200383-9d5f-4902-afde-7cea924d9b4b": {
              "id": "db200383-9d5f-4902-afde-7cea924d9b4b",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf": {
              "id": "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "e165e514-e977-4925-ad67-34e4237f8690": {
              "id": "e165e514-e977-4925-ad67-34e4237f8690",
              "parentNodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585"
            },
            "e1bb581f-c9ba-4ddb-bb52-1404f29634e7": {
              "id": "e1bb581f-c9ba-4ddb-bb52-1404f29634e7",
              "parentNodeId": ""
            },
            "e1e19b83-9f7f-4796-93e8-45b83e4eb56a": {
              "id": "e1e19b83-9f7f-4796-93e8-45b83e4eb56a",
              "parentNodeId": ""
            },
            "e4a61c22-bab6-4271-b38e-36480c995f31": {
              "id": "e4a61c22-bab6-4271-b38e-36480c995f31",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "e548779c-7d46-4ec3-b6ff-3a3762169ea4": {
              "id": "e548779c-7d46-4ec3-b6ff-3a3762169ea4",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e": {
              "id": "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "e761af32-69c3-453a-ab25-bec6300d7892": {
              "id": "e761af32-69c3-453a-ab25-bec6300d7892",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "e782dcb8-5bdb-459f-8e20-c7953f0aab9d": {
              "id": "e782dcb8-5bdb-459f-8e20-c7953f0aab9d",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "e9f74950-f2cd-491d-8a9c-bce149e870c3": {
              "id": "e9f74950-f2cd-491d-8a9c-bce149e870c3",
              "parentNodeId": ""
            },
            "ea580d9a-7197-41f6-bf89-9bdf2248f43b": {
              "id": "ea580d9a-7197-41f6-bf89-9bdf2248f43b",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            },
            "ec480a75-3600-433a-9dd4-b1f02c5b1f9b": {
              "id": "ec480a75-3600-433a-9dd4-b1f02c5b1f9b",
              "parentNodeId": "709ad45a-7e3b-4815-be07-31dd93397b00"
            },
            "f041b903-bfd6-4807-8dad-b825b5266694": {
              "id": "f041b903-bfd6-4807-8dad-b825b5266694",
              "parentNodeId": ""
            },
            "f2310ff3-c087-463e-9193-5b36a011710f": {
              "id": "f2310ff3-c087-463e-9193-5b36a011710f",
              "parentNodeId": ""
            },
            "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f": {
              "id": "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f",
              "parentNodeId": ""
            },
            "f552eaf6-5636-448f-9027-a481a30019d9": {
              "id": "f552eaf6-5636-448f-9027-a481a30019d9",
              "parentNodeId": ""
            },
            "f5b6133e-9280-4e08-b950-7a5c223425da": {
              "id": "f5b6133e-9280-4e08-b950-7a5c223425da",
              "parentNodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9"
            },
            "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189": {
              "id": "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189",
              "parentNodeId": ""
            },
            "f630ffdd-6958-4773-baee-6db6c0a2326c": {
              "id": "f630ffdd-6958-4773-baee-6db6c0a2326c",
              "parentNodeId": ""
            },
            "f8ebdaad-c32f-4676-a79c-d61879ecface": {
              "id": "f8ebdaad-c32f-4676-a79c-d61879ecface",
              "parentNodeId": ""
            },
            "f9ead5e0-e71b-42da-b9e6-171e659634bb": {
              "id": "f9ead5e0-e71b-42da-b9e6-171e659634bb",
              "parentNodeId": ""
            },
            "fab37fff-5672-4689-9023-3af4e8cbaf60": {
              "id": "fab37fff-5672-4689-9023-3af4e8cbaf60",
              "parentNodeId": ""
            },
            "ff9b4235-bbca-4378-a25b-c890f4fd2934": {
              "id": "ff9b4235-bbca-4378-a25b-c890f4fd2934",
              "parentNodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83"
            }
          }
        },
        "steps": {
          "00bad604-5693-4f41-9554-f3bd588ad7fb": {
            "nodeId": "00bad604-5693-4f41-9554-f3bd588ad7fb",
            "name": "Check for Blank Subject",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e115c992-0bd2-4571-a545-e16da411c191",
              "stepControlParams": [
                {
                  "edgeId": "314d9bec-c0af-4628-b652-f54ca302723b",
                  "expression": {
                    "left": {
                      "name": "96b7e996-b326-425f-8d47-46ef7fdf8dc9.Subject",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": ""
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject]}}=\"\""
                },
                {
                  "edgeId": "e115c992-0bd2-4571-a545-e16da411c191",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "014137b4-2a9f-46c3-8d4e-f682ce2b3f09": {
            "nodeId": "014137b4-2a9f-46c3-8d4e-f682ce2b3f09",
            "name": "Subject Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Subject]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687": {
            "nodeId": "0ad0959f-0d07-4d1d-bb95-d7bb78b2c687",
            "name": "Search and Purge - Spam",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c6308e49-4804-4ad3-a3fc-66ed849a3078",
              "stepControlParams": [
                {
                  "edgeId": "c6308e49-4804-4ad3-a3fc-66ed849a3078",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "b1ee66be-8f24-4d9b-b6ef-15248135e087",
                  "expression": {
                    "left": {
                      "name": "f9ead5e0-e71b-42da-b9e6-171e659634bb.Search and Purge",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[f9ead5e0-e71b-42da-b9e6-171e659634bb].[Search and Purge]}}=true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6": {
            "nodeId": "0f6ab7d9-a074-464c-ab3a-db5859bf2cb6",
            "name": "Spam Add to Database",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Spam",
                "Sender": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}",
                "Subject": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "10410922-dc49-47a5-89d0-a15590e842a1": {
            "nodeId": "10410922-dc49-47a5-89d0-a15590e842a1",
            "name": "Emergency Response Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": [],
                "bcc": [],
                "body": "{{[$workflow].[Emergency Response Body]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "description": "Accepts one or more attachment represented as a file type which contains the filename and the file content encoded with base64",
                  "items": {
                    "$ref": "#/definitions/file"
                  },
                  "order": 8,
                  "title": "Attachment",
                  "type": "array"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "One or more email addresses of recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Email To",
                  "type": "array"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_to",
                "subject",
                "body",
                "is_html",
                "email_from"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "15899f2f-0d41-486d-b55f-1395b27518f9": {
            "nodeId": "15899f2f-0d41-486d-b55f-1395b27518f9",
            "name": "Sender Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[ca318aa3-f50e-4d6d-bebf-6532862cbad8].[emails].[0]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e": {
            "nodeId": "1bdca0f4-9240-4a21-99ba-ae3c1b82e13e",
            "name": "Search and Purge Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "b1ee66be-8f24-4d9b-b6ef-15248135e087",
                "7ad13bfb-8758-41b9-b35b-7911f0ba14eb",
                "8e35c770-75eb-4f17-ae4f-3285b096231e"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27": {
            "nodeId": "1c2f3f7f-9c88-46ad-a6bb-a1b91a23ae27",
            "name": "Search and Purge",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "000221bd-6883-4367-8d06-1db61809852c",
              "stepControlParams": [
                {
                  "edgeId": "000221bd-6883-4367-8d06-1db61809852c",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "7ad13bfb-8758-41b9-b35b-7911f0ba14eb",
                  "expression": {
                    "left": {
                      "name": "2fd2481b-af28-42ff-ab10-b57d1272e77b.Search and Purge",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[2fd2481b-af28-42ff-ab10-b57d1272e77b].[Search and Purge]}}=true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "1d768b4b-de25-459b-b8b1-cdc69fe075c6": {
            "nodeId": "1d768b4b-de25-459b-b8b1-cdc69fe075c6",
            "name": "Email Information",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "###### Reported By\n{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}\n###### Subject\n{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}\n\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "1e315dc2-b058-4179-bfca-57d3354f37e7": {
            "nodeId": "1e315dc2-b058-4179-bfca-57d3354f37e7",
            "name": "Emergency Response Move",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "move_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[id]}}",
                "folder_name": "{{$workflow.[Reviewed Folder]}}",
                "mailbox_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "The email ID to retrieve",
                  "order": 2,
                  "title": "Email ID",
                  "type": "string"
                },
                "folder_name": {
                  "description": "The destination folder name",
                  "order": 3,
                  "title": "Folder Name",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Mailbox ID",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "email_id",
                "folder_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was move successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "21722583-47f3-4912-95fd-53b88384c00f": {
            "nodeId": "21722583-47f3-4912-95fd-53b88384c00f",
            "name": "Header Base64 Decode",
            "type": "action",
            "plugin": {
              "name": "Base64",
              "slugVendor": "rapid7",
              "slugName": "base64",
              "slugVersion": "1.1.6",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/base64/1.1.6/icon.png"
            },
            "identifier": "decode",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "base64": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[$item].[content]}}",
                "errors": "ignore"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "base64": {
                  "description": "Data to decode",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Base64",
                  "type": "string"
                },
                "errors": {
                  "default": "nothing",
                  "description": "How errors should be handled when decoding Base64",
                  "enum": [
                    "replace",
                    "ignore",
                    "nothing"
                  ],
                  "order": 2,
                  "title": "Errors",
                  "type": "string"
                }
              },
              "required": [
                "base64"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Decoded data result",
                  "order": 1,
                  "title": "Decoded Data",
                  "type": "string"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "273eaa07-0b6f-49f1-ae04-8966fa3385f9": {
            "nodeId": "273eaa07-0b6f-49f1-ae04-8966fa3385f9",
            "name": "2nd Check Malicious",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Malicious",
              "expressions": [
                {
                  "type": "text",
                  "value": "Malicious"
                }
              ],
              "ignoreCase": true,
              "input": "{{[a33cec55-fe59-43bb-a5ee-e8721aa57fb7].[matches]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "29cf0d94-e6e4-4bee-9995-b09a2f1580a5": {
            "nodeId": "29cf0d94-e6e4-4bee-9995-b09a2f1580a5",
            "name": "Response Decision",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "3a126479-2838-427f-8b17-41272d823a87",
              "stepControlParams": [
                {
                  "edgeId": "17c428c1-cfd4-4216-a771-d221a3dbbdfe",
                  "expression": {
                    "left": {
                      "name": "e761af32-69c3-453a-ab25-bec6300d7892.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[e761af32-69c3-453a-ab25-bec6300d7892].[$matched]}}=true"
                },
                {
                  "edgeId": "3a126479-2838-427f-8b17-41272d823a87",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "41de6e03-50df-43e8-88a3-87b357682567",
                  "expression": {
                    "left": {
                      "name": "6be7944f-d0b8-48d2-90a9-4c0f48521084.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[6be7944f-d0b8-48d2-90a9-4c0f48521084].[$matched]}}=true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "2ad959a3-e4fd-4113-ba68-a5154a59e1f5": {
            "nodeId": "2ad959a3-e4fd-4113-ba68-a5154a59e1f5",
            "name": "Header / Other",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2fc3f890-acba-4790-9f4e-60ff24721c7c",
              "stepControlParams": [
                {
                  "edgeId": "2fc3f890-acba-4790-9f4e-60ff24721c7c",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "ef03d3bb-7ffb-47ce-9251-919afa67b124",
                  "expression": {
                    "left": {
                      "name": "3bd68547-f860-4725-874b-42f284fa0340.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[3bd68547-f860-4725-874b-42f284fa0340].[$matched]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a": {
            "nodeId": "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a",
            "name": "2nd Sender check",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Sender"
                },
                "op": "=",
                "right": {
                  "name": "96b7e996-b326-425f-8d47-46ef7fdf8dc9.Sender.0",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Sender' = {{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "2b2508ba-5a8d-4271-9bf0-90e316f45485": {
            "nodeId": "2b2508ba-5a8d-4271-9bf0-90e316f45485",
            "name": "Body Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6",
                "59e9b243-5ac6-4768-b1a9-f0051f30ee69"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Email Body",
                  "type": "string",
                  "variables": {
                    "59e9b243-5ac6-4768-b1a9-f0051f30ee69": "{{[e9f74950-f2cd-491d-8a9c-bce149e870c3].[text]}}",
                    "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6": "{{[6b2b38e4-5baa-4cc2-9c93-22189dbec73d].[AttachedBody].[0]}}"
                  }
                },
                {
                  "arrayType": "string",
                  "inputBuilderSchemas": null,
                  "name": "URLs",
                  "type": "array",
                  "variables": {
                    "59e9b243-5ac6-4768-b1a9-f0051f30ee69": "{{[e1e19b83-9f7f-4796-93e8-45b83e4eb56a].[urls]}}",
                    "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6": "{{[3988477a-043e-4649-b43d-b7ad49d10d98].[urls]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Email Body": {
                  "description": "Emitted variable \"Email Body\"",
                  "order": 1,
                  "title": "Email Body",
                  "type": "string"
                },
                "URLs": {
                  "description": "Emitted variable \"URLs\"",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Email Body": {
                  "description": "Emitted variable \"Email Body\"",
                  "order": 1,
                  "title": "Email Body",
                  "type": "string"
                },
                "URLs": {
                  "description": "Emitted variable \"URLs\"",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "2c7a768c-90be-4842-803a-21a2ea9bc427": {
            "nodeId": "2c7a768c-90be-4842-803a-21a2ea9bc427",
            "name": "Header Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "92375286-f055-4673-8004-70b3a51fb583",
                "46855705-02a5-48ea-bb63-8ebaed0b471b"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "2f249df2-05dc-475f-8913-a4c596291a21": {
            "nodeId": "2f249df2-05dc-475f-8913-a4c596291a21",
            "name": "URL on Blocklist",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "true",
              "expressions": [
                {
                  "type": "text",
                  "value": "true"
                }
              ],
              "ignoreCase": true,
              "input": "{{[ff9b4235-bbca-4378-a25b-c890f4fd2934].[stdout]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "2fd2481b-af28-42ff-ab10-b57d1272e77b": {
            "nodeId": "2fd2481b-af28-42ff-ab10-b57d1272e77b",
            "name": "Malicious Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "e12514c8-49a7-4d92-928e-8c9d87843e64",
                "0bce2227-3360-4947-8fa2-91f06368936c",
                "4a977bd1-2862-45d7-970d-7b3d961a9df9",
                "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Search and Purge",
                  "type": "boolean",
                  "variables": {
                    "0bce2227-3360-4947-8fa2-91f06368936c": false,
                    "4a977bd1-2862-45d7-970d-7b3d961a9df9": true,
                    "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89": true,
                    "e12514c8-49a7-4d92-928e-8c9d87843e64": false
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "MaliciousDecision",
                  "type": "string",
                  "variables": {
                    "0bce2227-3360-4947-8fa2-91f06368936c": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[path]}}",
                    "4a977bd1-2862-45d7-970d-7b3d961a9df9": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[path]}}",
                    "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[path]}}",
                    "e12514c8-49a7-4d92-928e-8c9d87843e64": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[path]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "MaliciousDecisionMaker",
                  "type": "string",
                  "variables": {
                    "0bce2227-3360-4947-8fa2-91f06368936c": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                    "4a977bd1-2862-45d7-970d-7b3d961a9df9": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                    "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[display_name]}}",
                    "e12514c8-49a7-4d92-928e-8c9d87843e64": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[display_name]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "MaliciousDecisionMethod",
                  "type": "string",
                  "variables": {
                    "0bce2227-3360-4947-8fa2-91f06368936c": "Human",
                    "4a977bd1-2862-45d7-970d-7b3d961a9df9": "Human",
                    "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89": "Slack",
                    "e12514c8-49a7-4d92-928e-8c9d87843e64": "Slack"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "MaliciousDecision": {
                  "description": "Emitted variable \"MaliciousDecision\"",
                  "order": 2,
                  "title": "MaliciousDecision",
                  "type": "string"
                },
                "MaliciousDecisionMaker": {
                  "description": "Emitted variable \"MaliciousDecisionMaker\"",
                  "order": 3,
                  "title": "MaliciousDecisionMaker",
                  "type": "string"
                },
                "MaliciousDecisionMethod": {
                  "description": "Emitted variable \"MaliciousDecisionMethod\"",
                  "order": 4,
                  "title": "MaliciousDecisionMethod",
                  "type": "string"
                },
                "Search and Purge": {
                  "description": "Emitted variable \"Search and Purge\"",
                  "order": 1,
                  "title": "Search and Purge",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "MaliciousDecision": {
                  "description": "Emitted variable \"MaliciousDecision\"",
                  "order": 2,
                  "title": "MaliciousDecision",
                  "type": "string"
                },
                "MaliciousDecisionMaker": {
                  "description": "Emitted variable \"MaliciousDecisionMaker\"",
                  "order": 3,
                  "title": "MaliciousDecisionMaker",
                  "type": "string"
                },
                "MaliciousDecisionMethod": {
                  "description": "Emitted variable \"MaliciousDecisionMethod\"",
                  "order": 4,
                  "title": "MaliciousDecisionMethod",
                  "type": "string"
                },
                "Search and Purge": {
                  "description": "Emitted variable \"Search and Purge\"",
                  "order": 1,
                  "title": "Search and Purge",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8": {
            "nodeId": "30dc6ea8-6c35-49bc-87b4-6ee12c0b70b8",
            "name": "Header Malicious Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Malicious",
                "Sender": "{{[ca318aa3-f50e-4d6d-bebf-6532862cbad8].[emails].[0]}}",
                "Subject": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Subject]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "314e5653-a364-49b3-bf08-6812c1ed9038": {
            "nodeId": "314e5653-a364-49b3-bf08-6812c1ed9038",
            "name": "Screenshot Grab",
            "type": "action",
            "plugin": {
              "name": "Screenshot a URL",
              "slugVendor": "rapid7",
              "slugName": "url_screenshot",
              "slugVersion": "1.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/url_screenshot/1.0.1/icon.png"
            },
            "identifier": "screenshot",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delay": 10,
                "full_page": false,
                "url": "{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delay": {
                  "description": "Delay (in seconds) after page has loaded before screenshot",
                  "order": 2,
                  "title": "Delay",
                  "type": "integer"
                },
                "full_page": {
                  "default": false,
                  "description": "Export screenshot of \"body\" element instead of the default viewport.  This \"body\" element may have some formatting issues but should contain all elements of the page",
                  "order": 3,
                  "title": "Full Page Capture",
                  "type": "boolean"
                },
                "url": {
                  "description": "URL to screenshot",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "full_page",
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "screenshot": {
                  "description": "The resulting PNG screenshot of the URL",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "Screenshot",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "32fd691d-0758-409e-815a-e4b61e67ebc4": {
            "nodeId": "32fd691d-0758-409e-815a-e4b61e67ebc4",
            "name": "2nd Match Check",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "a528f454-fd0a-4d2d-af56-8c65b953c544",
              "stepControlParams": [
                {
                  "edgeId": "f7c6587d-284c-4e73-9e01-836a325b0455",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "a33cec55-fe59-43bb-a5ee-e8721aa57fb7.found",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[a33cec55-fe59-43bb-a5ee-e8721aa57fb7].[found]}}=true AND {{[2adf35c8-7fb9-4354-8a94-4b4d9e6e9a9a].[$success]}}=true"
                },
                {
                  "edgeId": "a528f454-fd0a-4d2d-af56-8c65b953c544",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "3988477a-043e-4649-b43d-b7ad49d10d98": {
            "nodeId": "3988477a-043e-4649-b43d-b7ad49d10d98",
            "name": "Attached Email - URL Extraction",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[flattened_attached_emails]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "3a062890-a1b1-4e4d-97ef-80b45dc43c69": {
            "nodeId": "3a062890-a1b1-4e4d-97ef-80b45dc43c69",
            "name": "Automated Response - Malicious",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Malicious Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "3bd68547-f860-4725-874b-42f284fa0340": {
            "nodeId": "3bd68547-f860-4725-874b-42f284fa0340",
            "name": "Header Match",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "^headers.*$",
              "expressions": [
                {
                  "type": "text",
                  "value": "^headers.*$"
                }
              ],
              "ignoreCase": true,
              "input": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[$item].[file_name]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "3ce6e171-5374-49e5-94f6-f7d059f7dc87": {
            "nodeId": "3ce6e171-5374-49e5-94f6-f7d059f7dc87",
            "name": "Slack Timeout Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "ATTENTION\n\nSlack timed out and defaulted to malicious for the below email. Please review and make any blocks as needed.\n\nReported By:\n{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}\n\nOriginal Sender:\n{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}\n\nOriginal Subject:\n{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "Slack Timeout Notification"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4291176f-1aaf-415b-96e6-c6ac812f6c90": {
            "nodeId": "4291176f-1aaf-415b-96e6-c6ac812f6c90",
            "name": "Email Body Extraction - PythonCode",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    \n    my_return_body = {}\n    email = params.get('email_body') # Get email body from workflow\n    \n    start_block_header = \"---------- Begin Email Headers ----------\"\n    end_block_header = \"---------- End Email Headers----------\"\n    start_block_reported = \"---------- Begin Reported Email ----------\"\n    end_block_reported = \"---------- End Reported Email ----------\"\n    \n    start_header = email.find(start_block_header)\n    end_header = email.find(end_block_header)\n    actual_header = email[start_header+len(start_block_header):end_header]\n    my_return_body[\"actual_header\"] = (actual_header)\n    \n    start_reported = email.find(start_block_reported)\n    end_reported = email.find(end_block_reported)\n    actual_reported = email[start_reported+len(start_block_reported):end_reported]\n    my_return_body[\"actual_reported\"] = (actual_reported)\n    return my_return_body",
                "input": {
                  "email_body": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[body]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "actual_reported": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "44cf989f-13e5-4491-a14c-03ff136c63c7": {
            "nodeId": "44cf989f-13e5-4491-a14c-03ff136c63c7",
            "name": "Test Match",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Test",
              "expressions": [
                {
                  "type": "text",
                  "value": "Test"
                }
              ],
              "ignoreCase": true,
              "input": "{{[e782dcb8-5bdb-459f-8e20-c7953f0aab9d].[matches]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "45f8c588-227a-4745-ae51-a753b9e5aa17": {
            "nodeId": "45f8c588-227a-4745-ae51-a753b9e5aa17",
            "name": "2nd Check Move Step",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "move_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[id]}}",
                "folder_name": "{{$workflow.[Reviewed Folder]}}",
                "mailbox_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "The email ID to retrieve",
                  "order": 2,
                  "title": "Email ID",
                  "type": "string"
                },
                "folder_name": {
                  "description": "The destination folder name",
                  "order": 3,
                  "title": "Folder Name",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Mailbox ID",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "email_id",
                "folder_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was move successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4850cf11-b7b2-4a3f-8674-13fb59b7713e": {
            "nodeId": "4850cf11-b7b2-4a3f-8674-13fb59b7713e",
            "name": "PDF File",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "(.PDF$)|(.pdf$)",
              "expressions": [
                {
                  "type": "text",
                  "value": "(.PDF$)|(.pdf$)"
                }
              ],
              "ignoreCase": true,
              "input": "{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[file_name]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "4b0e710c-c958-40c9-b4e1-4d04a5730c8e": {
            "nodeId": "4b0e710c-c958-40c9-b4e1-4d04a5730c8e",
            "name": "VirusTotal - Hash Lookup",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "6.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/6.0.5/icon.png"
            },
            "identifier": "lookup_hash",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[644803ff-4329-48ad-9a04-9b52d8c261a2].[submission].[sha256]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "MD5/SHA1/SHA256 hash to lookup",
                  "order": 1,
                  "title": "Hash",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "malicious": {
                  "description": "True if one or more positives",
                  "order": 2,
                  "title": "Malicious",
                  "type": "boolean"
                },
                "md5": {
                  "description": "MD5 hash",
                  "order": 12,
                  "title": "MD5",
                  "type": "string"
                },
                "permalink": {
                  "description": "Link to report (if found)",
                  "order": 4,
                  "title": "Permalink",
                  "type": "string"
                },
                "positives": {
                  "description": "Number of positives (if found)",
                  "order": 3,
                  "title": "Positives",
                  "type": "integer"
                },
                "resource": {
                  "description": "Resource",
                  "order": 5,
                  "title": "Resources",
                  "type": "string"
                },
                "response_code": {
                  "description": "Response code from the request",
                  "order": 1,
                  "title": "Response Code",
                  "type": "integer"
                },
                "scan_date": {
                  "description": "Scan Date",
                  "order": 7,
                  "title": "Scan Date",
                  "type": "string"
                },
                "scan_id": {
                  "description": "Scan ID",
                  "order": 6,
                  "title": "Scan ID",
                  "type": "string"
                },
                "scans": {
                  "description": "Scans",
                  "order": 8,
                  "title": "Scans",
                  "type": "object"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 11,
                  "title": "SHA1",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 10,
                  "title": "SHA256",
                  "type": "string"
                },
                "total": {
                  "description": "Total Scans",
                  "order": 9,
                  "title": "Total",
                  "type": "integer"
                },
                "verbose_msg": {
                  "description": "Message returned from the submission",
                  "order": 13,
                  "title": "Verbose Message",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4d53647b-3359-4ac3-adc7-8d98098d5ae9": {
            "nodeId": "4d53647b-3359-4ac3-adc7-8d98098d5ae9",
            "name": "Python - Filter URL List",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    exturllist = {}\n    unfiltered = []\n    urls = params.get('urls') # get urls from extractit\n    for item in urls:\n        if (item.lower().startswith(\"https://urldefense.proofpoint.com\")): # checks for any external Proofpoint encoded URLs and adds them to a list\n            unfiltered.append(item)\n    return{'sorted_urls' : sorted(unfiltered)} # sorts and deduplicates external URL list",
                "input": {
                  "urls": "{{[2b2508ba-5a8d-4271-9bf0-90e316f45485].[URLs]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "sorted_urls": {
                  "description": "Sample output result1 (delete or edit)",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result1",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "4dc47e0e-2e3c-4308-9c41-39ca6597b585": {
            "nodeId": "4dc47e0e-2e3c-4308-9c41-39ca6597b585",
            "name": "Phishing Database 2nd Check",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "c8e979ba-3fee-43d2-9358-b11edf44134e",
              "nextEdgeId": "07392133-d52f-4929-90b7-c1c354daec0f",
              "repeatCount": 3,
              "repeatDelay": 10,
              "repeatDelayDisplayUnit": "seconds"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d": {
            "nodeId": "4f307b2e-eb0f-41f2-8f55-bf4f4049e73d",
            "name": "Malicious Add to Database",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Malicious",
                "Sender": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}",
                "Subject": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "501db4bb-46db-41b3-a31e-759c5f470156": {
            "nodeId": "501db4bb-46db-41b3-a31e-759c5f470156",
            "name": "Header Legitimate Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Legitimate",
                "Sender": "{{[ca318aa3-f50e-4d6d-bebf-6532862cbad8].[emails].[0]}}",
                "Subject": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Subject]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "52fd62b5-e6cb-4d32-965a-8a747cb77cf3": {
            "nodeId": "52fd62b5-e6cb-4d32-965a-8a747cb77cf3",
            "name": "Malicious Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "{{[2fd2481b-af28-42ff-ab10-b57d1272e77b].[MaliciousDecision]}}",
                "DecisionMaker": "{{[2fd2481b-af28-42ff-ab10-b57d1272e77b].[MaliciousDecisionMaker]}}",
                "DecisionMethod": "{{[2fd2481b-af28-42ff-ab10-b57d1272e77b].[MaliciousDecisionMethod]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "53d69710-7fd5-4da7-b987-340f574ff50c": {
            "nodeId": "53d69710-7fd5-4da7-b987-340f574ff50c",
            "name": "Automated Response - Legitimate",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Legitimate Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "5b2815ca-42bf-42c0-8764-4af5d963288e": {
            "nodeId": "5b2815ca-42bf-42c0-8764-4af5d963288e",
            "name": "Email Type",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2b13118a-dff9-4228-a694-760589a587b8",
              "stepControlParams": [
                {
                  "edgeId": "2b13118a-dff9-4228-a694-760589a587b8",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9da2a3a0-43cf-49bf-910d-61ee0f5e4767",
                  "expression": {
                    "name": "6deb7d73-397b-4c4e-b675-d44c3df6b3c2.icon_email.flattened_attached_emails",
                    "type": "variable"
                  },
                  "expressionText": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[flattened_attached_emails]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "61b8f486-3577-4100-a005-4a32173f0e77": {
            "nodeId": "61b8f486-3577-4100-a005-4a32173f0e77",
            "name": "Header - Automated Response Kill Command",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "46b44777-a8b1-4318-92cd-37e4fda8f214",
                "expression": {
                  "left": {
                    "left": {
                      "name": "c9200333-bd34-4bbf-b3ca-cedbe640200b.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "op": "OR",
                  "right": {
                    "left": {
                      "name": "c9200333-bd34-4bbf-b3ca-cedbe640200b.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[c9200333-bd34-4bbf-b3ca-cedbe640200b].[$success]}}=true OR {{[c9200333-bd34-4bbf-b3ca-cedbe640200b].[success]}}=true"
              },
              "stopOnMatch": true
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE"
          },
          "644803ff-4329-48ad-9a04-9b52d8c261a2": {
            "nodeId": "644803ff-4329-48ad-9a04-9b52d8c261a2",
            "name": "Wildfire - Hash Generation",
            "type": "action",
            "plugin": {
              "name": "Palo Alto Wildfire",
              "slugVendor": "rapid7",
              "slugName": "paloalto_wildfire",
              "slugVersion": "1.1.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/paloalto_wildfire/1.1.2/icon.png"
            },
            "identifier": "submit_file",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[content]}}",
                "filename": "{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[file_name]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "File to submit. Supported types are Email-link, Flash, APK, PDF, JAR, PE, MS-Office",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 1,
                  "title": "File",
                  "type": "string"
                },
                "filename": {
                  "description": "Optional file name",
                  "order": 2,
                  "title": "Filename",
                  "type": "string"
                }
              },
              "required": [
                "file"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "filedata": {
                  "properties": {
                    "filename": {
                      "order": 3,
                      "title": "Filename",
                      "type": "string"
                    },
                    "filetype": {
                      "order": 2,
                      "title": "File Type",
                      "type": "string"
                    },
                    "md5": {
                      "description": "MD5 hash of file",
                      "order": 5,
                      "title": "MD5",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash of file",
                      "order": 4,
                      "title": "SHA256",
                      "type": "string"
                    },
                    "size": {
                      "description": "File size",
                      "order": 6,
                      "title": "Size",
                      "type": "string"
                    },
                    "supported_file_type": {
                      "description": "Boolean indicating whether the filetype of the sample is supported",
                      "order": 7,
                      "title": "Supported File",
                      "type": "boolean"
                    },
                    "url": {
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Filedata",
                  "type": "object"
                }
              },
              "properties": {
                "submission": {
                  "$ref": "#/definitions/filedata",
                  "description": "Submission",
                  "order": 1,
                  "title": "Submission"
                }
              },
              "required": [
                "submission"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "66b11adc-777d-42cf-9ef3-823b79bb3b4d": {
            "nodeId": "66b11adc-777d-42cf-9ef3-823b79bb3b4d",
            "name": "Header Spam Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Spam",
                "Sender": "{{[ca318aa3-f50e-4d6d-bebf-6532862cbad8].[emails].[0]}}",
                "Subject": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "67f18fe7-b650-4c5a-b8d1-b65d1d08e241": {
            "nodeId": "67f18fe7-b650-4c5a-b8d1-b65d1d08e241",
            "name": "Automated Response - Spam",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Spam Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "68ba176b-5c2c-4f19-9c58-d7ce436ab359": {
            "nodeId": "68ba176b-5c2c-4f19-9c58-d7ce436ab359",
            "name": "Attached Email Strip HTML",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[6b2b38e4-5baa-4cc2-9c93-22189dbec73d].[$item].[body]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "68fe6e99-5170-434d-b25c-61679046b716": {
            "nodeId": "68fe6e99-5170-434d-b25c-61679046b716",
            "name": "Legitimate Add to Database",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Legitimate",
                "Sender": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}",
                "Subject": "{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "690633fd-7bc5-43bd-9dda-df85e0fd4a98": {
            "nodeId": "690633fd-7bc5-43bd-9dda-df85e0fd4a98",
            "name": "Automated Response - Move Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "581e00c8-cb1e-4817-b330-3c3af49cbf1e",
                "cb407d68-0ab8-46a5-ab55-e1bd48e68463",
                "d04e5da7-b71d-40c7-bee8-3672cf6627c5"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "690f7f6f-e73c-4697-a864-bd24890d3ea3": {
            "nodeId": "690f7f6f-e73c-4697-a864-bd24890d3ea3",
            "name": "Automated Reply Body",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[body]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "6b2b38e4-5baa-4cc2-9c93-22189dbec73d": {
            "nodeId": "6b2b38e4-5baa-4cc2-9c93-22189dbec73d",
            "name": "Attached Email Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "68ba176b-5c2c-4f19-9c58-d7ce436ab359.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[68ba176b-5c2c-4f19-9c58-d7ce436ab359].[$success]}}=true",
                    "value": "{{[68ba176b-5c2c-4f19-9c58-d7ce436ab359].[text]}}",
                    "valueType": "string"
                  },
                  "name": "AttachedBody",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "7accf892-3a15-4d23-8a10-fa653009ad96",
              "nextEdgeId": "63a9c87b-fcd6-4be2-8ec4-75bad3f9fce6",
              "repeatVariable": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[flattened_attached_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "AttachedBody": {
                  "description": "Custom output: \"AttachedBody\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "AttachedBody",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "6be7944f-d0b8-48d2-90a9-4c0f48521084": {
            "nodeId": "6be7944f-d0b8-48d2-90a9-4c0f48521084",
            "name": "Malicious Match",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Malicious",
              "expressions": [
                {
                  "type": "text",
                  "value": "Malicious"
                }
              ],
              "ignoreCase": true,
              "input": "{{[e782dcb8-5bdb-459f-8e20-c7953f0aab9d].[matches]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "6c5aa972-c945-40d0-ac6e-9a23bca67de7": {
            "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7",
            "name": "Human Decision Point",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "notifications": {
                "artifactIds": null,
                "userIdsForEmail": []
              },
              "stepControlParams": [
                {
                  "edgeId": "0bce2227-3360-4947-8fa2-91f06368936c",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "1190502f-c865-4bf4-a752-b7bf92b228b6",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "202de0a3-0929-42ba-a10a-c8dad5f76043",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "2b2a6a5f-51cc-4538-b79d-3bf766078d97",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": true,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "4a977bd1-2862-45d7-970d-7b3d961a9df9",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                },
                {
                  "edgeId": "a35f8f80-2c0b-403e-949d-9838c93102cf",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "6c5aa972-c945-40d0-ac6e-9a23bca67de7"
                }
              ],
              "timeout": 1800,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "2b2a6a5f-51cc-4538-b79d-3bf766078d97"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE"
          },
          "6deb7d73-397b-4c4e-b675-d44c3df6b3c2": {
            "nodeId": "6deb7d73-397b-4c4e-b675-d44c3df6b3c2",
            "name": "Email Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.1.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.1.0/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": true,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "{{[$workflow].[Mailbox ID]}}",
                "subject_query": "{{[$workflow].[Subject Query]}}"
              }
            },
            "triggerId": "1f4e3bc3-d08d-45ca-85e3-db6145748d21",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": "",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "file_name": {
                      "order": 1,
                      "title": "File Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "6f8501ec-2962-469d-90d1-d4e422598efc": {
            "nodeId": "6f8501ec-2962-469d-90d1-d4e422598efc",
            "name": "Legitimate Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "{{[f630ffdd-6958-4773-baee-6db6c0a2326c].[LegitimateDecision]}}",
                "DecisionMaker": "{{[f630ffdd-6958-4773-baee-6db6c0a2326c].[LegitimateDecisionMaker]}}",
                "DecisionMethod": "{{[f630ffdd-6958-4773-baee-6db6c0a2326c].[LegitimateDecisionMethod]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "6f89ada2-f1f6-4be7-baf9-e2614ac931e5": {
            "nodeId": "6f89ada2-f1f6-4be7-baf9-e2614ac931e5",
            "name": "2nd Check Spam Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Spam Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "709ad45a-7e3b-4815-be07-31dd93397b00": {
            "nodeId": "709ad45a-7e3b-4815-be07-31dd93397b00",
            "name": "Attachment Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "54a92444-ffe6-4540-be82-49a9e78ff977",
              "nextEdgeId": "7341ff9e-7dd2-494f-9a80-b63f44bedeea",
              "repeatVariable": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[flattened_attached_files]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "7a0470b1-8d15-4b5f-8b58-423179b2c73d": {
            "nodeId": "7a0470b1-8d15-4b5f-8b58-423179b2c73d",
            "name": "2nd Check Move Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "57049438-b27e-4f7c-ab75-3326b23561e8",
                "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5",
                "c3b7153a-0167-4fd5-aeae-c6f74a80410c"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "2ndCheckDecision",
                  "type": "string",
                  "variables": {
                    "57049438-b27e-4f7c-ab75-3326b23561e8": "Legitimate",
                    "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5": "Spam",
                    "c3b7153a-0167-4fd5-aeae-c6f74a80410c": "Malicious"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "2ndCheckDecisionMaker",
                  "type": "string",
                  "variables": {
                    "57049438-b27e-4f7c-ab75-3326b23561e8": "2nd Check",
                    "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5": "2nd Check",
                    "c3b7153a-0167-4fd5-aeae-c6f74a80410c": "2nd Check"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "2ndCheckDecisionMethod",
                  "type": "string",
                  "variables": {
                    "57049438-b27e-4f7c-ab75-3326b23561e8": "Automated",
                    "95105548-8fb3-4e9e-8bfe-b165e0ca4aa5": "Automated",
                    "c3b7153a-0167-4fd5-aeae-c6f74a80410c": "Automated"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "2ndCheckDecision": {
                  "description": "Emitted variable \"2ndCheckDecision\"",
                  "order": 1,
                  "title": "2ndCheckDecision",
                  "type": "string"
                },
                "2ndCheckDecisionMaker": {
                  "description": "Emitted variable \"2ndCheckDecisionMaker\"",
                  "order": 2,
                  "title": "2ndCheckDecisionMaker",
                  "type": "string"
                },
                "2ndCheckDecisionMethod": {
                  "description": "Emitted variable \"2ndCheckDecisionMethod\"",
                  "order": 3,
                  "title": "2ndCheckDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "2ndCheckDecision": {
                  "description": "Emitted variable \"2ndCheckDecision\"",
                  "order": 1,
                  "title": "2ndCheckDecision",
                  "type": "string"
                },
                "2ndCheckDecisionMaker": {
                  "description": "Emitted variable \"2ndCheckDecisionMaker\"",
                  "order": 2,
                  "title": "2ndCheckDecisionMaker",
                  "type": "string"
                },
                "2ndCheckDecisionMethod": {
                  "description": "Emitted variable \"2ndCheckDecisionMethod\"",
                  "order": 3,
                  "title": "2ndCheckDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "7df69e7c-5be3-49e6-af5f-01fdfc0a4864": {
            "nodeId": "7df69e7c-5be3-49e6-af5f-01fdfc0a4864",
            "name": "Decode URL",
            "type": "action",
            "plugin": {
              "name": "Proofpoint URL Defense",
              "slugVendor": "rapid7",
              "slugName": "proofpoint_url_defense",
              "slugVersion": "1.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/proofpoint_url_defense/1.0.0/icon.png"
            },
            "identifier": "url_decode",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "encoded_url": "{{[c1cf7d0c-2033-43e2-9236-b7b7141dbc83].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "encoded_url": {
                  "description": "Proofpoint encoded URL or URL parameters e.g http-3A__www.example.org_url&d=BwdwBAg&c=TIwfCwdwWnrHy3gMA_uzZorHPsT2wfwvKrwfU",
                  "order": 1,
                  "title": "Encoded URL",
                  "type": "string"
                }
              },
              "required": [
                "encoded_url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "decoded_url": {
                  "description": "Decoded Proofpoint URL",
                  "order": 1,
                  "title": "Decoded Proofpoint URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a": {
            "nodeId": "7f3cbab3-0b9e-4743-8dd7-f51b89bc972a",
            "name": "2nd Check Kill Command",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "3f1973f8-3838-4938-994a-2e8f0ec46f0e",
                "expression": {
                  "left": {
                    "left": {
                      "name": "45f8c588-227a-4745-ae51-a753b9e5aa17.success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "op": "OR",
                  "right": {
                    "left": {
                      "name": "45f8c588-227a-4745-ae51-a753b9e5aa17.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[45f8c588-227a-4745-ae51-a753b9e5aa17].[success]}}=true OR {{[45f8c588-227a-4745-ae51-a753b9e5aa17].[$success]}}=true"
              },
              "stopOnMatch": true
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE"
          },
          "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b": {
            "nodeId": "7fb2c1e4-8e1c-4d67-8dde-75b36b5ce68b",
            "name": "Send Spam Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Spam Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "80f39b12-16ae-45ed-ab52-18e0b2433b65": {
            "nodeId": "80f39b12-16ae-45ed-ab52-18e0b2433b65",
            "name": "2nd Check Legit",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Legitimate",
              "expressions": [
                {
                  "type": "text",
                  "value": "Legitimate"
                }
              ],
              "ignoreCase": true,
              "input": "{{[a33cec55-fe59-43bb-a5ee-e8721aa57fb7].[matches]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "82246ef6-485b-4871-b024-df70469e40d7": {
            "nodeId": "82246ef6-485b-4871-b024-df70469e40d7",
            "name": "Search and Purge Emails",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office365 Email Security",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email_security",
              "slugVersion": "2.3.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email_security/2.3.2/icon.png"
            },
            "identifier": "mass_search_and_purge",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "compliance_search_name": "{{$workflow.[Search and Purge Title]}}",
                "content_match_query": "from:\"{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender].[0]}}\" AND subject:\"{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}\"",
                "delete_items": true,
                "query_timeout": 120
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "compliance_search_name": {
                  "description": "Name of compliance search",
                  "order": 1,
                  "title": "Compliance Search Name",
                  "type": "string"
                },
                "content_match_query": {
                  "description": "This parameter uses a text search string or a query that's formatted by using the Keyword Query Language (KQL). For more information about KQL, see Keyword Query Language syntax reference (https://go.microsoft.com/fwlink/p/?linkid=269603)",
                  "order": 2,
                  "title": "Content Match Query",
                  "type": "string"
                },
                "delete_items": {
                  "default": false,
                  "description": "The script only executes the delete action if this parameter is true",
                  "order": 4,
                  "title": "Delete Items",
                  "type": "boolean"
                },
                "query_timeout": {
                  "default": 60,
                  "description": "Query timeout in minutes",
                  "order": 3,
                  "title": "Query Timeout",
                  "type": "integer"
                }
              },
              "required": [
                "content_match_query",
                "compliance_search_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "85333f2b-5aa6-46f4-af09-c738cf0d8523": {
            "nodeId": "85333f2b-5aa6-46f4-af09-c738cf0d8523",
            "name": "Spam Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "{{[f9ead5e0-e71b-42da-b9e6-171e659634bb].[SpamDecision]}}",
                "DecisionMaker": "{{[f9ead5e0-e71b-42da-b9e6-171e659634bb].[SpamDecisionMaker]}}",
                "DecisionMethod": "{{[f9ead5e0-e71b-42da-b9e6-171e659634bb].[SpamDecisionMethod]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "87d6ae7a-3d87-4dbc-994e-7a814b2fba74": {
            "nodeId": "87d6ae7a-3d87-4dbc-994e-7a814b2fba74",
            "name": "Move Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "258c3742-2d91-4a69-b025-3ec04989557d",
                "9c250229-fae6-45ef-a500-35ac55f9a480",
                "c6308e49-4804-4ad3-a3fc-66ed849a3078",
                "21655065-c34c-4490-8266-79d8d8fd1b2b",
                "000221bd-6883-4367-8d06-1db61809852c",
                "fd859e29-c570-460a-87ed-183be2ec294e",
                "6ef52702-30eb-42b1-9bf1-688763294536"
              ],
              "variableSets": []
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "8f23af0b-dbc6-4937-a55d-3bf79399ad13": {
            "nodeId": "8f23af0b-dbc6-4937-a55d-3bf79399ad13",
            "name": "SenderDomain WhoIs",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[SenderDomain]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "90b542cf-e534-458d-b29d-09bba147bd6f": {
            "nodeId": "90b542cf-e534-458d-b29d-09bba147bd6f",
            "name": "URL Sleep",
            "type": "action",
            "plugin": {
              "name": "Sleep",
              "slugVendor": "rapid7",
              "slugName": "sleep",
              "slugVersion": "1.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/sleep/1.0.2/icon.png"
            },
            "identifier": "sleep",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "interval": 15
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "interval": {
                  "description": "Interval of time in seconds",
                  "order": 1,
                  "title": "Interval",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "slept": {
                  "description": "Time spent asleep",
                  "order": 1,
                  "title": "Slept",
                  "type": "integer"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "96b7e996-b326-425f-8d47-46ef7fdf8dc9": {
            "nodeId": "96b7e996-b326-425f-8d47-46ef7fdf8dc9",
            "name": "Header Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "3bd68547-f860-4725-874b-42f284fa0340.$matched",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[3bd68547-f860-4725-874b-42f284fa0340].[$matched]}}=true",
                    "value": "{{[15899f2f-0d41-486d-b55f-1395b27518f9].[content]}}",
                    "valueType": "string"
                  },
                  "name": "Sender",
                  "outputType": "array"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "3bd68547-f860-4725-874b-42f284fa0340.$matched",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[3bd68547-f860-4725-874b-42f284fa0340].[$matched]}}=true",
                    "value": "{{[014137b4-2a9f-46c3-8d4e-f682ce2b3f09].[content]}}",
                    "valueType": "string"
                  },
                  "name": "Subject",
                  "outputType": "array"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "3bd68547-f860-4725-874b-42f284fa0340.$matched",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[3bd68547-f860-4725-874b-42f284fa0340].[$matched]}}=true",
                    "value": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Date]}}",
                    "valueType": "string"
                  },
                  "name": "ReceivedTime",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "1a3ade89-7c24-4a4d-89e6-d8930e13cbe6",
              "nextEdgeId": "5f3921bd-272f-48ee-ab47-f7ee2e5bad71",
              "repeatVariable": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[flattened_attached_files]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "ReceivedTime": {
                  "description": "Custom output: \"ReceivedTime\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "ReceivedTime",
                  "type": "array"
                },
                "Sender": {
                  "description": "Custom output: \"Sender\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Sender",
                  "type": "array"
                },
                "Subject": {
                  "description": "Custom output: \"Subject\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Subject",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "977cd375-1e31-446e-9643-95e0834e80cc": {
            "nodeId": "977cd375-1e31-446e-9643-95e0834e80cc",
            "name": "Emergency Response Check",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "3749d0b0-46a1-4837-a6db-608ad6b8b384",
              "stepControlParams": [
                {
                  "edgeId": "ed92bb48-1764-4c57-bb57-1a8c42a25824",
                  "expression": {
                    "left": {
                      "name": "e1bb581f-c9ba-4ddb-bb52-1404f29634e7.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[e1bb581f-c9ba-4ddb-bb52-1404f29634e7].[$matched]}}=true"
                },
                {
                  "edgeId": "3749d0b0-46a1-4837-a6db-608ad6b8b384",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "97c230b0-575b-4eee-8c25-1a2b8b5bffc2": {
            "nodeId": "97c230b0-575b-4eee-8c25-1a2b8b5bffc2",
            "name": "Send Malicious Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Malicious Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b": {
            "nodeId": "9a6fda25-3b3c-4d1f-9717-a3292e05eb0b",
            "name": "Move Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "move_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[id]}}",
                "folder_name": "{{$workflow.[Reviewed Folder]}}",
                "mailbox_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "The email ID to retrieve",
                  "order": 2,
                  "title": "Email ID",
                  "type": "string"
                },
                "folder_name": {
                  "description": "The destination folder name",
                  "order": 3,
                  "title": "Folder Name",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Mailbox ID",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "email_id",
                "folder_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was move successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a33cec55-fe59-43bb-a5ee-e8721aa57fb7": {
            "nodeId": "a33cec55-fe59-43bb-a5ee-e8721aa57fb7",
            "name": "2nd Subject Check",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Subject"
                },
                "op": "=",
                "right": {
                  "name": "96b7e996-b326-425f-8d47-46ef7fdf8dc9.Subject.0",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Subject' = {{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject].[0]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "a522e423-bf66-43dc-9de1-c99dbde69e7a": {
            "nodeId": "a522e423-bf66-43dc-9de1-c99dbde69e7a",
            "name": "URL Analysis Results",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "###### Decoded URL\n{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}\n\n###### Screenshot\n<img64:{{[314e5653-a364-49b3-bf08-6812c1ed9038].[screenshot]}}/>\n\n###### URL Domain\n{{[a5e0212f-9108-4790-bde7-f9b9424db280].[domains].[0]}}\n\n##### Domain WhoIs\n###### Creation Date\n{{[ac74a0d3-d4bf-4a99-ad29-2d31204c9b63].[creation_date]}}\n###### Domain Status\n{{[ac74a0d3-d4bf-4a99-ad29-2d31204c9b63].[domain_status]}}\n\n###### Slack Command to Add to Blocklist\n@Rapid7 InsightConnect blocklist !submit {{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "a5e0212f-9108-4790-bde7-f9b9424db280": {
            "nodeId": "a5e0212f-9108-4790-bde7-f9b9424db280",
            "name": "URL Domain Extraction",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "domain_extractor",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}",
                "subdomain": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                },
                "subdomain": {
                  "description": "Include subdomain in result",
                  "order": 3,
                  "title": "Subdomain",
                  "type": "boolean"
                }
              },
              "required": [
                "subdomain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "domains": {
                  "description": "List of extracted Domain names",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domain Names",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "a84e53f0-c48f-4980-b509-fdb75ee6f055": {
            "nodeId": "a84e53f0-c48f-4980-b509-fdb75ee6f055",
            "name": "Header Artifact - Domain",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "##### Sender Domain:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[SenderDomain]}}\n\n##### Authentication Results:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Auth-Results]}}\n\n##### Received-SPF:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Received-SPF]}}\n\n##### SMTP:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Smtp]}}\n\n##### Return Path:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Return-Path]}}\n\n##### Domain Creation Date:\n{{[8f23af0b-dbc6-4937-a55d-3bf79399ad13].[creation_date]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63": {
            "nodeId": "ac74a0d3-d4bf-4a99-ad29-2d31204c9b63",
            "name": "URL Domain WhoIs",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[a5e0212f-9108-4790-bde7-f9b9424db280].[domains].[0]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "b89f9f45-1da7-4ecf-bd55-7d11c79e4379": {
            "nodeId": "b89f9f45-1da7-4ecf-bd55-7d11c79e4379",
            "name": "Check for Proofpoint Encoding",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "^https:\\/\\/urldefense\\.proofpoint\\.com\\/v2\\/url\\?u=.*$",
              "expressions": [
                {
                  "type": "text",
                  "value": "^https:\\/\\/urldefense\\.proofpoint\\.com\\/v2\\/url\\?u=.*$"
                }
              ],
              "ignoreCase": true,
              "input": "{{[c1cf7d0c-2033-43e2-9236-b7b7141dbc83].[$item]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9": {
            "nodeId": "bc7bcebb-f6f8-4f25-9b14-972b91bd33e9",
            "name": "Move Only Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Move Only",
                "DecisionMaker": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                "DecisionMethod": "Human"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f": {
            "nodeId": "be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f",
            "name": "Email Body",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "{{[2b2508ba-5a8d-4271-9bf0-90e316f45485].[Email Body]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "bee9301f-349c-451e-8e0c-85ffdc970bad": {
            "nodeId": "bee9301f-349c-451e-8e0c-85ffdc970bad",
            "name": "Search and Purge Success Check",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9c250229-fae6-45ef-a500-35ac55f9a480",
              "stepControlParams": [
                {
                  "edgeId": "9c250229-fae6-45ef-a500-35ac55f9a480",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "d846c2a1-8c15-4438-9d30-ab117d0ff341",
                  "expression": {
                    "left": {
                      "name": "82246ef6-485b-4871-b024-df70469e40d7.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[82246ef6-485b-4871-b024-df70469e40d7].[$success]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c0396569-5cc0-4862-b17b-ef30ef76c88e": {
            "nodeId": "c0396569-5cc0-4862-b17b-ef30ef76c88e",
            "name": "Image File Content",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "<img64:{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[content]}}/>"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c17cdd06-06fd-474d-abf8-052fbf783705": {
            "nodeId": "c17cdd06-06fd-474d-abf8-052fbf783705",
            "name": "2nd Check Legit Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Legitimate Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c1cf7d0c-2033-43e2-9236-b7b7141dbc83": {
            "nodeId": "c1cf7d0c-2033-43e2-9236-b7b7141dbc83",
            "name": "URL Analysis",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "7df69e7c-5be3-49e6-af5f-01fdfc0a4864.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[$success]}}=true",
                    "value": "{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}",
                    "valueType": "string"
                  },
                  "name": "DecodedURL",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "c4831743-5efe-4317-beb0-98f698908aaf",
              "nextEdgeId": "bf1ccaa6-cb3b-42e2-814a-d82572ebc93c",
              "repeatVariable": "{{[4d53647b-3359-4ac3-adc7-8d98098d5ae9].[sorted_urls]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "DecodedURL": {
                  "description": "Custom output: \"DecodedURL\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "DecodedURL",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8": {
            "nodeId": "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8",
            "name": "Image Check",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*\\.(?:jpg|gif|png))(?:\\?([^#]*))?(?:#(.*))?",
              "expressions": [
                {
                  "type": "text",
                  "value": "(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*\\.(?:jpg|gif|png))(?:\\?([^#]*))?(?:#(.*))?"
                }
              ],
              "ignoreCase": true,
              "input": "{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[file_name]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf": {
            "nodeId": "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf",
            "name": "Header Parser",
            "type": "action",
            "plugin": {
              "name": "Python 3 Script",
              "slugVendor": "rapid7",
              "slugName": "python_3_script",
              "slugVersion": "2.0.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/python_3_script/2.0.2/icon.png"
            },
            "identifier": "run",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "function": "def run(params={}):\n    \n    from email.parser import Parser\n    import socket\n      \n    header_file = params.get('header')\n    bad_chars = [\">\"]\n \n    parser = Parser()\n    \n    msg = parser.parsestr(header_file)\n    d = {}\n    d['Date'] = msg[\"Date\"]\n    d['From'] = msg[\"From\"]\n    d['Subject'] = msg[\"Subject\"]\n    try:\n        d['SenderDomain'] = msg['From'].split(\"@\")[1]\n    except:\n        d['SenderDomain'] = msg['From']\n    for i in bad_chars:\n        d['SenderDomain'] = d['SenderDomain'].replace(i, '')\n    d['Auth-Results'] = msg['Authentication-Results']\n    d['Received-SPF'] = msg['Received-SPF']\n    try:\n        d['Smtp'] = msg['Authentication-Results'].split(\";\")[0].split(\"=\")[2]\n    except:\n        d['Smtp'] = msg['From']\n    d['Return-Path'] = msg['Return-Path']\n    d['Received'] = msg['Received']\n    try:\n        d['ipaddr'] = socket.gethostbyname(str(d['Smtp']))\n    except:\n        try:\n           d['ipaddr'] = socket.gethostbyname(str(d['SenderDomain']))\n        except:\n           d['ipaddr'] = \"Domain will not resolve!!!!\" \n    return d",
                "input": {
                  "header": "{{[21722583-47f3-4912-95fd-53b88384c00f].[data]}}"
                }
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "function": {
                  "default": "def run(params={}):\\n    return {}",
                  "description": "Function definition. Must be named `run`. Accepts the `input` object as params. Returns the dict as output",
                  "displayType": "python",
                  "format": "python",
                  "order": 1,
                  "title": "Function",
                  "type": "string"
                },
                "input": {
                  "description": "Input object to be passed as `params={}` to the `run` function",
                  "order": 2,
                  "title": "Input",
                  "type": "object"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "result1": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "result2": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "definitions": {},
              "properties": {
                "Auth-Results": {
                  "type": "string"
                },
                "Date": {
                  "type": "string"
                },
                "From": {
                  "description": "Sample output result1 (delete or edit)",
                  "order": 1,
                  "title": "Result1",
                  "type": "string"
                },
                "Received-SPF": {
                  "type": "string"
                },
                "Return-Path": {
                  "type": "string"
                },
                "SenderDomain": {
                  "type": "string"
                },
                "Smtp": {
                  "description": "Sample output result2 (delete or edit)",
                  "order": 2,
                  "title": "Result2",
                  "type": "string"
                },
                "Subject": {
                  "type": "string"
                },
                "ipaddr": {
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c3b82488-db93-4658-9e3a-aea776396fac": {
            "nodeId": "c3b82488-db93-4658-9e3a-aea776396fac",
            "name": "Phishing Database Match",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c4634e6c-bf34-469e-94fa-1e54e75bffcf",
              "stepControlParams": [
                {
                  "edgeId": "d37c1823-d6b5-4910-aee8-71ca6eaf6fba",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "e782dcb8-5bdb-459f-8e20-c7953f0aab9d.found",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "e4a61c22-bab6-4271-b38e-36480c995f31.found",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[e782dcb8-5bdb-459f-8e20-c7953f0aab9d].[found]}}=true AND {{[e4a61c22-bab6-4271-b38e-36480c995f31].[found]}}=true"
                },
                {
                  "edgeId": "c4634e6c-bf34-469e-94fa-1e54e75bffcf",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "c502d2e3-d855-4cfa-a9c9-78376047b4b5": {
            "nodeId": "c502d2e3-d855-4cfa-a9c9-78376047b4b5",
            "name": "2nd Check Malicious Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Malicious Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "c5ff84f8-a45c-496e-aa18-2753aaff5911": {
            "nodeId": "c5ff84f8-a45c-496e-aa18-2753aaff5911",
            "name": "Header Check",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "^header",
              "expressions": [
                {
                  "type": "text",
                  "value": "^header"
                }
              ],
              "ignoreCase": true,
              "input": "{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[file_name]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "c62efedd-92c3-461f-95fc-e68f499af5bf": {
            "nodeId": "c62efedd-92c3-461f-95fc-e68f499af5bf",
            "name": "Header Artifact",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "##### Sender Domain:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[SenderDomain]}}\n\n##### Authentication Results:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Auth-Results]}}\n\n##### Received-SPF:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Received-SPF]}}\n\n##### SMTP:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Smtp]}}\n\n##### IP Addr:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[ipaddr]}}\n\n##### Return Path:\n{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Return-Path]}}\n\n##### Origination Location:\n{{[f5b6133e-9280-4e08-b950-7a5c223425da].[country]}} , {{[f5b6133e-9280-4e08-b950-7a5c223425da].[state]}} , {{[f5b6133e-9280-4e08-b950-7a5c223425da].[city]}}\n\n##### Organization Name:\n{{[f5b6133e-9280-4e08-b950-7a5c223425da].[orgname]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "c9200333-bd34-4bbf-b3ca-cedbe640200b": {
            "nodeId": "c9200333-bd34-4bbf-b3ca-cedbe640200b",
            "name": "Automated Response - Move Email",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "move_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[id]}}",
                "folder_name": "{{$workflow.[Reviewed Folder]}}",
                "mailbox_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "The email ID to retrieve",
                  "order": 2,
                  "title": "Email ID",
                  "type": "string"
                },
                "folder_name": {
                  "description": "The destination folder name",
                  "order": 3,
                  "title": "Folder Name",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Mailbox ID",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "email_id",
                "folder_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was move successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ca318aa3-f50e-4d6d-bebf-6532862cbad8": {
            "nodeId": "ca318aa3-f50e-4d6d-bebf-6532862cbad8",
            "name": "Sender Email Address Extraction",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "email_extractor",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[From]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "emails": {
                  "description": "List of extracted Email Addresses",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Email Addresses",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "cb49145d-05f3-4942-b9a9-343a73885baf": {
            "nodeId": "cb49145d-05f3-4942-b9a9-343a73885baf",
            "name": "Threat Crowd - Hash Lookup",
            "type": "action",
            "plugin": {
              "name": "Threat Crowd",
              "slugVendor": "rapid7",
              "slugName": "threatcrowd",
              "slugVersion": "3.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/threatcrowd/3.0.1/icon.png"
            },
            "identifier": "hash",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hash": "{{[644803ff-4329-48ad-9a04-9b52d8c261a2].[submission].[md5]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hash": {
                  "description": "Hash to search - MD5 and SHA1 supported",
                  "order": 1,
                  "title": "Search Hash",
                  "type": "string"
                }
              },
              "required": [
                "hash"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "hash": {
                  "properties": {
                    "md5": {
                      "description": "MD5 hash value",
                      "order": 1,
                      "title": "MD5 Hash",
                      "type": "string"
                    },
                    "sha1": {
                      "description": "SHA1 hash value",
                      "order": 2,
                      "title": "SHA1 Hash",
                      "type": "string"
                    }
                  },
                  "required": [
                    "md5",
                    "sha1"
                  ],
                  "title": "Hash",
                  "type": "object"
                }
              },
              "properties": {
                "domains": {
                  "description": "List of domains",
                  "items": {
                    "type": "string"
                  },
                  "order": 4,
                  "title": "Domains",
                  "type": "array"
                },
                "found": {
                  "description": "Whether search returned results",
                  "order": 7,
                  "title": "Found",
                  "type": "boolean"
                },
                "hashes": {
                  "$ref": "#/definitions/hash",
                  "description": "List of hashes",
                  "order": 2,
                  "title": "Hashes"
                },
                "ips": {
                  "description": "List of IP addresses",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "IPs",
                  "type": "array"
                },
                "permalink": {
                  "description": "Permalink URL",
                  "order": 6,
                  "title": "Permalink",
                  "type": "string"
                },
                "references": {
                  "description": "List of references",
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "References",
                  "type": "array"
                },
                "scans": {
                  "description": "List of scans",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Scans",
                  "type": "array"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "d19d069c-a155-4e9f-9e39-a92368e571da": {
            "nodeId": "d19d069c-a155-4e9f-9e39-a92368e571da",
            "name": "File Hashes",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "###### File Name\n{{[709ad45a-7e3b-4815-be07-31dd93397b00].[$item].[file_name]}}\n###### MD5\n{{[644803ff-4329-48ad-9a04-9b52d8c261a2].[submission].[md5]}}\n###### SHA-256\n{{[644803ff-4329-48ad-9a04-9b52d8c261a2].[submission].[sha256]}}\n\n##### Threat Crowd\n###### Found\n{{[cb49145d-05f3-4942-b9a9-343a73885baf].[found]}}\n\n###### Scans\n{{[cb49145d-05f3-4942-b9a9-343a73885baf].[scans]}}\n\n##### VirusTotal\n\n###### Positives / Totals\n{{[4b0e710c-c958-40c9-b4e1-4d04a5730c8e].[positives]}}/{{[4b0e710c-c958-40c9-b4e1-4d04a5730c8e].[total]}}\n\n###### Malicious\n{{[4b0e710c-c958-40c9-b4e1-4d04a5730c8e].[malicious]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "d4d3458c-86ff-4ca8-a169-2156a26a5fdb": {
            "nodeId": "d4d3458c-86ff-4ca8-a169-2156a26a5fdb",
            "name": "IP WhoIs Fail Check",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "12a932b8-152c-4883-bcc5-ff4e7ae32011",
              "stepControlParams": [
                {
                  "edgeId": "12a932b8-152c-4883-bcc5-ff4e7ae32011",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "7ac5fc3e-692b-4883-9115-8fc6b050e705",
                  "expression": {
                    "left": {
                      "name": "f5b6133e-9280-4e08-b950-7a5c223425da.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[f5b6133e-9280-4e08-b950-7a5c223425da].[$success]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "d6508a73-a938-4c0d-9413-2b90e28b2bf6": {
            "nodeId": "d6508a73-a938-4c0d-9413-2b90e28b2bf6",
            "name": "Slack Timeout Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "Slack Timeout",
                "DecisionMaker": "Slack Timeout",
                "DecisionMethod": "Automated"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "db200383-9d5f-4902-afde-7cea924d9b4b": {
            "nodeId": "db200383-9d5f-4902-afde-7cea924d9b4b",
            "name": "2nd Check Automated Decision",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "1be0f05f-bc48-43f0-b84e-47df1608851d",
              "stepControlParams": [
                {
                  "edgeId": "bc80a6c5-890d-4851-94d5-702e26e6db6a",
                  "expression": {
                    "left": {
                      "name": "80f39b12-16ae-45ed-ab52-18e0b2433b65.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[80f39b12-16ae-45ed-ab52-18e0b2433b65].[$matched]}}=true"
                },
                {
                  "edgeId": "4bd6c62f-f6de-44c7-867c-6e4aacb09a21",
                  "expression": {
                    "left": {
                      "name": "273eaa07-0b6f-49f1-ae04-8966fa3385f9.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[273eaa07-0b6f-49f1-ae04-8966fa3385f9].[$matched]}}=true"
                },
                {
                  "edgeId": "1be0f05f-bc48-43f0-b84e-47df1608851d",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf": {
            "nodeId": "db9f0e93-aad4-4ac0-8cbc-1b6264e891cf",
            "name": "2nd Check Add to Metrics",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "DecisionMaker": {
                        "type": "string"
                      },
                      "DecisionMethod": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "Decision": "{{[7a0470b1-8d15-4b5f-8b58-423179b2c73d].[2ndCheckDecision]}}",
                "DecisionMaker": "{{[7a0470b1-8d15-4b5f-8b58-423179b2c73d].[2ndCheckDecisionMaker]}}",
                "DecisionMethod": "{{[7a0470b1-8d15-4b5f-8b58-423179b2c73d].[2ndCheckDecisionMethod]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "e165e514-e977-4925-ad67-34e4237f8690": {
            "nodeId": "e165e514-e977-4925-ad67-34e4237f8690",
            "name": "Blank Subject Loop Break",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "7002f74a-f7ce-457c-b808-be54d3a13c6f",
                "expression": {
                  "left": {
                    "name": "00bad604-5693-4f41-9554-f3bd588ad7fb.path",
                    "type": "variable"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": "Blank"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[00bad604-5693-4f41-9554-f3bd588ad7fb].[path]}}=\"Blank\""
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "e1bb581f-c9ba-4ddb-bb52-1404f29634e7": {
            "nodeId": "e1bb581f-c9ba-4ddb-bb52-1404f29634e7",
            "name": "Emergency Response",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Emergency Response Check",
              "expressions": [
                {
                  "type": "text",
                  "value": "Emergency Response Check"
                }
              ],
              "ignoreCase": true,
              "input": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "e1e19b83-9f7f-4796-93e8-45b83e4eb56a": {
            "nodeId": "e1e19b83-9f7f-4796-93e8-45b83e4eb56a",
            "name": "No Attached Email - URL Extraction",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "2.0.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/2.0.0/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[body]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e4a61c22-bab6-4271-b38e-36480c995f31": {
            "nodeId": "e4a61c22-bab6-4271-b38e-36480c995f31",
            "name": "Sender - Phishing Database Lookup",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Sender"
                },
                "op": "=",
                "right": {
                  "name": "ca318aa3-f50e-4d6d-bebf-6532862cbad8.emails.0",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Sender' = {{[ca318aa3-f50e-4d6d-bebf-6532862cbad8].[emails].[0]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "e548779c-7d46-4ec3-b6ff-3a3762169ea4": {
            "nodeId": "e548779c-7d46-4ec3-b6ff-3a3762169ea4",
            "name": "PDF File Match",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ae63493f-3adf-4c5c-8d43-5264161bd82d",
              "stepControlParams": [
                {
                  "edgeId": "ae63493f-3adf-4c5c-8d43-5264161bd82d",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "cb20bea5-ad1c-40f4-89ad-4c38de0d4314",
                  "expression": {
                    "left": {
                      "name": "4850cf11-b7b2-4a3f-8674-13fb59b7713e.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[4850cf11-b7b2-4a3f-8674-13fb59b7713e].[$matched]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e": {
            "nodeId": "e6b27a3f-13bb-4edb-b5a8-60f559f2b56e",
            "name": "File Type",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "401e6e2f-0d3d-48cc-9a54-f3b2010e11e7",
              "stepControlParams": [
                {
                  "edgeId": "393824ec-6108-4fab-b529-9650630f31af",
                  "expression": {
                    "left": {
                      "name": "c5ff84f8-a45c-496e-aa18-2753aaff5911.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[c5ff84f8-a45c-496e-aa18-2753aaff5911].[$matched]}}=true"
                },
                {
                  "edgeId": "401e6e2f-0d3d-48cc-9a54-f3b2010e11e7",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "e761af32-69c3-453a-ab25-bec6300d7892": {
            "nodeId": "e761af32-69c3-453a-ab25-bec6300d7892",
            "name": "Legitimate Match",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": true,
              "expressionText": "Legitimate",
              "expressions": [
                {
                  "type": "text",
                  "value": "Legitimate"
                }
              ],
              "ignoreCase": true,
              "input": "{{[e782dcb8-5bdb-459f-8e20-c7953f0aab9d].[matches]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "e782dcb8-5bdb-459f-8e20-c7953f0aab9d": {
            "nodeId": "e782dcb8-5bdb-459f-8e20-c7953f0aab9d",
            "name": "Subject - Phishing Database Lookup",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Subject"
                },
                "op": "=",
                "right": {
                  "name": "c3996cb4-b895-4ea6-92ab-17c0ff64b5bf.Subject",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Subject' = {{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[Subject]}}",
              "globalArtifactSchema": {
                "definitions": {
                  "_ROOT_": {
                    "properties": {
                      "Decision": {
                        "type": "string"
                      },
                      "Sender": {
                        "type": "string"
                      },
                      "Subject": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  }
                },
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "$ref": "#/definitions/_ROOT_"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "e9f74950-f2cd-491d-8a9c-bce149e870c3": {
            "nodeId": "e9f74950-f2cd-491d-8a9c-bce149e870c3",
            "name": "Strip HTML from Body",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[4291176f-1aaf-415b-96e6-c6ac812f6c90].[actual_reported]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "ea580d9a-7197-41f6-bf89-9bdf2248f43b": {
            "nodeId": "ea580d9a-7197-41f6-bf89-9bdf2248f43b",
            "name": "ProofPoint Encoding",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "839d1b11-a348-4235-bccf-2b83d718fd28",
              "stepControlParams": [
                {
                  "edgeId": "839d1b11-a348-4235-bccf-2b83d718fd28",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "351fbca7-99f7-47fd-bde0-b5000b1e2f4a",
                  "expression": {
                    "left": {
                      "name": "b89f9f45-1da7-4ecf-bd55-7d11c79e4379.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[b89f9f45-1da7-4ecf-bd55-7d11c79e4379].[$matched]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "ec480a75-3600-433a-9dd4-b1f02c5b1f9b": {
            "nodeId": "ec480a75-3600-433a-9dd4-b1f02c5b1f9b",
            "name": "Image File",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "0d04074b-c8bc-432e-8b7e-d2cc83644955",
              "stepControlParams": [
                {
                  "edgeId": "0d04074b-c8bc-432e-8b7e-d2cc83644955",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "643d0f2f-1175-4837-9eac-a8e5f685414b",
                  "expression": {
                    "left": {
                      "name": "c1eba663-a0ec-48b5-a4d4-af69fc00b9a8.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[c1eba663-a0ec-48b5-a4d4-af69fc00b9a8].[$matched]}}=true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f041b903-bfd6-4807-8dad-b825b5266694": {
            "nodeId": "f041b903-bfd6-4807-8dad-b825b5266694",
            "name": "Auto Move Automated Reply",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "4179d02d-4b78-4a04-86f0-99460500ad80",
              "stepControlParams": [
                {
                  "edgeId": "d9043464-a397-4495-8fe7-f0ab8675da48",
                  "expression": {
                    "left": {
                      "name": "fab37fff-5672-4689-9023-3af4e8cbaf60.$matched",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[fab37fff-5672-4689-9023-3af4e8cbaf60].[$matched]}}=true"
                },
                {
                  "edgeId": "4179d02d-4b78-4a04-86f0-99460500ad80",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f2310ff3-c087-463e-9193-5b36a011710f": {
            "nodeId": "f2310ff3-c087-463e-9193-5b36a011710f",
            "name": "Move Auto Reply",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.1/icon.png"
            },
            "identifier": "move_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "email_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[id]}}",
                "folder_name": "{{$workflow.[Reviewed Folder]}}",
                "mailbox_id": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "email_id": {
                  "description": "The email ID to retrieve",
                  "order": 2,
                  "title": "Email ID",
                  "type": "string"
                },
                "folder_name": {
                  "description": "The destination folder name",
                  "order": 3,
                  "title": "Folder Name",
                  "type": "string"
                },
                "mailbox_id": {
                  "description": "Mailbox ID",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "email_id",
                "folder_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Was move successful",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f": {
            "nodeId": "f3005c0f-bfca-4ef1-b2e8-ca7fd805177f",
            "name": "Send Legitimate Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "4.1.7",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/4.1.7/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": {
                  "content": "",
                  "filename": ""
                },
                "bcc": [],
                "body": "{{$workflow.[Legitimate Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": true,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "$ref": "#/definitions/file",
                  "description": "Attachment",
                  "order": 8,
                  "title": "Attachment"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "Email address of recipients",
                  "order": 2,
                  "title": "Email To",
                  "type": "string"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f552eaf6-5636-448f-9027-a481a30019d9": {
            "nodeId": "f552eaf6-5636-448f-9027-a481a30019d9",
            "name": "Search and Purge Failure Notice",
            "type": "action_chatops",
            "continueOnFailure": true,
            "isDisabled": false,
            "parameters": {
              "input": {
                "attachments": [],
                "message": "**ATTENTION**\nSearch and Purge Failed for one or more LOBs\n\nSearch and Purge Success (True/False):\n{{[82246ef6-485b-4871-b024-df70469e40d7].[$success]}}",
                "recipient": "{{[$workflow].[Slack Channel]}}",
                "thread_ts": ""
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "items": {
                    "type": "object"
                  },
                  "order": 4,
                  "title": "Attachments",
                  "type": "array"
                },
                "message": {
                  "description": "Message to send",
                  "order": 3,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "Channels begin with # (e.g. #channel) and usernames begin with @ (e.g. @username)",
                  "order": 1,
                  "title": "Enter #channel or @username",
                  "type": "string"
                },
                "thread_ts": {
                  "description": "Select timestamp output variable from parent message step",
                  "order": 2,
                  "title": "To post in a thread, select parent message timestamp",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "parent_message_timestamp": {
                  "description": "The timestamp of the parent message or of the current message if there is no parent. Used to post messages to a thread.",
                  "order": 3,
                  "title": "Parent Message Timestamp",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_message"
          },
          "f5b6133e-9280-4e08-b950-7a5c223425da": {
            "nodeId": "f5b6133e-9280-4e08-b950-7a5c223425da",
            "name": "Header IP WhoIs",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.0.3/icon.png"
            },
            "identifier": "address",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[c3996cb4-b895-4ea6-92ab-17c0ff64b5bf].[ipaddr]}}",
                "registrar": "Autodetect"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP to Lookup",
                  "order": 1,
                  "title": "Address",
                  "type": "string"
                },
                "registrar": {
                  "default": "Autodetect",
                  "description": "Domain Registrar",
                  "enum": [
                    "Autodetect",
                    "RIPE",
                    "ARIN",
                    "LACNIC",
                    "APNIC"
                  ],
                  "order": 2,
                  "title": "Registrar",
                  "type": "string"
                }
              },
              "required": [
                "address"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "address": {
                  "description": "Address",
                  "order": 9,
                  "title": "Address",
                  "type": "string"
                },
                "cidr": {
                  "description": "CIDR",
                  "order": 4,
                  "title": "CIDR",
                  "type": "string"
                },
                "city": {
                  "description": "City",
                  "order": 10,
                  "title": "City",
                  "type": "string"
                },
                "country": {
                  "description": "Country",
                  "order": 13,
                  "title": "Country",
                  "type": "string"
                },
                "netname": {
                  "description": "Network name",
                  "order": 1,
                  "title": "Network Name",
                  "type": "string"
                },
                "netrange": {
                  "description": "Network Range",
                  "order": 3,
                  "title": "Network Range",
                  "type": "string"
                },
                "nettype": {
                  "description": "Network type",
                  "order": 2,
                  "title": "Network Type",
                  "type": "string"
                },
                "org_abuse_email": {
                  "description": "Organization abuse e-mail",
                  "order": 14,
                  "title": "Organization Abuse E-mail",
                  "type": "string"
                },
                "org_abuse_phone": {
                  "description": "Organization abuse phone",
                  "order": 15,
                  "title": "Organization Abuse Phone",
                  "type": "string"
                },
                "org_tech_email": {
                  "description": "Organization tech e-mail",
                  "order": 16,
                  "title": "Organization Tech E-mail",
                  "type": "string"
                },
                "org_tech_phone": {
                  "description": "Organization tech phone",
                  "order": 17,
                  "title": "Organization Tech Phone",
                  "type": "string"
                },
                "organization": {
                  "description": "Organization",
                  "order": 5,
                  "title": "Organization",
                  "type": "string"
                },
                "orgname": {
                  "description": "Organization name",
                  "order": 6,
                  "title": "Organization Name",
                  "type": "string"
                },
                "postal": {
                  "description": "Postal",
                  "order": 11,
                  "title": "Postal",
                  "type": "string"
                },
                "regdate": {
                  "description": "Registration date",
                  "order": 7,
                  "title": "Registration Date",
                  "type": "string"
                },
                "state": {
                  "description": "State",
                  "order": 12,
                  "title": "State",
                  "type": "string"
                },
                "update": {
                  "description": "WHOIS updated date",
                  "order": 8,
                  "title": "WHOIS Updated Date",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189": {
            "nodeId": "f62fb0fe-4f3f-4f94-b3d4-20050c3d5189",
            "name": "Slack Timeout Malicious Notice",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "5.0.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.0.3/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": [],
                "bcc": [],
                "body": "{{$workflow.[Malicious Response]}}",
                "cc": [],
                "email_from": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[account]}}",
                "email_to": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}",
                "is_html": false,
                "subject": "RE: {{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "description": "Accepts one or more attachment represented as a file type which contains the filename and the file content encoded with base64",
                  "items": {
                    "$ref": "#/definitions/file"
                  },
                  "order": 8,
                  "title": "Attachment",
                  "type": "array"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "One or more email addresses of recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Email To",
                  "type": "array"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "subject",
                "body",
                "is_html",
                "email_from",
                "email_to"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "f630ffdd-6958-4773-baee-6db6c0a2326c": {
            "nodeId": "f630ffdd-6958-4773-baee-6db6c0a2326c",
            "name": "Legitimate Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06",
                "af7c7f91-b614-4c8c-9380-9ba592fb2609"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "LegitimateDecision",
                  "type": "string",
                  "variables": {
                    "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[path]}}",
                    "af7c7f91-b614-4c8c-9380-9ba592fb2609": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[path]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "LegitimateDecisionMethod",
                  "type": "string",
                  "variables": {
                    "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06": "Human",
                    "af7c7f91-b614-4c8c-9380-9ba592fb2609": "Slack"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "LegitimateDecisionMaker",
                  "type": "string",
                  "variables": {
                    "2a3454cb-03f1-4dd7-93a4-1bc1725d4d06": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                    "af7c7f91-b614-4c8c-9380-9ba592fb2609": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[display_name]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "LegitimateDecision": {
                  "description": "Emitted variable \"LegitimateDecision\"",
                  "order": 1,
                  "title": "LegitimateDecision",
                  "type": "string"
                },
                "LegitimateDecisionMaker": {
                  "description": "Emitted variable \"LegitimateDecisionMaker\"",
                  "order": 3,
                  "title": "LegitimateDecisionMaker",
                  "type": "string"
                },
                "LegitimateDecisionMethod": {
                  "description": "Emitted variable \"LegitimateDecisionMethod\"",
                  "order": 2,
                  "title": "LegitimateDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "LegitimateDecision": {
                  "description": "Emitted variable \"LegitimateDecision\"",
                  "order": 1,
                  "title": "LegitimateDecision",
                  "type": "string"
                },
                "LegitimateDecisionMaker": {
                  "description": "Emitted variable \"LegitimateDecisionMaker\"",
                  "order": 3,
                  "title": "LegitimateDecisionMaker",
                  "type": "string"
                },
                "LegitimateDecisionMethod": {
                  "description": "Emitted variable \"LegitimateDecisionMethod\"",
                  "order": 2,
                  "title": "LegitimateDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "f8ebdaad-c32f-4676-a79c-d61879ecface": {
            "nodeId": "f8ebdaad-c32f-4676-a79c-d61879ecface",
            "name": "Slack Message",
            "type": "decision_chatops",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "attachments": null,
              "message": "**Reported Email**\n\n**Reported By**\n{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[sender]}}\n\n**Original Sender**\n{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Sender]}}\n\n**Original Subject**\n{{[96b7e996-b326-425f-8d47-46ef7fdf8dc9].[Subject]}}\n\n#####\n**Email Body**\n{{[be2a7f4c-328b-41f7-8fc4-a8c13ec2a38f].[content]}}\n\n##### URLs\n**Decoded URL**\n{{[c1cf7d0c-2033-43e2-9236-b7b7141dbc83].[DecodedURL]}}\n\n**Domain Created**\n{{[c1cf7d0c-2033-43e2-9236-b7b7141dbc83].[urldomaincreated]}}\n\n**VirusTotal Malicious**\n{{[c1cf7d0c-2033-43e2-9236-b7b7141dbc83].[VTMalicious]}}",
              "messageType": "button",
              "options": [
                {
                  "answer": "Legitimate",
                  "buttonStyle": "primary",
                  "confirmation": "Email will be marked as legitimate and a response will be sent to the client.",
                  "edgeId": "af7c7f91-b614-4c8c-9380-9ba592fb2609",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Malicious",
                  "buttonStyle": "danger",
                  "confirmation": "Email will be marked as malicious and a response will be sent to the client.",
                  "edgeId": "bd2b3e27-dd8e-41e8-bf7f-c28143d14f89",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Malicious - Duplicate",
                  "buttonStyle": "danger",
                  "confirmation": "Email will be marked as malicious and a response will be sent to the client.",
                  "edgeId": "e12514c8-49a7-4d92-928e-8c9d87843e64",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Spam",
                  "buttonStyle": "default",
                  "confirmation": "Email will be marked as spam and a response will be sent to the client.",
                  "edgeId": "d2305b9e-9a8c-486e-addf-fa0296e323a5",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Move Only",
                  "buttonStyle": "default",
                  "confirmation": "Email will be removed from inbox, no response will be sent to the client.",
                  "edgeId": "21655065-c34c-4490-8266-79d8d8fd1b2b",
                  "isTimeoutOnly": false
                },
                {
                  "answer": "Slack Timeout",
                  "buttonStyle": null,
                  "confirmation": null,
                  "edgeId": "885e355f-a099-4768-bfad-77252114c36c",
                  "isTimeoutOnly": true
                }
              ],
              "question": "Please make a decision.",
              "recipient": "{{$workflow.[Slack Channel]}}",
              "timeout": 900,
              "timeoutDisplayUnit": "minutes",
              "timeoutEdgeId": "885e355f-a099-4768-bfad-77252114c36c"
            },
            "defaultInputJSONSchema": {
              "properties": {
                "attachments": {
                  "description": "JSON array of attachments - see Help for documentation",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 3,
                  "title": "Attachments",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "recipient": {
                  "description": "A channel (e.g. #channel) or username",
                  "order": 2,
                  "title": "Recipient",
                  "type": "string"
                }
              },
              "required": [
                "recipient"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "$success": {
                  "description": "",
                  "order": 8,
                  "title": "$success",
                  "type": "boolean"
                },
                "channel_id": {
                  "description": "ChannelID of successful message",
                  "order": 1,
                  "title": "Channel ID",
                  "type": "string"
                },
                "display_name": {
                  "description": "The slack display name for the user responding to the question",
                  "order": 9,
                  "title": "Display Name",
                  "type": "string"
                },
                "message": {
                  "description": "The message that was sent to slack",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "path": {
                  "description": "The path taken",
                  "order": 6,
                  "title": "Path",
                  "type": "string"
                },
                "recipient": {
                  "description": "The Channel name or User Name",
                  "order": 3,
                  "title": "Recipient",
                  "type": "string"
                },
                "responding_user": {
                  "description": "The slack username of the user responding to the question",
                  "order": 7,
                  "title": "Response User",
                  "type": "string"
                },
                "response_question": {
                  "description": "The response question that was sent to slack",
                  "order": 5,
                  "title": "Response Question",
                  "type": "string"
                },
                "timestamp": {
                  "description": "Timestamp of successful message",
                  "order": 2,
                  "title": "Timestamp",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "NONE",
            "chatOpsAppName": "slack",
            "chatOpsIdentifier": "post_interactive_message"
          },
          "f9ead5e0-e71b-42da-b9e6-171e659634bb": {
            "nodeId": "f9ead5e0-e71b-42da-b9e6-171e659634bb",
            "name": "Spam Join Step",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "202de0a3-0929-42ba-a10a-c8dad5f76043",
                "a35f8f80-2c0b-403e-949d-9838c93102cf",
                "d2305b9e-9a8c-486e-addf-fa0296e323a5"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Search and Purge",
                  "type": "boolean",
                  "variables": {
                    "202de0a3-0929-42ba-a10a-c8dad5f76043": true,
                    "a35f8f80-2c0b-403e-949d-9838c93102cf": false,
                    "d2305b9e-9a8c-486e-addf-fa0296e323a5": false
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "SpamDecision",
                  "type": "string",
                  "variables": {
                    "202de0a3-0929-42ba-a10a-c8dad5f76043": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[path]}}",
                    "a35f8f80-2c0b-403e-949d-9838c93102cf": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[path]}}",
                    "d2305b9e-9a8c-486e-addf-fa0296e323a5": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[path]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "SpamDecisionMaker",
                  "type": "string",
                  "variables": {
                    "202de0a3-0929-42ba-a10a-c8dad5f76043": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                    "a35f8f80-2c0b-403e-949d-9838c93102cf": "{{[6c5aa972-c945-40d0-ac6e-9a23bca67de7].[decisionMakerId]}}",
                    "d2305b9e-9a8c-486e-addf-fa0296e323a5": "{{[f8ebdaad-c32f-4676-a79c-d61879ecface].[display_name]}}"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "SpamDecisionMethod",
                  "type": "string",
                  "variables": {
                    "202de0a3-0929-42ba-a10a-c8dad5f76043": "Human",
                    "a35f8f80-2c0b-403e-949d-9838c93102cf": "Human",
                    "d2305b9e-9a8c-486e-addf-fa0296e323a5": "Slack"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Search and Purge": {
                  "description": "Emitted variable \"Search and Purge\"",
                  "order": 1,
                  "title": "Search and Purge",
                  "type": "boolean"
                },
                "SpamDecision": {
                  "description": "Emitted variable \"SpamDecision\"",
                  "order": 2,
                  "title": "SpamDecision",
                  "type": "string"
                },
                "SpamDecisionMaker": {
                  "description": "Emitted variable \"SpamDecisionMaker\"",
                  "order": 3,
                  "title": "SpamDecisionMaker",
                  "type": "string"
                },
                "SpamDecisionMethod": {
                  "description": "Emitted variable \"SpamDecisionMethod\"",
                  "order": 4,
                  "title": "SpamDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Search and Purge": {
                  "description": "Emitted variable \"Search and Purge\"",
                  "order": 1,
                  "title": "Search and Purge",
                  "type": "boolean"
                },
                "SpamDecision": {
                  "description": "Emitted variable \"SpamDecision\"",
                  "order": 2,
                  "title": "SpamDecision",
                  "type": "string"
                },
                "SpamDecisionMaker": {
                  "description": "Emitted variable \"SpamDecisionMaker\"",
                  "order": 3,
                  "title": "SpamDecisionMaker",
                  "type": "string"
                },
                "SpamDecisionMethod": {
                  "description": "Emitted variable \"SpamDecisionMethod\"",
                  "order": 4,
                  "title": "SpamDecisionMethod",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "fab37fff-5672-4689-9023-3af4e8cbaf60": {
            "nodeId": "fab37fff-5672-4689-9023-3af4e8cbaf60",
            "name": "Check for Automated Reply",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "^RE",
              "expressions": [
                {
                  "type": "text",
                  "value": "^RE"
                }
              ],
              "ignoreCase": true,
              "input": "{{[6deb7d73-397b-4c4e-b675-d44c3df6b3c2].[icon_email].[subject]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "ff9b4235-bbca-4378-a25b-c890f4fd2934": {
            "nodeId": "ff9b4235-bbca-4378-a25b-c890f4fd2934",
            "name": "Check URL Blocklist",
            "type": "action",
            "plugin": {
              "name": "PowerShell",
              "slugVendor": "rapid7",
              "slugName": "powershell",
              "slugVersion": "2.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/powershell/2.1.3/icon.png"
            },
            "identifier": "powershell_string",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[$workflow].[URL Blocklist Server]}}",
                "host_name": "{{[$workflow].[URL Blocklist Hostname]}}",
                "script": "$file = Get-Content \"C:\\inetpub\\wwwroot\\urlblock.txt\"\n$containsWord = $file | %{$_ -match \"{{[7df69e7c-5be3-49e6-af5f-01fdfc0a4864].[decoded_url]}}\"}\nif ($containsWord -contains $true) {\n\techo true\n}\nelse {\n\techo false\n}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IP address of the remote host e.g. 192.168.1.1. If address is left blank PowerShell will run locally",
                  "order": 2,
                  "title": "Address",
                  "type": "string"
                },
                "host_name": {
                  "description": "Case-sensitive name of the remote host, eg. MyComputer for Kerberos connection only",
                  "order": 3,
                  "title": "Host Name",
                  "type": "string"
                },
                "script": {
                  "description": "PowerShell script as a string",
                  "order": 1,
                  "title": "Script",
                  "type": "string"
                }
              },
              "required": [
                "script"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "stderr": {
                  "description": "PowerShell standard error",
                  "order": 2,
                  "title": "PowerShell Standard Error",
                  "type": "string"
                },
                "stdout": {
                  "description": "PowerShell standard output",
                  "order": 1,
                  "title": "PowerShell Standard Output",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Endpoint Detection & Response"
        ],
        "humanCostSeconds": 1200,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Mailbox ID": {
                "type": "string",
                "description": "Mailbox ID that is to be monitored for the Email Trigger (i.e. example@test.com)."
              },
              "Slack Channel": {
                "type": "string",
                "description": "The name of the Slack Channel to communicate to."
              },
              "Spam Response": {
                "type": "string",
                "description": "Approved response to Spam emails."
              },
              "Subject Query": {
                "type": "string",
                "description": "The regex enabled subject query used by the Email Trigger to match on specific subjects."
              },
              "Reviewed Folder": {
                "type": "string",
                "description": "The Mailbox folder to move emails into that are auto replies or emergency responses."
              },
              "Malicious Response": {
                "type": "string",
                "description": "Approved response to Malicious emails"
              },
              "Legitimate Response": {
                "type": "string",
                "description": "Approved response to Legitimate emails."
              },
              "URL Blocklist Server": {
                "type": "string",
                "description": "The IP Address of the host that contains the remote Palo Alto blocklist."
              },
              "Search and Purge Title": {
                "type": "string",
                "description": ""
              },
              "URL Blocklist Hostname": {
                "type": "string",
                "description": "Hostname of the server that contains the remote Palo Alto Blocklist."
              },
              "Emergency Response Body": {
                "type": "string",
                "description": "Body of emergency response email."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "1f4e3bc3-d08d-45ca-85e3-db6145748d21",
        "identifier": "email_received",
        "name": "Email Trigger",
        "description": "",
        "input": {
          "flatten_attachments": true,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "{{[$workflow].[Mailbox ID]}}",
          "subject_query": "{{[$workflow].[Subject Query]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": "",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "file_name": {
                  "order": 1,
                  "title": "File Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "5.1.0",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/5.1.0/icon.png"
        }
      }
    ]
  }
}