{
  "kom": {
    "komandVersion": "1.111.4-0-gb43d1",
    "komFileVersion": "2.0.0",
    "exportedAt": "2022-09-03T13:02:46.165141766Z",
    "workflowVersions": [
      {
        "name": "Scan Asset with InsightVM from Microsoft Teams",
        "type": "runnable",
        "version": "",
        "description": "# Description\n\nScan and report on an asset's vulnerabilities and risk posture without leaving your Chat window. Built for patching administrators who may not have access to InsightVM, this workflow fetches the last vulnerability statistics for a given host, triggers a new scan for that host, and returns the updated vulnerability statistics. \n\nBy displaying the last known vulnerability and risk data, the user is able to easily identify any change in vulnerability count or overall risk with the newly collected scan data.\n\nSample Trigger Commands:\n\n`!scan-asset workstation123`\n\n# Key Features\n\n* Launch a scan of a single asset with a Microsoft Teams message\n* Extend single-asset scanning capabilities to users without access to InsightVM\n* Receive vulnerability and risk score statistics in Microsoft Teams\n* Quickly compare previous vulnerability data with newly collected vulnerability data\n* Confirm the effectiveness of patches and remediation actions without leaving Chat\n\n# Requirements\n\n* InsightConnect License\n* InsightVM Site ID\n* [Microsoft Teams](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n\n# Documentation\n\n## Readme\n\nThis workflow utilizes existing InsightVM (or Nexpose) sites and scan engines to run ad hoc single-asset scans. These ad hoc scans will not skip the scan engine queue. As such, if a scan engine is running a scheduled scan, then the scan triggered by this workflow will be added to the back of the scan engine queue.\n\nThis workflow may only scan assets that are in the site's asset scope. As such, administrators should configure the site so that the asset scope is broad enough to be useful for consumers of this workflow. On the other hand, explicitly exclude critical systems from the site scope to prevent unauthorized scanning activity.\n\n## Setup\n\n### InsightVM Setup\n\nThis workflow requires a pre-configured InsightVM (or Nexpose) site in order to scan a target. The scan will inherit all configuration settings for this site, and the asset specified must be in the Asset scope for the selected site.\n\nThe following guidelines are recommended for use when configuring the site within InsightVM (or Nexpose) for this workflow:\n\n1. **Create New Site** Create a new site in InsightVM. This site will be used solely for this InsightConnect workflow.\n2. **Add Assets** Add all possible scan targets. Using Class A, B, or C subnets (eg, 10.1.2.0/24, 10.1.0.0/16, or 10.0.0.0/8) or an asset group (eg, Windows Workstations) is recommended.\n3. **Add Authentication** Add scan credentials in order to perform authenticated scans. Authenticated scans yield significantly more accurate results than non-authenticated scans. Administrative credentials are highly recommended for best results.\n4. **Select Scan Template** Choose a scan template for the site. The default `Full Audit without Web Spider` is appropriate in most cases.\n5. **Select Scan Engine** Select the `Engine most recently used for that asset` option. Also, select the scan engine with the broadest network access from the scan engine list below.\n6. **No Scheduled Scans** Given this site likely has an extremely broad scope, it is not recommended that this site be used for regular vulnerability scanning. As such, it is recommended that there be no scheduled scans for the site.\n\nSave the site configuration and navigate to the Site Summary page. View the URL in your web browser to find the `Site ID`. For example, if my console URL is `https://10.1.2.3:3780/site.jsp?siteid=123`, then my `Site ID` is `123`.\n\nOnce you have found the site ID, move on to configure the InsightConnect workflow.\n\n### InsightConnect Setup\n\nImport the workflow from the Rapid7 Extension Library and proceed through the Import Workflow wizard in InsightConnect. Import plugins, create or select connections, and rename the workflow as a part of the Import Workflow wizard as necessary.\n\n\nThis workflow leverages InsightConnect's Parameters feature. This feature allows variables used multiple times throughout a workflow to be entered once and then referenced throughout the workflow.\nSelect \"Parameters\" either from the Workflow Control Panel or from the Builder to begin configuration.\nThere are three parameters you will need to configure in order to complete setup of your workflow:\n\n1. `Channel Name` Parameter needs to be provided with your Teams Channel Name.\n2. `Team Name` Parameter needs to be provided with your Teams Name.\n3. `Site ID` Parameter needs to be provided with your Site ID.\n\nAfter configuring the parameters, activate the workflow in order to trigger it.\nTo trigger workflow use command in your Teams environment.\n\n## Technical Details\n\nPlugins utilized by workflow:\n\n|Plugin|Version|Count|\n|----|----|--------|\n|Microsoft Teams|3.1.3|11|\n|HTML|1.2.2|1|\n|Rapid7 InsightVM Console|4.9.1|5|\n|Type Converter|1.8.0|1|\n|Timers|2.0.5|3|\n\n## Troubleshooting\n\n_There is no troubleshooting information at this time_\n\n# Version History\n\n* 1.2.1 - Update keywords\n* 1.2.0 - Add workflow parameters | Update Microsoft Teams to version 3.1.3 | Update HTML to version 1.2.2 | Update Rapid7 InsightVM Console to version 4.9.1 | Update Type Converter to version 1.8.0 | Update Timers to version 2.0.5 | Update documentation\n* 1.1.0 - Replace the Settings step with automatic team and channel name extraction in all Microsoft Teams steps except the first one | Update Microsoft Teams to version 3.1.0 | Update documentation\n* 1.0.0 - Initial workflow\n\n# Links\n\n## References\n\n* [Microsoft Teams](https://teams.microsoft.com)\n* [Microsoft Teams Setup](https://insightconnect.help.rapid7.com/docs/microsoft-teams)\n",
        "graph": {
          "edges": {
            "0abf8ef1-4ce1-4dfe-aa23-966ae32335af": {
              "id": "0abf8ef1-4ce1-4dfe-aa23-966ae32335af",
              "name": "Scan Did Not Finish",
              "description": "If the scan does NOT complete for any reason",
              "parentNodeId": "",
              "fromNodeId": "e5e05b38-3bf6-4785-a1ca-b4baab6de569",
              "toNodeId": "b08448d2-170a-447e-a1a4-0395040805fb"
            },
            "1bc36fc0-b8f8-4b7d-8767-10e23aea7605": {
              "id": "1bc36fc0-b8f8-4b7d-8767-10e23aea7605",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "toNodeId": "91192672-ea19-476b-9bf7-a606c71a9951"
            },
            "2b28c7b1-3956-4535-8b16-1b945b0701da": {
              "id": "2b28c7b1-3956-4535-8b16-1b945b0701da",
              "name": "Scan Finished",
              "description": "If the scan completes with no errors ",
              "parentNodeId": "",
              "fromNodeId": "e5e05b38-3bf6-4785-a1ca-b4baab6de569",
              "toNodeId": "a3866bda-9e08-4afd-b6c0-acd2b446f8a3"
            },
            "2f0ce356-bc58-4b9e-bce5-db335d487b4a": {
              "id": "2f0ce356-bc58-4b9e-bce5-db335d487b4a",
              "name": "Error Output",
              "description": "status =~ /aborted|error/",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7",
              "toNodeId": "cfc00829-8775-403a-86f0-fbd8499c71c4"
            },
            "309e1f07-8be2-413f-8ffc-f9a8fa046668": {
              "id": "309e1f07-8be2-413f-8ffc-f9a8fa046668",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "368f0859-fe8b-462c-8d3a-42de7cf407e3",
              "toNodeId": "c9b63fbb-2046-4ae0-b682-6d6f069c314b"
            },
            "3603ca03-9e72-4f00-ac14-29f733ed3401": {
              "id": "3603ca03-9e72-4f00-ac14-29f733ed3401",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "01a8075c-e726-4b83-b81c-2ec022ea62e4",
              "toNodeId": "07fa527f-35e8-49e9-b7a9-892f8ccddefa"
            },
            "3ab29641-0820-47e9-93cf-e024c35e6ca0": {
              "id": "3ab29641-0820-47e9-93cf-e024c35e6ca0",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "1e553c96-a918-4964-9fad-7916f5e7a6da",
              "toNodeId": "d1afcf27-37a4-45db-8358-8641e1c19151"
            },
            "3b6043ca-ebb3-4937-9dce-162edc2ef823": {
              "id": "3b6043ca-ebb3-4937-9dce-162edc2ef823",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "cfc00829-8775-403a-86f0-fbd8499c71c4",
              "toNodeId": "9dc688ec-7087-4818-8096-fdcd10b40325"
            },
            "3c11128d-a86b-4c79-be71-34d12a9304c1": {
              "id": "3c11128d-a86b-4c79-be71-34d12a9304c1",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "5fba5d1d-7643-4577-ac38-3ee016ead105",
              "toNodeId": "b2586560-4b29-4c42-8ba9-a96410b69b23"
            },
            "3c9888ff-2258-4dab-9a83-1cfc8da52301": {
              "id": "3c9888ff-2258-4dab-9a83-1cfc8da52301",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "35b17f6a-0a33-40de-9477-59f5fd73942d",
              "toNodeId": ""
            },
            "452aec33-7a31-48dc-98f6-68b1e8ee898b": {
              "id": "452aec33-7a31-48dc-98f6-68b1e8ee898b",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "e5cc9186-ca78-45ba-af5f-be183915d218",
              "toNodeId": "7fbd956f-e239-40fd-801e-4b4411dfe334"
            },
            "46a86429-4a95-4e9e-b4f9-e438bc85fa90": {
              "id": "46a86429-4a95-4e9e-b4f9-e438bc85fa90",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "1a31d3af-d021-45e7-8455-dbeab4a59048",
              "toNodeId": ""
            },
            "4a8c0f49-8f81-40e4-9465-1f1b15b70ac9": {
              "id": "4a8c0f49-8f81-40e4-9465-1f1b15b70ac9",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "e15e1d61-2435-4767-8092-f8ae7e74b081",
              "toNodeId": ""
            },
            "52312b82-5ae4-46a1-99ca-0c95b3fed196": {
              "id": "52312b82-5ae4-46a1-99ca-0c95b3fed196",
              "name": "Paused",
              "description": "status =~ /stopped|paused/",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7",
              "toNodeId": "1e553c96-a918-4964-9fad-7916f5e7a6da"
            },
            "54f165f9-18fd-46af-8a08-298c0563afc1": {
              "id": "54f165f9-18fd-46af-8a08-298c0563afc1",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "27c9932d-2e58-42ed-b0da-f28550418c95",
              "toNodeId": "29a906de-a2b5-4baa-91cd-e85e02a9b677"
            },
            "55c2b95c-e801-43e1-9be7-3a41de44c7ec": {
              "id": "55c2b95c-e801-43e1-9be7-3a41de44c7ec",
              "name": "Running",
              "description": "status =~ /running|integrating|dispatched/",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7",
              "toNodeId": "35b17f6a-0a33-40de-9477-59f5fd73942d"
            },
            "578c7584-f851-4dea-a5dd-d709deaf0e52": {
              "id": "578c7584-f851-4dea-a5dd-d709deaf0e52",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "c9b63fbb-2046-4ae0-b682-6d6f069c314b",
              "toNodeId": "8b3765cf-023a-4a24-bc20-27f0e09c7b9d"
            },
            "579ef51f-5366-42bb-8984-893ccd4761fc": {
              "id": "579ef51f-5366-42bb-8984-893ccd4761fc",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "b0a783dc-4b5e-4f5f-9673-f1e706787688",
              "toNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "64407118-a722-4076-9993-eb6b770b85fa": {
              "id": "64407118-a722-4076-9993-eb6b770b85fa",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "29a906de-a2b5-4baa-91cd-e85e02a9b677",
              "toNodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7"
            },
            "6916b6f1-7b25-4d6b-adb5-898f19c70afc": {
              "id": "6916b6f1-7b25-4d6b-adb5-898f19c70afc",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "f22b5842-d7c1-4b80-bc6e-7341d07b5622",
              "toNodeId": ""
            },
            "6bc06142-02b1-4dd8-a29d-a5332818e758": {
              "id": "6bc06142-02b1-4dd8-a29d-a5332818e758",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8b3765cf-023a-4a24-bc20-27f0e09c7b9d",
              "toNodeId": "8e9eccf3-73fe-4932-a088-99887f9dc5bc"
            },
            "7bdb99fc-6320-44a4-9ba2-5ee37f95150d": {
              "id": "7bdb99fc-6320-44a4-9ba2-5ee37f95150d",
              "name": "Asset Found",
              "description": "An asset with a hostname containing the search term was found in InsightVM.",
              "parentNodeId": "",
              "fromNodeId": "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b",
              "toNodeId": "7b963048-cbe6-4368-b518-cdb5d810570b"
            },
            "80fb47ab-b951-41e3-bb0b-2be59eae86c5": {
              "id": "80fb47ab-b951-41e3-bb0b-2be59eae86c5",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "b2586560-4b29-4c42-8ba9-a96410b69b23",
              "toNodeId": "e15e1d61-2435-4767-8092-f8ae7e74b081"
            },
            "88ef1564-4ded-4a11-bf85-dbb87e3927eb": {
              "id": "88ef1564-4ded-4a11-bf85-dbb87e3927eb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "57dfa2d9-602d-44c1-841d-4082f3c72389",
              "toNodeId": ""
            },
            "8a49af9a-1e79-4c79-931c-839ea301484b": {
              "id": "8a49af9a-1e79-4c79-931c-839ea301484b",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "07fa527f-35e8-49e9-b7a9-892f8ccddefa",
              "toNodeId": "b0a783dc-4b5e-4f5f-9673-f1e706787688"
            },
            "8b359df4-758a-4f4c-bdde-b8955603bb67": {
              "id": "8b359df4-758a-4f4c-bdde-b8955603bb67",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a3866bda-9e08-4afd-b6c0-acd2b446f8a3",
              "toNodeId": "bbbe8639-1ce3-445b-8351-d53a720a0799"
            },
            "92e8c045-7fb1-4a2a-bb55-82235bbbf52c": {
              "id": "92e8c045-7fb1-4a2a-bb55-82235bbbf52c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7b963048-cbe6-4368-b518-cdb5d810570b",
              "toNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "9ba1b60d-75a6-489e-a4e8-a64f77ca8a69": {
              "id": "9ba1b60d-75a6-489e-a4e8-a64f77ca8a69",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab",
              "toNodeId": "90233698-ca2a-4af9-a677-bea7b2cc92ab"
            },
            "a8e68dcc-9e43-4c77-9e43-1cf7261a5fcf": {
              "id": "a8e68dcc-9e43-4c77-9e43-1cf7261a5fcf",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "bbbe8639-1ce3-445b-8351-d53a720a0799",
              "toNodeId": "6e4dc68e-0e86-426e-96e1-6e7155b4f88d"
            },
            "ac6590f4-01c7-4778-b641-128a98e6b7c5": {
              "id": "ac6590f4-01c7-4778-b641-128a98e6b7c5",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "toNodeId": "27c9932d-2e58-42ed-b0da-f28550418c95"
            },
            "b2b319b0-3e1b-4d94-8ea0-221fa6e1df51": {
              "id": "b2b319b0-3e1b-4d94-8ea0-221fa6e1df51",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "9dc688ec-7087-4818-8096-fdcd10b40325",
              "toNodeId": ""
            },
            "b528b3fb-84ff-4492-9efb-1800f7e1c843": {
              "id": "b528b3fb-84ff-4492-9efb-1800f7e1c843",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "toNodeId": "a725b949-51bf-409f-9ff6-244a857553ae"
            },
            "b768c0b1-6369-4fdd-b9ef-89d9ca03a11c": {
              "id": "b768c0b1-6369-4fdd-b9ef-89d9ca03a11c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "b08448d2-170a-447e-a1a4-0395040805fb",
              "toNodeId": "d962b87e-69f6-43ae-930e-2a0841d9328f"
            },
            "b91a2a12-b529-4aa6-911b-bc50fce170bb": {
              "id": "b91a2a12-b529-4aa6-911b-bc50fce170bb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "7fbd956f-e239-40fd-801e-4b4411dfe334",
              "toNodeId": "368f0859-fe8b-462c-8d3a-42de7cf407e3"
            },
            "c0fdf4ef-99a2-408a-a8f2-3a9a370dcf88": {
              "id": "c0fdf4ef-99a2-408a-a8f2-3a9a370dcf88",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "91192672-ea19-476b-9bf7-a606c71a9951",
              "toNodeId": "e5e05b38-3bf6-4785-a1ca-b4baab6de569"
            },
            "c161225d-f3b8-4dac-bb21-bc1463a25d28": {
              "id": "c161225d-f3b8-4dac-bb21-bc1463a25d28",
              "name": "Asset Not Found",
              "description": "No asset with a hostname containing the search term was found in InsightVM.",
              "parentNodeId": "",
              "fromNodeId": "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b",
              "toNodeId": "1a31d3af-d021-45e7-8455-dbeab4a59048"
            },
            "d73cb21f-313a-45bb-9aad-b727178a1d3e": {
              "id": "d73cb21f-313a-45bb-9aad-b727178a1d3e",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d962b87e-69f6-43ae-930e-2a0841d9328f",
              "toNodeId": "57dfa2d9-602d-44c1-841d-4082f3c72389"
            },
            "dc3e4b23-d8bc-4b6c-8392-7b6d87d1ee01": {
              "id": "dc3e4b23-d8bc-4b6c-8392-7b6d87d1ee01",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "d1afcf27-37a4-45db-8358-8641e1c19151",
              "toNodeId": "5fba5d1d-7643-4577-ac38-3ee016ead105"
            },
            "e54ef8c4-bc66-4159-8b1b-c969b0b152ef": {
              "id": "e54ef8c4-bc66-4159-8b1b-c969b0b152ef",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "8e9eccf3-73fe-4932-a088-99887f9dc5bc",
              "toNodeId": "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b"
            },
            "e69350ec-4a74-408b-9373-ede33d8040ae": {
              "id": "e69350ec-4a74-408b-9373-ede33d8040ae",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "6e4dc68e-0e86-426e-96e1-6e7155b4f88d",
              "toNodeId": "d962b87e-69f6-43ae-930e-2a0841d9328f"
            },
            "e73de023-a305-44e3-8940-53858aaf681a": {
              "id": "e73de023-a305-44e3-8940-53858aaf681a",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "9eb59f4b-f4c3-4783-8085-618fce021d83",
              "toNodeId": "e5cc9186-ca78-45ba-af5f-be183915d218"
            },
            "edf34730-c726-42f7-832e-2cb72713b2c2": {
              "id": "edf34730-c726-42f7-832e-2cb72713b2c2",
              "name": "",
              "description": "",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "90233698-ca2a-4af9-a677-bea7b2cc92ab",
              "toNodeId": "f22b5842-d7c1-4b80-bc6e-7341d07b5622"
            },
            "f96c518b-8221-4767-a62e-8f512dc14f18": {
              "id": "f96c518b-8221-4767-a62e-8f512dc14f18",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "toNodeId": ""
            },
            "fcbfbcb5-6700-4dff-a61e-c3252c9008dd": {
              "id": "fcbfbcb5-6700-4dff-a61e-c3252c9008dd",
              "name": "",
              "description": "",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "fromNodeId": "a725b949-51bf-409f-9ff6-244a857553ae",
              "toNodeId": "01a8075c-e726-4b83-b81c-2ec022ea62e4"
            },
            "fe6cf796-759b-46c8-b48d-177d2bc6d456": {
              "id": "fe6cf796-759b-46c8-b48d-177d2bc6d456",
              "name": "Finished",
              "description": "status =~ /finished/",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "fromNodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7",
              "toNodeId": "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab"
            }
          },
          "nodes": {
            "01a8075c-e726-4b83-b81c-2ec022ea62e4": {
              "id": "01a8075c-e726-4b83-b81c-2ec022ea62e4",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "07fa527f-35e8-49e9-b7a9-892f8ccddefa": {
              "id": "07fa527f-35e8-49e9-b7a9-892f8ccddefa",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "1a31d3af-d021-45e7-8455-dbeab4a59048": {
              "id": "1a31d3af-d021-45e7-8455-dbeab4a59048",
              "parentNodeId": ""
            },
            "1e553c96-a918-4964-9fad-7916f5e7a6da": {
              "id": "1e553c96-a918-4964-9fad-7916f5e7a6da",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "27c9932d-2e58-42ed-b0da-f28550418c95": {
              "id": "27c9932d-2e58-42ed-b0da-f28550418c95",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b": {
              "id": "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b",
              "parentNodeId": ""
            },
            "29a906de-a2b5-4baa-91cd-e85e02a9b677": {
              "id": "29a906de-a2b5-4baa-91cd-e85e02a9b677",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "35b17f6a-0a33-40de-9477-59f5fd73942d": {
              "id": "35b17f6a-0a33-40de-9477-59f5fd73942d",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "368f0859-fe8b-462c-8d3a-42de7cf407e3": {
              "id": "368f0859-fe8b-462c-8d3a-42de7cf407e3",
              "parentNodeId": ""
            },
            "57dfa2d9-602d-44c1-841d-4082f3c72389": {
              "id": "57dfa2d9-602d-44c1-841d-4082f3c72389",
              "parentNodeId": ""
            },
            "5c6d3567-4385-4be8-b143-f66de30ba196": {
              "id": "5c6d3567-4385-4be8-b143-f66de30ba196",
              "parentNodeId": ""
            },
            "5fba5d1d-7643-4577-ac38-3ee016ead105": {
              "id": "5fba5d1d-7643-4577-ac38-3ee016ead105",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "6e4dc68e-0e86-426e-96e1-6e7155b4f88d": {
              "id": "6e4dc68e-0e86-426e-96e1-6e7155b4f88d",
              "parentNodeId": ""
            },
            "7b963048-cbe6-4368-b518-cdb5d810570b": {
              "id": "7b963048-cbe6-4368-b518-cdb5d810570b",
              "parentNodeId": ""
            },
            "7fbd956f-e239-40fd-801e-4b4411dfe334": {
              "id": "7fbd956f-e239-40fd-801e-4b4411dfe334",
              "parentNodeId": ""
            },
            "8b3765cf-023a-4a24-bc20-27f0e09c7b9d": {
              "id": "8b3765cf-023a-4a24-bc20-27f0e09c7b9d",
              "parentNodeId": ""
            },
            "8e9eccf3-73fe-4932-a088-99887f9dc5bc": {
              "id": "8e9eccf3-73fe-4932-a088-99887f9dc5bc",
              "parentNodeId": ""
            },
            "90233698-ca2a-4af9-a677-bea7b2cc92ab": {
              "id": "90233698-ca2a-4af9-a677-bea7b2cc92ab",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "91192672-ea19-476b-9bf7-a606c71a9951": {
              "id": "91192672-ea19-476b-9bf7-a606c71a9951",
              "parentNodeId": ""
            },
            "973205db-20e8-49fc-9acc-9fe10b8698d7": {
              "id": "973205db-20e8-49fc-9acc-9fe10b8698d7",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "9dc688ec-7087-4818-8096-fdcd10b40325": {
              "id": "9dc688ec-7087-4818-8096-fdcd10b40325",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "9eb59f4b-f4c3-4783-8085-618fce021d83": {
              "id": "9eb59f4b-f4c3-4783-8085-618fce021d83",
              "parentNodeId": ""
            },
            "a3866bda-9e08-4afd-b6c0-acd2b446f8a3": {
              "id": "a3866bda-9e08-4afd-b6c0-acd2b446f8a3",
              "parentNodeId": ""
            },
            "a725b949-51bf-409f-9ff6-244a857553ae": {
              "id": "a725b949-51bf-409f-9ff6-244a857553ae",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "b08448d2-170a-447e-a1a4-0395040805fb": {
              "id": "b08448d2-170a-447e-a1a4-0395040805fb",
              "parentNodeId": ""
            },
            "b0a783dc-4b5e-4f5f-9673-f1e706787688": {
              "id": "b0a783dc-4b5e-4f5f-9673-f1e706787688",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "b2586560-4b29-4c42-8ba9-a96410b69b23": {
              "id": "b2586560-4b29-4c42-8ba9-a96410b69b23",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "bbbe8639-1ce3-445b-8351-d53a720a0799": {
              "id": "bbbe8639-1ce3-445b-8351-d53a720a0799",
              "parentNodeId": ""
            },
            "c9b63fbb-2046-4ae0-b682-6d6f069c314b": {
              "id": "c9b63fbb-2046-4ae0-b682-6d6f069c314b",
              "parentNodeId": ""
            },
            "ceb73879-8d0f-4952-81c5-3a2c321d50ca": {
              "id": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
              "parentNodeId": "5c6d3567-4385-4be8-b143-f66de30ba196"
            },
            "cfc00829-8775-403a-86f0-fbd8499c71c4": {
              "id": "cfc00829-8775-403a-86f0-fbd8499c71c4",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "d1afcf27-37a4-45db-8358-8641e1c19151": {
              "id": "d1afcf27-37a4-45db-8358-8641e1c19151",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "d962b87e-69f6-43ae-930e-2a0841d9328f": {
              "id": "d962b87e-69f6-43ae-930e-2a0841d9328f",
              "parentNodeId": ""
            },
            "e15e1d61-2435-4767-8092-f8ae7e74b081": {
              "id": "e15e1d61-2435-4767-8092-f8ae7e74b081",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "e5cc9186-ca78-45ba-af5f-be183915d218": {
              "id": "e5cc9186-ca78-45ba-af5f-be183915d218",
              "parentNodeId": ""
            },
            "e5e05b38-3bf6-4785-a1ca-b4baab6de569": {
              "id": "e5e05b38-3bf6-4785-a1ca-b4baab6de569",
              "parentNodeId": ""
            },
            "f22b5842-d7c1-4b80-bc6e-7341d07b5622": {
              "id": "f22b5842-d7c1-4b80-bc6e-7341d07b5622",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            },
            "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab": {
              "id": "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab",
              "parentNodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca"
            }
          }
        },
        "steps": {
          "01a8075c-e726-4b83-b81c-2ec022ea62e4": {
            "nodeId": "01a8075c-e726-4b83-b81c-2ec022ea62e4",
            "name": "If Scan Fails to Start",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "3603ca03-9e72-4f00-ac14-29f733ed3401",
                "expression": {
                  "expr": {
                    "name": "a725b949-51bf-409f-9ff6-244a857553ae.$success",
                    "type": "variable"
                  },
                  "op": "NOT",
                  "type": "unary"
                },
                "expressionText": "NOT ({{[a725b949-51bf-409f-9ff6-244a857553ae].[$success]}})"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "07fa527f-35e8-49e9-b7a9-892f8ccddefa": {
            "nodeId": "07fa527f-35e8-49e9-b7a9-892f8ccddefa",
            "name": "MS-TEAMS - Scan Started",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<strong>The scan has started.<br/>\nPlease wait 3 minutes for the next update.</strong>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1a31d3af-d021-45e7-8455-dbeab4a59048": {
            "nodeId": "1a31d3af-d021-45e7-8455-dbeab4a59048",
            "name": "Asset Not Found Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message": "No asset with hostname containing `{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}` was found.\nhttps://media.giphy.com/media/xTiTnm8AGoS75Cvyko/giphy.gif",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "1e553c96-a918-4964-9fad-7916f5e7a6da": {
            "nodeId": "1e553c96-a918-4964-9fad-7916f5e7a6da",
            "name": "MS-TEAMS - Scan Paused",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<strong>The scan was paused.</br>\nWill try to start it again in 5 minutes./strong>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "27c9932d-2e58-42ed-b0da-f28550418c95": {
            "nodeId": "27c9932d-2e58-42ed-b0da-f28550418c95",
            "name": "Get Scan Status",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "get_scan",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "scan_id": "{{[a725b949-51bf-409f-9ff6-244a857553ae].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "scan_id": {
                  "description": "ID of the scan to obtain",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "string"
                }
              },
              "required": [
                "scan_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "vulnerabilities_count": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 2,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 3,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total",
                      "order": 4,
                      "title": "Total number of vulnerabilities",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities Count",
                  "type": "object"
                }
              },
              "properties": {
                "assets": {
                  "description": "Number of assets within the scan",
                  "order": 3,
                  "title": "Assets",
                  "type": "integer"
                },
                "duration": {
                  "description": "Duration of the scan in ISO8601 format",
                  "order": 7,
                  "title": "Duration",
                  "type": "string"
                },
                "endTime": {
                  "description": "End time of the scan in ISO8601 format",
                  "order": 9,
                  "title": "End Time",
                  "type": "string"
                },
                "engineName": {
                  "description": "Name of the engine used for the scan",
                  "order": 8,
                  "title": "Engine Name",
                  "type": "string"
                },
                "id": {
                  "description": "ID of the scan",
                  "order": 10,
                  "title": "ID",
                  "type": "integer"
                },
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 4,
                  "title": "Links",
                  "type": "array"
                },
                "scanName": {
                  "description": "User-driven scan name for the scan",
                  "order": 11,
                  "title": "Scan Name",
                  "type": "string"
                },
                "scanType": {
                  "description": "Scan type (manual, automated, scheduled)",
                  "order": 2,
                  "title": "Scan Type",
                  "type": "string"
                },
                "startTime": {
                  "description": "Start time of the scan in ISO8601 format",
                  "order": 6,
                  "title": "Start Time",
                  "type": "string"
                },
                "status": {
                  "description": "Scan status (aborted, unknown, running, finished, stopped, error, paused, dispatched or integrating)",
                  "order": 1,
                  "title": "Status",
                  "type": "string"
                },
                "vulnerabilities": {
                  "$ref": "#/definitions/vulnerabilities_count",
                  "description": "Counts of vulnerabilities found within the scan",
                  "order": 5,
                  "title": "Vulnerabilities"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b": {
            "nodeId": "2890c115-4f63-45cc-8ed1-c0e1f84c5f8b",
            "name": "Asset Found?",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c161225d-f3b8-4dac-bb21-bc1463a25d28",
              "stepControlParams": [
                {
                  "edgeId": "7bdb99fc-6320-44a4-9ba2-5ee37f95150d",
                  "expression": {
                    "name": "c9b63fbb-2046-4ae0-b682-6d6f069c314b.$success",
                    "type": "variable"
                  },
                  "expressionText": "{{[c9b63fbb-2046-4ae0-b682-6d6f069c314b].[$success]}}"
                },
                {
                  "edgeId": "c161225d-f3b8-4dac-bb21-bc1463a25d28",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "29a906de-a2b5-4baa-91cd-e85e02a9b677": {
            "nodeId": "29a906de-a2b5-4baa-91cd-e85e02a9b677",
            "name": "If Lookup Scan Fails",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "64407118-a722-4076-9993-eb6b770b85fa",
                "expression": {
                  "expr": {
                    "name": "27c9932d-2e58-42ed-b0da-f28550418c95.$success",
                    "type": "variable"
                  },
                  "op": "NOT",
                  "type": "unary"
                },
                "expressionText": "NOT ({{[27c9932d-2e58-42ed-b0da-f28550418c95].[$success]}})"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "35b17f6a-0a33-40de-9477-59f5fd73942d": {
            "nodeId": "35b17f6a-0a33-40de-9477-59f5fd73942d",
            "name": "MS-TEAMS - Scan Running",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<strong>The scan is still running.<br/>\nA status check will be conducted in 60 seconds</strong>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "368f0859-fe8b-462c-8d3a-42de7cf407e3": {
            "nodeId": "368f0859-fe8b-462c-8d3a-42de7cf407e3",
            "name": "Searching Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message": "Searching for {{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}...",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message": {
                  "description": "Message to send",
                  "order": 4,
                  "title": "Message",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name",
                "message"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "57dfa2d9-602d-44c1-841d-4082f3c72389": {
            "nodeId": "57dfa2d9-602d-44c1-841d-4082f3c72389",
            "name": "Final Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# PRE-SCAN:\n### Trigger\n- _{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[from].[user].[displayName]}}_ started the Scan Asset workflow with the search term _{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}_ in the _{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}_ channel at _{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[createdDateTime]}}_.\n### Hostname that was scanned\n- _{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}_\n### Original RiskScore:\n- _{{[8e9eccf3-73fe-4932-a088-99887f9dc5bc].[output]}}_\n# POST-SCAN:\n### Outcome\n- Posted Scan Output for the asset _{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}_ to the _{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}_ channel in MS TEAMS.\n### New RiskScore\n{{#if [91192672-ea19-476b-9bf7-a606c71a9951].[found]}}\n- The New RiskScore is:  **{{[d962b87e-69f6-43ae-930e-2a0841d9328f].[NewRiskScore]}}**\n{{else}}\n- The System Could not be Scanned; thus there is NO new RiskScore.\n{{/if}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE"
          },
          "5c6d3567-4385-4be8-b143-f66de30ba196": {
            "nodeId": "5c6d3567-4385-4be8-b143-f66de30ba196",
            "name": "Remediations Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "b528b3fb-84ff-4492-9efb-1800f7e1c843",
              "nextEdgeId": "1bc36fc0-b8f8-4b7d-8767-10e23aea7605",
              "repeatVariable": "{{[c9b63fbb-2046-4ae0-b682-6d6f069c314b].[assets]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "5fba5d1d-7643-4577-ac38-3ee016ead105": {
            "nodeId": "5fba5d1d-7643-4577-ac38-3ee016ead105",
            "name": "Resume Scan",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "update_scan_status",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "id": "{{[a725b949-51bf-409f-9ff6-244a857553ae].[id]}}",
                "status": "resume"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "id": {
                  "description": "Scan ID",
                  "order": 1,
                  "title": "ID",
                  "type": "integer"
                },
                "status": {
                  "default": "stop",
                  "description": "Status to which the scan should be set (stop, resume, pause)",
                  "enum": [
                    "stop",
                    "resume",
                    "pause"
                  ],
                  "order": 2,
                  "title": "Status",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "status"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 1,
                  "title": "Links",
                  "type": "array"
                }
              },
              "required": [
                "links"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "6e4dc68e-0e86-426e-96e1-6e7155b4f88d": {
            "nodeId": "6e4dc68e-0e86-426e-96e1-6e7155b4f88d",
            "name": "MS-TEAMS - Final Notification",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<p style=\"font-size:100%;\"><strong>The NEW RISKSCORE for the Asset {{[a3866bda-9e08-4afd-b6c0-acd2b446f8a3].[assets].[0].[hostname]}} is:</strong></p>\n<p style=\"font-size:150%;color:#FFFF00;background-color:#FF0000;\"><strong><i>{{[bbbe8639-1ce3-445b-8351-d53a720a0799].[riskScore]}}</strong></i></p>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7b963048-cbe6-4368-b518-cdb5d810570b": {
            "nodeId": "7b963048-cbe6-4368-b518-cdb5d810570b",
            "name": "Found Asset Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<p style=\"font-size:150%;\"><strong>Found asset {{#each [c9b63fbb-2046-4ae0-b682-6d6f069c314b].[assets]}} `{{this.[hostName]}}` {{/each}}<br/>\nStarting the scan for the system...</strong></p>\n<p style=\"font-size:125%;\"><strong><i>Here is the current information for {{#each [c9b63fbb-2046-4ae0-b682-6d6f069c314b].[assets]}} `{{this.[hostName]}}` {{/each}} before scanning:</strong></p>\n{{#each [c9b63fbb-2046-4ae0-b682-6d6f069c314b].[assets]}}\n<dl>\n  <dt>HOSTNAME:</dt>\n  <dd>- <i>{{this.[hostName]}}</i></dd>\n  <dt>IPADDRESS:</dt>\n  <dd>- <i>{{this.[ip]}}</i></dd>\n  <dt>MAC</dt>\n  <dd>- <i>{{this.[mac]}}</i></dd>\n  <dt>OPERATING SYSTEM:</dt>\n  <dd>- <i>{{this.[os]}}</i></dd>\n  <dt>CURRENT RISK SCORE:</dt>\n  <dd>- <i>{{[8e9eccf3-73fe-4932-a088-99887f9dc5bc].[output]}}</i></dd>\n  <dt>TOTAL VULNERABILITIES:</dt>\n  <dd>- <i>{{this.[vulnerabilities].[total]}}</i></dd>\n</dl>\n{{/each}}\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "7fbd956f-e239-40fd-801e-4b4411dfe334": {
            "nodeId": "7fbd956f-e239-40fd-801e-4b4411dfe334",
            "name": "Extract Argument",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "!scan-asset\\s+{{argument:/.*/}}",
              "expressions": [
                {
                  "type": "text",
                  "value": "!scan-asset\\s+"
                },
                {
                  "type": "variable",
                  "value": {
                    "ident": "argument",
                    "regex": ".*"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[e5cc9186-ca78-45ba-af5f-be183915d218].[text]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "8b3765cf-023a-4a24-bc20-27f0e09c7b9d": {
            "nodeId": "8b3765cf-023a-4a24-bc20-27f0e09c7b9d",
            "name": "RiskScore - Remove Decimals",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{riskScore:/\\d+/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "riskScore",
                    "regex": "\\d+"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[c9b63fbb-2046-4ae0-b682-6d6f069c314b].[assets].[0].[riskScore]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "8e9eccf3-73fe-4932-a088-99887f9dc5bc": {
            "nodeId": "8e9eccf3-73fe-4932-a088-99887f9dc5bc",
            "name": "RiskScore to Integer",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.0",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.0/icon.png"
            },
            "identifier": "string_to_integer",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "input": "{{[8b3765cf-023a-4a24-bc20-27f0e09c7b9d].[riskScore]}}",
                "strip": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "input": {
                  "description": "Input variable",
                  "order": 1,
                  "title": "Input",
                  "type": "string"
                },
                "strip": {
                  "description": "Strip whitespace",
                  "order": 2,
                  "title": "Strip",
                  "type": "boolean"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Type converted input",
                  "order": 1,
                  "title": "Output",
                  "type": "integer"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "90233698-ca2a-4af9-a677-bea7b2cc92ab": {
            "nodeId": "90233698-ca2a-4af9-a677-bea7b2cc92ab",
            "name": "Update Global Artifact",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "globalArtifactSchema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              },
              "input": {
                "value": "{{[fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab]}}"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "append_global_artifacts"
          },
          "91192672-ea19-476b-9bf7-a606c71a9951": {
            "nodeId": "91192672-ea19-476b-9bf7-a606c71a9951",
            "name": "Lookup Global Artifact",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "Job-URL"
                },
                "op": "=",
                "right": {
                  "name": "$job.URL",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'Job-URL' = {{[$job].[URL]}}",
              "globalArtifactSchema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts"
          },
          "973205db-20e8-49fc-9acc-9fe10b8698d7": {
            "nodeId": "973205db-20e8-49fc-9acc-9fe10b8698d7",
            "name": "Decision - Scan Status",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "fe6cf796-759b-46c8-b48d-177d2bc6d456",
              "stepControlParams": [
                {
                  "edgeId": "2f0ce356-bc58-4b9e-bce5-db335d487b4a",
                  "expression": {
                    "left": {
                      "name": "27c9932d-2e58-42ed-b0da-f28550418c95.status",
                      "type": "variable"
                    },
                    "op": "=~",
                    "right": {
                      "regexp": "aborted|error",
                      "type": "regexp"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}} =~ /aborted|error/"
                },
                {
                  "edgeId": "52312b82-5ae4-46a1-99ca-0c95b3fed196",
                  "expression": {
                    "left": {
                      "name": "27c9932d-2e58-42ed-b0da-f28550418c95.status",
                      "type": "variable"
                    },
                    "op": "=~",
                    "right": {
                      "regexp": "stopped|paused",
                      "type": "regexp"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}} =~ /stopped|paused/"
                },
                {
                  "edgeId": "55c2b95c-e801-43e1-9be7-3a41de44c7ec",
                  "expression": {
                    "left": {
                      "name": "27c9932d-2e58-42ed-b0da-f28550418c95.status",
                      "type": "variable"
                    },
                    "op": "=~",
                    "right": {
                      "regexp": "running|integrating|dispatched",
                      "type": "regexp"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}} =~ /running|integrating|dispatched/"
                },
                {
                  "edgeId": "fe6cf796-759b-46c8-b48d-177d2bc6d456",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "9dc688ec-7087-4818-8096-fdcd10b40325": {
            "nodeId": "9dc688ec-7087-4818-8096-fdcd10b40325",
            "name": "Break Loop - Error",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "b2b319b0-3e1b-4d94-8ea0-221fa6e1df51",
                "expression": {
                  "left": {
                    "name": "27c9932d-2e58-42ed-b0da-f28550418c95.status",
                    "type": "variable"
                  },
                  "op": "=~",
                  "right": {
                    "regexp": "aborted|error",
                    "type": "regexp"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}} =~ /aborted|error/"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "9eb59f4b-f4c3-4783-8085-618fce021d83": {
            "nodeId": "9eb59f4b-f4c3-4783-8085-618fce021d83",
            "name": "scan-asset Trigger",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "new_message_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "channel_name": "{{$workflow.[Channel Name]}}",
                "message_content": "!scan-asset\\s\\S",
                "team_name": "{{$workflow.[Team Name]}}"
              }
            },
            "triggerId": "623e1957-b4db-47b0-acd6-2668a242d112",
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "Regex to match new messages against",
                  "order": 3,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "required": [
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "hashes": {
                  "properties": {
                    "md5_hashes": {
                      "description": "Extracted MD5 Hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "MD5 Hashes",
                      "type": "array"
                    },
                    "sha1_hashes": {
                      "description": "Extracted SHA1 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "SHA1 Hashes",
                      "type": "array"
                    },
                    "sha256_hashes": {
                      "description": "Extracted SHA256 hashes from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "SHA256 Hashes",
                      "type": "array"
                    }
                  },
                  "title": "Hashes",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "cves": {
                      "description": "Extracted CVEs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "CVEs",
                      "type": "array"
                    },
                    "domains": {
                      "description": "Extracted domains from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "Domains",
                      "type": "array"
                    },
                    "email_addresses": {
                      "description": "Extracted email addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 3,
                      "title": "Email Addresses",
                      "type": "array"
                    },
                    "hashes": {
                      "$ref": "#/definitions/hashes",
                      "description": "Extracted hashes from message",
                      "order": 4,
                      "title": "Hashes"
                    },
                    "ip_addresses": {
                      "$ref": "#/definitions/ip_addresses",
                      "description": "Extracted IP addresses from message",
                      "order": 5,
                      "title": "IP Addressses"
                    },
                    "mac_addresses": {
                      "description": "Extracted MAC addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "MAC Addresses",
                      "type": "array"
                    },
                    "urls": {
                      "description": "Extracted URLs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "URLs",
                      "type": "array"
                    },
                    "uuids": {
                      "description": "Extracted UUIDs from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "UUIDs",
                      "type": "array"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                },
                "ip_addresses": {
                  "properties": {
                    "ipv4_addresses": {
                      "description": "Extracted IPv4 addressses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 1,
                      "title": "IPv4 Addressses",
                      "type": "array"
                    },
                    "ipv6_addresses": {
                      "description": "Extracted IPv6 addresses from message",
                      "items": {
                        "type": "string"
                      },
                      "order": 2,
                      "title": "IPv6 Addressses",
                      "type": "array"
                    }
                  },
                  "title": "Ip Addresses",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "channel_name": {
                  "description": "Name of the channel where the message was posted",
                  "order": 3,
                  "title": "Channel Name",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "The indicators object that was extracted from message",
                  "order": 2,
                  "title": "Indicators"
                },
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                },
                "team_name": {
                  "description": "Name of the team to which the channel is assigned to",
                  "order": 4,
                  "title": "Team Name",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION"
          },
          "a3866bda-9e08-4afd-b6c0-acd2b446f8a3": {
            "nodeId": "a3866bda-9e08-4afd-b6c0-acd2b446f8a3",
            "name": "Get New Risk Score",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "asset_search",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "searchCriteria": {
                  "filters": [
                    {
                      "field": "host-name",
                      "operator": "contains",
                      "value": "{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}"
                    }
                  ],
                  "match": "all"
                },
                "size": 0,
                "sort_criteria": {}
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "searchCriteria": {
                  "description": "Tag search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria",
                  "order": 1,
                  "title": "Search Criteria",
                  "type": "object"
                },
                "size": {
                  "default": 0,
                  "description": "The number of records to retrieve. If blank or '0' all assets that match the search will be returned",
                  "order": 2,
                  "title": "Size",
                  "type": "number"
                },
                "sort_criteria": {
                  "description": "JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)",
                  "order": 3,
                  "title": "Sort Criteria",
                  "type": "object"
                }
              },
              "required": [
                "searchCriteria"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address": {
                  "properties": {
                    "ip": {
                      "description": "IPv4 or IPv6 address",
                      "order": 1,
                      "title": "IP",
                      "type": "string"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 2,
                      "title": "MAC",
                      "type": "string"
                    }
                  },
                  "title": "Address",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "addresses": {
                      "description": "All addresses discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/address"
                      },
                      "order": 1,
                      "title": "Addresses",
                      "type": "array"
                    },
                    "assessedForPolicies": {
                      "description": "Whether the asset has been assessed for policies at least once",
                      "order": 2,
                      "title": "Assessed for Policies",
                      "type": "boolean"
                    },
                    "assessedForVulnerabilities": {
                      "description": "Whether the asset has been assessed for vulnerabilities at least once",
                      "order": 3,
                      "title": "Assessed for Vulnerabilities",
                      "type": "boolean"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 4,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 5,
                      "title": "Databases",
                      "type": "array"
                    },
                    "files": {
                      "description": "Files discovered with searching on the asset",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 6,
                      "title": "Files",
                      "type": "array"
                    },
                    "history": {
                      "description": "History of changes to the asset over time",
                      "items": {
                        "$ref": "#/definitions/history"
                      },
                      "order": 7,
                      "title": "History",
                      "type": "array"
                    },
                    "hostName": {
                      "description": "Primary host name (local or FQDN) of the asset",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "hostNames": {
                      "description": "All hostnames or aliases discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/hostName"
                      },
                      "order": 9,
                      "title": "Hostnames",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of the asset",
                      "order": 10,
                      "title": "ID",
                      "type": "integer"
                    },
                    "ids": {
                      "description": "Unique identifiers found on the asset, such as hardware or operating system identifiers",
                      "items": {
                        "$ref": "#/definitions/id"
                      },
                      "order": 11,
                      "title": "IDs",
                      "type": "array"
                    },
                    "ip": {
                      "description": "Primary IPv4 or IPv6 address of the asset",
                      "order": 12,
                      "title": "IP",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 13,
                      "title": "Links",
                      "type": "array"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 14,
                      "title": "MAC",
                      "type": "string"
                    },
                    "os": {
                      "description": "Full description of the operating system of the asset",
                      "order": 15,
                      "title": "OS",
                      "type": "string"
                    },
                    "osFingerprint": {
                      "$ref": "#/definitions/osFingerprint",
                      "description": "Details of the operating system of the asset",
                      "order": 16,
                      "title": "OS Fingerprint"
                    },
                    "rawRiskScore": {
                      "description": "Base risk score of the asset",
                      "order": 17,
                      "title": "Raw Risk Score",
                      "type": "number"
                    },
                    "riskScore": {
                      "description": "Risk score (with criticality adjustments) of the asset",
                      "order": 18,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "services": {
                      "description": "Services discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/service"
                      },
                      "order": 19,
                      "title": "Services",
                      "type": "array"
                    },
                    "software": {
                      "description": "Software discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/software"
                      },
                      "order": 20,
                      "title": "Software",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type of asset e.g. unknown, guest, hypervisor, physical, mobile",
                      "order": 21,
                      "title": "Type",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User group accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 22,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "User accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 23,
                      "title": "Users",
                      "type": "array"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities",
                      "description": " Summary information for vulnerabilities on the asset",
                      "order": 24,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Asset",
                  "type": "object"
                },
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "cpe": {
                  "properties": {
                    "edition": {
                      "description": "Edition-related terms applied by the vendor to the product",
                      "order": 1,
                      "title": "Edition",
                      "type": "string"
                    },
                    "language": {
                      "description": "Defines the language supported in the user interface of the product being described. The format of the language tag adheres to RFC 5646",
                      "order": 2,
                      "title": "Language",
                      "type": "string"
                    },
                    "other": {
                      "description": "Captures any other general descriptive or identifying information which is vendor- or product-specific and which does not logically fit in any other attribute value",
                      "order": 3,
                      "title": "Other",
                      "type": "string"
                    },
                    "part": {
                      "description": "A single letter code that designates the particular platform part that is being identified",
                      "order": 4,
                      "title": "Part",
                      "type": "string"
                    },
                    "product": {
                      "description": "Most common and recognizable title or name of the product",
                      "order": 5,
                      "title": "Product",
                      "type": "string"
                    },
                    "swEdition": {
                      "description": "Characterizes how the product is tailored to a particular market or class of end users",
                      "order": 6,
                      "title": "Software Edition",
                      "type": "string"
                    },
                    "targetHW": {
                      "description": "Characterize the instruction set architecture on which the product operates",
                      "order": 7,
                      "title": "Target Hardware",
                      "type": "string"
                    },
                    "targetSW": {
                      "description": "Characterizes the software computing environment within which the product operates",
                      "order": 8,
                      "title": "Target Software",
                      "type": "string"
                    },
                    "update": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular update, service pack, or point release of the product",
                      "order": 9,
                      "title": "Update",
                      "type": "string"
                    },
                    "v2.2": {
                      "description": "The full CPE string in the CPE 2.2 format",
                      "order": 10,
                      "title": "Version 2.2",
                      "type": "string"
                    },
                    "v2.3": {
                      "description": "The full CPE string in the CPE 2.3 format",
                      "order": 11,
                      "title": "Version 2.3",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "The person or organization that manufactured or created the product",
                      "order": 12,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular release version of the product",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Cpe",
                  "type": "object"
                },
                "database": {
                  "properties": {
                    "description": {
                      "description": "Description of the database instance",
                      "order": 1,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the database",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the database instance",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Database",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "history": {
                  "properties": {
                    "date": {
                      "description": "Date the asset information was collected or changed",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "description": {
                      "description": "Additional information describing the change",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "scanId": {
                      "description": "If a scan-oriented change, the identifier of the corresponding scan the asset was scanned in",
                      "order": 3,
                      "title": "Scan ID",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type, for additional information see the help section of this plugin",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    },
                    "user": {
                      "description": "User",
                      "order": 5,
                      "title": "User",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version",
                      "order": 6,
                      "title": "Version",
                      "type": "integer"
                    },
                    "vulnerabilityExceptionId": {
                      "description": "Vulnerability exception ID",
                      "order": 7,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    }
                  },
                  "title": "History",
                  "type": "object"
                },
                "hostName": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "HostName",
                  "type": "object"
                },
                "id": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Id",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "osFingerprint": {
                  "properties": {
                    "architecture": {
                      "description": "The architecture of the operating system",
                      "order": 1,
                      "title": "Architecture",
                      "type": "string"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the operating system",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 2,
                      "title": "Configuration",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "Common Platform Enumeration",
                      "order": 3,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "The description of the operating system (containing vendor, family, product, version and architecture in a single string)",
                      "order": 4,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the operating system",
                      "order": 5,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the operating system",
                      "order": 6,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Name of the operating system",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "systemName": {
                      "description": "A combination of vendor and family (with redundancies removed), suitable for grouping",
                      "order": 8,
                      "title": "System Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of operating system",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the operating system",
                      "order": 10,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the operating system",
                      "order": 11,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "OsFingerprint",
                  "type": "object"
                },
                "page": {
                  "properties": {
                    "linkType": {
                      "description": "Type of link used to traverse or detect the page",
                      "order": 1,
                      "title": "Link Type",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path to the page (URI)",
                      "order": 2,
                      "title": "Path",
                      "type": "string"
                    },
                    "response": {
                      "description": "HTTP response code observed with retrieving the page",
                      "order": 3,
                      "title": "Response",
                      "type": "integer"
                    }
                  },
                  "title": "Page",
                  "type": "object"
                },
                "service": {
                  "properties": {
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 2,
                      "title": "Databases",
                      "type": "array"
                    },
                    "family": {
                      "description": "Family of the service",
                      "order": 3,
                      "title": "Family",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name of the service",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "port": {
                      "description": "Port of the service",
                      "order": 6,
                      "title": "Port",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product running the service",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service",
                      "order": 8,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User groups",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 9,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 10,
                      "title": "Users",
                      "type": "array"
                    },
                    "vendor": {
                      "description": "Vendor of the service",
                      "order": 11,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the service",
                      "order": 12,
                      "title": "Version",
                      "type": "string"
                    },
                    "webApplications": {
                      "description": "Web applications found on the service",
                      "items": {
                        "$ref": "#/definitions/webApplication"
                      },
                      "order": 13,
                      "title": "Web Applications",
                      "type": "array"
                    }
                  },
                  "title": "Service",
                  "type": "object"
                },
                "software": {
                  "properties": {
                    "configurations": {
                      "description": "Configurations",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "CPE",
                      "order": 2,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "Description of the software",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the software",
                      "order": 4,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 5,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product of the software",
                      "order": 6,
                      "title": "Product",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of the software",
                      "order": 7,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the software",
                      "order": 8,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the software",
                      "order": 9,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Software",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "fullName": {
                      "description": "Full name of the user account",
                      "order": 1,
                      "title": "Full Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the user account",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user account",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                },
                "userGroup": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the user group",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user group",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "UserGroup",
                  "type": "object"
                },
                "vulnerabilities": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "exploits": {
                      "description": "Number of distinct exploits that can exploit any of the vulnerabilities on the asset",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "malwareKits": {
                      "description": "Number of distinct malware kits that vulnerabilities on the asset are susceptible to",
                      "order": 3,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 4,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 5,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total number of vulnerabilities",
                      "order": 6,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities",
                  "type": "object"
                },
                "webApplication": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the web application",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "pages": {
                      "description": "Pages",
                      "items": {
                        "$ref": "#/definitions/page"
                      },
                      "order": 2,
                      "title": "Pages",
                      "type": "array"
                    },
                    "root": {
                      "description": "Web root of the web application",
                      "order": 3,
                      "title": "Root",
                      "type": "string"
                    },
                    "virtualHost": {
                      "description": "Virtual host of the web application",
                      "order": 4,
                      "title": "Virtual Host",
                      "type": "string"
                    }
                  },
                  "title": "WebApplication",
                  "type": "object"
                }
              },
              "properties": {
                "assets": {
                  "description": "List of asset details returned by the search",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 1,
                  "title": "Assets",
                  "type": "array"
                }
              },
              "required": [
                "assets"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "a725b949-51bf-409f-9ff6-244a857553ae": {
            "nodeId": "a725b949-51bf-409f-9ff6-244a857553ae",
            "name": "Scan Asset",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "scan",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "hosts": [
                  "{{[5c6d3567-4385-4be8-b143-f66de30ba196].[$item].[hostName]}}"
                ],
                "site_id": "{{$workflow.[Site ID]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "hosts": {
                  "description": "The hosts that should be included in the scan",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Hosts",
                  "type": "array"
                },
                "site_id": {
                  "description": "ID of the site to scan",
                  "order": 1,
                  "title": "Site ID",
                  "type": "string"
                }
              },
              "required": [
                "site_id"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                }
              },
              "properties": {
                "id": {
                  "description": "Identifier of the resource created",
                  "order": 1,
                  "title": "Scan ID",
                  "type": "integer"
                },
                "links": {
                  "description": "Hypermedia links to corresponding or related resources",
                  "items": {
                    "$ref": "#/definitions/link"
                  },
                  "order": 2,
                  "title": "Links",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b08448d2-170a-447e-a1a4-0395040805fb": {
            "nodeId": "b08448d2-170a-447e-a1a4-0395040805fb",
            "name": "MS-Teams - Final Notification - Failure",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<p style=\"font-size:100%;\"><strong>There was an issue and the scan you started did not complete without Errors.<br/>Please try again or contact support.<br/>Thank you</strong></p>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "b0a783dc-4b5e-4f5f-9673-f1e706787688": {
            "nodeId": "b0a783dc-4b5e-4f5f-9673-f1e706787688",
            "name": "Delay 3 Minutes",
            "type": "action",
            "plugin": {
              "name": "Timers",
              "slugVendor": "rapid7",
              "slugName": "timers",
              "slugVersion": "2.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/2.0.5/icon.png"
            },
            "identifier": "delay",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delay": 180
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delay": {
                  "description": "How long to delay the workflow (in seconds)",
                  "order": 1,
                  "title": "Delay",
                  "type": "number"
                }
              },
              "required": [
                "delay"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "b2586560-4b29-4c42-8ba9-a96410b69b23": {
            "nodeId": "b2586560-4b29-4c42-8ba9-a96410b69b23",
            "name": "If Resume Scan Fails",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "80fb47ab-b951-41e3-bb0b-2be59eae86c5",
                "expression": {
                  "expr": {
                    "name": "5fba5d1d-7643-4577-ac38-3ee016ead105.$success",
                    "type": "variable"
                  },
                  "op": "NOT",
                  "type": "unary"
                },
                "expressionText": "NOT ({{[5fba5d1d-7643-4577-ac38-3ee016ead105].[$success]}})"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "bbbe8639-1ce3-445b-8351-d53a720a0799": {
            "nodeId": "bbbe8639-1ce3-445b-8351-d53a720a0799",
            "name": "Get Scanned Risk Score",
            "type": "pattern_match",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "captureAll": false,
              "expressionText": "{{riskScore:/\\d+/}}",
              "expressions": [
                {
                  "type": "variable",
                  "value": {
                    "ident": "riskScore",
                    "regex": "\\d+"
                  }
                }
              ],
              "ignoreCase": true,
              "input": "{{[a3866bda-9e08-4afd-b6c0-acd2b446f8a3].[assets].[0].[riskScore]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/pattern-match.svg",
            "connectionType": "NONE"
          },
          "c9b63fbb-2046-4ae0-b682-6d6f069c314b": {
            "nodeId": "c9b63fbb-2046-4ae0-b682-6d6f069c314b",
            "name": "Find Asset ID",
            "type": "action",
            "plugin": {
              "name": "Rapid7 InsightVM Console",
              "slugVendor": "rapid7",
              "slugName": "rapid7_insightvm",
              "slugVersion": "4.9.1",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/rapid7_insightvm/4.9.1/icon.png"
            },
            "identifier": "asset_search",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "searchCriteria": {
                  "filters": [
                    {
                      "field": "site-id",
                      "operator": "in",
                      "values": [
                        "{{$workflow.[Site ID]}}"
                      ]
                    },
                    {
                      "field": "host-name",
                      "operator": "contains",
                      "value": "{{[7fbd956f-e239-40fd-801e-4b4411dfe334].[argument]}}"
                    }
                  ],
                  "match": "all"
                },
                "size": 0,
                "sort_criteria": {}
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "searchCriteria": {
                  "description": "Tag search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria",
                  "order": 1,
                  "title": "Search Criteria",
                  "type": "object"
                },
                "size": {
                  "default": 0,
                  "description": "The number of records to retrieve. If blank or '0' all assets that match the search will be returned",
                  "order": 2,
                  "title": "Size",
                  "type": "number"
                },
                "sort_criteria": {
                  "description": "JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)",
                  "order": 3,
                  "title": "Sort Criteria",
                  "type": "object"
                }
              },
              "required": [
                "searchCriteria"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "address": {
                  "properties": {
                    "ip": {
                      "description": "IPv4 or IPv6 address",
                      "order": 1,
                      "title": "IP",
                      "type": "string"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 2,
                      "title": "MAC",
                      "type": "string"
                    }
                  },
                  "title": "Address",
                  "type": "object"
                },
                "asset": {
                  "properties": {
                    "addresses": {
                      "description": "All addresses discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/address"
                      },
                      "order": 1,
                      "title": "Addresses",
                      "type": "array"
                    },
                    "assessedForPolicies": {
                      "description": "Whether the asset has been assessed for policies at least once",
                      "order": 2,
                      "title": "Assessed for Policies",
                      "type": "boolean"
                    },
                    "assessedForVulnerabilities": {
                      "description": "Whether the asset has been assessed for vulnerabilities at least once",
                      "order": 3,
                      "title": "Assessed for Vulnerabilities",
                      "type": "boolean"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 4,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 5,
                      "title": "Databases",
                      "type": "array"
                    },
                    "files": {
                      "description": "Files discovered with searching on the asset",
                      "items": {
                        "$ref": "#/definitions/file"
                      },
                      "order": 6,
                      "title": "Files",
                      "type": "array"
                    },
                    "history": {
                      "description": "History of changes to the asset over time",
                      "items": {
                        "$ref": "#/definitions/history"
                      },
                      "order": 7,
                      "title": "History",
                      "type": "array"
                    },
                    "hostName": {
                      "description": "Primary host name (local or FQDN) of the asset",
                      "order": 8,
                      "title": "Hostname",
                      "type": "string"
                    },
                    "hostNames": {
                      "description": "All hostnames or aliases discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/hostName"
                      },
                      "order": 9,
                      "title": "Hostnames",
                      "type": "array"
                    },
                    "id": {
                      "description": "Identifier of the asset",
                      "order": 10,
                      "title": "ID",
                      "type": "integer"
                    },
                    "ids": {
                      "description": "Unique identifiers found on the asset, such as hardware or operating system identifiers",
                      "items": {
                        "$ref": "#/definitions/id"
                      },
                      "order": 11,
                      "title": "IDs",
                      "type": "array"
                    },
                    "ip": {
                      "description": "Primary IPv4 or IPv6 address of the asset",
                      "order": 12,
                      "title": "IP",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 13,
                      "title": "Links",
                      "type": "array"
                    },
                    "mac": {
                      "description": "Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48",
                      "order": 14,
                      "title": "MAC",
                      "type": "string"
                    },
                    "os": {
                      "description": "Full description of the operating system of the asset",
                      "order": 15,
                      "title": "OS",
                      "type": "string"
                    },
                    "osFingerprint": {
                      "$ref": "#/definitions/osFingerprint",
                      "description": "Details of the operating system of the asset",
                      "order": 16,
                      "title": "OS Fingerprint"
                    },
                    "rawRiskScore": {
                      "description": "Base risk score of the asset",
                      "order": 17,
                      "title": "Raw Risk Score",
                      "type": "number"
                    },
                    "riskScore": {
                      "description": "Risk score (with criticality adjustments) of the asset",
                      "order": 18,
                      "title": "Risk Score",
                      "type": "number"
                    },
                    "services": {
                      "description": "Services discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/service"
                      },
                      "order": 19,
                      "title": "Services",
                      "type": "array"
                    },
                    "software": {
                      "description": "Software discovered on the asset",
                      "items": {
                        "$ref": "#/definitions/software"
                      },
                      "order": 20,
                      "title": "Software",
                      "type": "array"
                    },
                    "type": {
                      "description": "Type of asset e.g. unknown, guest, hypervisor, physical, mobile",
                      "order": 21,
                      "title": "Type",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User group accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 22,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "User accounts enumerated on the asset",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 23,
                      "title": "Users",
                      "type": "array"
                    },
                    "vulnerabilities": {
                      "$ref": "#/definitions/vulnerabilities",
                      "description": " Summary information for vulnerabilities on the asset",
                      "order": 24,
                      "title": "Vulnerabilities"
                    }
                  },
                  "title": "Asset",
                  "type": "object"
                },
                "configuration": {
                  "properties": {
                    "name": {
                      "description": "Name of the configuration value",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "description": "Configuration value",
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Configuration",
                  "type": "object"
                },
                "cpe": {
                  "properties": {
                    "edition": {
                      "description": "Edition-related terms applied by the vendor to the product",
                      "order": 1,
                      "title": "Edition",
                      "type": "string"
                    },
                    "language": {
                      "description": "Defines the language supported in the user interface of the product being described. The format of the language tag adheres to RFC 5646",
                      "order": 2,
                      "title": "Language",
                      "type": "string"
                    },
                    "other": {
                      "description": "Captures any other general descriptive or identifying information which is vendor- or product-specific and which does not logically fit in any other attribute value",
                      "order": 3,
                      "title": "Other",
                      "type": "string"
                    },
                    "part": {
                      "description": "A single letter code that designates the particular platform part that is being identified",
                      "order": 4,
                      "title": "Part",
                      "type": "string"
                    },
                    "product": {
                      "description": "Most common and recognizable title or name of the product",
                      "order": 5,
                      "title": "Product",
                      "type": "string"
                    },
                    "swEdition": {
                      "description": "Characterizes how the product is tailored to a particular market or class of end users",
                      "order": 6,
                      "title": "Software Edition",
                      "type": "string"
                    },
                    "targetHW": {
                      "description": "Characterize the instruction set architecture on which the product operates",
                      "order": 7,
                      "title": "Target Hardware",
                      "type": "string"
                    },
                    "targetSW": {
                      "description": "Characterizes the software computing environment within which the product operates",
                      "order": 8,
                      "title": "Target Software",
                      "type": "string"
                    },
                    "update": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular update, service pack, or point release of the product",
                      "order": 9,
                      "title": "Update",
                      "type": "string"
                    },
                    "v2.2": {
                      "description": "The full CPE string in the CPE 2.2 format",
                      "order": 10,
                      "title": "Version 2.2",
                      "type": "string"
                    },
                    "v2.3": {
                      "description": "The full CPE string in the CPE 2.3 format",
                      "order": 11,
                      "title": "Version 2.3",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "The person or organization that manufactured or created the product",
                      "order": 12,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Vendor-specific alphanumeric strings characterizing the particular release version of the product",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Cpe",
                  "type": "object"
                },
                "database": {
                  "properties": {
                    "description": {
                      "description": "Description of the database instance",
                      "order": 1,
                      "title": "Description",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the database",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the database instance",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Database",
                  "type": "object"
                },
                "file": {
                  "properties": {
                    "attributes": {
                      "description": "Attributes detected on the file",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Attributes",
                      "type": "array"
                    },
                    "content": {
                      "description": "Contents of the file",
                      "displayType": "bytes",
                      "format": "bytes",
                      "order": 5,
                      "title": "Contents",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name of the file",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    },
                    "size": {
                      "description": "Size of the regular file (in bytes). If the file is a directory, no value is returned",
                      "order": 3,
                      "title": "Size",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type of the file, e.g. file or directory",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                },
                "history": {
                  "properties": {
                    "date": {
                      "description": "Date the asset information was collected or changed",
                      "order": 1,
                      "title": "Date",
                      "type": "string"
                    },
                    "description": {
                      "description": "Additional information describing the change",
                      "order": 2,
                      "title": "Description",
                      "type": "string"
                    },
                    "scanId": {
                      "description": "If a scan-oriented change, the identifier of the corresponding scan the asset was scanned in",
                      "order": 3,
                      "title": "Scan ID",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type, for additional information see the help section of this plugin",
                      "order": 4,
                      "title": "Type",
                      "type": "string"
                    },
                    "user": {
                      "description": "User",
                      "order": 5,
                      "title": "User",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version",
                      "order": 6,
                      "title": "Version",
                      "type": "integer"
                    },
                    "vulnerabilityExceptionId": {
                      "description": "Vulnerability exception ID",
                      "order": 7,
                      "title": "Vulnerability Exception ID",
                      "type": "integer"
                    }
                  },
                  "title": "History",
                  "type": "object"
                },
                "hostName": {
                  "properties": {
                    "name": {
                      "description": "Name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "HostName",
                  "type": "object"
                },
                "id": {
                  "properties": {
                    "id": {
                      "description": "ID",
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "source": {
                      "description": "Source",
                      "order": 2,
                      "title": "Source",
                      "type": "string"
                    }
                  },
                  "title": "Id",
                  "type": "object"
                },
                "link": {
                  "properties": {
                    "href": {
                      "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
                      "order": 1,
                      "title": "URL",
                      "type": "string"
                    },
                    "rel": {
                      "description": "Link relation type following RFC 5988",
                      "order": 2,
                      "title": "Rel",
                      "type": "string"
                    }
                  },
                  "title": "Link",
                  "type": "object"
                },
                "osFingerprint": {
                  "properties": {
                    "architecture": {
                      "description": "The architecture of the operating system",
                      "order": 1,
                      "title": "Architecture",
                      "type": "string"
                    },
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the operating system",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 2,
                      "title": "Configuration",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "Common Platform Enumeration",
                      "order": 3,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "The description of the operating system (containing vendor, family, product, version and architecture in a single string)",
                      "order": 4,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the operating system",
                      "order": 5,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the operating system",
                      "order": 6,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Name of the operating system",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "systemName": {
                      "description": "A combination of vendor and family (with redundancies removed), suitable for grouping",
                      "order": 8,
                      "title": "System Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of operating system",
                      "order": 9,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the operating system",
                      "order": 10,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the operating system",
                      "order": 11,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "OsFingerprint",
                  "type": "object"
                },
                "page": {
                  "properties": {
                    "linkType": {
                      "description": "Type of link used to traverse or detect the page",
                      "order": 1,
                      "title": "Link Type",
                      "type": "string"
                    },
                    "path": {
                      "description": "Path to the page (URI)",
                      "order": 2,
                      "title": "Path",
                      "type": "string"
                    },
                    "response": {
                      "description": "HTTP response code observed with retrieving the page",
                      "order": 3,
                      "title": "Response",
                      "type": "integer"
                    }
                  },
                  "title": "Page",
                  "type": "object"
                },
                "service": {
                  "properties": {
                    "configurations": {
                      "description": "Configuration key-values pairs enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "databases": {
                      "description": "Databases enumerated on the service",
                      "items": {
                        "$ref": "#/definitions/database"
                      },
                      "order": 2,
                      "title": "Databases",
                      "type": "array"
                    },
                    "family": {
                      "description": "Family of the service",
                      "order": 3,
                      "title": "Family",
                      "type": "string"
                    },
                    "links": {
                      "description": "Hypermedia links to corresponding or related resources",
                      "items": {
                        "$ref": "#/definitions/link"
                      },
                      "order": 4,
                      "title": "Links",
                      "type": "array"
                    },
                    "name": {
                      "description": "Name of the service",
                      "order": 5,
                      "title": "Name",
                      "type": "string"
                    },
                    "port": {
                      "description": "Port of the service",
                      "order": 6,
                      "title": "Port",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product running the service",
                      "order": 7,
                      "title": "Product",
                      "type": "string"
                    },
                    "protocol": {
                      "description": "Protocol of the service",
                      "order": 8,
                      "title": "Protocol",
                      "type": "string"
                    },
                    "userGroups": {
                      "description": "User groups",
                      "items": {
                        "$ref": "#/definitions/userGroup"
                      },
                      "order": 9,
                      "title": "User Groups",
                      "type": "array"
                    },
                    "users": {
                      "description": "Users",
                      "items": {
                        "$ref": "#/definitions/user"
                      },
                      "order": 10,
                      "title": "Users",
                      "type": "array"
                    },
                    "vendor": {
                      "description": "Vendor of the service",
                      "order": 11,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the service",
                      "order": 12,
                      "title": "Version",
                      "type": "string"
                    },
                    "webApplications": {
                      "description": "Web applications found on the service",
                      "items": {
                        "$ref": "#/definitions/webApplication"
                      },
                      "order": 13,
                      "title": "Web Applications",
                      "type": "array"
                    }
                  },
                  "title": "Service",
                  "type": "object"
                },
                "software": {
                  "properties": {
                    "configurations": {
                      "description": "Configurations",
                      "items": {
                        "$ref": "#/definitions/configuration"
                      },
                      "order": 1,
                      "title": "Configurations",
                      "type": "array"
                    },
                    "cpe": {
                      "$ref": "#/definitions/cpe",
                      "description": "CPE",
                      "order": 2,
                      "title": "CPE"
                    },
                    "description": {
                      "description": "Description of the software",
                      "order": 3,
                      "title": "Description",
                      "type": "string"
                    },
                    "family": {
                      "description": "Family of the software",
                      "order": 4,
                      "title": "Family",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 5,
                      "title": "ID",
                      "type": "integer"
                    },
                    "product": {
                      "description": "Product of the software",
                      "order": 6,
                      "title": "Product",
                      "type": "string"
                    },
                    "type": {
                      "description": "Type of the software",
                      "order": 7,
                      "title": "Type",
                      "type": "string"
                    },
                    "vendor": {
                      "description": "Vendor of the software",
                      "order": 8,
                      "title": "Vendor",
                      "type": "string"
                    },
                    "version": {
                      "description": "Version of the software",
                      "order": 9,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Software",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "fullName": {
                      "description": "Full name of the user account",
                      "order": 1,
                      "title": "Full Name",
                      "type": "string"
                    },
                    "id": {
                      "description": "Identifier of the user account",
                      "order": 2,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user account",
                      "order": 3,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                },
                "userGroup": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the user group",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "name": {
                      "description": "Name of the user group",
                      "order": 2,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "UserGroup",
                  "type": "object"
                },
                "vulnerabilities": {
                  "properties": {
                    "critical": {
                      "description": "Number of critical vulnerabilities",
                      "order": 1,
                      "title": "Critical",
                      "type": "integer"
                    },
                    "exploits": {
                      "description": "Number of distinct exploits that can exploit any of the vulnerabilities on the asset",
                      "order": 2,
                      "title": "Exploits",
                      "type": "integer"
                    },
                    "malwareKits": {
                      "description": "Number of distinct malware kits that vulnerabilities on the asset are susceptible to",
                      "order": 3,
                      "title": "Malware Kits",
                      "type": "integer"
                    },
                    "moderate": {
                      "description": "Number of moderate vulnerabilities",
                      "order": 4,
                      "title": "Moderate",
                      "type": "integer"
                    },
                    "severe": {
                      "description": "Number of severe vulnerabilities",
                      "order": 5,
                      "title": "Severe",
                      "type": "integer"
                    },
                    "total": {
                      "description": "Total number of vulnerabilities",
                      "order": 6,
                      "title": "Total",
                      "type": "integer"
                    }
                  },
                  "title": "Vulnerabilities",
                  "type": "object"
                },
                "webApplication": {
                  "properties": {
                    "id": {
                      "description": "Identifier of the web application",
                      "order": 1,
                      "title": "ID",
                      "type": "integer"
                    },
                    "pages": {
                      "description": "Pages",
                      "items": {
                        "$ref": "#/definitions/page"
                      },
                      "order": 2,
                      "title": "Pages",
                      "type": "array"
                    },
                    "root": {
                      "description": "Web root of the web application",
                      "order": 3,
                      "title": "Root",
                      "type": "string"
                    },
                    "virtualHost": {
                      "description": "Virtual host of the web application",
                      "order": 4,
                      "title": "Virtual Host",
                      "type": "string"
                    }
                  },
                  "title": "WebApplication",
                  "type": "object"
                }
              },
              "properties": {
                "assets": {
                  "description": "List of asset details returned by the search",
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "order": 1,
                  "title": "Assets",
                  "type": "array"
                }
              },
              "required": [
                "assets"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "ceb73879-8d0f-4952-81c5-3a2c321d50ca": {
            "nodeId": "ceb73879-8d0f-4952-81c5-3a2c321d50ca",
            "name": "Loop - Scan Status",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "ac6590f4-01c7-4778-b641-128a98e6b7c5",
              "nextEdgeId": "f96c518b-8221-4767-a62e-8f512dc14f18",
              "repeatCount": 30,
              "repeatDelay": 60,
              "repeatDelayDisplayUnit": "minutes"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/loop.svg",
            "connectionType": "NONE"
          },
          "cfc00829-8775-403a-86f0-fbd8499c71c4": {
            "nodeId": "cfc00829-8775-403a-86f0-fbd8499c71c4",
            "name": "MS-TEAMS - Error Message",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<strong>The scan finished with an error.</strong><br/>\nPlease login and check the Nexpose Console to see what caused the problem\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          },
          "d1afcf27-37a4-45db-8358-8641e1c19151": {
            "nodeId": "d1afcf27-37a4-45db-8358-8641e1c19151",
            "name": "Pause Resuming for 5 Minutes",
            "type": "action",
            "plugin": {
              "name": "Timers",
              "slugVendor": "rapid7",
              "slugName": "timers",
              "slugVersion": "2.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/2.0.5/icon.png"
            },
            "identifier": "delay",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delay": 300
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delay": {
                  "description": "How long to delay the workflow (in seconds)",
                  "order": 1,
                  "title": "Delay",
                  "type": "number"
                }
              },
              "required": [
                "delay"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "d962b87e-69f6-43ae-930e-2a0841d9328f": {
            "nodeId": "d962b87e-69f6-43ae-930e-2a0841d9328f",
            "name": "Final Join - Artifact",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "b768c0b1-6369-4fdd-b9ef-89d9ca03a11c",
                "e69350ec-4a74-408b-9373-ede33d8040ae"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "NewRiskScore",
                  "type": "string",
                  "variables": {
                    "b768c0b1-6369-4fdd-b9ef-89d9ca03a11c": "There is no New RiskScore",
                    "e69350ec-4a74-408b-9373-ede33d8040ae": "{{[bbbe8639-1ce3-445b-8351-d53a720a0799].[riskScore]}}"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "NewRiskScore": {
                  "description": "Emitted variable \"NewRiskScore\"",
                  "order": 1,
                  "title": "NewRiskScore",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "NewRiskScore": {
                  "description": "Emitted variable \"NewRiskScore\"",
                  "order": 1,
                  "title": "NewRiskScore",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE"
          },
          "e15e1d61-2435-4767-8092-f8ae7e74b081": {
            "nodeId": "e15e1d61-2435-4767-8092-f8ae7e74b081",
            "name": "Timer - Delay Resume",
            "type": "action",
            "plugin": {
              "name": "Timers",
              "slugVendor": "rapid7",
              "slugName": "timers",
              "slugVersion": "2.0.5",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/2.0.5/icon.png"
            },
            "identifier": "delay",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delay": 180
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delay": {
                  "description": "How long to delay the workflow (in seconds)",
                  "order": 1,
                  "title": "Delay",
                  "type": "number"
                }
              },
              "required": [
                "delay"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e5cc9186-ca78-45ba-af5f-be183915d218": {
            "nodeId": "e5cc9186-ca78-45ba-af5f-be183915d218",
            "name": "Clean Teams Message",
            "type": "action",
            "plugin": {
              "name": "HTML",
              "slugVendor": "rapid7",
              "slugName": "html",
              "slugVersion": "1.2.2",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/html/1.2.2/icon.png"
            },
            "identifier": "text",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "doc": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[body].[content]}}",
                "remove_scripts": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "doc": {
                  "description": "Document to transform",
                  "order": 1,
                  "title": "Document",
                  "type": "string"
                },
                "remove_scripts": {
                  "description": "Remove non-HTML scripts from the document",
                  "order": 2,
                  "title": "Remove Scripts",
                  "type": "boolean"
                }
              },
              "required": [
                "doc"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "text": {
                  "description": "String without HTML tags",
                  "order": 1,
                  "title": "Text",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR"
          },
          "e5e05b38-3bf6-4785-a1ca-b4baab6de569": {
            "nodeId": "e5e05b38-3bf6-4785-a1ca-b4baab6de569",
            "name": "Did Scan Complete",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2b28c7b1-3956-4535-8b16-1b945b0701da",
              "stepControlParams": [
                {
                  "edgeId": "2b28c7b1-3956-4535-8b16-1b945b0701da",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "0abf8ef1-4ce1-4dfe-aa23-966ae32335af",
                  "expression": {
                    "expr": {
                      "name": "91192672-ea19-476b-9bf7-a606c71a9951.found",
                      "type": "variable"
                    },
                    "op": "NOT",
                    "type": "unary"
                  },
                  "expressionText": "NOT {{[91192672-ea19-476b-9bf7-a606c71a9951].[found]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE"
          },
          "f22b5842-d7c1-4b80-bc6e-7341d07b5622": {
            "nodeId": "f22b5842-d7c1-4b80-bc6e-7341d07b5622",
            "name": "Break Loop - Finished",
            "type": "break",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "6916b6f1-7b25-4d6b-adb5-898f19c70afc",
                "expression": {
                  "left": {
                    "name": "27c9932d-2e58-42ed-b0da-f28550418c95.status",
                    "type": "variable"
                  },
                  "op": "=~",
                  "right": {
                    "regexp": "finished",
                    "type": "regexp"
                  },
                  "type": "binary"
                },
                "expressionText": "{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}} =~ /finished/"
              }
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://eu.cdn-assets.connect.insight.rapid7.com/step-type-icons/break.svg",
            "connectionType": "NONE"
          },
          "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab": {
            "nodeId": "fd8ecd2a-59d3-4ad0-87e4-354bd22d8dab",
            "name": "MS-TEAMS - Scan Finished",
            "type": "action",
            "plugin": {
              "name": "Microsoft Teams",
              "slugVendor": "rapid7",
              "slugName": "microsoft_teams",
              "slugVersion": "3.1.3",
              "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
            },
            "identifier": "send_html_message",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "channel_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[channel_name]}}",
                "message_content": "<html>\n<p style=\"font-size:150%;\"><strong>The scan has finished with the following results:</strong></p>\n<dl>\n  <dt><strong>STATUS:</strong></dt>\n  <dd>- <i>{{[27c9932d-2e58-42ed-b0da-f28550418c95].[status]}}</i></dd>\n  <dt><strong>DURATION:</strong></dt>\n  <dd>- <i>{{[27c9932d-2e58-42ed-b0da-f28550418c95].[duration]}}</i></dd>\n  <dt><strong>VULNERABILITIES:</strong></dt>\n  <dd>- <i>SEVERE VULNERABILITIES:</i>  {{[27c9932d-2e58-42ed-b0da-f28550418c95].[vulnerabilities].[severe]}}</dd>\n  <dd>- <i>CRITICAL VULNERABILITIES:</i>  {{[27c9932d-2e58-42ed-b0da-f28550418c95].[vulnerabilities].[critical]}}</dd>\n  <dd>- <i>MODERATE VULNERABILITIES:</i>  {{[27c9932d-2e58-42ed-b0da-f28550418c95].[vulnerabilities].[moderate]}}</dd>\n</dl>\n</html>",
                "team_name": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[team_name]}}",
                "thread_id": "{{[9eb59f4b-f4c3-4783-8085-618fce021d83].[message].[id]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "channel_name": {
                  "description": "Channel name",
                  "order": 2,
                  "title": "Channel Name",
                  "type": "string"
                },
                "message_content": {
                  "description": "HTML content to send",
                  "order": 4,
                  "title": "Message Content",
                  "type": "string"
                },
                "team_name": {
                  "description": "Team name",
                  "order": 1,
                  "title": "Team Name",
                  "type": "string"
                },
                "thread_id": {
                  "description": "To post in a thread, select parent message ID",
                  "order": 3,
                  "title": "Thread ID",
                  "type": "string"
                }
              },
              "required": [
                "message_content",
                "team_name",
                "channel_name"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "body": {
                  "properties": {
                    "content": {
                      "description": "Content",
                      "order": 1,
                      "title": "Content",
                      "type": "string"
                    },
                    "contentType": {
                      "description": "Content type",
                      "order": 2,
                      "title": "Content Type",
                      "type": "string"
                    }
                  },
                  "title": "Body",
                  "type": "object"
                },
                "from": {
                  "properties": {
                    "user": {
                      "$ref": "#/definitions/user",
                      "description": "User",
                      "order": 1,
                      "title": "User"
                    }
                  },
                  "title": "From",
                  "type": "object"
                },
                "message": {
                  "properties": {
                    "body": {
                      "$ref": "#/definitions/body",
                      "description": "Body",
                      "order": 1,
                      "title": "Body"
                    },
                    "createdDateTime": {
                      "description": "Created date time",
                      "order": 3,
                      "title": "Created Date Time",
                      "type": "string"
                    },
                    "first_word": {
                      "description": "Extracted first word from message (easy way to obtain a chat command)",
                      "order": 9,
                      "title": "First Word",
                      "type": "string"
                    },
                    "from": {
                      "$ref": "#/definitions/from",
                      "description": "From",
                      "order": 2,
                      "title": "From"
                    },
                    "id": {
                      "description": "ID",
                      "order": 8,
                      "title": "ID",
                      "type": "string"
                    },
                    "importance": {
                      "description": "Importance",
                      "order": 5,
                      "title": "Importance",
                      "type": "string"
                    },
                    "locale": {
                      "description": "Locale",
                      "order": 7,
                      "title": "Locale",
                      "type": "string"
                    },
                    "messageType": {
                      "description": "Message type",
                      "order": 6,
                      "title": "Message Type",
                      "type": "string"
                    },
                    "webUrl": {
                      "description": "Web URL",
                      "order": 4,
                      "title": "Web URL",
                      "type": "string"
                    },
                    "words": {
                      "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Words",
                      "type": "array"
                    }
                  },
                  "required": [
                    "words",
                    "first_word"
                  ],
                  "title": "Message",
                  "type": "object"
                },
                "user": {
                  "properties": {
                    "displayName": {
                      "description": "Display name",
                      "order": 1,
                      "title": "Display name",
                      "type": "string"
                    },
                    "id": {
                      "description": "ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    }
                  },
                  "title": "User",
                  "type": "object"
                }
              },
              "properties": {
                "message": {
                  "$ref": "#/definitions/message",
                  "description": "The message object that was created",
                  "order": 1,
                  "title": "Message"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION"
          }
        },
        "tags": [
          "Asset Management",
          "Microsoft",
          "Rapid7",
          "Vulnerability Management"
        ],
        "humanCostSeconds": 300,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Site ID": {
                "type": "integer",
                "description": "The ID of the InsightVM (or Nexpose) site that should be used for scanning. See workflow setup instructions for details."
              },
              "Team Name": {
                "type": "string",
                "description": "The name of the Microsoft Teams Team where scans may be started from."
              },
              "Channel Name": {
                "type": "string",
                "description": "The name of the Microsoft Teams Channel where scans may be started from."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "623e1957-b4db-47b0-acd6-2668a242d112",
        "identifier": "new_message_received",
        "name": "scan-asset Trigger",
        "description": "",
        "input": {
          "channel_name": "{{$workflow.[Channel Name]}}",
          "message_content": "!scan-asset\\s\\S",
          "team_name": "{{$workflow.[Team Name]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "channel_name": {
              "description": "Channel",
              "order": 2,
              "title": "Channel Name",
              "type": "string"
            },
            "message_content": {
              "description": "Regex to match new messages against",
              "order": 3,
              "title": "Message Content",
              "type": "string"
            },
            "team_name": {
              "description": "Team name",
              "order": 1,
              "title": "Team Name",
              "type": "string"
            }
          },
          "required": [
            "team_name",
            "channel_name"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "body": {
              "properties": {
                "content": {
                  "description": "Content",
                  "order": 1,
                  "title": "Content",
                  "type": "string"
                },
                "contentType": {
                  "description": "Content type",
                  "order": 2,
                  "title": "Content Type",
                  "type": "string"
                }
              },
              "title": "Body",
              "type": "object"
            },
            "from": {
              "properties": {
                "user": {
                  "$ref": "#/definitions/user",
                  "description": "User",
                  "order": 1,
                  "title": "User"
                }
              },
              "title": "From",
              "type": "object"
            },
            "hashes": {
              "properties": {
                "md5_hashes": {
                  "description": "Extracted MD5 Hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "MD5 Hashes",
                  "type": "array"
                },
                "sha1_hashes": {
                  "description": "Extracted SHA1 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "SHA1 Hashes",
                  "type": "array"
                },
                "sha256_hashes": {
                  "description": "Extracted SHA256 hashes from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "SHA256 Hashes",
                  "type": "array"
                }
              },
              "title": "Hashes",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "cves": {
                  "description": "Extracted CVEs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CVEs",
                  "type": "array"
                },
                "domains": {
                  "description": "Extracted domains from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domains",
                  "type": "array"
                },
                "email_addresses": {
                  "description": "Extracted email addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 3,
                  "title": "Email Addresses",
                  "type": "array"
                },
                "hashes": {
                  "$ref": "#/definitions/hashes",
                  "description": "Extracted hashes from message",
                  "order": 4,
                  "title": "Hashes"
                },
                "ip_addresses": {
                  "$ref": "#/definitions/ip_addresses",
                  "description": "Extracted IP addresses from message",
                  "order": 5,
                  "title": "IP Addressses"
                },
                "mac_addresses": {
                  "description": "Extracted MAC addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "MAC Addresses",
                  "type": "array"
                },
                "urls": {
                  "description": "Extracted URLs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "URLs",
                  "type": "array"
                },
                "uuids": {
                  "description": "Extracted UUIDs from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "UUIDs",
                  "type": "array"
                }
              },
              "title": "Indicators",
              "type": "object"
            },
            "ip_addresses": {
              "properties": {
                "ipv4_addresses": {
                  "description": "Extracted IPv4 addressses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IPv4 Addressses",
                  "type": "array"
                },
                "ipv6_addresses": {
                  "description": "Extracted IPv6 addresses from message",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "IPv6 Addressses",
                  "type": "array"
                }
              },
              "title": "Ip Addresses",
              "type": "object"
            },
            "message": {
              "properties": {
                "body": {
                  "$ref": "#/definitions/body",
                  "description": "Body",
                  "order": 1,
                  "title": "Body"
                },
                "createdDateTime": {
                  "description": "Created date time",
                  "order": 3,
                  "title": "Created Date Time",
                  "type": "string"
                },
                "first_word": {
                  "description": "Extracted first word from message (easy way to obtain a chat command)",
                  "order": 9,
                  "title": "First Word",
                  "type": "string"
                },
                "from": {
                  "$ref": "#/definitions/from",
                  "description": "From",
                  "order": 2,
                  "title": "From"
                },
                "id": {
                  "description": "ID",
                  "order": 8,
                  "title": "ID",
                  "type": "string"
                },
                "importance": {
                  "description": "Importance",
                  "order": 5,
                  "title": "Importance",
                  "type": "string"
                },
                "locale": {
                  "description": "Locale",
                  "order": 7,
                  "title": "Locale",
                  "type": "string"
                },
                "messageType": {
                  "description": "Message type",
                  "order": 6,
                  "title": "Message Type",
                  "type": "string"
                },
                "webUrl": {
                  "description": "Web URL",
                  "order": 4,
                  "title": "Web URL",
                  "type": "string"
                },
                "words": {
                  "description": "The message split by spaces into a list of words. This list makes finding and using parameters in chat commands easier",
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Words",
                  "type": "array"
                }
              },
              "required": [
                "words",
                "first_word"
              ],
              "title": "Message",
              "type": "object"
            },
            "user": {
              "properties": {
                "displayName": {
                  "description": "Display name",
                  "order": 1,
                  "title": "Display name",
                  "type": "string"
                },
                "id": {
                  "description": "ID",
                  "order": 2,
                  "title": "ID",
                  "type": "string"
                }
              },
              "title": "User",
              "type": "object"
            }
          },
          "properties": {
            "channel_name": {
              "description": "Name of the channel where the message was posted",
              "order": 3,
              "title": "Channel Name",
              "type": "string"
            },
            "indicators": {
              "$ref": "#/definitions/indicators",
              "description": "The indicators object that was extracted from message",
              "order": 2,
              "title": "Indicators"
            },
            "message": {
              "$ref": "#/definitions/message",
              "description": "The message object that was created",
              "order": 1,
              "title": "Message"
            },
            "team_name": {
              "description": "Name of the team to which the channel is assigned to",
              "order": 4,
              "title": "Team Name",
              "type": "string"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Teams",
          "slugVendor": "rapid7",
          "slugName": "microsoft_teams",
          "slugVersion": "3.1.3",
          "imageData": "https://eu.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_teams/3.1.3/icon.png"
        }
      }
    ]
  }
}